-- LinguisticNotePropertyType
-- []
-- Snowflake SQL : LinguisticNotePropertyType 

CREATE INDEX ON notes.linguisticnote_pt (linguisticnote_id);
CREATE INDEX ON notes.linguisticnote (id);

CREATE MATERIALIZED VIEW notes.linguisticnote_view AS
SELECT 
    notes.linguisticnote_pt.id,
    notes.linguisticnote.note_lang AS lang,
    COALESCE(notes.linguisticnote.note_value, '('|| notes.linguisticnote.note_nilreason ||')') AS note
FROM notes.linguisticnote_pt
INNER JOIN notes.linguisticnote ON notes.linguisticnote_pt.linguisticnote_id = notes.linguisticnote.id;

CREATE INDEX ON notes.linguisticnote_view (id);
-- NotePropertyType
-- ['notes.linguisticnote_view']
-- Snowflake SQL : NotePropertyType 

CREATE INDEX ON notes.note_pt (note_id);
CREATE INDEX ON notes.note (id);

CREATE MATERIALIZED VIEW notes.note_view AS
SELECT
    notes.note_pt.id,
    jsonb_build_object(
        'propertyName', COALESCE(notes.note.propertyname_value, '(' || notes.note.propertyname_nilreason || ')'),
        'purpose', COALESCE(notes.note.purpose_value, '(' || notes.note.purpose_nilreason || ')'),
        'notes', translated_notes.notes_array
    ) AS note
FROM notes.note_pt
INNER JOIN notes.note ON notes.note_pt.note_id = notes.note.id
LEFT JOIN LATERAL (
    SELECT jsonb_agg(
        jsonb_build_object(
            'id', notes.linguisticnote_view.id,
            'lang', notes.linguisticnote_view.lang,
            'note', notes.linguisticnote_view.note
        )
    ) AS notes_array
    FROM master_join
    JOIN notes.linguisticnote_view ON master_join.target_id = notes.linguisticnote_view.id
    WHERE master_join.source_id = notes.note.id
) AS translated_notes ON true;

CREATE INDEX ON notes.note_view (id);
-- AircraftCharacteristicPropertyType
-- ['notes.note_view']
create or replace view shared.aircraftcharacteristic_view as
select
    shared.aircraftcharacteristic_pt.id,
    shared.aircraftcharacteristic_pt.nilreason AS aircraftcharacteristic_nilreason,
    coalesce(cast(shared.aircraftcharacteristic.type_value as varchar), '(' || shared.aircraftcharacteristic.type_nilreason || ')') as type,
    coalesce(cast(shared.aircraftcharacteristic.engine_value as varchar), '(' || shared.aircraftcharacteristic.engine_nilreason || ')') as engine,
    coalesce(cast(shared.aircraftcharacteristic.numberengine_value as varchar), '(' || shared.aircraftcharacteristic.numberengine_nilreason || ')') as numberengine,
    coalesce(cast(shared.aircraftcharacteristic.typeaircrafticao_value as varchar), '(' || shared.aircraftcharacteristic.typeaircrafticao_nilreason || ')') as typeaircrafticao,
    coalesce(cast(shared.aircraftcharacteristic.aircraftlandingcategory_value as varchar), '(' || shared.aircraftcharacteristic.aircraftlandingcategory_nilreason || ')') as aircraftlandingcategory,
    coalesce(cast(shared.aircraftcharacteristic.wingspaninterpretation_value as varchar), '(' || shared.aircraftcharacteristic.wingspaninterpretation_nilreason || ')') as wingspaninterpretation,
    coalesce(cast(shared.aircraftcharacteristic.classwingspan_value as varchar), '(' || shared.aircraftcharacteristic.classwingspan_nilreason || ')') as classwingspan,
    coalesce(cast(shared.aircraftcharacteristic.weightinterpretation_value as varchar), '(' || shared.aircraftcharacteristic.weightinterpretation_nilreason || ')') as weightinterpretation,
    coalesce(cast(shared.aircraftcharacteristic.passengers_value as varchar), '(' || shared.aircraftcharacteristic.passengers_nilreason || ')') as passengers,
    coalesce(cast(shared.aircraftcharacteristic.passengersinterpretation_value as varchar), '(' || shared.aircraftcharacteristic.passengersinterpretation_nilreason || ')') as passengersinterpretation,
    coalesce(cast(shared.aircraftcharacteristic.speedinterpretation_value as varchar), '(' || shared.aircraftcharacteristic.speedinterpretation_nilreason || ')') as speedinterpretation,
    coalesce(cast(shared.aircraftcharacteristic.waketurbulence_value as varchar), '(' || shared.aircraftcharacteristic.waketurbulence_nilreason || ')') as waketurbulence,
    coalesce(cast(shared.aircraftcharacteristic.navigationequipment_value as varchar), '(' || shared.aircraftcharacteristic.navigationequipment_nilreason || ')') as navigationequipment,
    coalesce(cast(shared.aircraftcharacteristic.navigationspecification_value as varchar), '(' || shared.aircraftcharacteristic.navigationspecification_nilreason || ')') as navigationspecification,
    coalesce(cast(shared.aircraftcharacteristic.verticalseparationcapability_value as varchar), '(' || shared.aircraftcharacteristic.verticalseparationcapability_nilreason || ')') as verticalseparationcapability,
    coalesce(cast(shared.aircraftcharacteristic.anticollisionandseparationequipment_value as varchar), '(' || shared.aircraftcharacteristic.anticollisionandseparationequipment_nilreason || ')') as anticollisionandseparationequipment,
    coalesce(cast(shared.aircraftcharacteristic.communicationequipment_value as varchar), '(' || shared.aircraftcharacteristic.communicationequipment_nilreason || ')') as communicationequipment,
    coalesce(cast(shared.aircraftcharacteristic.surveillanceequipment_value as varchar), '(' || shared.aircraftcharacteristic.surveillanceequipment_nilreason || ')') as surveillanceequipment,
    coalesce(cast(shared.aircraftcharacteristic.wingspan_value as varchar) || ' ' || shared.aircraftcharacteristic.wingspan_uom, '(' || shared.aircraftcharacteristic.wingspan_nilreason || ')') as wingspan,
    coalesce(cast(shared.aircraftcharacteristic.weight_value as varchar) || ' ' || shared.aircraftcharacteristic.weight_uom, '(' || shared.aircraftcharacteristic.weight_nilreason || ')') as weight,
    coalesce(cast(shared.aircraftcharacteristic.speed_value as varchar) || ' ' || shared.aircraftcharacteristic.speed_uom, '(' || shared.aircraftcharacteristic.speed_nilreason || ')') as speed,
    jsonb_agg(notes_note_view_rsdokk.*) AS aircraftcharacteristic_annotation
from shared.aircraftcharacteristic_pt 
inner join shared.aircraftcharacteristic on shared.aircraftcharacteristic_pt.aircraftcharacteristic_id = shared.aircraftcharacteristic.id
left join master_join master_join_zlmioh on shared.aircraftcharacteristic.id = master_join_zlmioh.source_id
left join notes.note_view notes_note_view_rsdokk on master_join_zlmioh.target_id = notes_note_view_rsdokk.id
group by
    shared.aircraftcharacteristic_pt.id,
    shared.aircraftcharacteristic_pt.nilreason,
    shared.aircraftcharacteristic.type_value,
    shared.aircraftcharacteristic.type_nilreason,
    shared.aircraftcharacteristic.engine_value,
    shared.aircraftcharacteristic.engine_nilreason,
    shared.aircraftcharacteristic.numberengine_value,
    shared.aircraftcharacteristic.numberengine_nilreason,
    shared.aircraftcharacteristic.typeaircrafticao_value,
    shared.aircraftcharacteristic.typeaircrafticao_nilreason,
    shared.aircraftcharacteristic.aircraftlandingcategory_value,
    shared.aircraftcharacteristic.aircraftlandingcategory_nilreason,
    shared.aircraftcharacteristic.wingspaninterpretation_value,
    shared.aircraftcharacteristic.wingspaninterpretation_nilreason,
    shared.aircraftcharacteristic.classwingspan_value,
    shared.aircraftcharacteristic.classwingspan_nilreason,
    shared.aircraftcharacteristic.weightinterpretation_value,
    shared.aircraftcharacteristic.weightinterpretation_nilreason,
    shared.aircraftcharacteristic.passengers_value,
    shared.aircraftcharacteristic.passengers_nilreason,
    shared.aircraftcharacteristic.passengersinterpretation_value,
    shared.aircraftcharacteristic.passengersinterpretation_nilreason,
    shared.aircraftcharacteristic.speedinterpretation_value,
    shared.aircraftcharacteristic.speedinterpretation_nilreason,
    shared.aircraftcharacteristic.waketurbulence_value,
    shared.aircraftcharacteristic.waketurbulence_nilreason,
    shared.aircraftcharacteristic.navigationequipment_value,
    shared.aircraftcharacteristic.navigationequipment_nilreason,
    shared.aircraftcharacteristic.navigationspecification_value,
    shared.aircraftcharacteristic.navigationspecification_nilreason,
    shared.aircraftcharacteristic.verticalseparationcapability_value,
    shared.aircraftcharacteristic.verticalseparationcapability_nilreason,
    shared.aircraftcharacteristic.anticollisionandseparationequipment_value,
    shared.aircraftcharacteristic.anticollisionandseparationequipment_nilreason,
    shared.aircraftcharacteristic.communicationequipment_value,
    shared.aircraftcharacteristic.communicationequipment_nilreason,
    shared.aircraftcharacteristic.surveillanceequipment_value,
    shared.aircraftcharacteristic.surveillanceequipment_nilreason,
    shared.aircraftcharacteristic.wingspan_value,
    shared.aircraftcharacteristic.wingspan_uom,
    shared.aircraftcharacteristic.wingspan_nilreason,
    shared.aircraftcharacteristic.weight_value,
    shared.aircraftcharacteristic.weight_uom,
    shared.aircraftcharacteristic.weight_nilreason,
    shared.aircraftcharacteristic.speed_value,
    shared.aircraftcharacteristic.speed_uom,
    shared.aircraftcharacteristic.speed_nilreason;
-- AirspaceLayerPropertyType
-- ['notes.note_view']
create or replace view shared.airspacelayer_view as
select
    shared.airspacelayer_pt.id,
    shared.airspacelayer_pt.nilreason AS airspacelayer_nilreason,
    coalesce(cast(shared.airspacelayer.upperlimitreference_value as varchar), '(' || shared.airspacelayer.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(shared.airspacelayer.lowerlimitreference_value as varchar), '(' || shared.airspacelayer.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(shared.airspacelayer.altitudeinterpretation_value as varchar), '(' || shared.airspacelayer.altitudeinterpretation_nilreason || ')') as altitudeinterpretation,
    coalesce(cast(shared.airspacelayer.upperlimit_value as varchar) || ' ' || shared.airspacelayer.upperlimit_uom, '(' || shared.airspacelayer.upperlimit_nilreason || ')') as upperlimit,
    coalesce(cast(shared.airspacelayer.lowerlimit_value as varchar) || ' ' || shared.airspacelayer.lowerlimit_uom, '(' || shared.airspacelayer.lowerlimit_nilreason || ')') as lowerlimit,
    coalesce(cast(shared_standardlevelcolumn_pt_ebbogi.title as varchar), '(' || shared_standardlevelcolumn_pt_ebbogi.nilreason[1] || ')') AS discretelevelseries,
    shared_standardlevelcolumn_pt_ebbogi.href AS discretelevelseries_href,
    jsonb_agg(notes_note_view_homiic.*) AS airspacelayer_annotation
from shared.airspacelayer_pt 
inner join shared.airspacelayer on shared.airspacelayer_pt.airspacelayer_id = shared.airspacelayer.id
left join shared.standardlevelcolumn_pt shared_standardlevelcolumn_pt_ebbogi on shared.airspacelayer.discretelevelseries_id = shared_standardlevelcolumn_pt_ebbogi.id
left join master_join master_join_rqljfo on shared.airspacelayer.id = master_join_rqljfo.source_id
left join notes.note_view notes_note_view_homiic on master_join_rqljfo.target_id = notes_note_view_homiic.id
group by
    shared.airspacelayer_pt.id,
    shared.airspacelayer_pt.nilreason,
    shared.airspacelayer.upperlimitreference_value,
    shared.airspacelayer.upperlimitreference_nilreason,
    shared.airspacelayer.lowerlimitreference_value,
    shared.airspacelayer.lowerlimitreference_nilreason,
    shared.airspacelayer.altitudeinterpretation_value,
    shared.airspacelayer.altitudeinterpretation_nilreason,
    shared.airspacelayer.upperlimit_value,
    shared.airspacelayer.upperlimit_uom,
    shared.airspacelayer.upperlimit_nilreason,
    shared.airspacelayer.lowerlimit_value,
    shared.airspacelayer.lowerlimit_uom,
    shared.airspacelayer.lowerlimit_nilreason,
    shared_standardlevelcolumn_pt_ebbogi.title,
    shared_standardlevelcolumn_pt_ebbogi.nilreason[1],
    shared_standardlevelcolumn_pt_ebbogi.href;
-- AirspaceVolumeDependencyPropertyType
-- ['notes.note_view']
create or replace view airspace.airspacevolumedependency_view as
select
    airspace.airspacevolumedependency_pt.id,
    airspace.airspacevolumedependency_pt.nilreason AS airspacevolumedependency_nilreason,
    coalesce(cast(airspace.airspacevolumedependency.dependency_value as varchar), '(' || airspace.airspacevolumedependency.dependency_nilreason || ')') as dependency,
    coalesce(cast(airspace_airspace_pt_oyopee.title as varchar), '(' || airspace_airspace_pt_oyopee.nilreason[1] || ')') AS theairspace,
    airspace_airspace_pt_oyopee.href AS theairspace_href,
    jsonb_agg(notes_note_view_vqjwba.*) AS airspacevolumedependency_annotation
from airspace.airspacevolumedependency_pt 
inner join airspace.airspacevolumedependency on airspace.airspacevolumedependency_pt.airspacevolumedependency_id = airspace.airspacevolumedependency.id
left join airspace.airspace_pt airspace_airspace_pt_oyopee on airspace.airspacevolumedependency.theairspace_id = airspace_airspace_pt_oyopee.id
left join master_join master_join_zsomnq on airspace.airspacevolumedependency.id = master_join_zsomnq.source_id
left join notes.note_view notes_note_view_vqjwba on master_join_zsomnq.target_id = notes_note_view_vqjwba.id
group by
    airspace.airspacevolumedependency_pt.id,
    airspace.airspacevolumedependency_pt.nilreason,
    airspace.airspacevolumedependency.dependency_value,
    airspace.airspacevolumedependency.dependency_nilreason,
    airspace_airspace_pt_oyopee.title,
    airspace_airspace_pt_oyopee.nilreason[1],
    airspace_airspace_pt_oyopee.href;
-- AltitudeAdjustmentPropertyType
-- ['notes.note_view']
create or replace view shared.altitudeadjustment_view as
select
    shared.altitudeadjustment_pt.id,
    shared.altitudeadjustment_pt.nilreason AS altitudeadjustment_nilreason,
    coalesce(cast(shared.altitudeadjustment.altitudeadjustmenttype_value as varchar), '(' || shared.altitudeadjustment.altitudeadjustmenttype_nilreason || ')') as altitudeadjustmenttype,
    coalesce(cast(shared.altitudeadjustment.primaryalternateminimum_value as varchar), '(' || shared.altitudeadjustment.primaryalternateminimum_nilreason || ')') as primaryalternateminimum,
    coalesce(cast(shared.altitudeadjustment.localremotecode_value as varchar), '(' || shared.altitudeadjustment.localremotecode_nilreason || ')') as localremotecode,
    coalesce(cast(shared.altitudeadjustment.altitudeadjustment_value as varchar) || ' ' || shared.altitudeadjustment.altitudeadjustment_uom, '(' || shared.altitudeadjustment.altitudeadjustment_nilreason || ')') as altitudeadjustment,
    jsonb_agg(notes_note_view_rureja.*) AS altitudeadjustment_annotation
from shared.altitudeadjustment_pt 
inner join shared.altitudeadjustment on shared.altitudeadjustment_pt.altitudeadjustment_id = shared.altitudeadjustment.id
left join master_join master_join_nhdctf on shared.altitudeadjustment.id = master_join_nhdctf.source_id
left join notes.note_view notes_note_view_rureja on master_join_nhdctf.target_id = notes_note_view_rureja.id
group by
    shared.altitudeadjustment_pt.id,
    shared.altitudeadjustment_pt.nilreason,
    shared.altitudeadjustment.altitudeadjustmenttype_value,
    shared.altitudeadjustment.altitudeadjustmenttype_nilreason,
    shared.altitudeadjustment.primaryalternateminimum_value,
    shared.altitudeadjustment.primaryalternateminimum_nilreason,
    shared.altitudeadjustment.localremotecode_value,
    shared.altitudeadjustment.localremotecode_nilreason,
    shared.altitudeadjustment.altitudeadjustment_value,
    shared.altitudeadjustment.altitudeadjustment_uom,
    shared.altitudeadjustment.altitudeadjustment_nilreason;
-- AngleUsePropertyType
-- ['notes.note_view']
create or replace view navaids_points.angleuse_view as
select
    navaids_points.angleuse_pt.id,
    navaids_points.angleuse_pt.nilreason AS angleuse_nilreason,
    coalesce(cast(navaids_points.angleuse.alongcourseguidance_value as varchar), '(' || navaids_points.angleuse.alongcourseguidance_nilreason || ')') as alongcourseguidance,
    coalesce(cast(navaids_points_angleindication_pt_apocdb.title as varchar), '(' || navaids_points_angleindication_pt_apocdb.nilreason[1] || ')') AS theangleindication,
    navaids_points_angleindication_pt_apocdb.href AS theangleindication_href,
    jsonb_agg(notes_note_view_giosle.*) AS angleuse_annotation
from navaids_points.angleuse_pt 
inner join navaids_points.angleuse on navaids_points.angleuse_pt.angleuse_id = navaids_points.angleuse.id
left join navaids_points.angleindication_pt navaids_points_angleindication_pt_apocdb on navaids_points.angleuse.theangleindication_id = navaids_points_angleindication_pt_apocdb.id
left join master_join master_join_xfmgjm on navaids_points.angleuse.id = master_join_xfmgjm.source_id
left join notes.note_view notes_note_view_giosle on master_join_xfmgjm.target_id = notes_note_view_giosle.id
group by
    navaids_points.angleuse_pt.id,
    navaids_points.angleuse_pt.nilreason,
    navaids_points.angleuse.alongcourseguidance_value,
    navaids_points.angleuse.alongcourseguidance_nilreason,
    navaids_points_angleindication_pt_apocdb.title,
    navaids_points_angleindication_pt_apocdb.nilreason[1],
    navaids_points_angleindication_pt_apocdb.href;
-- ApproachAltitudeTablePropertyType
-- ['notes.note_view']
create or replace view procedure.approachaltitudetable_view as
select
    procedure.approachaltitudetable_pt.id,
    procedure.approachaltitudetable_pt.nilreason AS approachaltitudetable_nilreason,
    coalesce(cast(procedure.approachaltitudetable.measurementpoint_value as varchar), '(' || procedure.approachaltitudetable.measurementpoint_nilreason || ')') as measurementpoint,
    coalesce(cast(procedure.approachaltitudetable.altitudereference_value as varchar), '(' || procedure.approachaltitudetable.altitudereference_nilreason || ')') as altitudereference,
    coalesce(cast(procedure.approachaltitudetable.altitude_value as varchar) || ' ' || procedure.approachaltitudetable.altitude_uom, '(' || procedure.approachaltitudetable.altitude_nilreason || ')') as altitude,
    jsonb_agg(notes_note_view_uesfhx.*) AS approachaltitudetable_annotation
from procedure.approachaltitudetable_pt 
inner join procedure.approachaltitudetable on procedure.approachaltitudetable_pt.approachaltitudetable_id = procedure.approachaltitudetable.id
left join master_join master_join_ckikep on procedure.approachaltitudetable.id = master_join_ckikep.source_id
left join notes.note_view notes_note_view_uesfhx on master_join_ckikep.target_id = notes_note_view_uesfhx.id
group by
    procedure.approachaltitudetable_pt.id,
    procedure.approachaltitudetable_pt.nilreason,
    procedure.approachaltitudetable.measurementpoint_value,
    procedure.approachaltitudetable.measurementpoint_nilreason,
    procedure.approachaltitudetable.altitudereference_value,
    procedure.approachaltitudetable.altitudereference_nilreason,
    procedure.approachaltitudetable.altitude_value,
    procedure.approachaltitudetable.altitude_uom,
    procedure.approachaltitudetable.altitude_nilreason;
-- ApproachDistanceTablePropertyType
-- ['notes.note_view']
create or replace view procedure.approachdistancetable_view as
select
    procedure.approachdistancetable_pt.id,
    procedure.approachdistancetable_pt.nilreason AS approachdistancetable_nilreason,
    coalesce(cast(procedure.approachdistancetable.startingmeasurementpoint_value as varchar), '(' || procedure.approachdistancetable.startingmeasurementpoint_nilreason || ')') as startingmeasurementpoint,
    coalesce(cast(procedure.approachdistancetable.endingmeasurementpoint_value as varchar), '(' || procedure.approachdistancetable.endingmeasurementpoint_nilreason || ')') as endingmeasurementpoint,
    coalesce(cast(procedure.approachdistancetable.valuehat_value as varchar) || ' ' || procedure.approachdistancetable.valuehat_uom, '(' || procedure.approachdistancetable.valuehat_nilreason || ')') as valuehat,
    coalesce(cast(procedure.approachdistancetable.distance_value as varchar) || ' ' || procedure.approachdistancetable.distance_uom, '(' || procedure.approachdistancetable.distance_nilreason || ')') as distance,
    jsonb_agg(notes_note_view_rdfzxg.*) AS approachdistancetable_annotation
from procedure.approachdistancetable_pt 
inner join procedure.approachdistancetable on procedure.approachdistancetable_pt.approachdistancetable_id = procedure.approachdistancetable.id
left join master_join master_join_stkloc on procedure.approachdistancetable.id = master_join_stkloc.source_id
left join notes.note_view notes_note_view_rdfzxg on master_join_stkloc.target_id = notes_note_view_rdfzxg.id
group by
    procedure.approachdistancetable_pt.id,
    procedure.approachdistancetable_pt.nilreason,
    procedure.approachdistancetable.startingmeasurementpoint_value,
    procedure.approachdistancetable.startingmeasurementpoint_nilreason,
    procedure.approachdistancetable.endingmeasurementpoint_value,
    procedure.approachdistancetable.endingmeasurementpoint_nilreason,
    procedure.approachdistancetable.valuehat_value,
    procedure.approachdistancetable.valuehat_uom,
    procedure.approachdistancetable.valuehat_nilreason,
    procedure.approachdistancetable.distance_value,
    procedure.approachdistancetable.distance_uom,
    procedure.approachdistancetable.distance_nilreason;
-- ApproachTimingTablePropertyType
-- ['notes.note_view']
create or replace view procedure.approachtimingtable_view as
select
    procedure.approachtimingtable_pt.id,
    procedure.approachtimingtable_pt.nilreason AS approachtimingtable_nilreason,
    coalesce(cast(procedure.approachtimingtable.startingmeasurementpoint_value as varchar), '(' || procedure.approachtimingtable.startingmeasurementpoint_nilreason || ')') as startingmeasurementpoint,
    coalesce(cast(procedure.approachtimingtable.endingmeasurementpoint_value as varchar), '(' || procedure.approachtimingtable.endingmeasurementpoint_nilreason || ')') as endingmeasurementpoint,
    coalesce(cast(procedure.approachtimingtable.time_value as varchar) || ' ' || procedure.approachtimingtable.time_uom, '(' || procedure.approachtimingtable.time_nilreason || ')') as time,
    coalesce(cast(procedure.approachtimingtable.speed_value as varchar) || ' ' || procedure.approachtimingtable.speed_uom, '(' || procedure.approachtimingtable.speed_nilreason || ')') as speed,
    jsonb_agg(notes_note_view_zvzfuj.*) AS approachtimingtable_annotation
from procedure.approachtimingtable_pt 
inner join procedure.approachtimingtable on procedure.approachtimingtable_pt.approachtimingtable_id = procedure.approachtimingtable.id
left join master_join master_join_virvsm on procedure.approachtimingtable.id = master_join_virvsm.source_id
left join notes.note_view notes_note_view_zvzfuj on master_join_virvsm.target_id = notes_note_view_zvzfuj.id
group by
    procedure.approachtimingtable_pt.id,
    procedure.approachtimingtable_pt.nilreason,
    procedure.approachtimingtable.startingmeasurementpoint_value,
    procedure.approachtimingtable.startingmeasurementpoint_nilreason,
    procedure.approachtimingtable.endingmeasurementpoint_value,
    procedure.approachtimingtable.endingmeasurementpoint_nilreason,
    procedure.approachtimingtable.time_value,
    procedure.approachtimingtable.time_uom,
    procedure.approachtimingtable.time_nilreason,
    procedure.approachtimingtable.speed_value,
    procedure.approachtimingtable.speed_uom,
    procedure.approachtimingtable.speed_nilreason;
-- AuthorityForAerialRefuellingPropertyType
-- ['notes.note_view']
create or replace view aerial_refuelling.authorityforaerialrefuelling_view as
select
    aerial_refuelling.authorityforaerialrefuelling_pt.id,
    aerial_refuelling.authorityforaerialrefuelling_pt.nilreason AS authorityforaerialrefuelling_nilreason,
    coalesce(cast(aerial_refuelling.authorityforaerialrefuelling.type_value as varchar), '(' || aerial_refuelling.authorityforaerialrefuelling.type_nilreason || ')') as type,
    coalesce(cast(organisation_organisationauthority_pt_hpggre.title as varchar), '(' || organisation_organisationauthority_pt_hpggre.nilreason[1] || ')') AS theorganisationauthority,
    organisation_organisationauthority_pt_hpggre.href AS theorganisationauthority_href,
    jsonb_agg(notes_note_view_gxdjal.*) AS authorityforaerialrefuelling_annotation
from aerial_refuelling.authorityforaerialrefuelling_pt 
inner join aerial_refuelling.authorityforaerialrefuelling on aerial_refuelling.authorityforaerialrefuelling_pt.authorityforaerialrefuelling_id = aerial_refuelling.authorityforaerialrefuelling.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_hpggre on aerial_refuelling.authorityforaerialrefuelling.theorganisationauthority_id = organisation_organisationauthority_pt_hpggre.id
left join master_join master_join_cbsqml on aerial_refuelling.authorityforaerialrefuelling.id = master_join_cbsqml.source_id
left join notes.note_view notes_note_view_gxdjal on master_join_cbsqml.target_id = notes_note_view_gxdjal.id
group by
    aerial_refuelling.authorityforaerialrefuelling_pt.id,
    aerial_refuelling.authorityforaerialrefuelling_pt.nilreason,
    aerial_refuelling.authorityforaerialrefuelling.type_value,
    aerial_refuelling.authorityforaerialrefuelling.type_nilreason,
    organisation_organisationauthority_pt_hpggre.title,
    organisation_organisationauthority_pt_hpggre.nilreason[1],
    organisation_organisationauthority_pt_hpggre.href;
-- AuthorityForNavaidEquipmentPropertyType
-- ['notes.note_view']
create or replace view navaids_points.authorityfornavaidequipment_view as
select
    navaids_points.authorityfornavaidequipment_pt.id,
    navaids_points.authorityfornavaidequipment_pt.nilreason AS authorityfornavaidequipment_nilreason,
    coalesce(cast(navaids_points.authorityfornavaidequipment.type_value as varchar), '(' || navaids_points.authorityfornavaidequipment.type_nilreason || ')') as type,
    coalesce(cast(organisation_organisationauthority_pt_purrmf.title as varchar), '(' || organisation_organisationauthority_pt_purrmf.nilreason[1] || ')') AS theorganisationauthority,
    organisation_organisationauthority_pt_purrmf.href AS theorganisationauthority_href,
    jsonb_agg(notes_note_view_fgoogc.*) AS authorityfornavaidequipment_annotation
from navaids_points.authorityfornavaidequipment_pt 
inner join navaids_points.authorityfornavaidequipment on navaids_points.authorityfornavaidequipment_pt.authorityfornavaidequipment_id = navaids_points.authorityfornavaidequipment.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_purrmf on navaids_points.authorityfornavaidequipment.theorganisationauthority_id = organisation_organisationauthority_pt_purrmf.id
left join master_join master_join_bxcami on navaids_points.authorityfornavaidequipment.id = master_join_bxcami.source_id
left join notes.note_view notes_note_view_fgoogc on master_join_bxcami.target_id = notes_note_view_fgoogc.id
group by
    navaids_points.authorityfornavaidequipment_pt.id,
    navaids_points.authorityfornavaidequipment_pt.nilreason,
    navaids_points.authorityfornavaidequipment.type_value,
    navaids_points.authorityfornavaidequipment.type_nilreason,
    organisation_organisationauthority_pt_purrmf.title,
    organisation_organisationauthority_pt_purrmf.nilreason[1],
    organisation_organisationauthority_pt_purrmf.href;
-- AuthorityForSpecialNavigationStationPropertyType
-- ['notes.note_view']
create or replace view navaids_points.authorityforspecialnavigationstation_view as
select
    navaids_points.authorityforspecialnavigationstation_pt.id,
    navaids_points.authorityforspecialnavigationstation_pt.nilreason AS authorityforspecialnavigationstation_nilreason,
    coalesce(cast(navaids_points.authorityforspecialnavigationstation.type_value as varchar), '(' || navaids_points.authorityforspecialnavigationstation.type_nilreason || ')') as type,
    coalesce(cast(organisation_organisationauthority_pt_gteadi.title as varchar), '(' || organisation_organisationauthority_pt_gteadi.nilreason[1] || ')') AS theorganisationauthority,
    organisation_organisationauthority_pt_gteadi.href AS theorganisationauthority_href,
    jsonb_agg(notes_note_view_xovebc.*) AS authorityforspecialnavigationstation_annotation
from navaids_points.authorityforspecialnavigationstation_pt 
inner join navaids_points.authorityforspecialnavigationstation on navaids_points.authorityforspecialnavigationstation_pt.authorityforspecialnavigationstation_id = navaids_points.authorityforspecialnavigationstation.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_gteadi on navaids_points.authorityforspecialnavigationstation.theorganisationauthority_id = organisation_organisationauthority_pt_gteadi.id
left join master_join master_join_sckkxx on navaids_points.authorityforspecialnavigationstation.id = master_join_sckkxx.source_id
left join notes.note_view notes_note_view_xovebc on master_join_sckkxx.target_id = notes_note_view_xovebc.id
group by
    navaids_points.authorityforspecialnavigationstation_pt.id,
    navaids_points.authorityforspecialnavigationstation_pt.nilreason,
    navaids_points.authorityforspecialnavigationstation.type_value,
    navaids_points.authorityforspecialnavigationstation.type_nilreason,
    organisation_organisationauthority_pt_gteadi.title,
    organisation_organisationauthority_pt_gteadi.nilreason[1],
    organisation_organisationauthority_pt_gteadi.href;
-- AuthorityForSpecialNavigationSystemPropertyType
-- ['notes.note_view']
create or replace view navaids_points.authorityforspecialnavigationsystem_view as
select
    navaids_points.authorityforspecialnavigationsystem_pt.id,
    navaids_points.authorityforspecialnavigationsystem_pt.nilreason AS authorityforspecialnavigationsystem_nilreason,
    coalesce(cast(navaids_points.authorityforspecialnavigationsystem.type_value as varchar), '(' || navaids_points.authorityforspecialnavigationsystem.type_nilreason || ')') as type,
    coalesce(cast(organisation_organisationauthority_pt_jlkdyi.title as varchar), '(' || organisation_organisationauthority_pt_jlkdyi.nilreason[1] || ')') AS theorganisationauthority,
    organisation_organisationauthority_pt_jlkdyi.href AS theorganisationauthority_href,
    jsonb_agg(notes_note_view_eycyqz.*) AS authorityforspecialnavigationsystem_annotation
from navaids_points.authorityforspecialnavigationsystem_pt 
inner join navaids_points.authorityforspecialnavigationsystem on navaids_points.authorityforspecialnavigationsystem_pt.authorityforspecialnavigationsystem_id = navaids_points.authorityforspecialnavigationsystem.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_jlkdyi on navaids_points.authorityforspecialnavigationsystem.theorganisationauthority_id = organisation_organisationauthority_pt_jlkdyi.id
left join master_join master_join_sppjtg on navaids_points.authorityforspecialnavigationsystem.id = master_join_sppjtg.source_id
left join notes.note_view notes_note_view_eycyqz on master_join_sppjtg.target_id = notes_note_view_eycyqz.id
group by
    navaids_points.authorityforspecialnavigationsystem_pt.id,
    navaids_points.authorityforspecialnavigationsystem_pt.nilreason,
    navaids_points.authorityforspecialnavigationsystem.type_value,
    navaids_points.authorityforspecialnavigationsystem.type_nilreason,
    organisation_organisationauthority_pt_jlkdyi.title,
    organisation_organisationauthority_pt_jlkdyi.nilreason[1],
    organisation_organisationauthority_pt_jlkdyi.href;
-- CallsignDetailPropertyType
-- ['notes.note_view']
create or replace view service.callsigndetail_view as
select
    service.callsigndetail_pt.id,
    service.callsigndetail_pt.nilreason AS callsigndetail_nilreason,
    coalesce(cast(service.callsigndetail.callsign_value as varchar), '(' || service.callsigndetail.callsign_nilreason || ')') as callsign,
    coalesce(cast(service.callsigndetail.language_value as varchar), '(' || service.callsigndetail.language_nilreason || ')') as language,
    jsonb_agg(notes_note_view_sfeljf.*) AS callsigndetail_annotation
from service.callsigndetail_pt 
inner join service.callsigndetail on service.callsigndetail_pt.callsigndetail_id = service.callsigndetail.id
left join master_join master_join_hoenkw on service.callsigndetail.id = master_join_hoenkw.source_id
left join notes.note_view notes_note_view_sfeljf on master_join_hoenkw.target_id = notes_note_view_sfeljf.id
group by
    service.callsigndetail_pt.id,
    service.callsigndetail_pt.nilreason,
    service.callsigndetail.callsign_value,
    service.callsigndetail.callsign_nilreason,
    service.callsigndetail.language_value,
    service.callsigndetail.language_nilreason;
-- CircleSectorPropertyType
-- ['notes.note_view']
create or replace view shared.circlesector_view as
select
    shared.circlesector_pt.id,
    shared.circlesector_pt.nilreason AS circlesector_nilreason,
    coalesce(cast(shared.circlesector.arcdirection_value as varchar), '(' || shared.circlesector.arcdirection_nilreason || ')') as arcdirection,
    coalesce(cast(shared.circlesector.fromangle_value as varchar), '(' || shared.circlesector.fromangle_nilreason || ')') as fromangle,
    coalesce(cast(shared.circlesector.toangle_value as varchar), '(' || shared.circlesector.toangle_nilreason || ')') as toangle,
    coalesce(cast(shared.circlesector.angletype_value as varchar), '(' || shared.circlesector.angletype_nilreason || ')') as angletype,
    coalesce(cast(shared.circlesector.angledirectionreference_value as varchar), '(' || shared.circlesector.angledirectionreference_nilreason || ')') as angledirectionreference,
    coalesce(cast(shared.circlesector.upperlimitreference_value as varchar), '(' || shared.circlesector.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(shared.circlesector.lowerlimitreference_value as varchar), '(' || shared.circlesector.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(shared.circlesector.innerdistance_value as varchar) || ' ' || shared.circlesector.innerdistance_uom, '(' || shared.circlesector.innerdistance_nilreason || ')') as innerdistance,
    coalesce(cast(shared.circlesector.outerdistance_value as varchar) || ' ' || shared.circlesector.outerdistance_uom, '(' || shared.circlesector.outerdistance_nilreason || ')') as outerdistance,
    coalesce(cast(shared.circlesector.upperlimit_value as varchar) || ' ' || shared.circlesector.upperlimit_uom, '(' || shared.circlesector.upperlimit_nilreason || ')') as upperlimit,
    coalesce(cast(shared.circlesector.lowerlimit_value as varchar) || ' ' || shared.circlesector.lowerlimit_uom, '(' || shared.circlesector.lowerlimit_nilreason || ')') as lowerlimit,
    jsonb_agg(notes_note_view_fgdmyo.*) AS circlesector_annotation
from shared.circlesector_pt 
inner join shared.circlesector on shared.circlesector_pt.circlesector_id = shared.circlesector.id
left join master_join master_join_prbtgc on shared.circlesector.id = master_join_prbtgc.source_id
left join notes.note_view notes_note_view_fgdmyo on master_join_prbtgc.target_id = notes_note_view_fgdmyo.id
group by
    shared.circlesector_pt.id,
    shared.circlesector_pt.nilreason,
    shared.circlesector.arcdirection_value,
    shared.circlesector.arcdirection_nilreason,
    shared.circlesector.fromangle_value,
    shared.circlesector.fromangle_nilreason,
    shared.circlesector.toangle_value,
    shared.circlesector.toangle_nilreason,
    shared.circlesector.angletype_value,
    shared.circlesector.angletype_nilreason,
    shared.circlesector.angledirectionreference_value,
    shared.circlesector.angledirectionreference_nilreason,
    shared.circlesector.upperlimitreference_value,
    shared.circlesector.upperlimitreference_nilreason,
    shared.circlesector.lowerlimitreference_value,
    shared.circlesector.lowerlimitreference_nilreason,
    shared.circlesector.innerdistance_value,
    shared.circlesector.innerdistance_uom,
    shared.circlesector.innerdistance_nilreason,
    shared.circlesector.outerdistance_value,
    shared.circlesector.outerdistance_uom,
    shared.circlesector.outerdistance_nilreason,
    shared.circlesector.upperlimit_value,
    shared.circlesector.upperlimit_uom,
    shared.circlesector.upperlimit_nilreason,
    shared.circlesector.lowerlimit_value,
    shared.circlesector.lowerlimit_uom,
    shared.circlesector.lowerlimit_nilreason;
-- CityPropertyType
-- ['notes.note_view']
create or replace view airport_heliport.city_view as
select
    airport_heliport.city_pt.id,
    airport_heliport.city_pt.nilreason AS city_nilreason,
    coalesce(cast(airport_heliport.city.name_value as varchar), '(' || airport_heliport.city.name_nilreason || ')') as name,
    jsonb_agg(notes_note_view_wxshin.*) AS city_annotation
from airport_heliport.city_pt 
inner join airport_heliport.city on airport_heliport.city_pt.city_id = airport_heliport.city.id
left join master_join master_join_pmmust on airport_heliport.city.id = master_join_pmmust.source_id
left join notes.note_view notes_note_view_wxshin on master_join_pmmust.target_id = notes_note_view_wxshin.id
group by
    airport_heliport.city_pt.id,
    airport_heliport.city_pt.nilreason,
    airport_heliport.city.name_value,
    airport_heliport.city.name_nilreason;
-- CurvePropertyType
-- ['notes.note_view']
-- Snowflake SQL : CurvePropertyType 

CREATE MATERIALIZED VIEW geometry.curve_view AS
WITH 
center AS (
    SELECT 
		id, 
		point,
		radius,
		start_angle,
		end_angle,
		(end_angle - start_angle) / 100 AS step_size
    FROM public.linestring_segment 
	WHERE public.linestring_segment.interpretation = 2
	UNION ALL 
	SELECT 
		id, 
		point,
		radius,
		0 as start_angle,
		2*PI() as end_angle,
		(0 - 2*PI()) / 100 AS step_size
    FROM public.linestring_segment 
	WHERE public.linestring_segment.interpretation = 3
),
interpolated_points AS (
    SELECT 
        center.id,
		ST_Project(center.point::geography, center.radius, center.start_angle + center.step_size * n)::geometry AS point_geom
    FROM 
        generate_series(0, 100) AS n, 	
        center
),
arc_line AS (
    SELECT 
        interpolated_points.id,
        ST_MakeLine(point_geom) AS arc_geom
    FROM interpolated_points
    GROUP BY id
),
segment_union AS (
    SELECT 
		id, 
		ST_ReducePrecision(linestring,0.000000000000001) AS geom
    FROM
		public.linestring_segment 
    WHERE 
		public.linestring_segment.interpretation = 0
    UNION ALL 
    SELECT 
		id, 
		ST_Segmentize((ST_ReducePrecision(linestring, 0.000000000000001)::geography), 1000)::geometry AS geom
    FROM 
		public.linestring_segment 
    WHERE 
		public.linestring_segment.interpretation = 1
    UNION ALL 
    SELECT 
		id, 
		ST_ReducePrecision(arc_geom, 0.000000000000001) AS geom
    FROM 
		arc_line
),
merged_segments AS (
    SELECT 
        geometry.curve_pt.id,
        ST_LineMerge(ST_Collect(segment_union.geom)) AS merged_geom,
		horizontalaccuracy,
		horizontalaccuracy_uom,
		horizontalaccuracy_nilreason,
		nilreason
    FROM 
        geometry.curve_pt
    INNER JOIN 
        public.elevated_curve_pt ON geometry.curve_pt.id = public.elevated_curve_pt.curvepropertytype_id
    INNER JOIN 
        segment_union ON public.elevated_curve_pt.segments_id = segment_union.id
    GROUP BY geometry.curve_pt.id
)
SELECT 
    merged_segments.id, 
	merged_geom as geom,
	COALESCE(merged_segments.horizontalaccuracy || ' ' || merged_segments.horizontalaccuracy_uom, '(' || merged_segments.horizontalaccuracy_nilreason || ')') AS horizontalAccuracy
FROM merged_segments;

CREATE INDEX ON geometry.curve_view (id);
-- DirectFlightClassPropertyType
-- ['notes.note_view']
create or replace view routes.directflightclass_view as
select
    routes.directflightclass_pt.id,
    routes.directflightclass_pt.nilreason AS directflightclass_nilreason,
    coalesce(cast(routes.directflightclass.exceedlength_value as varchar) || ' ' || routes.directflightclass.exceedlength_uom, '(' || routes.directflightclass.exceedlength_nilreason || ')') as exceedlength,
    jsonb_agg(notes_note_view_tnuhvz.*) AS directflightclass_annotation
from routes.directflightclass_pt 
inner join routes.directflightclass on routes.directflightclass_pt.directflightclass_id = routes.directflightclass.id
left join master_join master_join_mavfdi on routes.directflightclass.id = master_join_mavfdi.source_id
left join notes.note_view notes_note_view_tnuhvz on master_join_mavfdi.target_id = notes_note_view_tnuhvz.id
group by
    routes.directflightclass_pt.id,
    routes.directflightclass_pt.nilreason,
    routes.directflightclass.exceedlength_value,
    routes.directflightclass.exceedlength_uom,
    routes.directflightclass.exceedlength_nilreason;
-- ElevatedCurvePropertyType
-- ['notes.note_view']
-- Snowflake SQL : ElevatedCurvePropertyType 

CREATE MATERIALIZED VIEW geometry.elevatedcurve_view AS
WITH 
center AS (
    SELECT 
		id, 
		point,
		radius,
		start_angle,
		end_angle,
		(end_angle - start_angle) / 100 AS step_size
    FROM public.linestring_segment 
	WHERE public.linestring_segment.interpretation = 2
	UNION ALL 
	SELECT 
		id, 
		point,
		radius,
		0 as start_angle,
		2*PI() as end_angle,
		(0 - 2*PI()) / 100 AS step_size
    FROM public.linestring_segment 
	WHERE public.linestring_segment.interpretation = 3
),
interpolated_points AS (
    SELECT 
        center.id,
		ST_Project(center.point::geography, center.radius, center.start_angle + center.step_size * n)::geometry AS point_geom
    FROM 
        generate_series(0, 100) AS n, 	
        center
),
arc_line AS (
    SELECT 
        id,
        ST_MakeLine(point_geom) AS arc_geom
    FROM interpolated_points
    GROUP BY id
),
segment_union AS (
    SELECT 
		id, 
		ST_ReducePrecision(linestring,0.000000000000001) AS geom
    FROM
		public.linestring_segment 
    WHERE 
		public.linestring_segment.interpretation = 0
    UNION ALL 
    SELECT 
		id, 
		ST_Segmentize((ST_ReducePrecision(linestring, 0.000000000000001)::geography), 1000)::geometry AS geom
    FROM 
		public.linestring_segment 
    WHERE 
		public.linestring_segment.interpretation = 1
    UNION ALL 
    SELECT 
		id, 
		ST_ReducePrecision(arc_geom, 0.000000000000001) AS geom
    FROM 
		arc_line
),
merged_segments AS (
    SELECT 
        geometry.elevated_curve_pt.id,
        ST_LineMerge(ST_Collect(segment_union.geom)) AS merged_geom,
		elevation,
		elevation_uom,
		elevation_nilreason,
		geoidundulation,
		geoidundulation_uom,
		geoidundulation_nilreason,
		horizontalaccuracy,
		horizontalaccuracy_uom,
		horizontalaccuracy_nilreason,
		verticalaccuracy,
		verticalaccuracy_uom,
		verticalaccuracy_nilreason,
		verticaldatum,
		verticaldatum_nilreason,
		nilreason
    FROM 
        geometry.elevated_curve_pt
    INNER JOIN 
        geometry.elevated_curve_pt_linestring_segment ON geometry.elevated_curve_pt.id = geometry.elevated_curve_pt_linestring_segment.elevatedcurvepropertytype_id
    INNER JOIN 
        segment_union ON geometry.elevated_curve_pt_linestring_segment.segments_id = segment_union.id
    GROUP BY geometry.elevated_curve_pt.id
)
SELECT 
    merged_segments.id,
	merged_geom as geom,
	COALESCE(merged_segments.elevation || ' ' || merged_segments.elevation_uom, '(' || merged_segments.elevation_nilreason || ')') AS elevation,
	COALESCE(merged_segments.geoidundulation || ' ' || merged_segments.geoidundulation_uom, '(' || merged_segments.geoidundulation_nilreason || ')') AS geoidUndulation,
	COALESCE(merged_segments.verticaldatum || ' ' || merged_segments.geoidundulation_uom, '(' || merged_segments.geoidundulation_nilreason || ')') AS verticalDatum,
	COALESCE(CAST(merged_segments.verticalaccuracy AS varchar), '(' || merged_segments.verticaldatum_nilreason || ')') AS verticalAccuracy,
	COALESCE(merged_segments.horizontalaccuracy || ' ' || merged_segments.horizontalaccuracy_uom, '(' || merged_segments.horizontalaccuracy_nilreason || ')') AS horizontalAccuracy
FROM merged_segments;

CREATE INDEX ON geometry.elevatedcurve_view (id);
-- ElevatedPointPropertyType
-- ['notes.note_view']
-- Snowflake SQL : ElevatedPointPropertyType

CREATE MATERIALIZED VIEW geometry.elevatedpoint_view AS
SELECT 
    id, 
    point as geom,
	COALESCE(elevation || ' ' || elevation_uom, '(' || elevation_nilreason || ')') AS elevation,
	COALESCE(geoidundulation || ' ' || geoidundulation_uom, '(' || geoidundulation_nilreason || ')') AS geoidUndulation,
	COALESCE(verticaldatum || ' ' || geoidundulation_uom, '(' || geoidundulation_nilreason || ')') AS verticalDatum,
	COALESCE(verticalaccuracy || ' ' || horizontalaccuracy_uom, '(' || verticaldatum_nilreason || ')') AS verticalAccuracy,
	COALESCE(horizontalaccuracy || ' ' || horizontalaccuracy_uom, '(' || horizontalaccuracy_nilreason || ')') AS horizontalAccuracy
FROM geometry.elevated_point_pt;

CREATE INDEX ON geometry.elevatedpoint_view (id);
-- ElevatedSurfacePropertyType
-- ['notes.note_view']

-- EquipmentUnavailableAdjustmentColumnPropertyType
-- ['notes.note_view']
create or replace view procedure.equipmentunavailableadjustmentcolumn_view as
select
    procedure.equipmentunavailableadjustmentcolumn_pt.id,
    procedure.equipmentunavailableadjustmentcolumn_pt.nilreason AS equipmentunavailableadjustmentcolumn_nilreason,
    coalesce(cast(procedure.equipmentunavailableadjustmentcolumn.guidanceequipment_value as varchar), '(' || procedure.equipmentunavailableadjustmentcolumn.guidanceequipment_nilreason || ')') as guidanceequipment,
    coalesce(cast(procedure.equipmentunavailableadjustmentcolumn.landingsystemlights_value as varchar), '(' || procedure.equipmentunavailableadjustmentcolumn.landingsystemlights_nilreason || ')') as landingsystemlights,
    coalesce(cast(procedure.equipmentunavailableadjustmentcolumn.equipmentrvr_value as varchar), '(' || procedure.equipmentunavailableadjustmentcolumn.equipmentrvr_nilreason || ')') as equipmentrvr,
    coalesce(cast(procedure.equipmentunavailableadjustmentcolumn.approachlightinginoperative_value as varchar), '(' || procedure.equipmentunavailableadjustmentcolumn.approachlightinginoperative_nilreason || ')') as approachlightinginoperative,
    coalesce(cast(procedure.equipmentunavailableadjustmentcolumn.visibilityadjustment_value as varchar) || ' ' || procedure.equipmentunavailableadjustmentcolumn.visibilityadjustment_uom, '(' || procedure.equipmentunavailableadjustmentcolumn.visibilityadjustment_nilreason || ')') as visibilityadjustment,
    jsonb_agg(notes_note_view_lwxidc.*) AS equipmentunavailableadjustmentcolumn_annotation
from procedure.equipmentunavailableadjustmentcolumn_pt 
inner join procedure.equipmentunavailableadjustmentcolumn on procedure.equipmentunavailableadjustmentcolumn_pt.equipmentunavailableadjustmentcolumn_id = procedure.equipmentunavailableadjustmentcolumn.id
left join master_join master_join_lykulo on procedure.equipmentunavailableadjustmentcolumn.id = master_join_lykulo.source_id
left join notes.note_view notes_note_view_lwxidc on master_join_lykulo.target_id = notes_note_view_lwxidc.id
group by
    procedure.equipmentunavailableadjustmentcolumn_pt.id,
    procedure.equipmentunavailableadjustmentcolumn_pt.nilreason,
    procedure.equipmentunavailableadjustmentcolumn.guidanceequipment_value,
    procedure.equipmentunavailableadjustmentcolumn.guidanceequipment_nilreason,
    procedure.equipmentunavailableadjustmentcolumn.landingsystemlights_value,
    procedure.equipmentunavailableadjustmentcolumn.landingsystemlights_nilreason,
    procedure.equipmentunavailableadjustmentcolumn.equipmentrvr_value,
    procedure.equipmentunavailableadjustmentcolumn.equipmentrvr_nilreason,
    procedure.equipmentunavailableadjustmentcolumn.approachlightinginoperative_value,
    procedure.equipmentunavailableadjustmentcolumn.approachlightinginoperative_nilreason,
    procedure.equipmentunavailableadjustmentcolumn.visibilityadjustment_value,
    procedure.equipmentunavailableadjustmentcolumn.visibilityadjustment_uom,
    procedure.equipmentunavailableadjustmentcolumn.visibilityadjustment_nilreason;
-- FASDataBlockPropertyType
-- ['notes.note_view']
create or replace view public.fasdatablock_view as
select
    public.fasdatablock_pt.id,
    public.fasdatablock_pt.nilreason AS fasdatablock_nilreason,
    coalesce(cast(public.fasdatablock.horizontalalarmlimit_value as varchar), '(' || public.fasdatablock.horizontalalarmlimit_nilreason || ')') as horizontalalarmlimit,
    coalesce(cast(public.fasdatablock.verticalalarmlimit_value as varchar), '(' || public.fasdatablock.verticalalarmlimit_nilreason || ')') as verticalalarmlimit,
    coalesce(cast(public.fasdatablock.crcremainder_value as varchar), '(' || public.fasdatablock.crcremainder_nilreason || ')') as crcremainder,
    coalesce(cast(public.fasdatablock.operationtype_value as varchar), '(' || public.fasdatablock.operationtype_nilreason || ')') as operationtype,
    coalesce(cast(public.fasdatablock.serviceprovidersbas_value as varchar), '(' || public.fasdatablock.serviceprovidersbas_nilreason || ')') as serviceprovidersbas,
    coalesce(cast(public.fasdatablock.approachperformancedesignator_value as varchar), '(' || public.fasdatablock.approachperformancedesignator_nilreason || ')') as approachperformancedesignator,
    coalesce(cast(public.fasdatablock.referencepathdataselector_value as varchar), '(' || public.fasdatablock.referencepathdataselector_nilreason || ')') as referencepathdataselector,
    coalesce(cast(public.fasdatablock.thresholdcoursewidth_value as varchar) || ' ' || public.fasdatablock.thresholdcoursewidth_uom, '(' || public.fasdatablock.thresholdcoursewidth_nilreason || ')') as thresholdcoursewidth,
    coalesce(cast(public.fasdatablock.lengthoffset_value as varchar) || ' ' || public.fasdatablock.lengthoffset_uom, '(' || public.fasdatablock.lengthoffset_nilreason || ')') as lengthoffset,
    jsonb_agg(notes_note_view_ukyffe.*) AS fasdatablock_annotation
from public.fasdatablock_pt 
inner join public.fasdatablock on public.fasdatablock_pt.fasdatablock_id = public.fasdatablock.id
left join master_join master_join_dktvtb on public.fasdatablock.id = master_join_dktvtb.source_id
left join notes.note_view notes_note_view_ukyffe on master_join_dktvtb.target_id = notes_note_view_ukyffe.id
group by
    public.fasdatablock_pt.id,
    public.fasdatablock_pt.nilreason,
    public.fasdatablock.horizontalalarmlimit_value,
    public.fasdatablock.horizontalalarmlimit_nilreason,
    public.fasdatablock.verticalalarmlimit_value,
    public.fasdatablock.verticalalarmlimit_nilreason,
    public.fasdatablock.crcremainder_value,
    public.fasdatablock.crcremainder_nilreason,
    public.fasdatablock.operationtype_value,
    public.fasdatablock.operationtype_nilreason,
    public.fasdatablock.serviceprovidersbas_value,
    public.fasdatablock.serviceprovidersbas_nilreason,
    public.fasdatablock.approachperformancedesignator_value,
    public.fasdatablock.approachperformancedesignator_nilreason,
    public.fasdatablock.referencepathdataselector_value,
    public.fasdatablock.referencepathdataselector_nilreason,
    public.fasdatablock.thresholdcoursewidth_value,
    public.fasdatablock.thresholdcoursewidth_uom,
    public.fasdatablock.thresholdcoursewidth_nilreason,
    public.fasdatablock.lengthoffset_value,
    public.fasdatablock.lengthoffset_uom,
    public.fasdatablock.lengthoffset_nilreason;
-- FlightCharacteristicPropertyType
-- ['notes.note_view']
create or replace view shared.flightcharacteristic_view as
select
    shared.flightcharacteristic_pt.id,
    shared.flightcharacteristic_pt.nilreason AS flightcharacteristic_nilreason,
    coalesce(cast(shared.flightcharacteristic.type_value as varchar), '(' || shared.flightcharacteristic.type_nilreason || ')') as type,
    coalesce(cast(shared.flightcharacteristic.rule_value as varchar), '(' || shared.flightcharacteristic.rule_nilreason || ')') as rule,
    coalesce(cast(shared.flightcharacteristic.status_value as varchar), '(' || shared.flightcharacteristic.status_nilreason || ')') as status,
    coalesce(cast(shared.flightcharacteristic.military_value as varchar), '(' || shared.flightcharacteristic.military_nilreason || ')') as military,
    coalesce(cast(shared.flightcharacteristic.origin_value as varchar), '(' || shared.flightcharacteristic.origin_nilreason || ')') as origin,
    coalesce(cast(shared.flightcharacteristic.purpose_value as varchar), '(' || shared.flightcharacteristic.purpose_nilreason || ')') as purpose,
    jsonb_agg(notes_note_view_giupip.*) AS flightcharacteristic_annotation
from shared.flightcharacteristic_pt 
inner join shared.flightcharacteristic on shared.flightcharacteristic_pt.flightcharacteristic_id = shared.flightcharacteristic.id
left join master_join master_join_vyhqey on shared.flightcharacteristic.id = master_join_vyhqey.source_id
left join notes.note_view notes_note_view_giupip on master_join_vyhqey.target_id = notes_note_view_giupip.id
group by
    shared.flightcharacteristic_pt.id,
    shared.flightcharacteristic_pt.nilreason,
    shared.flightcharacteristic.type_value,
    shared.flightcharacteristic.type_nilreason,
    shared.flightcharacteristic.rule_value,
    shared.flightcharacteristic.rule_nilreason,
    shared.flightcharacteristic.status_value,
    shared.flightcharacteristic.status_nilreason,
    shared.flightcharacteristic.military_value,
    shared.flightcharacteristic.military_nilreason,
    shared.flightcharacteristic.origin_value,
    shared.flightcharacteristic.origin_nilreason,
    shared.flightcharacteristic.purpose_value,
    shared.flightcharacteristic.purpose_nilreason;
-- FlightConditionCircumstancePropertyType
-- ['notes.note_view']
create or replace view routes.flightconditioncircumstance_view as
select
    routes.flightconditioncircumstance_pt.id,
    routes.flightconditioncircumstance_pt.nilreason AS flightconditioncircumstance_nilreason,
    coalesce(cast(routes.flightconditioncircumstance.referencelocation_value as varchar), '(' || routes.flightconditioncircumstance.referencelocation_nilreason || ')') as referencelocation,
    coalesce(cast(routes.flightconditioncircumstance.relationwithlocation_value as varchar), '(' || routes.flightconditioncircumstance.relationwithlocation_nilreason || ')') as relationwithlocation,
    jsonb_agg(notes_note_view_bxnwzs.*) AS flightconditioncircumstance_annotation
from routes.flightconditioncircumstance_pt 
inner join routes.flightconditioncircumstance on routes.flightconditioncircumstance_pt.flightconditioncircumstance_id = routes.flightconditioncircumstance.id
left join master_join master_join_iptelh on routes.flightconditioncircumstance.id = master_join_iptelh.source_id
left join notes.note_view notes_note_view_bxnwzs on master_join_iptelh.target_id = notes_note_view_bxnwzs.id
group by
    routes.flightconditioncircumstance_pt.id,
    routes.flightconditioncircumstance_pt.nilreason,
    routes.flightconditioncircumstance.referencelocation_value,
    routes.flightconditioncircumstance.referencelocation_nilreason,
    routes.flightconditioncircumstance.relationwithlocation_value,
    routes.flightconditioncircumstance.relationwithlocation_nilreason;
-- FlightRestrictionLevelPropertyType
-- ['notes.note_view']
create or replace view routes.flightrestrictionlevel_view as
select
    routes.flightrestrictionlevel_pt.id,
    routes.flightrestrictionlevel_pt.nilreason AS flightrestrictionlevel_nilreason,
    coalesce(cast(routes.flightrestrictionlevel.upperlevelreference_value as varchar), '(' || routes.flightrestrictionlevel.upperlevelreference_nilreason || ')') as upperlevelreference,
    coalesce(cast(routes.flightrestrictionlevel.lowerlevelreference_value as varchar), '(' || routes.flightrestrictionlevel.lowerlevelreference_nilreason || ')') as lowerlevelreference,
    coalesce(cast(routes.flightrestrictionlevel.upperlevel_value as varchar) || ' ' || routes.flightrestrictionlevel.upperlevel_uom, '(' || routes.flightrestrictionlevel.upperlevel_nilreason || ')') as upperlevel,
    coalesce(cast(routes.flightrestrictionlevel.lowerlevel_value as varchar) || ' ' || routes.flightrestrictionlevel.lowerlevel_uom, '(' || routes.flightrestrictionlevel.lowerlevel_nilreason || ')') as lowerlevel,
    jsonb_agg(notes_note_view_sklcji.*) AS flightrestrictionlevel_annotation
from routes.flightrestrictionlevel_pt 
inner join routes.flightrestrictionlevel on routes.flightrestrictionlevel_pt.flightrestrictionlevel_id = routes.flightrestrictionlevel.id
left join master_join master_join_hldhug on routes.flightrestrictionlevel.id = master_join_hldhug.source_id
left join notes.note_view notes_note_view_sklcji on master_join_hldhug.target_id = notes_note_view_sklcji.id
group by
    routes.flightrestrictionlevel_pt.id,
    routes.flightrestrictionlevel_pt.nilreason,
    routes.flightrestrictionlevel.upperlevelreference_value,
    routes.flightrestrictionlevel.upperlevelreference_nilreason,
    routes.flightrestrictionlevel.lowerlevelreference_value,
    routes.flightrestrictionlevel.lowerlevelreference_nilreason,
    routes.flightrestrictionlevel.upperlevel_value,
    routes.flightrestrictionlevel.upperlevel_uom,
    routes.flightrestrictionlevel.upperlevel_nilreason,
    routes.flightrestrictionlevel.lowerlevel_value,
    routes.flightrestrictionlevel.lowerlevel_uom,
    routes.flightrestrictionlevel.lowerlevel_nilreason;
-- FuelPropertyType
-- ['notes.note_view']
create or replace view service.fuel_view as
select
    service.fuel_pt.id,
    service.fuel_pt.nilreason AS fuel_nilreason,
    coalesce(cast(service.fuel.category_value as varchar), '(' || service.fuel.category_nilreason || ')') as category,
    jsonb_agg(notes_note_view_phlnmg.*) AS fuel_annotation
from service.fuel_pt 
inner join service.fuel on service.fuel_pt.fuel_id = service.fuel.id
left join master_join master_join_mdjcrh on service.fuel.id = master_join_mdjcrh.source_id
left join notes.note_view notes_note_view_phlnmg on master_join_mdjcrh.target_id = notes_note_view_phlnmg.id
group by
    service.fuel_pt.id,
    service.fuel_pt.nilreason,
    service.fuel.category_value,
    service.fuel.category_nilreason;
-- HoldingPatternDistancePropertyType
-- ['notes.note_view']
create or replace view holding.holdingpatterndistance_view as
select
    holding.holdingpatterndistance_pt.id,
    holding.holdingpatterndistance_pt.nilreason AS holdingpatterndistance_nilreason,
    coalesce(cast(holding.holdingpatterndistance.length_value as varchar) || ' ' || holding.holdingpatterndistance.length_uom, '(' || holding.holdingpatterndistance.length_nilreason || ')') as length,
    jsonb_agg(notes_note_view_gvpsum.*) AS holdingpatterndistance_annotation
from holding.holdingpatterndistance_pt 
inner join holding.holdingpatterndistance on holding.holdingpatterndistance_pt.holdingpatterndistance_id = holding.holdingpatterndistance.id
left join master_join master_join_hrduio on holding.holdingpatterndistance.id = master_join_hrduio.source_id
left join notes.note_view notes_note_view_gvpsum on master_join_hrduio.target_id = notes_note_view_gvpsum.id
group by
    holding.holdingpatterndistance_pt.id,
    holding.holdingpatterndistance_pt.nilreason,
    holding.holdingpatterndistance.length_value,
    holding.holdingpatterndistance.length_uom,
    holding.holdingpatterndistance.length_nilreason;
-- HoldingPatternDurationPropertyType
-- ['notes.note_view']
create or replace view holding.holdingpatternduration_view as
select
    holding.holdingpatternduration_pt.id,
    holding.holdingpatternduration_pt.nilreason AS holdingpatternduration_nilreason,
    coalesce(cast(holding.holdingpatternduration.duration_value as varchar) || ' ' || holding.holdingpatternduration.duration_uom, '(' || holding.holdingpatternduration.duration_nilreason || ')') as duration,
    jsonb_agg(notes_note_view_kjlpvg.*) AS holdingpatternduration_annotation
from holding.holdingpatternduration_pt 
inner join holding.holdingpatternduration on holding.holdingpatternduration_pt.holdingpatternduration_id = holding.holdingpatternduration.id
left join master_join master_join_wxfxzh on holding.holdingpatternduration.id = master_join_wxfxzh.source_id
left join notes.note_view notes_note_view_kjlpvg on master_join_wxfxzh.target_id = notes_note_view_kjlpvg.id
group by
    holding.holdingpatternduration_pt.id,
    holding.holdingpatternduration_pt.nilreason,
    holding.holdingpatternduration.duration_value,
    holding.holdingpatternduration.duration_uom,
    holding.holdingpatternduration.duration_nilreason;
-- HoldingUsePropertyType
-- ['notes.note_view']
create or replace view procedure.holdinguse_view as
select
    procedure.holdinguse_pt.id,
    procedure.holdinguse_pt.nilreason AS holdinguse_nilreason,
    coalesce(cast(procedure.holdinguse.holdinguse_value as varchar), '(' || procedure.holdinguse.holdinguse_nilreason || ')') as holdinguse,
    coalesce(cast(procedure.holdinguse.instruction_value as varchar), '(' || procedure.holdinguse.instruction_nilreason || ')') as instruction,
    coalesce(cast(procedure.holdinguse.instructionaltitudereference_value as varchar), '(' || procedure.holdinguse.instructionaltitudereference_nilreason || ')') as instructionaltitudereference,
    coalesce(cast(procedure.holdinguse.instructedaltitude_value as varchar) || ' ' || procedure.holdinguse.instructedaltitude_uom, '(' || procedure.holdinguse.instructedaltitude_nilreason || ')') as instructedaltitude,
    coalesce(cast(holding_holdingpattern_pt_qxvocx.title as varchar), '(' || holding_holdingpattern_pt_qxvocx.nilreason[1] || ')') AS theholdingpattern,
    holding_holdingpattern_pt_qxvocx.href AS theholdingpattern_href,
    jsonb_agg(notes_note_view_xpixkl.*) AS holdinguse_annotation
from procedure.holdinguse_pt 
inner join procedure.holdinguse on procedure.holdinguse_pt.holdinguse_id = procedure.holdinguse.id
left join holding.holdingpattern_pt holding_holdingpattern_pt_qxvocx on procedure.holdinguse.theholdingpattern_id = holding_holdingpattern_pt_qxvocx.id
left join master_join master_join_rbvxok on procedure.holdinguse.id = master_join_rbvxok.source_id
left join notes.note_view notes_note_view_xpixkl on master_join_rbvxok.target_id = notes_note_view_xpixkl.id
group by
    procedure.holdinguse_pt.id,
    procedure.holdinguse_pt.nilreason,
    procedure.holdinguse.holdinguse_value,
    procedure.holdinguse.holdinguse_nilreason,
    procedure.holdinguse.instruction_value,
    procedure.holdinguse.instruction_nilreason,
    procedure.holdinguse.instructionaltitudereference_value,
    procedure.holdinguse.instructionaltitudereference_nilreason,
    procedure.holdinguse.instructedaltitude_value,
    procedure.holdinguse.instructedaltitude_uom,
    procedure.holdinguse.instructedaltitude_nilreason,
    holding_holdingpattern_pt_qxvocx.title,
    holding_holdingpattern_pt_qxvocx.nilreason[1],
    holding_holdingpattern_pt_qxvocx.href;
-- LandingTakeoffAreaCollectionPropertyType
-- ['notes.note_view']
create or replace view procedure.landingtakeoffareacollection_view as
select
    procedure.landingtakeoffareacollection_pt.id,
    procedure.landingtakeoffareacollection_pt.nilreason AS landingtakeoffareacollection_nilreason,
    jsonb_build_object('id', airport_heliport_runwaydirection_pt_xceuvp.id,
    'title', coalesce(cast(airport_heliport_runwaydirection_pt_xceuvp.title AS varchar), '(' || airport_heliport_runwaydirection_pt_xceuvp.nilreason[1] || ')'),
    'href', airport_heliport_runwaydirection_pt_xceuvp.href) AS runway,
    jsonb_build_object('id', airport_heliport_touchdownliftoff_pt_lghxck.id,
    'title', coalesce(cast(airport_heliport_touchdownliftoff_pt_lghxck.title AS varchar), '(' || airport_heliport_touchdownliftoff_pt_lghxck.nilreason[1] || ')'),
    'href', airport_heliport_touchdownliftoff_pt_lghxck.href) AS tlof,
    jsonb_agg(notes_note_view_eabwje.*) AS landingtakeoffareacollection_annotation
from procedure.landingtakeoffareacollection_pt 
inner join procedure.landingtakeoffareacollection on procedure.landingtakeoffareacollection_pt.landingtakeoffareacollection_id = procedure.landingtakeoffareacollection.id
left join master_join master_join_ekxrwe on procedure.landingtakeoffareacollection.id = master_join_ekxrwe.source_id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_xceuvp on master_join_ekxrwe.target_id = airport_heliport_runwaydirection_pt_xceuvp.id
left join master_join master_join_eluist on procedure.landingtakeoffareacollection.id = master_join_eluist.source_id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_lghxck on master_join_eluist.target_id = airport_heliport_touchdownliftoff_pt_lghxck.id
left join master_join master_join_xxxqkc on procedure.landingtakeoffareacollection.id = master_join_xxxqkc.source_id
left join notes.note_view notes_note_view_eabwje on master_join_xxxqkc.target_id = notes_note_view_eabwje.id
group by
    procedure.landingtakeoffareacollection_pt.id,
    procedure.landingtakeoffareacollection_pt.nilreason;
-- LightActivationPropertyType
-- ['notes.note_view']
create or replace view airport_heliport.lightactivation_view as
select
    airport_heliport.lightactivation_pt.id,
    airport_heliport.lightactivation_pt.nilreason AS lightactivation_nilreason,
    coalesce(cast(airport_heliport.lightactivation.clicks_value as varchar), '(' || airport_heliport.lightactivation.clicks_nilreason || ')') as clicks,
    coalesce(cast(airport_heliport.lightactivation.intensitylevel_value as varchar), '(' || airport_heliport.lightactivation.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(airport_heliport.lightactivation.activation_value as varchar), '(' || airport_heliport.lightactivation.activation_nilreason || ')') as activation,
    jsonb_agg(notes_note_view_kekosa.*) AS lightactivation_annotation
from airport_heliport.lightactivation_pt 
inner join airport_heliport.lightactivation on airport_heliport.lightactivation_pt.lightactivation_id = airport_heliport.lightactivation.id
left join master_join master_join_netlmo on airport_heliport.lightactivation.id = master_join_netlmo.source_id
left join notes.note_view notes_note_view_kekosa on master_join_netlmo.target_id = notes_note_view_kekosa.id
group by
    airport_heliport.lightactivation_pt.id,
    airport_heliport.lightactivation_pt.nilreason,
    airport_heliport.lightactivation.clicks_value,
    airport_heliport.lightactivation.clicks_nilreason,
    airport_heliport.lightactivation.intensitylevel_value,
    airport_heliport.lightactivation.intensitylevel_nilreason,
    airport_heliport.lightactivation.activation_value,
    airport_heliport.lightactivation.activation_nilreason;
-- MeteorologyPropertyType
-- ['notes.note_view']
create or replace view shared.meteorology_view as
select
    shared.meteorology_pt.id,
    shared.meteorology_pt.nilreason AS meteorology_nilreason,
    coalesce(cast(shared.meteorology.flightconditions_value as varchar), '(' || shared.meteorology.flightconditions_nilreason || ')') as flightconditions,
    coalesce(cast(shared.meteorology.visibilityinterpretation_value as varchar), '(' || shared.meteorology.visibilityinterpretation_nilreason || ')') as visibilityinterpretation,
    coalesce(cast(shared.meteorology.runwayvisualrangeinterpretation_value as varchar), '(' || shared.meteorology.runwayvisualrangeinterpretation_nilreason || ')') as runwayvisualrangeinterpretation,
    coalesce(cast(shared.meteorology.visibility_value as varchar) || ' ' || shared.meteorology.visibility_uom, '(' || shared.meteorology.visibility_nilreason || ')') as visibility,
    coalesce(cast(shared.meteorology.runwayvisualrange_value as varchar) || ' ' || shared.meteorology.runwayvisualrange_uom, '(' || shared.meteorology.runwayvisualrange_nilreason || ')') as runwayvisualrange,
    jsonb_agg(notes_note_view_pelyte.*) AS meteorology_annotation
from shared.meteorology_pt 
inner join shared.meteorology on shared.meteorology_pt.meteorology_id = shared.meteorology.id
left join master_join master_join_vspghc on shared.meteorology.id = master_join_vspghc.source_id
left join notes.note_view notes_note_view_pelyte on master_join_vspghc.target_id = notes_note_view_pelyte.id
group by
    shared.meteorology_pt.id,
    shared.meteorology_pt.nilreason,
    shared.meteorology.flightconditions_value,
    shared.meteorology.flightconditions_nilreason,
    shared.meteorology.visibilityinterpretation_value,
    shared.meteorology.visibilityinterpretation_nilreason,
    shared.meteorology.runwayvisualrangeinterpretation_value,
    shared.meteorology.runwayvisualrangeinterpretation_nilreason,
    shared.meteorology.visibility_value,
    shared.meteorology.visibility_uom,
    shared.meteorology.visibility_nilreason,
    shared.meteorology.runwayvisualrange_value,
    shared.meteorology.runwayvisualrange_uom,
    shared.meteorology.runwayvisualrange_nilreason;
-- MissedApproachGroupPropertyType
-- ['notes.note_view']
create or replace view procedure.missedapproachgroup_view as
select
    procedure.missedapproachgroup_pt.id,
    procedure.missedapproachgroup_pt.nilreason AS missedapproachgroup_nilreason,
    coalesce(cast(procedure.missedapproachgroup.instruction_value as varchar), '(' || procedure.missedapproachgroup.instruction_nilreason || ')') as instruction,
    coalesce(cast(procedure.missedapproachgroup.alternateclimbinstruction_value as varchar), '(' || procedure.missedapproachgroup.alternateclimbinstruction_nilreason || ')') as alternateclimbinstruction,
    coalesce(cast(procedure.missedapproachgroup.alternateclimbaltitude_value as varchar) || ' ' || procedure.missedapproachgroup.alternateclimbaltitude_uom, '(' || procedure.missedapproachgroup.alternateclimbaltitude_nilreason || ')') as alternateclimbaltitude,
    jsonb_build_object('id', airport_heliport_altimetersource_pt_wdwamy.id,
    'title', coalesce(cast(airport_heliport_altimetersource_pt_wdwamy.title AS varchar), '(' || airport_heliport_altimetersource_pt_wdwamy.nilreason[1] || ')'),
    'href', airport_heliport_altimetersource_pt_wdwamy.href) AS altimeter,
    jsonb_agg(notes_note_view_qklsff.*) AS missedapproachgroup_annotation
from procedure.missedapproachgroup_pt 
inner join procedure.missedapproachgroup on procedure.missedapproachgroup_pt.missedapproachgroup_id = procedure.missedapproachgroup.id
left join master_join master_join_ofuepc on procedure.missedapproachgroup.id = master_join_ofuepc.source_id
left join airport_heliport.altimetersource_pt airport_heliport_altimetersource_pt_wdwamy on master_join_ofuepc.target_id = airport_heliport_altimetersource_pt_wdwamy.id
left join master_join master_join_fjchym on procedure.missedapproachgroup.id = master_join_fjchym.source_id
left join notes.note_view notes_note_view_qklsff on master_join_fjchym.target_id = notes_note_view_qklsff.id
group by
    procedure.missedapproachgroup_pt.id,
    procedure.missedapproachgroup_pt.nilreason,
    procedure.missedapproachgroup.instruction_value,
    procedure.missedapproachgroup.instruction_nilreason,
    procedure.missedapproachgroup.alternateclimbinstruction_value,
    procedure.missedapproachgroup.alternateclimbinstruction_nilreason,
    procedure.missedapproachgroup.alternateclimbaltitude_value,
    procedure.missedapproachgroup.alternateclimbaltitude_uom,
    procedure.missedapproachgroup.alternateclimbaltitude_nilreason;
-- NavaidComponentPropertyType
-- ['notes.note_view']
create or replace view navaids_points.navaidcomponent_view as
select
    navaids_points.navaidcomponent_pt.id,
    navaids_points.navaidcomponent_pt.nilreason AS navaidcomponent_nilreason,
    coalesce(cast(navaids_points.navaidcomponent.collocationgroup_value as varchar), '(' || navaids_points.navaidcomponent.collocationgroup_nilreason || ')') as collocationgroup,
    coalesce(cast(navaids_points.navaidcomponent.markerposition_value as varchar), '(' || navaids_points.navaidcomponent.markerposition_nilreason || ')') as markerposition,
    coalesce(cast(navaids_points.navaidcomponent.providesnavigablelocation_value as varchar), '(' || navaids_points.navaidcomponent.providesnavigablelocation_nilreason || ')') as providesnavigablelocation,
    jsonb_agg(notes_note_view_ukajra.*) AS navaidcomponent_annotation
from navaids_points.navaidcomponent_pt 
inner join navaids_points.navaidcomponent on navaids_points.navaidcomponent_pt.navaidcomponent_id = navaids_points.navaidcomponent.id
left join master_join master_join_hkrayt on navaids_points.navaidcomponent.id = master_join_hkrayt.source_id
left join notes.note_view notes_note_view_ukajra on master_join_hkrayt.target_id = notes_note_view_ukajra.id
group by
    navaids_points.navaidcomponent_pt.id,
    navaids_points.navaidcomponent_pt.nilreason,
    navaids_points.navaidcomponent.collocationgroup_value,
    navaids_points.navaidcomponent.collocationgroup_nilreason,
    navaids_points.navaidcomponent.markerposition_value,
    navaids_points.navaidcomponent.markerposition_nilreason,
    navaids_points.navaidcomponent.providesnavigablelocation_value,
    navaids_points.navaidcomponent.providesnavigablelocation_nilreason;
-- NavaidEquipmentDistancePropertyType
-- ['notes.note_view']
create or replace view airport_heliport.navaidequipmentdistance_view as
select
    airport_heliport.navaidequipmentdistance_pt.id,
    airport_heliport.navaidequipmentdistance_pt.nilreason AS navaidequipmentdistance_nilreason,
    coalesce(cast(airport_heliport.navaidequipmentdistance.distance_value as varchar) || ' ' || airport_heliport.navaidequipmentdistance.distance_uom, '(' || airport_heliport.navaidequipmentdistance.distance_nilreason || ')') as distance,
    coalesce(cast(airport_heliport.navaidequipmentdistance.distanceaccuracy_value as varchar) || ' ' || airport_heliport.navaidequipmentdistance.distanceaccuracy_uom, '(' || airport_heliport.navaidequipmentdistance.distanceaccuracy_nilreason || ')') as distanceaccuracy,
    jsonb_agg(notes_note_view_gziywa.*) AS navaidequipmentdistance_annotation
from airport_heliport.navaidequipmentdistance_pt 
inner join airport_heliport.navaidequipmentdistance on airport_heliport.navaidequipmentdistance_pt.navaidequipmentdistance_id = airport_heliport.navaidequipmentdistance.id
left join master_join master_join_ifxoif on airport_heliport.navaidequipmentdistance.id = master_join_ifxoif.source_id
left join notes.note_view notes_note_view_gziywa on master_join_ifxoif.target_id = notes_note_view_gziywa.id
group by
    airport_heliport.navaidequipmentdistance_pt.id,
    airport_heliport.navaidequipmentdistance_pt.nilreason,
    airport_heliport.navaidequipmentdistance.distance_value,
    airport_heliport.navaidequipmentdistance.distance_uom,
    airport_heliport.navaidequipmentdistance.distance_nilreason,
    airport_heliport.navaidequipmentdistance.distanceaccuracy_value,
    airport_heliport.navaidequipmentdistance.distanceaccuracy_uom,
    airport_heliport.navaidequipmentdistance.distanceaccuracy_nilreason;
-- NitrogenPropertyType
-- ['notes.note_view']
create or replace view service.nitrogen_view as
select
    service.nitrogen_pt.id,
    service.nitrogen_pt.nilreason AS nitrogen_nilreason,
    coalesce(cast(service.nitrogen.type_value as varchar), '(' || service.nitrogen.type_nilreason || ')') as type,
    jsonb_agg(notes_note_view_tctfzw.*) AS nitrogen_annotation
from service.nitrogen_pt 
inner join service.nitrogen on service.nitrogen_pt.nitrogen_id = service.nitrogen.id
left join master_join master_join_nmsrnb on service.nitrogen.id = master_join_nmsrnb.source_id
left join notes.note_view notes_note_view_tctfzw on master_join_nmsrnb.target_id = notes_note_view_tctfzw.id
group by
    service.nitrogen_pt.id,
    service.nitrogen_pt.nilreason,
    service.nitrogen.type_value,
    service.nitrogen.type_nilreason;
-- ObstaclePlacementPropertyType
-- ['notes.note_view']
create or replace view shared.obstacleplacement_view as
select
    shared.obstacleplacement_pt.id,
    shared.obstacleplacement_pt.nilreason AS obstacleplacement_nilreason,
    coalesce(cast(shared.obstacleplacement.obstaclebearing_value as varchar), '(' || shared.obstacleplacement.obstaclebearing_nilreason || ')') as obstaclebearing,
    coalesce(cast(shared.obstacleplacement.pointtype_value as varchar), '(' || shared.obstacleplacement.pointtype_nilreason || ')') as pointtype,
    coalesce(cast(shared.obstacleplacement.obstacleplacement_value as varchar), '(' || shared.obstacleplacement.obstacleplacement_nilreason || ')') as obstacleplacement,
    coalesce(cast(shared.obstacleplacement.obstacledistance_value as varchar) || ' ' || shared.obstacleplacement.obstacledistance_uom, '(' || shared.obstacleplacement.obstacledistance_nilreason || ')') as obstacledistance,
    jsonb_agg(notes_note_view_xccrxk.*) AS obstacleplacement_annotation
from shared.obstacleplacement_pt 
inner join shared.obstacleplacement on shared.obstacleplacement_pt.obstacleplacement_id = shared.obstacleplacement.id
left join master_join master_join_idnnyo on shared.obstacleplacement.id = master_join_idnnyo.source_id
left join notes.note_view notes_note_view_xccrxk on master_join_idnnyo.target_id = notes_note_view_xccrxk.id
group by
    shared.obstacleplacement_pt.id,
    shared.obstacleplacement_pt.nilreason,
    shared.obstacleplacement.obstaclebearing_value,
    shared.obstacleplacement.obstaclebearing_nilreason,
    shared.obstacleplacement.pointtype_value,
    shared.obstacleplacement.pointtype_nilreason,
    shared.obstacleplacement.obstacleplacement_value,
    shared.obstacleplacement.obstacleplacement_nilreason,
    shared.obstacleplacement.obstacledistance_value,
    shared.obstacleplacement.obstacledistance_uom,
    shared.obstacleplacement.obstacledistance_nilreason;
-- OilPropertyType
-- ['notes.note_view']
create or replace view service.oil_view as
select
    service.oil_pt.id,
    service.oil_pt.nilreason AS oil_nilreason,
    coalesce(cast(service.oil.category_value as varchar), '(' || service.oil.category_nilreason || ')') as category,
    jsonb_agg(notes_note_view_eaomgo.*) AS oil_annotation
from service.oil_pt 
inner join service.oil on service.oil_pt.oil_id = service.oil.id
left join master_join master_join_jdzlbi on service.oil.id = master_join_jdzlbi.source_id
left join notes.note_view notes_note_view_eaomgo on master_join_jdzlbi.target_id = notes_note_view_eaomgo.id
group by
    service.oil_pt.id,
    service.oil_pt.nilreason,
    service.oil.category_value,
    service.oil.category_nilreason;
-- OrganisationAuthorityAssociationPropertyType
-- ['notes.note_view']
create or replace view organisation.organisationauthorityassociation_view as
select
    organisation.organisationauthorityassociation_pt.id,
    organisation.organisationauthorityassociation_pt.nilreason AS organisationauthorityassociation_nilreason,
    coalesce(cast(organisation.organisationauthorityassociation.type_value as varchar), '(' || organisation.organisationauthorityassociation.type_nilreason || ')') as type,
    coalesce(cast(organisation_organisationauthority_pt_hkbrgn.title as varchar), '(' || organisation_organisationauthority_pt_hkbrgn.nilreason[1] || ')') AS theorganisationauthority,
    organisation_organisationauthority_pt_hkbrgn.href AS theorganisationauthority_href,
    jsonb_agg(notes_note_view_wyzmgc.*) AS organisationauthorityassociation_annotation
from organisation.organisationauthorityassociation_pt 
inner join organisation.organisationauthorityassociation on organisation.organisationauthorityassociation_pt.organisationauthorityassociation_id = organisation.organisationauthorityassociation.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_hkbrgn on organisation.organisationauthorityassociation.theorganisationauthority_id = organisation_organisationauthority_pt_hkbrgn.id
left join master_join master_join_pxbyqa on organisation.organisationauthorityassociation.id = master_join_pxbyqa.source_id
left join notes.note_view notes_note_view_wyzmgc on master_join_pxbyqa.target_id = notes_note_view_wyzmgc.id
group by
    organisation.organisationauthorityassociation_pt.id,
    organisation.organisationauthorityassociation_pt.nilreason,
    organisation.organisationauthorityassociation.type_value,
    organisation.organisationauthorityassociation.type_nilreason,
    organisation_organisationauthority_pt_hkbrgn.title,
    organisation_organisationauthority_pt_hkbrgn.nilreason[1],
    organisation_organisationauthority_pt_hkbrgn.href;
-- OxygenPropertyType
-- ['notes.note_view']
create or replace view service.oxygen_view as
select
    service.oxygen_pt.id,
    service.oxygen_pt.nilreason AS oxygen_nilreason,
    coalesce(cast(service.oxygen.type_value as varchar), '(' || service.oxygen.type_nilreason || ')') as type,
    jsonb_agg(notes_note_view_zbgdim.*) AS oxygen_annotation
from service.oxygen_pt 
inner join service.oxygen on service.oxygen_pt.oxygen_id = service.oxygen.id
left join master_join master_join_rljkji on service.oxygen.id = master_join_rljkji.source_id
left join notes.note_view notes_note_view_zbgdim on master_join_rljkji.target_id = notes_note_view_zbgdim.id
group by
    service.oxygen_pt.id,
    service.oxygen_pt.nilreason,
    service.oxygen.type_value,
    service.oxygen.type_nilreason;
-- PointPropertyType
-- ['notes.note_view']
-- Snowflake SQL : PointPropertyType

CREATE MATERIALIZED VIEW geometry.point_view AS
SELECT
    id, 
	point as geom,
	COALESCE(horizontalaccuracy || ' ' || horizontalaccuracy_uom, '(' || horizontalaccuracy_nilreason || ')') AS horizontalAccuracy
FROM geometry.point_pt;

CREATE INDEX ON geometry.point_view (id);
-- ProcedureTransitionLegPropertyType
-- ['notes.note_view']
create or replace view procedure.proceduretransitionleg_view as
select
    procedure.proceduretransitionleg_pt.id,
    procedure.proceduretransitionleg_pt.nilreason AS proceduretransitionleg_nilreason,
    coalesce(cast(procedure.proceduretransitionleg.seqnumberarinc_value as varchar), '(' || procedure.proceduretransitionleg.seqnumberarinc_nilreason || ')') as seqnumberarinc,
    jsonb_agg(notes_note_view_oouywl.*) AS proceduretransitionleg_annotation
from procedure.proceduretransitionleg_pt 
inner join procedure.proceduretransitionleg on procedure.proceduretransitionleg_pt.proceduretransitionleg_id = procedure.proceduretransitionleg.id
left join master_join master_join_iodzgd on procedure.proceduretransitionleg.id = master_join_iodzgd.source_id
left join notes.note_view notes_note_view_oouywl on master_join_iodzgd.target_id = notes_note_view_oouywl.id
group by
    procedure.proceduretransitionleg_pt.id,
    procedure.proceduretransitionleg_pt.nilreason,
    procedure.proceduretransitionleg.seqnumberarinc_value,
    procedure.proceduretransitionleg.seqnumberarinc_nilreason;
-- RadarComponentPropertyType
-- ['notes.note_view']
create or replace view surveillance.radarcomponent_view as
select
    surveillance.radarcomponent_pt.id,
    surveillance.radarcomponent_pt.nilreason AS radarcomponent_nilreason,
    coalesce(cast(surveillance.radarcomponent.collocationgroup_value as varchar), '(' || surveillance.radarcomponent.collocationgroup_nilreason || ')') as collocationgroup,
    jsonb_agg(notes_note_view_tqtqbh.*) AS radarcomponent_annotation
from surveillance.radarcomponent_pt 
inner join surveillance.radarcomponent on surveillance.radarcomponent_pt.radarcomponent_id = surveillance.radarcomponent.id
left join master_join master_join_fasrfc on surveillance.radarcomponent.id = master_join_fasrfc.source_id
left join notes.note_view notes_note_view_tqtqbh on master_join_fasrfc.target_id = notes_note_view_tqtqbh.id
group by
    surveillance.radarcomponent_pt.id,
    surveillance.radarcomponent_pt.nilreason,
    surveillance.radarcomponent.collocationgroup_value,
    surveillance.radarcomponent.collocationgroup_nilreason;
-- RidgePropertyType
-- ['notes.note_view']
create or replace view airport_heliport.ridge_view as
select
    airport_heliport.ridge_pt.id,
    airport_heliport.ridge_pt.nilreason AS ridge_nilreason,
    coalesce(cast(airport_heliport.ridge.side_value as varchar), '(' || airport_heliport.ridge.side_nilreason || ')') as side,
    coalesce(cast(airport_heliport.ridge.distance_value as varchar) || ' ' || airport_heliport.ridge.distance_uom, '(' || airport_heliport.ridge.distance_nilreason || ')') as distance,
    coalesce(cast(airport_heliport.ridge.depth_value as varchar) || ' ' || airport_heliport.ridge.depth_uom, '(' || airport_heliport.ridge.depth_nilreason || ')') as depth,
    jsonb_agg(notes_note_view_fslldj.*) AS ridge_annotation
from airport_heliport.ridge_pt 
inner join airport_heliport.ridge on airport_heliport.ridge_pt.ridge_id = airport_heliport.ridge.id
left join master_join master_join_mjbczj on airport_heliport.ridge.id = master_join_mjbczj.source_id
left join notes.note_view notes_note_view_fslldj on master_join_mjbczj.target_id = notes_note_view_fslldj.id
group by
    airport_heliport.ridge_pt.id,
    airport_heliport.ridge_pt.nilreason,
    airport_heliport.ridge.side_value,
    airport_heliport.ridge.side_nilreason,
    airport_heliport.ridge.distance_value,
    airport_heliport.ridge.distance_uom,
    airport_heliport.ridge.distance_nilreason,
    airport_heliport.ridge.depth_value,
    airport_heliport.ridge.depth_uom,
    airport_heliport.ridge.depth_nilreason;
-- SectorDesignPropertyType
-- ['notes.note_view']
create or replace view procedure.sectordesign_view as
select
    procedure.sectordesign_pt.id,
    procedure.sectordesign_pt.nilreason AS sectordesign_nilreason,
    coalesce(cast(procedure.sectordesign.turndirection_value as varchar), '(' || procedure.sectordesign.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(procedure.sectordesign.designgradient_value as varchar), '(' || procedure.sectordesign.designgradient_nilreason || ')') as designgradient,
    coalesce(cast(procedure.sectordesign.turnpermitted_value as varchar), '(' || procedure.sectordesign.turnpermitted_nilreason || ')') as turnpermitted,
    coalesce(cast(procedure.sectordesign.terminationaltitude_value as varchar) || ' ' || procedure.sectordesign.terminationaltitude_uom, '(' || procedure.sectordesign.terminationaltitude_nilreason || ')') as terminationaltitude,
    jsonb_agg(notes_note_view_sopeqe.*) AS sectordesign_annotation
from procedure.sectordesign_pt 
inner join procedure.sectordesign on procedure.sectordesign_pt.sectordesign_id = procedure.sectordesign.id
left join master_join master_join_xkgcox on procedure.sectordesign.id = master_join_xkgcox.source_id
left join notes.note_view notes_note_view_sopeqe on master_join_xkgcox.target_id = notes_note_view_sopeqe.id
group by
    procedure.sectordesign_pt.id,
    procedure.sectordesign_pt.nilreason,
    procedure.sectordesign.turndirection_value,
    procedure.sectordesign.turndirection_nilreason,
    procedure.sectordesign.designgradient_value,
    procedure.sectordesign.designgradient_nilreason,
    procedure.sectordesign.turnpermitted_value,
    procedure.sectordesign.turnpermitted_nilreason,
    procedure.sectordesign.terminationaltitude_value,
    procedure.sectordesign.terminationaltitude_uom,
    procedure.sectordesign.terminationaltitude_nilreason;
-- StandardLevelPropertyType
-- ['notes.note_view']
create or replace view shared.standardlevel_view as
select
    shared.standardlevel_pt.id,
    shared.standardlevel_pt.nilreason AS standardlevel_nilreason,
    coalesce(cast(shared.standardlevel.verticaldistance_value as varchar) || ' ' || shared.standardlevel.verticaldistance_uom, '(' || shared.standardlevel.verticaldistance_nilreason || ')') as verticaldistance,
    jsonb_agg(notes_note_view_ywplnj.*) AS standardlevel_annotation
from shared.standardlevel_pt 
inner join shared.standardlevel on shared.standardlevel_pt.standardlevel_id = shared.standardlevel.id
left join master_join master_join_fpeivj on shared.standardlevel.id = master_join_fpeivj.source_id
left join notes.note_view notes_note_view_ywplnj on master_join_fpeivj.target_id = notes_note_view_ywplnj.id
group by
    shared.standardlevel_pt.id,
    shared.standardlevel_pt.nilreason,
    shared.standardlevel.verticaldistance_value,
    shared.standardlevel.verticaldistance_uom,
    shared.standardlevel.verticaldistance_nilreason;
-- SurfaceCharacteristicsPropertyType
-- ['notes.note_view']
create or replace view airport_heliport.surfacecharacteristics_view as
select
    airport_heliport.surfacecharacteristics_pt.id,
    airport_heliport.surfacecharacteristics_pt.nilreason AS surfacecharacteristics_nilreason,
    coalesce(cast(airport_heliport.surfacecharacteristics.composition_value as varchar), '(' || airport_heliport.surfacecharacteristics.composition_nilreason || ')') as composition,
    coalesce(cast(airport_heliport.surfacecharacteristics.preparation_value as varchar), '(' || airport_heliport.surfacecharacteristics.preparation_nilreason || ')') as preparation,
    coalesce(cast(airport_heliport.surfacecharacteristics.surfacecondition_value as varchar), '(' || airport_heliport.surfacecharacteristics.surfacecondition_nilreason || ')') as surfacecondition,
    coalesce(cast(airport_heliport.surfacecharacteristics.classpcn_value as varchar), '(' || airport_heliport.surfacecharacteristics.classpcn_nilreason || ')') as classpcn,
    coalesce(cast(airport_heliport.surfacecharacteristics.pavementtypepcn_value as varchar), '(' || airport_heliport.surfacecharacteristics.pavementtypepcn_nilreason || ')') as pavementtypepcn,
    coalesce(cast(airport_heliport.surfacecharacteristics.pavementsubgradepcn_value as varchar), '(' || airport_heliport.surfacecharacteristics.pavementsubgradepcn_nilreason || ')') as pavementsubgradepcn,
    coalesce(cast(airport_heliport.surfacecharacteristics.maxtyrepressurepcn_value as varchar), '(' || airport_heliport.surfacecharacteristics.maxtyrepressurepcn_nilreason || ')') as maxtyrepressurepcn,
    coalesce(cast(airport_heliport.surfacecharacteristics.evaluationmethodpcn_value as varchar), '(' || airport_heliport.surfacecharacteristics.evaluationmethodpcn_nilreason || ')') as evaluationmethodpcn,
    coalesce(cast(airport_heliport.surfacecharacteristics.classlcn_value as varchar), '(' || airport_heliport.surfacecharacteristics.classlcn_nilreason || ')') as classlcn,
    coalesce(cast(airport_heliport.surfacecharacteristics.weightsiwl_value as varchar) || ' ' || airport_heliport.surfacecharacteristics.weightsiwl_uom, '(' || airport_heliport.surfacecharacteristics.weightsiwl_nilreason || ')') as weightsiwl,
    coalesce(cast(airport_heliport.surfacecharacteristics.tyrepressuresiwl_value as varchar) || ' ' || airport_heliport.surfacecharacteristics.tyrepressuresiwl_uom, '(' || airport_heliport.surfacecharacteristics.tyrepressuresiwl_nilreason || ')') as tyrepressuresiwl,
    coalesce(cast(airport_heliport.surfacecharacteristics.weightauw_value as varchar) || ' ' || airport_heliport.surfacecharacteristics.weightauw_uom, '(' || airport_heliport.surfacecharacteristics.weightauw_nilreason || ')') as weightauw,
    jsonb_agg(notes_note_view_liymkd.*) AS surfacecharacteristics_annotation
from airport_heliport.surfacecharacteristics_pt 
inner join airport_heliport.surfacecharacteristics on airport_heliport.surfacecharacteristics_pt.surfacecharacteristics_id = airport_heliport.surfacecharacteristics.id
left join master_join master_join_tsgyuh on airport_heliport.surfacecharacteristics.id = master_join_tsgyuh.source_id
left join notes.note_view notes_note_view_liymkd on master_join_tsgyuh.target_id = notes_note_view_liymkd.id
group by
    airport_heliport.surfacecharacteristics_pt.id,
    airport_heliport.surfacecharacteristics_pt.nilreason,
    airport_heliport.surfacecharacteristics.composition_value,
    airport_heliport.surfacecharacteristics.composition_nilreason,
    airport_heliport.surfacecharacteristics.preparation_value,
    airport_heliport.surfacecharacteristics.preparation_nilreason,
    airport_heliport.surfacecharacteristics.surfacecondition_value,
    airport_heliport.surfacecharacteristics.surfacecondition_nilreason,
    airport_heliport.surfacecharacteristics.classpcn_value,
    airport_heliport.surfacecharacteristics.classpcn_nilreason,
    airport_heliport.surfacecharacteristics.pavementtypepcn_value,
    airport_heliport.surfacecharacteristics.pavementtypepcn_nilreason,
    airport_heliport.surfacecharacteristics.pavementsubgradepcn_value,
    airport_heliport.surfacecharacteristics.pavementsubgradepcn_nilreason,
    airport_heliport.surfacecharacteristics.maxtyrepressurepcn_value,
    airport_heliport.surfacecharacteristics.maxtyrepressurepcn_nilreason,
    airport_heliport.surfacecharacteristics.evaluationmethodpcn_value,
    airport_heliport.surfacecharacteristics.evaluationmethodpcn_nilreason,
    airport_heliport.surfacecharacteristics.classlcn_value,
    airport_heliport.surfacecharacteristics.classlcn_nilreason,
    airport_heliport.surfacecharacteristics.weightsiwl_value,
    airport_heliport.surfacecharacteristics.weightsiwl_uom,
    airport_heliport.surfacecharacteristics.weightsiwl_nilreason,
    airport_heliport.surfacecharacteristics.tyrepressuresiwl_value,
    airport_heliport.surfacecharacteristics.tyrepressuresiwl_uom,
    airport_heliport.surfacecharacteristics.tyrepressuresiwl_nilreason,
    airport_heliport.surfacecharacteristics.weightauw_value,
    airport_heliport.surfacecharacteristics.weightauw_uom,
    airport_heliport.surfacecharacteristics.weightauw_nilreason;
-- SurfacePropertyType
-- ['notes.note_view']

-- SurveillanceGroundStationPropertyType
-- ['notes.note_view']
create or replace view surveillance.surveillancegroundstation_view as
select
    surveillance.surveillancegroundstation_pt.id,
    surveillance.surveillancegroundstation_pt.nilreason AS surveillancegroundstation_nilreason,
    coalesce(cast(surveillance.surveillancegroundstation.videomap_value as varchar), '(' || surveillance.surveillancegroundstation.videomap_nilreason || ')') as videomap,
    coalesce(cast(organisation_unit_pt_bckien.title as varchar), '(' || organisation_unit_pt_bckien.nilreason[1] || ')') AS theunit,
    organisation_unit_pt_bckien.href AS theunit_href,
    jsonb_agg(notes_note_view_ewxcjz.*) AS surveillancegroundstation_annotation
from surveillance.surveillancegroundstation_pt 
inner join surveillance.surveillancegroundstation on surveillance.surveillancegroundstation_pt.surveillancegroundstation_id = surveillance.surveillancegroundstation.id
left join organisation.unit_pt organisation_unit_pt_bckien on surveillance.surveillancegroundstation.theunit_id = organisation_unit_pt_bckien.id
left join master_join master_join_wdcleo on surveillance.surveillancegroundstation.id = master_join_wdcleo.source_id
left join notes.note_view notes_note_view_ewxcjz on master_join_wdcleo.target_id = notes_note_view_ewxcjz.id
group by
    surveillance.surveillancegroundstation_pt.id,
    surveillance.surveillancegroundstation_pt.nilreason,
    surveillance.surveillancegroundstation.videomap_value,
    surveillance.surveillancegroundstation.videomap_nilreason,
    organisation_unit_pt_bckien.title,
    organisation_unit_pt_bckien.nilreason[1],
    organisation_unit_pt_bckien.href;
-- TimesheetPropertyType
-- ['notes.note_view']
-- Snowflake SQL : TimesheetPropertyType 

CREATE MATERIALIZED VIEW shared.timesheet_view AS
SELECT
shared.timesheet_pt.id,
jsonb_build_object(
	'timereference', COALESCE(shared.timesheet.timereference_value, '(' || shared.timesheet.timereference_nilreason || ')'),
	'startdate', COALESCE(shared.timesheet.startdate_value, '(' || shared.timesheet.startdate_nilreason || ')'),
	'enddate', COALESCE(shared.timesheet.enddate_value, '(' || shared.timesheet.enddate_nilreason || ')'),
	'day', COALESCE(shared.timesheet.day_value, '(' || shared.timesheet.day_nilreason || ')'),
	'daytil', COALESCE(shared.timesheet.daytil_value, '(' || shared.timesheet.daytil_nilreason || ')'),
	'starttime', COALESCE(shared.timesheet.starttime_value, '(' || shared.timesheet.starttime_nilreason || ')'),
	'startevent', COALESCE(shared.timesheet.startevent_value, '(' || shared.timesheet.startevent_nilreason || ')'),
	'starteventinterpretation', COALESCE(shared.timesheet.starteventinterpretation_value, '(' || shared.timesheet.starteventinterpretation_nilreason || ')'),
	'starttimerelativeevent', COALESCE(shared.timesheet.starttimerelativeevent_value || ' ' || shared.timesheet.starttimerelativeevent_uom, '(' || shared.timesheet.starttimerelativeevent_nilreason || ')'),
	'endtime', COALESCE(shared.timesheet.endtime_value, '(' || shared.timesheet.endtime_nilreason || ')'),
	'endevent', COALESCE(shared.timesheet.endevent_value, '(' || shared.timesheet.endevent_nilreason || ')'),
	'endeventinterpretation', COALESCE(shared.timesheet.endeventinterpretation_value, '(' || shared.timesheet.endeventinterpretation_nilreason || ')'),
	'endtimerelativeevent', COALESCE(shared.timesheet.endtimerelativeevent_value || ' ' || shared.timesheet.endtimerelativeevent_uom, '(' || shared.timesheet.endtimerelativeevent_nilreason || ')'),
	'daylightsavingadjust',COALESCE(shared.timesheet.daylightsavingadjust_value, '(' || shared.timesheet.daylightsavingadjust_nilreason || ')'),
	'excluded', COALESCE(shared.timesheet.excluded_value, '(' || shared.timesheet.excluded_nilreason || ')'),
	'annotations', COALESCE(jsonb_agg(notes.note_view.note), '[]'::jsonb)
)
FROM shared.timesheet_pt
INNER JOIN shared.timesheet ON shared.timesheet_pt.timesheet_id = shared.timesheet.id
LEFT JOIN master_join ON shared.timesheet.id = master_join.source_id
LEFT JOIN notes.note_view ON master_join.target_id = notes.note_view.id
GROUP BY
    shared.timesheet_pt.id,
    shared.timesheet.timereference_value,
    shared.timesheet.timereference_nilreason,
    shared.timesheet.startdate_value,
    shared.timesheet.startdate_nilreason,
    shared.timesheet.enddate_value,
    shared.timesheet.enddate_nilreason,
    shared.timesheet.day_value,
    shared.timesheet.day_nilreason,
    shared.timesheet.daytil_value,
    shared.timesheet.daytil_nilreason,
    shared.timesheet.starttime_value,
    shared.timesheet.starttime_nilreason,
    shared.timesheet.startevent_value,
    shared.timesheet.startevent_nilreason,
    shared.timesheet.starteventinterpretation_value,
    shared.timesheet.starteventinterpretation_nilreason,
    shared.timesheet.endtime_value,
    shared.timesheet.endtime_nilreason,
    shared.timesheet.endevent_value,
    shared.timesheet.endevent_nilreason,
    shared.timesheet.endeventinterpretation_value,
    shared.timesheet.endeventinterpretation_nilreason,
    shared.timesheet.daylightsavingadjust_value,
    shared.timesheet.daylightsavingadjust_nilreason,
    shared.timesheet.excluded_value,
    shared.timesheet.excluded_nilreason,
    shared.timesheet.starttimerelativeevent_value,
    shared.timesheet.starttimerelativeevent_uom,
    shared.timesheet.starttimerelativeevent_nilreason,
    shared.timesheet.endtimerelativeevent_value,
    shared.timesheet.endtimerelativeevent_uom,
    shared.timesheet.endtimerelativeevent_nilreason;

CREATE INDEX ON shared.timesheet_view (id);
-- UnitDependencyPropertyType
-- ['notes.note_view']
create or replace view organisation.unitdependency_view as
select
    organisation.unitdependency_pt.id,
    organisation.unitdependency_pt.nilreason AS unitdependency_nilreason,
    coalesce(cast(organisation.unitdependency.type_value as varchar), '(' || organisation.unitdependency.type_nilreason || ')') as type,
    coalesce(cast(organisation_unit_pt_qixdgw.title as varchar), '(' || organisation_unit_pt_qixdgw.nilreason[1] || ')') AS theunit,
    organisation_unit_pt_qixdgw.href AS theunit_href,
    jsonb_agg(notes_note_view_mfgiuz.*) AS unitdependency_annotation
from organisation.unitdependency_pt 
inner join organisation.unitdependency on organisation.unitdependency_pt.unitdependency_id = organisation.unitdependency.id
left join organisation.unit_pt organisation_unit_pt_qixdgw on organisation.unitdependency.theunit_id = organisation_unit_pt_qixdgw.id
left join master_join master_join_ylbrgt on organisation.unitdependency.id = master_join_ylbrgt.source_id
left join notes.note_view notes_note_view_mfgiuz on master_join_ylbrgt.target_id = notes_note_view_mfgiuz.id
group by
    organisation.unitdependency_pt.id,
    organisation.unitdependency_pt.nilreason,
    organisation.unitdependency.type_value,
    organisation.unitdependency.type_nilreason,
    organisation_unit_pt_qixdgw.title,
    organisation_unit_pt_qixdgw.nilreason[1],
    organisation_unit_pt_qixdgw.href;
-- DepartureArrivalConditionPropertyType
-- ['notes.note_view', 'shared.aircraftcharacteristic_view']
create or replace view procedure.departurearrivalcondition_view as
select
    procedure.departurearrivalcondition_pt.id,
    procedure.departurearrivalcondition_pt.nilreason AS departurearrivalcondition_nilreason,
    coalesce(cast(procedure.departurearrivalcondition.minimumcrossingatendreference_value as varchar), '(' || procedure.departurearrivalcondition.minimumcrossingatendreference_nilreason || ')') as minimumcrossingatendreference,
    coalesce(cast(procedure.departurearrivalcondition.maximumcrossingatendreference_value as varchar), '(' || procedure.departurearrivalcondition.maximumcrossingatendreference_nilreason || ')') as maximumcrossingatendreference,
    coalesce(cast(procedure.departurearrivalcondition.minimumenroutealtitude_value as varchar) || ' ' || procedure.departurearrivalcondition.minimumenroutealtitude_uom, '(' || procedure.departurearrivalcondition.minimumenroutealtitude_nilreason || ')') as minimumenroutealtitude,
    coalesce(cast(procedure.departurearrivalcondition.minimumcrossingatend_value as varchar) || ' ' || procedure.departurearrivalcondition.minimumcrossingatend_uom, '(' || procedure.departurearrivalcondition.minimumcrossingatend_nilreason || ')') as minimumcrossingatend,
    coalesce(cast(procedure.departurearrivalcondition.maximumcrossingatend_value as varchar) || ' ' || procedure.departurearrivalcondition.maximumcrossingatend_uom, '(' || procedure.departurearrivalcondition.maximumcrossingatend_nilreason || ')') as maximumcrossingatend,
    shared_aircraftcharacteristic_view_docynf.id AS enginetype,
    jsonb_agg(notes_note_view_sbpbnx.*) AS departurearrivalcondition_annotation
from procedure.departurearrivalcondition_pt 
inner join procedure.departurearrivalcondition on procedure.departurearrivalcondition_pt.departurearrivalcondition_id = procedure.departurearrivalcondition.id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_docynf on procedure.departurearrivalcondition.engine_id = shared_aircraftcharacteristic_view_docynf.id
left join master_join master_join_nofcbw on procedure.departurearrivalcondition.id = master_join_nofcbw.source_id
left join notes.note_view notes_note_view_sbpbnx on master_join_nofcbw.target_id = notes_note_view_sbpbnx.id
group by
    procedure.departurearrivalcondition_pt.id,
    procedure.departurearrivalcondition_pt.nilreason,
    procedure.departurearrivalcondition.minimumcrossingatendreference_value,
    procedure.departurearrivalcondition.minimumcrossingatendreference_nilreason,
    procedure.departurearrivalcondition.maximumcrossingatendreference_value,
    procedure.departurearrivalcondition.maximumcrossingatendreference_nilreason,
    procedure.departurearrivalcondition.minimumenroutealtitude_value,
    procedure.departurearrivalcondition.minimumenroutealtitude_uom,
    procedure.departurearrivalcondition.minimumenroutealtitude_nilreason,
    procedure.departurearrivalcondition.minimumcrossingatend_value,
    procedure.departurearrivalcondition.minimumcrossingatend_uom,
    procedure.departurearrivalcondition.minimumcrossingatend_nilreason,
    procedure.departurearrivalcondition.maximumcrossingatend_value,
    procedure.departurearrivalcondition.maximumcrossingatend_uom,
    procedure.departurearrivalcondition.maximumcrossingatend_nilreason,
    shared_aircraftcharacteristic_view_docynf.id;
-- FinalProfilePropertyType
-- ['notes.note_view', 'procedure.approachdistancetable_view', 'procedure.approachtimingtable_view', 'procedure.approachaltitudetable_view']
create or replace view procedure.finalprofile_view as
select
    procedure.finalprofile_pt.id,
    procedure.finalprofile_pt.nilreason AS finalprofile_nilreason,
    jsonb_agg(procedure_approachaltitudetable_view_spxicy.id) AS altitude,
    jsonb_agg(procedure_approachdistancetable_view_sykppr.id) AS distance,
    jsonb_agg(procedure_approachtimingtable_view_svsxfi.id) AS timing,
    jsonb_agg(notes_note_view_qizwac.*) AS finalprofile_annotation
from procedure.finalprofile_pt 
inner join procedure.finalprofile on procedure.finalprofile_pt.finalprofile_id = procedure.finalprofile.id
left join master_join master_join_jwrgdq on procedure.finalprofile.id = master_join_jwrgdq.source_id
left join procedure.approachaltitudetable_view procedure_approachaltitudetable_view_spxicy on master_join_jwrgdq.target_id = procedure_approachaltitudetable_view_spxicy.id
left join master_join master_join_beclpv on procedure.finalprofile.id = master_join_beclpv.source_id
left join procedure.approachdistancetable_view procedure_approachdistancetable_view_sykppr on master_join_beclpv.target_id = procedure_approachdistancetable_view_sykppr.id
left join master_join master_join_nhikag on procedure.finalprofile.id = master_join_nhikag.source_id
left join procedure.approachtimingtable_view procedure_approachtimingtable_view_svsxfi on master_join_nhikag.target_id = procedure_approachtimingtable_view_svsxfi.id
left join master_join master_join_edbiho on procedure.finalprofile.id = master_join_edbiho.source_id
left join notes.note_view notes_note_view_qizwac on master_join_edbiho.target_id = notes_note_view_qizwac.id
group by
    procedure.finalprofile_pt.id,
    procedure.finalprofile_pt.nilreason;
-- ReflectorPropertyType
-- ['notes.note_view', 'geometry.elevatedpoint_view']
create or replace view surveillance.reflector_view as
select
    surveillance.reflector_pt.id,
    surveillance.reflector_pt.nilreason AS reflector_nilreason,
    coalesce(cast(surveillance.reflector.type_value as varchar), '(' || surveillance.reflector.type_nilreason || ')') as type,
    geometry_elevatedpoint_view_gjjiay.geom AS geom,
    ST_X(geometry_elevatedpoint_view_gjjiay.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_gjjiay.geom) AS latitude,
    geometry_elevatedpoint_view_gjjiay.elevation,
    geometry_elevatedpoint_view_gjjiay.geoidUndulation,
    geometry_elevatedpoint_view_gjjiay.verticalDatum,
    geometry_elevatedpoint_view_gjjiay.verticalAccuracy,
    geometry_elevatedpoint_view_gjjiay.horizontalAccuracy,
    jsonb_agg(notes_note_view_fzanhu.*) AS reflector_annotation
from surveillance.reflector_pt 
inner join surveillance.reflector on surveillance.reflector_pt.reflector_id = surveillance.reflector.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_gjjiay on surveillance.reflector.touchdownreflector_id = geometry_elevatedpoint_view_gjjiay.id
left join master_join master_join_nicfqf on surveillance.reflector.id = master_join_nicfqf.source_id
left join notes.note_view notes_note_view_fzanhu on master_join_nicfqf.target_id = notes_note_view_fzanhu.id
group by
    surveillance.reflector_pt.id,
    surveillance.reflector_pt.nilreason,
    surveillance.reflector.type_value,
    surveillance.reflector.type_nilreason,
    geometry_elevatedpoint_view_gjjiay.geom,
    geometry_elevatedpoint_view_gjjiay.elevation,
    geometry_elevatedpoint_view_gjjiay.geoidUndulation,
    geometry_elevatedpoint_view_gjjiay.verticalDatum,
    geometry_elevatedpoint_view_gjjiay.verticalAccuracy,
    geometry_elevatedpoint_view_gjjiay.horizontalAccuracy;
-- MarkingElementPropertyType
-- ['geometry.elevatedsurface_view', 'geometry.elevatedcurve_view', 'notes.note_view', 'geometry.elevatedpoint_view']
create or replace view airport_heliport.markingelement_view as
select
    airport_heliport.markingelement_pt.id,
    airport_heliport.markingelement_pt.nilreason AS markingelement_nilreason,
    coalesce(cast(airport_heliport.markingelement.colour_value as varchar), '(' || airport_heliport.markingelement.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport.markingelement.style_value as varchar), '(' || airport_heliport.markingelement.style_nilreason || ')') as style,
    geometry_elevatedsurface_view_qdvfvn.geom AS geom,
    geometry_elevatedsurface_view_qdvfvn.elevation,
    geometry_elevatedsurface_view_qdvfvn.geoidUndulation,
    geometry_elevatedsurface_view_qdvfvn.verticalDatum,
    geometry_elevatedsurface_view_qdvfvn.verticalAccuracy,
    geometry_elevatedsurface_view_qdvfvn.horizontalAccuracy,
    geometry_elevatedcurve_view_ttpsvz.geom AS geom,
    geometry_elevatedcurve_view_ttpsvz.elevation,
    geometry_elevatedcurve_view_ttpsvz.geoidUndulation,
    geometry_elevatedcurve_view_ttpsvz.verticalDatum,
    geometry_elevatedcurve_view_ttpsvz.verticalAccuracy,
    geometry_elevatedcurve_view_ttpsvz.horizontalAccuracy,
    geometry_elevatedpoint_view_cxhtrz.geom AS geom,
    ST_X(geometry_elevatedpoint_view_cxhtrz.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_cxhtrz.geom) AS latitude,
    geometry_elevatedpoint_view_cxhtrz.elevation,
    geometry_elevatedpoint_view_cxhtrz.geoidUndulation,
    geometry_elevatedpoint_view_cxhtrz.verticalDatum,
    geometry_elevatedpoint_view_cxhtrz.verticalAccuracy,
    geometry_elevatedpoint_view_cxhtrz.horizontalAccuracy,
    jsonb_agg(notes_note_view_zhjjly.*) AS markingelement_annotation
from airport_heliport.markingelement_pt 
inner join airport_heliport.markingelement on airport_heliport.markingelement_pt.markingelement_id = airport_heliport.markingelement.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_qdvfvn on airport_heliport.markingelement.extent_surfaceextent_id = geometry_elevatedsurface_view_qdvfvn.id
left join geometry.elevatedcurve_view geometry_elevatedcurve_view_ttpsvz on airport_heliport.markingelement.extent_curveextent_id = geometry_elevatedcurve_view_ttpsvz.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_cxhtrz on airport_heliport.markingelement.extent_location_id = geometry_elevatedpoint_view_cxhtrz.id
left join master_join master_join_giujbi on airport_heliport.markingelement.id = master_join_giujbi.source_id
left join notes.note_view notes_note_view_zhjjly on master_join_giujbi.target_id = notes_note_view_zhjjly.id
group by
    airport_heliport.markingelement_pt.id,
    airport_heliport.markingelement_pt.nilreason,
    airport_heliport.markingelement.colour_value,
    airport_heliport.markingelement.colour_nilreason,
    airport_heliport.markingelement.style_value,
    airport_heliport.markingelement.style_nilreason,
    geometry_elevatedsurface_view_qdvfvn.geom,
    geometry_elevatedsurface_view_qdvfvn.elevation,
    geometry_elevatedsurface_view_qdvfvn.geoidUndulation,
    geometry_elevatedsurface_view_qdvfvn.verticalDatum,
    geometry_elevatedsurface_view_qdvfvn.verticalAccuracy,
    geometry_elevatedsurface_view_qdvfvn.horizontalAccuracy,
    geometry_elevatedcurve_view_ttpsvz.geom,
    geometry_elevatedcurve_view_ttpsvz.elevation,
    geometry_elevatedcurve_view_ttpsvz.geoidUndulation,
    geometry_elevatedcurve_view_ttpsvz.verticalDatum,
    geometry_elevatedcurve_view_ttpsvz.verticalAccuracy,
    geometry_elevatedcurve_view_ttpsvz.horizontalAccuracy,
    geometry_elevatedpoint_view_cxhtrz.geom,
    geometry_elevatedpoint_view_cxhtrz.elevation,
    geometry_elevatedpoint_view_cxhtrz.geoidUndulation,
    geometry_elevatedpoint_view_cxhtrz.verticalDatum,
    geometry_elevatedpoint_view_cxhtrz.verticalAccuracy,
    geometry_elevatedpoint_view_cxhtrz.horizontalAccuracy;
-- SurfaceContaminationLayerPropertyType
-- ['geometry.elevatedsurface_view', 'notes.note_view']
create or replace view airport_heliport.surfacecontaminationlayer_view as
select
    airport_heliport.surfacecontaminationlayer_pt.id,
    airport_heliport.surfacecontaminationlayer_pt.nilreason AS surfacecontaminationlayer_nilreason,
    coalesce(cast(airport_heliport.surfacecontaminationlayer.layerorder_value as varchar), '(' || airport_heliport.surfacecontaminationlayer.layerorder_nilreason || ')') as layerorder,
    coalesce(cast(airport_heliport.surfacecontaminationlayer.type_value as varchar), '(' || airport_heliport.surfacecontaminationlayer.type_nilreason || ')') as type,
    geometry_elevatedsurface_view_cfefqy.geom AS geom,
    jsonb_agg(notes_note_view_gyuthc.*) AS surfacecontaminationlayer_annotation
from airport_heliport.surfacecontaminationlayer_pt 
inner join airport_heliport.surfacecontaminationlayer on airport_heliport.surfacecontaminationlayer_pt.surfacecontaminationlayer_id = airport_heliport.surfacecontaminationlayer.id
left join master_join master_join_pddolg on airport_heliport.surfacecontaminationlayer.id = master_join_pddolg.source_id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_cfefqy on master_join_pddolg.target_id = geometry_elevatedsurface_view_cfefqy.id
left join master_join master_join_jjkcrz on airport_heliport.surfacecontaminationlayer.id = master_join_jjkcrz.source_id
left join notes.note_view notes_note_view_gyuthc on master_join_jjkcrz.target_id = notes_note_view_gyuthc.id
group by
    airport_heliport.surfacecontaminationlayer_pt.id,
    airport_heliport.surfacecontaminationlayer_pt.nilreason,
    airport_heliport.surfacecontaminationlayer.layerorder_value,
    airport_heliport.surfacecontaminationlayer.layerorder_nilreason,
    airport_heliport.surfacecontaminationlayer.type_value,
    airport_heliport.surfacecontaminationlayer.type_nilreason;
-- EquipmentUnavailableAdjustmentPropertyType
-- ['procedure.equipmentunavailableadjustmentcolumn_view', 'notes.note_view']
create or replace view procedure.equipmentunavailableadjustment_view as
select
    procedure.equipmentunavailableadjustment_pt.id,
    procedure.equipmentunavailableadjustment_pt.nilreason AS equipmentunavailableadjustment_nilreason,
    coalesce(cast(procedure.equipmentunavailableadjustment.type_value as varchar), '(' || procedure.equipmentunavailableadjustment.type_nilreason || ')') as type,
    coalesce(cast(procedure.equipmentunavailableadjustment.approachlightinginoperative_value as varchar), '(' || procedure.equipmentunavailableadjustment.approachlightinginoperative_nilreason || ')') as approachlightinginoperative,
    jsonb_agg(procedure_equipmentunavailableadjustmentcolumn_view_qpqava.id) AS adjustmentinopcol,
    jsonb_agg(notes_note_view_ahqmsq.*) AS equipmentunavailableadjustment_annotation
from procedure.equipmentunavailableadjustment_pt 
inner join procedure.equipmentunavailableadjustment on procedure.equipmentunavailableadjustment_pt.equipmentunavailableadjustment_id = procedure.equipmentunavailableadjustment.id
left join master_join master_join_pjykrl on procedure.equipmentunavailableadjustment.id = master_join_pjykrl.source_id
left join procedure.equipmentunavailableadjustmentcolumn_view procedure_equipmentunavailableadjustmentcolumn_view_qpqava on master_join_pjykrl.target_id = procedure_equipmentunavailableadjustmentcolumn_view_qpqava.id
left join master_join master_join_zlxqml on procedure.equipmentunavailableadjustment.id = master_join_zlxqml.source_id
left join notes.note_view notes_note_view_ahqmsq on master_join_zlxqml.target_id = notes_note_view_ahqmsq.id
group by
    procedure.equipmentunavailableadjustment_pt.id,
    procedure.equipmentunavailableadjustment_pt.nilreason,
    procedure.equipmentunavailableadjustment.type_value,
    procedure.equipmentunavailableadjustment.type_nilreason,
    procedure.equipmentunavailableadjustment.approachlightinginoperative_value,
    procedure.equipmentunavailableadjustment.approachlightinginoperative_nilreason;
-- ObstructionPropertyType
-- ['shared.altitudeadjustment_view', 'shared.obstacleplacement_view', 'notes.note_view']
create or replace view shared.obstruction_view as
select
    shared.obstruction_pt.id,
    shared.obstruction_pt.nilreason AS obstruction_nilreason,
    coalesce(cast(shared.obstruction.surfacepenetration_value as varchar), '(' || shared.obstruction.surfacepenetration_nilreason || ')') as surfacepenetration,
    coalesce(cast(shared.obstruction.slopepenetration_value as varchar), '(' || shared.obstruction.slopepenetration_nilreason || ')') as slopepenetration,
    coalesce(cast(shared.obstruction.controlling_value as varchar), '(' || shared.obstruction.controlling_nilreason || ')') as controlling,
    coalesce(cast(shared.obstruction.closein_value as varchar), '(' || shared.obstruction.closein_nilreason || ')') as closein,
    coalesce(cast(shared.obstruction.requiredclearance_value as varchar) || ' ' || shared.obstruction.requiredclearance_uom, '(' || shared.obstruction.requiredclearance_nilreason || ')') as requiredclearance,
    coalesce(cast(shared.obstruction.minimumaltitude_value as varchar) || ' ' || shared.obstruction.minimumaltitude_uom, '(' || shared.obstruction.minimumaltitude_nilreason || ')') as minimumaltitude,
    coalesce(cast(obstacles_verticalstructure_pt_aqqajz.title as varchar), '(' || obstacles_verticalstructure_pt_aqqajz.nilreason[1] || ')') AS theverticalstructure,
    obstacles_verticalstructure_pt_aqqajz.href AS theverticalstructure_href,
    jsonb_agg(shared_altitudeadjustment_view_fkpprp.id) AS adjustment,
    jsonb_agg(shared_obstacleplacement_view_zjvzav.id) AS obstacleplacement,
    jsonb_agg(notes_note_view_snsykz.*) AS obstruction_annotation
from shared.obstruction_pt 
inner join shared.obstruction on shared.obstruction_pt.obstruction_id = shared.obstruction.id
left join obstacles.verticalstructure_pt obstacles_verticalstructure_pt_aqqajz on shared.obstruction.theverticalstructure_id = obstacles_verticalstructure_pt_aqqajz.id
left join master_join master_join_xznlgv on shared.obstruction.id = master_join_xznlgv.source_id
left join shared.altitudeadjustment_view shared_altitudeadjustment_view_fkpprp on master_join_xznlgv.target_id = shared_altitudeadjustment_view_fkpprp.id
left join master_join master_join_tcaflh on shared.obstruction.id = master_join_tcaflh.source_id
left join shared.obstacleplacement_view shared_obstacleplacement_view_zjvzav on master_join_tcaflh.target_id = shared_obstacleplacement_view_zjvzav.id
left join master_join master_join_mcpqcw on shared.obstruction.id = master_join_mcpqcw.source_id
left join notes.note_view notes_note_view_snsykz on master_join_mcpqcw.target_id = notes_note_view_snsykz.id
group by
    shared.obstruction_pt.id,
    shared.obstruction_pt.nilreason,
    shared.obstruction.surfacepenetration_value,
    shared.obstruction.surfacepenetration_nilreason,
    shared.obstruction.slopepenetration_value,
    shared.obstruction.slopepenetration_nilreason,
    shared.obstruction.controlling_value,
    shared.obstruction.controlling_nilreason,
    shared.obstruction.closein_value,
    shared.obstruction.closein_nilreason,
    shared.obstruction.requiredclearance_value,
    shared.obstruction.requiredclearance_uom,
    shared.obstruction.requiredclearance_nilreason,
    shared.obstruction.minimumaltitude_value,
    shared.obstruction.minimumaltitude_uom,
    shared.obstruction.minimumaltitude_nilreason,
    obstacles_verticalstructure_pt_aqqajz.title,
    obstacles_verticalstructure_pt_aqqajz.nilreason[1],
    obstacles_verticalstructure_pt_aqqajz.href;
-- DirectFlightSegmentPropertyType
-- ['geometry.point_view', 'notes.note_view']
create or replace view routes.directflightsegment_view as
select
    routes.directflightsegment_pt.id,
    routes.directflightsegment_pt.nilreason AS directflightsegment_nilreason,
    coalesce(cast(navaids_points_designatedpoint_pt_ytyxni.title as varchar), '(' || navaids_points_designatedpoint_pt_ytyxni.nilreason[1] || ')') AS endfixdesignatedpoint,
    navaids_points_designatedpoint_pt_ytyxni.href AS endfixdesignatedpoint_href,
    coalesce(cast(navaids_points_designatedpoint_pt_qxiach.title as varchar), '(' || navaids_points_designatedpoint_pt_qxiach.nilreason[1] || ')') AS startfixdesignatedpoint,
    navaids_points_designatedpoint_pt_qxiach.href AS startfixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_woaoux.title as varchar), '(' || navaids_points_navaid_pt_woaoux.nilreason[1] || ')') AS endnavaidsystem,
    navaids_points_navaid_pt_woaoux.href AS endnavaidsystem_href,
    coalesce(cast(navaids_points_navaid_pt_mmxigz.title as varchar), '(' || navaids_points_navaid_pt_mmxigz.nilreason[1] || ')') AS startnavaidsystem,
    navaids_points_navaid_pt_mmxigz.href AS startnavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_govokr.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_govokr.nilreason[1] || ')') AS endaimingpoint,
    airport_heliport_touchdownliftoff_pt_govokr.href AS endaimingpoint_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_ftarvr.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_ftarvr.nilreason[1] || ')') AS startaimingpoint,
    airport_heliport_touchdownliftoff_pt_ftarvr.href AS startaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_ypeuxc.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_ypeuxc.nilreason[1] || ')') AS endrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_ypeuxc.href AS endrunwaypoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_nymefc.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_nymefc.nilreason[1] || ')') AS startrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_nymefc.href AS startrunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_thheun.title as varchar), '(' || airport_heliport_airportheliport_pt_thheun.nilreason[1] || ')') AS endairportreferencepoint,
    airport_heliport_airportheliport_pt_thheun.href AS endairportreferencepoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_kxpcnn.title as varchar), '(' || airport_heliport_airportheliport_pt_kxpcnn.nilreason[1] || ')') AS startairportreferencepoint,
    airport_heliport_airportheliport_pt_kxpcnn.href AS startairportreferencepoint_href,
    geometry_point_view_qyrozb.geom AS geom,
    ST_X(geometry_point_view_qyrozb.geom) AS longitude,
    ST_Y(geometry_point_view_qyrozb.geom) AS latitude,
    geometry_point_view_qyrozb.horizontalAccuracy,
    geometry_point_view_izwyhs.geom AS geom,
    ST_X(geometry_point_view_izwyhs.geom) AS longitude,
    ST_Y(geometry_point_view_izwyhs.geom) AS latitude,
    geometry_point_view_izwyhs.horizontalAccuracy,
    jsonb_agg(notes_note_view_pospff.*) AS directflightsegment_annotation
from routes.directflightsegment_pt 
inner join routes.directflightsegment on routes.directflightsegment_pt.directflightsegment_id = routes.directflightsegment.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_ytyxni on routes.directflightsegment.end_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_ytyxni.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_woaoux on routes.directflightsegment.end_navaidsystem_id = navaids_points_navaid_pt_woaoux.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_govokr on routes.directflightsegment.end_aimingpoint_id = airport_heliport_touchdownliftoff_pt_govokr.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_ypeuxc on routes.directflightsegment.end_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_ypeuxc.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_thheun on routes.directflightsegment.end_airportreferencepoint_id = airport_heliport_airportheliport_pt_thheun.id
left join geometry.point_view geometry_point_view_qyrozb on routes.directflightsegment.end_position_id = geometry_point_view_qyrozb.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_qxiach on routes.directflightsegment.start_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_qxiach.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_mmxigz on routes.directflightsegment.start_navaidsystem_id = navaids_points_navaid_pt_mmxigz.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_ftarvr on routes.directflightsegment.start_aimingpoint_id = airport_heliport_touchdownliftoff_pt_ftarvr.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_nymefc on routes.directflightsegment.start_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_nymefc.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_kxpcnn on routes.directflightsegment.start_airportreferencepoint_id = airport_heliport_airportheliport_pt_kxpcnn.id
left join geometry.point_view geometry_point_view_izwyhs on routes.directflightsegment.start_position_id = geometry_point_view_izwyhs.id
left join master_join master_join_chsiyw on routes.directflightsegment.id = master_join_chsiyw.source_id
left join notes.note_view notes_note_view_pospff on master_join_chsiyw.target_id = notes_note_view_pospff.id
group by
    routes.directflightsegment_pt.id,
    routes.directflightsegment_pt.nilreason,
    navaids_points_designatedpoint_pt_ytyxni.title,
    navaids_points_designatedpoint_pt_ytyxni.nilreason[1],
    navaids_points_designatedpoint_pt_ytyxni.href,
    navaids_points_navaid_pt_woaoux.title,
    navaids_points_navaid_pt_woaoux.nilreason[1],
    navaids_points_navaid_pt_woaoux.href,
    airport_heliport_touchdownliftoff_pt_govokr.title,
    airport_heliport_touchdownliftoff_pt_govokr.nilreason[1],
    airport_heliport_touchdownliftoff_pt_govokr.href,
    airport_heliport_runwaycentrelinepoint_pt_ypeuxc.title,
    airport_heliport_runwaycentrelinepoint_pt_ypeuxc.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_ypeuxc.href,
    airport_heliport_airportheliport_pt_thheun.title,
    airport_heliport_airportheliport_pt_thheun.nilreason[1],
    airport_heliport_airportheliport_pt_thheun.href,
    geometry_point_view_qyrozb.geom,
    geometry_point_view_qyrozb.horizontalAccuracy,
    navaids_points_designatedpoint_pt_qxiach.title,
    navaids_points_designatedpoint_pt_qxiach.nilreason[1],
    navaids_points_designatedpoint_pt_qxiach.href,
    navaids_points_navaid_pt_mmxigz.title,
    navaids_points_navaid_pt_mmxigz.nilreason[1],
    navaids_points_navaid_pt_mmxigz.href,
    airport_heliport_touchdownliftoff_pt_ftarvr.title,
    airport_heliport_touchdownliftoff_pt_ftarvr.nilreason[1],
    airport_heliport_touchdownliftoff_pt_ftarvr.href,
    airport_heliport_runwaycentrelinepoint_pt_nymefc.title,
    airport_heliport_runwaycentrelinepoint_pt_nymefc.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_nymefc.href,
    airport_heliport_airportheliport_pt_kxpcnn.title,
    airport_heliport_airportheliport_pt_kxpcnn.nilreason[1],
    airport_heliport_airportheliport_pt_kxpcnn.href,
    geometry_point_view_izwyhs.geom,
    geometry_point_view_izwyhs.horizontalAccuracy;
-- RoutePortionPropertyType
-- ['geometry.point_view', 'notes.note_view']
create or replace view routes.routeportion_view as
select
    routes.routeportion_pt.id,
    routes.routeportion_pt.nilreason AS routeportion_nilreason,
    coalesce(cast(navaids_points_designatedpoint_pt_cjlcsw.title as varchar), '(' || navaids_points_designatedpoint_pt_cjlcsw.nilreason[1] || ')') AS startfixdesignatedpoint,
    navaids_points_designatedpoint_pt_cjlcsw.href AS startfixdesignatedpoint_href,
    coalesce(cast(navaids_points_designatedpoint_pt_eidumt.title as varchar), '(' || navaids_points_designatedpoint_pt_eidumt.nilreason[1] || ')') AS intermediatepointfixdesignatedpoint,
    navaids_points_designatedpoint_pt_eidumt.href AS intermediatepointfixdesignatedpoint_href,
    coalesce(cast(navaids_points_designatedpoint_pt_wdtnqu.title as varchar), '(' || navaids_points_designatedpoint_pt_wdtnqu.nilreason[1] || ')') AS endfixdesignatedpoint,
    navaids_points_designatedpoint_pt_wdtnqu.href AS endfixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_tqyzfm.title as varchar), '(' || navaids_points_navaid_pt_tqyzfm.nilreason[1] || ')') AS startnavaidsystem,
    navaids_points_navaid_pt_tqyzfm.href AS startnavaidsystem_href,
    coalesce(cast(navaids_points_navaid_pt_vbdtuo.title as varchar), '(' || navaids_points_navaid_pt_vbdtuo.nilreason[1] || ')') AS intermediatepointnavaidsystem,
    navaids_points_navaid_pt_vbdtuo.href AS intermediatepointnavaidsystem_href,
    coalesce(cast(navaids_points_navaid_pt_jpvoai.title as varchar), '(' || navaids_points_navaid_pt_jpvoai.nilreason[1] || ')') AS endnavaidsystem,
    navaids_points_navaid_pt_jpvoai.href AS endnavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_xqwumi.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_xqwumi.nilreason[1] || ')') AS startaimingpoint,
    airport_heliport_touchdownliftoff_pt_xqwumi.href AS startaimingpoint_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_czlfoy.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_czlfoy.nilreason[1] || ')') AS intermediatepointaimingpoint,
    airport_heliport_touchdownliftoff_pt_czlfoy.href AS intermediatepointaimingpoint_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_gfgvkb.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_gfgvkb.nilreason[1] || ')') AS endaimingpoint,
    airport_heliport_touchdownliftoff_pt_gfgvkb.href AS endaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_ofxqoi.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_ofxqoi.nilreason[1] || ')') AS startrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_ofxqoi.href AS startrunwaypoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_cshztl.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_cshztl.nilreason[1] || ')') AS intermediatepointrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_cshztl.href AS intermediatepointrunwaypoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_uxankp.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_uxankp.nilreason[1] || ')') AS endrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_uxankp.href AS endrunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_skeqpl.title as varchar), '(' || airport_heliport_airportheliport_pt_skeqpl.nilreason[1] || ')') AS startairportreferencepoint,
    airport_heliport_airportheliport_pt_skeqpl.href AS startairportreferencepoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_uptwwz.title as varchar), '(' || airport_heliport_airportheliport_pt_uptwwz.nilreason[1] || ')') AS intermediatepointairportreferencepoint,
    airport_heliport_airportheliport_pt_uptwwz.href AS intermediatepointairportreferencepoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_bzivcp.title as varchar), '(' || airport_heliport_airportheliport_pt_bzivcp.nilreason[1] || ')') AS endairportreferencepoint,
    airport_heliport_airportheliport_pt_bzivcp.href AS endairportreferencepoint_href,
    geometry_point_view_ctnhuz.geom AS geom,
    ST_X(geometry_point_view_ctnhuz.geom) AS longitude,
    ST_Y(geometry_point_view_ctnhuz.geom) AS latitude,
    geometry_point_view_ctnhuz.horizontalAccuracy,
    geometry_point_view_ivkxny.geom AS geom,
    ST_X(geometry_point_view_ivkxny.geom) AS longitude,
    ST_Y(geometry_point_view_ivkxny.geom) AS latitude,
    geometry_point_view_ivkxny.horizontalAccuracy,
    geometry_point_view_jecnwv.geom AS geom,
    ST_X(geometry_point_view_jecnwv.geom) AS longitude,
    ST_Y(geometry_point_view_jecnwv.geom) AS latitude,
    geometry_point_view_jecnwv.horizontalAccuracy,
    coalesce(cast(routes_route_pt_hdktmr.title as varchar), '(' || routes_route_pt_hdktmr.nilreason[1] || ')') AS referencedroute,
    routes_route_pt_hdktmr.href AS referencedroute_href,
    jsonb_agg(notes_note_view_avuvqq.*) AS routeportion_annotation
from routes.routeportion_pt 
inner join routes.routeportion on routes.routeportion_pt.routeportion_id = routes.routeportion.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_cjlcsw on routes.routeportion.start_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_cjlcsw.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_tqyzfm on routes.routeportion.start_navaidsystem_id = navaids_points_navaid_pt_tqyzfm.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_xqwumi on routes.routeportion.start_aimingpoint_id = airport_heliport_touchdownliftoff_pt_xqwumi.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_ofxqoi on routes.routeportion.start_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_ofxqoi.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_skeqpl on routes.routeportion.start_airportreferencepoint_id = airport_heliport_airportheliport_pt_skeqpl.id
left join geometry.point_view geometry_point_view_ctnhuz on routes.routeportion.start_position_id = geometry_point_view_ctnhuz.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_eidumt on routes.routeportion.intermediatepoint_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_eidumt.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_vbdtuo on routes.routeportion.intermediatepoint_navaidsystem_id = navaids_points_navaid_pt_vbdtuo.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_czlfoy on routes.routeportion.intermediatepoint_aimingpoint_id = airport_heliport_touchdownliftoff_pt_czlfoy.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_cshztl on routes.routeportion.intermediatepoint_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_cshztl.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_uptwwz on routes.routeportion.intermediatepoint_airportreferencepoint_id = airport_heliport_airportheliport_pt_uptwwz.id
left join geometry.point_view geometry_point_view_ivkxny on routes.routeportion.intermediatepoint_position_id = geometry_point_view_ivkxny.id
left join routes.route_pt routes_route_pt_hdktmr on routes.routeportion.referencedroute_id = routes_route_pt_hdktmr.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_wdtnqu on routes.routeportion.end_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_wdtnqu.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_jpvoai on routes.routeportion.end_navaidsystem_id = navaids_points_navaid_pt_jpvoai.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_gfgvkb on routes.routeportion.end_aimingpoint_id = airport_heliport_touchdownliftoff_pt_gfgvkb.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_uxankp on routes.routeportion.end_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_uxankp.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_bzivcp on routes.routeportion.end_airportreferencepoint_id = airport_heliport_airportheliport_pt_bzivcp.id
left join geometry.point_view geometry_point_view_jecnwv on routes.routeportion.end_position_id = geometry_point_view_jecnwv.id
left join master_join master_join_rjsrlc on routes.routeportion.id = master_join_rjsrlc.source_id
left join notes.note_view notes_note_view_avuvqq on master_join_rjsrlc.target_id = notes_note_view_avuvqq.id
group by
    routes.routeportion_pt.id,
    routes.routeportion_pt.nilreason,
    navaids_points_designatedpoint_pt_cjlcsw.title,
    navaids_points_designatedpoint_pt_cjlcsw.nilreason[1],
    navaids_points_designatedpoint_pt_cjlcsw.href,
    navaids_points_navaid_pt_tqyzfm.title,
    navaids_points_navaid_pt_tqyzfm.nilreason[1],
    navaids_points_navaid_pt_tqyzfm.href,
    airport_heliport_touchdownliftoff_pt_xqwumi.title,
    airport_heliport_touchdownliftoff_pt_xqwumi.nilreason[1],
    airport_heliport_touchdownliftoff_pt_xqwumi.href,
    airport_heliport_runwaycentrelinepoint_pt_ofxqoi.title,
    airport_heliport_runwaycentrelinepoint_pt_ofxqoi.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_ofxqoi.href,
    airport_heliport_airportheliport_pt_skeqpl.title,
    airport_heliport_airportheliport_pt_skeqpl.nilreason[1],
    airport_heliport_airportheliport_pt_skeqpl.href,
    geometry_point_view_ctnhuz.geom,
    geometry_point_view_ctnhuz.horizontalAccuracy,
    navaids_points_designatedpoint_pt_eidumt.title,
    navaids_points_designatedpoint_pt_eidumt.nilreason[1],
    navaids_points_designatedpoint_pt_eidumt.href,
    navaids_points_navaid_pt_vbdtuo.title,
    navaids_points_navaid_pt_vbdtuo.nilreason[1],
    navaids_points_navaid_pt_vbdtuo.href,
    airport_heliport_touchdownliftoff_pt_czlfoy.title,
    airport_heliport_touchdownliftoff_pt_czlfoy.nilreason[1],
    airport_heliport_touchdownliftoff_pt_czlfoy.href,
    airport_heliport_runwaycentrelinepoint_pt_cshztl.title,
    airport_heliport_runwaycentrelinepoint_pt_cshztl.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_cshztl.href,
    airport_heliport_airportheliport_pt_uptwwz.title,
    airport_heliport_airportheliport_pt_uptwwz.nilreason[1],
    airport_heliport_airportheliport_pt_uptwwz.href,
    geometry_point_view_ivkxny.geom,
    geometry_point_view_ivkxny.horizontalAccuracy,
    routes_route_pt_hdktmr.title,
    routes_route_pt_hdktmr.nilreason[1],
    routes_route_pt_hdktmr.href,
    navaids_points_designatedpoint_pt_wdtnqu.title,
    navaids_points_designatedpoint_pt_wdtnqu.nilreason[1],
    navaids_points_designatedpoint_pt_wdtnqu.href,
    navaids_points_navaid_pt_jpvoai.title,
    navaids_points_navaid_pt_jpvoai.nilreason[1],
    navaids_points_navaid_pt_jpvoai.href,
    airport_heliport_touchdownliftoff_pt_gfgvkb.title,
    airport_heliport_touchdownliftoff_pt_gfgvkb.nilreason[1],
    airport_heliport_touchdownliftoff_pt_gfgvkb.href,
    airport_heliport_runwaycentrelinepoint_pt_uxankp.title,
    airport_heliport_runwaycentrelinepoint_pt_uxankp.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_uxankp.href,
    airport_heliport_airportheliport_pt_bzivcp.title,
    airport_heliport_airportheliport_pt_bzivcp.nilreason[1],
    airport_heliport_airportheliport_pt_bzivcp.href,
    geometry_point_view_jecnwv.geom,
    geometry_point_view_jecnwv.horizontalAccuracy;
-- ProcedureTransitionPropertyType
-- ['procedure.proceduretransitionleg_view', 'procedure.landingtakeoffareacollection_view', 'geometry.curve_view', 'notes.note_view']
create or replace view procedure.proceduretransition_view as
select
    procedure.proceduretransition_pt.id,
    procedure.proceduretransition_pt.nilreason AS proceduretransition_nilreason,
    coalesce(cast(procedure.proceduretransition.transitionid_value as varchar), '(' || procedure.proceduretransition.transitionid_nilreason || ')') as transitionid,
    coalesce(cast(procedure.proceduretransition.type_value as varchar), '(' || procedure.proceduretransition.type_nilreason || ')') as type,
    coalesce(cast(procedure.proceduretransition.instruction_value as varchar), '(' || procedure.proceduretransition.instruction_nilreason || ')') as instruction,
    coalesce(cast(procedure.proceduretransition.vectorheading_value as varchar), '(' || procedure.proceduretransition.vectorheading_nilreason || ')') as vectorheading,
    procedure_landingtakeoffareacollection_view_akfroj.id AS departurerunwaytransition,
    geometry_curve_view_lsrnuq.geom AS geom,
    jsonb_agg(procedure_proceduretransitionleg_view_fclohn.id) AS transitionleg,
    jsonb_agg(notes_note_view_bjbleg.*) AS proceduretransition_annotation
from procedure.proceduretransition_pt 
inner join procedure.proceduretransition on procedure.proceduretransition_pt.proceduretransition_id = procedure.proceduretransition.id
left join procedure.landingtakeoffareacollection_view procedure_landingtakeoffareacollection_view_akfroj on procedure.proceduretransition.departurerunwaytransition_id = procedure_landingtakeoffareacollection_view_akfroj.id
left join geometry.curve_view geometry_curve_view_lsrnuq on procedure.proceduretransition.trajectory_id = geometry_curve_view_lsrnuq.id
left join master_join master_join_sxsiuz on procedure.proceduretransition.id = master_join_sxsiuz.source_id
left join procedure.proceduretransitionleg_view procedure_proceduretransitionleg_view_fclohn on master_join_sxsiuz.target_id = procedure_proceduretransitionleg_view_fclohn.id
left join master_join master_join_jbvmyj on procedure.proceduretransition.id = master_join_jbvmyj.source_id
left join notes.note_view notes_note_view_bjbleg on master_join_jbvmyj.target_id = notes_note_view_bjbleg.id
group by
    procedure.proceduretransition_pt.id,
    procedure.proceduretransition_pt.nilreason,
    procedure.proceduretransition.transitionid_value,
    procedure.proceduretransition.transitionid_nilreason,
    procedure.proceduretransition.type_value,
    procedure.proceduretransition.type_nilreason,
    procedure.proceduretransition.instruction_value,
    procedure.proceduretransition.instruction_nilreason,
    procedure.proceduretransition.vectorheading_value,
    procedure.proceduretransition.vectorheading_nilreason,
    procedure_landingtakeoffareacollection_view_akfroj.id,
    geometry_curve_view_lsrnuq.geom;
-- AirspaceVolumePropertyType
-- ['geometry.surface_view', 'geometry.curve_view', 'notes.note_view', 'airspace.airspacevolumedependency_view']
create or replace view airspace.airspacevolume_view as
select
    airspace.airspacevolume_pt.id,
    airspace.airspacevolume_pt.nilreason AS airspacevolume_nilreason,
    coalesce(cast(airspace.airspacevolume.upperlimitreference_value as varchar), '(' || airspace.airspacevolume.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(airspace.airspacevolume.maximumlimitreference_value as varchar), '(' || airspace.airspacevolume.maximumlimitreference_nilreason || ')') as maximumlimitreference,
    coalesce(cast(airspace.airspacevolume.lowerlimitreference_value as varchar), '(' || airspace.airspacevolume.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(airspace.airspacevolume.minimumlimitreference_value as varchar), '(' || airspace.airspacevolume.minimumlimitreference_nilreason || ')') as minimumlimitreference,
    coalesce(cast(airspace.airspacevolume.upperlimit_value as varchar) || ' ' || airspace.airspacevolume.upperlimit_uom, '(' || airspace.airspacevolume.upperlimit_nilreason || ')') as upperlimit,
    coalesce(cast(airspace.airspacevolume.maximumlimit_value as varchar) || ' ' || airspace.airspacevolume.maximumlimit_uom, '(' || airspace.airspacevolume.maximumlimit_nilreason || ')') as maximumlimit,
    coalesce(cast(airspace.airspacevolume.lowerlimit_value as varchar) || ' ' || airspace.airspacevolume.lowerlimit_uom, '(' || airspace.airspacevolume.lowerlimit_nilreason || ')') as lowerlimit,
    coalesce(cast(airspace.airspacevolume.minimumlimit_value as varchar) || ' ' || airspace.airspacevolume.minimumlimit_uom, '(' || airspace.airspacevolume.minimumlimit_nilreason || ')') as minimumlimit,
    coalesce(cast(airspace.airspacevolume.width_value as varchar) || ' ' || airspace.airspacevolume.width_uom, '(' || airspace.airspacevolume.width_nilreason || ')') as width,
    geometry_surface_view_atdrur.geom AS geom,
    geometry_curve_view_azxcnn.geom AS geom,
    airspace_airspacevolumedependency_view_tsuoft.id AS contributorairspace,
    jsonb_agg(notes_note_view_lbeyxw.*) AS airspacevolume_annotation
from airspace.airspacevolume_pt 
inner join airspace.airspacevolume on airspace.airspacevolume_pt.airspacevolume_id = airspace.airspacevolume.id
left join geometry.surface_view geometry_surface_view_atdrur on airspace.airspacevolume.horizontalprojection_id = geometry_surface_view_atdrur.id
left join geometry.curve_view geometry_curve_view_azxcnn on airspace.airspacevolume.centreline_id = geometry_curve_view_azxcnn.id
left join airspace.airspacevolumedependency_view airspace_airspacevolumedependency_view_tsuoft on airspace.airspacevolume.contributorairspace_id = airspace_airspacevolumedependency_view_tsuoft.id
left join master_join master_join_gmakez on airspace.airspacevolume.id = master_join_gmakez.source_id
left join notes.note_view notes_note_view_lbeyxw on master_join_gmakez.target_id = notes_note_view_lbeyxw.id
group by
    airspace.airspacevolume_pt.id,
    airspace.airspacevolume_pt.nilreason,
    airspace.airspacevolume.upperlimitreference_value,
    airspace.airspacevolume.upperlimitreference_nilreason,
    airspace.airspacevolume.maximumlimitreference_value,
    airspace.airspacevolume.maximumlimitreference_nilreason,
    airspace.airspacevolume.lowerlimitreference_value,
    airspace.airspacevolume.lowerlimitreference_nilreason,
    airspace.airspacevolume.minimumlimitreference_value,
    airspace.airspacevolume.minimumlimitreference_nilreason,
    airspace.airspacevolume.upperlimit_value,
    airspace.airspacevolume.upperlimit_uom,
    airspace.airspacevolume.upperlimit_nilreason,
    airspace.airspacevolume.maximumlimit_value,
    airspace.airspacevolume.maximumlimit_uom,
    airspace.airspacevolume.maximumlimit_nilreason,
    airspace.airspacevolume.lowerlimit_value,
    airspace.airspacevolume.lowerlimit_uom,
    airspace.airspacevolume.lowerlimit_nilreason,
    airspace.airspacevolume.minimumlimit_value,
    airspace.airspacevolume.minimumlimit_uom,
    airspace.airspacevolume.minimumlimit_nilreason,
    airspace.airspacevolume.width_value,
    airspace.airspacevolume.width_uom,
    airspace.airspacevolume.width_nilreason,
    geometry_surface_view_atdrur.geom,
    geometry_curve_view_azxcnn.geom,
    airspace_airspacevolumedependency_view_tsuoft.id;
-- PointReferencePropertyType
-- ['geometry.surface_view', 'navaids_points.angleuse_view', 'notes.note_view']
create or replace view navaids_points.pointreference_view as
select
    navaids_points.pointreference_pt.id,
    navaids_points.pointreference_pt.nilreason AS pointreference_nilreason,
    coalesce(cast(navaids_points.pointreference.role_value as varchar), '(' || navaids_points.pointreference.role_nilreason || ')') as role,
    coalesce(cast(navaids_points.pointreference.priorfixtolerance_value as varchar) || ' ' || navaids_points.pointreference.priorfixtolerance_uom, '(' || navaids_points.pointreference.priorfixtolerance_nilreason || ')') as priorfixtolerance,
    coalesce(cast(navaids_points.pointreference.postfixtolerance_value as varchar) || ' ' || navaids_points.pointreference.postfixtolerance_uom, '(' || navaids_points.pointreference.postfixtolerance_nilreason || ')') as postfixtolerance,
    coalesce(cast(navaids_points_designatedpoint_pt_wspflg.title as varchar), '(' || navaids_points_designatedpoint_pt_wspflg.nilreason[1] || ')') AS point,
    navaids_points_designatedpoint_pt_wspflg.href AS point_href,
    geometry_surface_view_dfwxnc.geom AS geom,
    jsonb_agg(navaids_points_angleuse_view_kcokgw.id) AS facilityangle,
    jsonb_build_object('id', navaids_points_distanceindication_pt_kxeayw.id,
    'title', coalesce(cast(navaids_points_distanceindication_pt_kxeayw.title AS varchar), '(' || navaids_points_distanceindication_pt_kxeayw.nilreason[1] || ')'),
    'href', navaids_points_distanceindication_pt_kxeayw.href) AS facilitydistance,
    jsonb_agg(notes_note_view_wijsfk.*) AS pointreference_annotation
from navaids_points.pointreference_pt 
inner join navaids_points.pointreference on navaids_points.pointreference_pt.pointreference_id = navaids_points.pointreference.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_wspflg on navaids_points.pointreference.point_id = navaids_points_designatedpoint_pt_wspflg.id
left join geometry.surface_view geometry_surface_view_dfwxnc on navaids_points.pointreference.fixtolerancearea_id = geometry_surface_view_dfwxnc.id
left join master_join master_join_skzyls on navaids_points.pointreference.id = master_join_skzyls.source_id
left join navaids_points.angleuse_view navaids_points_angleuse_view_kcokgw on master_join_skzyls.target_id = navaids_points_angleuse_view_kcokgw.id
left join master_join master_join_lzrfib on navaids_points.pointreference.id = master_join_lzrfib.source_id
left join navaids_points.distanceindication_pt navaids_points_distanceindication_pt_kxeayw on master_join_lzrfib.target_id = navaids_points_distanceindication_pt_kxeayw.id
left join master_join master_join_xfonqu on navaids_points.pointreference.id = master_join_xfonqu.source_id
left join notes.note_view notes_note_view_wijsfk on master_join_xfonqu.target_id = notes_note_view_wijsfk.id
group by
    navaids_points.pointreference_pt.id,
    navaids_points.pointreference_pt.nilreason,
    navaids_points.pointreference.role_value,
    navaids_points.pointreference.role_nilreason,
    navaids_points.pointreference.priorfixtolerance_value,
    navaids_points.pointreference.priorfixtolerance_uom,
    navaids_points.pointreference.priorfixtolerance_nilreason,
    navaids_points.pointreference.postfixtolerance_value,
    navaids_points.pointreference.postfixtolerance_uom,
    navaids_points.pointreference.postfixtolerance_nilreason,
    navaids_points_designatedpoint_pt_wspflg.title,
    navaids_points_designatedpoint_pt_wspflg.nilreason[1],
    navaids_points_designatedpoint_pt_wspflg.href,
    geometry_surface_view_dfwxnc.geom;
-- AirportHeliportResponsibilityOrganisationPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view airport_heliport.airportheliportresponsibilityorganisation_view as
select
    airport_heliport.airportheliportresponsibilityorganisation_pt.id,
    airport_heliport.airportheliportresponsibilityorganisation_pt.nilreason AS airportheliportresponsibilityorganisation_nilreason,
    coalesce(cast(airport_heliport.airportheliportresponsibilityorganisation.role_value as varchar), '(' || airport_heliport.airportheliportresponsibilityorganisation.role_nilreason || ')') as role,
    coalesce(cast(organisation_organisationauthority_pt_ggggqs.title as varchar), '(' || organisation_organisationauthority_pt_ggggqs.nilreason[1] || ')') AS theorganisationauthority,
    organisation_organisationauthority_pt_ggggqs.href AS theorganisationauthority_href,
    jsonb_build_object('id', organisation_organisationauthority_pt_pamopw.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_pamopw.title AS varchar), '(' || organisation_organisationauthority_pt_pamopw.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_pamopw.href) AS specialdateauthority,
    jsonb_agg(notes_note_view_xwmsvy.*) AS airportheliportresponsibilityorganisation_annotation
from airport_heliport.airportheliportresponsibilityorganisation_pt 
inner join airport_heliport.airportheliportresponsibilityorganisation on airport_heliport.airportheliportresponsibilityorganisation_pt.airportheliportresponsibilityorganisation_id = airport_heliport.airportheliportresponsibilityorganisation.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_ggggqs on airport_heliport.airportheliportresponsibilityorganisation.theorganisationauthority_id = organisation_organisationauthority_pt_ggggqs.id
left join master_join master_join_aufbsf on airport_heliport.airportheliportresponsibilityorganisation.id = master_join_aufbsf.source_id
left join shared.timesheet_view shared_timesheet_view_fhgaeg on master_join_aufbsf.target_id = shared_timesheet_view_fhgaeg.id
left join master_join master_join_yaoaov on airport_heliport.airportheliportresponsibilityorganisation.id = master_join_yaoaov.source_id
left join notes.note_view notes_note_view_xwmsvy on master_join_yaoaov.target_id = notes_note_view_xwmsvy.id
left join master_join master_join_dmerxe on airport_heliport.airportheliportresponsibilityorganisation.id = master_join_dmerxe.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_pamopw on master_join_dmerxe.target_id = organisation_organisationauthority_pt_pamopw.id
group by
    airport_heliport.airportheliportresponsibilityorganisation_pt.id,
    airport_heliport.airportheliportresponsibilityorganisation_pt.nilreason,
    airport_heliport.airportheliportresponsibilityorganisation.role_value,
    airport_heliport.airportheliportresponsibilityorganisation.role_nilreason,
    organisation_organisationauthority_pt_ggggqs.title,
    organisation_organisationauthority_pt_ggggqs.nilreason[1],
    organisation_organisationauthority_pt_ggggqs.href;
-- AirspaceActivationPropertyType
-- ['shared.timesheet_view', 'notes.note_view', 'shared.airspacelayer_view', 'shared.aircraftcharacteristic_view']
create or replace view airspace.airspaceactivation_view as
select
    airspace.airspaceactivation_pt.id,
    airspace.airspaceactivation_pt.nilreason AS airspaceactivation_nilreason,
    coalesce(cast(airspace.airspaceactivation.activity_value as varchar), '(' || airspace.airspaceactivation.activity_nilreason || ')') as activity,
    coalesce(cast(airspace.airspaceactivation.status_value as varchar), '(' || airspace.airspaceactivation.status_nilreason || ')') as status,
    jsonb_agg(notes_note_view_oxyowh.*) AS airspaceactivation_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_lkqwmk.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_lkqwmk.title AS varchar), '(' || organisation_organisationauthority_pt_lkqwmk.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_lkqwmk.href) AS specialdateauthority,
    jsonb_build_object('id', organisation_organisationauthority_pt_vftviw.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_vftviw.title AS varchar), '(' || organisation_organisationauthority_pt_vftviw.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_vftviw.href) AS user,
    jsonb_agg(shared_airspacelayer_view_qxgezv.id) AS levels,
    jsonb_agg(shared_aircraftcharacteristic_view_jpqdhr.id) AS aircraft
from airspace.airspaceactivation_pt 
inner join airspace.airspaceactivation on airspace.airspaceactivation_pt.airspaceactivation_id = airspace.airspaceactivation.id
left join master_join master_join_tsscfb on airspace.airspaceactivation.id = master_join_tsscfb.source_id
left join shared.timesheet_view shared_timesheet_view_hyzkjf on master_join_tsscfb.target_id = shared_timesheet_view_hyzkjf.id
left join master_join master_join_vbpuoz on airspace.airspaceactivation.id = master_join_vbpuoz.source_id
left join notes.note_view notes_note_view_oxyowh on master_join_vbpuoz.target_id = notes_note_view_oxyowh.id
left join master_join master_join_bdrkpw on airspace.airspaceactivation.id = master_join_bdrkpw.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_lkqwmk on master_join_bdrkpw.target_id = organisation_organisationauthority_pt_lkqwmk.id
left join master_join master_join_smkmrv on airspace.airspaceactivation.id = master_join_smkmrv.source_id
left join shared.airspacelayer_view shared_airspacelayer_view_qxgezv on master_join_smkmrv.target_id = shared_airspacelayer_view_qxgezv.id
left join master_join master_join_sbysil on airspace.airspaceactivation.id = master_join_sbysil.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_vftviw on master_join_sbysil.target_id = organisation_organisationauthority_pt_vftviw.id
left join master_join master_join_kcjyst on airspace.airspaceactivation.id = master_join_kcjyst.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_jpqdhr on master_join_kcjyst.target_id = shared_aircraftcharacteristic_view_jpqdhr.id
group by
    airspace.airspaceactivation_pt.id,
    airspace.airspaceactivation_pt.nilreason,
    airspace.airspaceactivation.activity_value,
    airspace.airspaceactivation.activity_nilreason,
    airspace.airspaceactivation.status_value,
    airspace.airspaceactivation.status_nilreason;
-- AirspaceLayerClassPropertyType
-- ['shared.timesheet_view', 'notes.note_view', 'shared.airspacelayer_view']
create or replace view airspace.airspacelayerclass_view as
select
    airspace.airspacelayerclass_pt.id,
    airspace.airspacelayerclass_pt.nilreason AS airspacelayerclass_nilreason,
    coalesce(cast(airspace.airspacelayerclass.classification_value as varchar), '(' || airspace.airspacelayerclass.classification_nilreason || ')') as classification,
    jsonb_agg(notes_note_view_hoqnaf.*) AS airspacelayerclass_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_odkgog.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_odkgog.title AS varchar), '(' || organisation_organisationauthority_pt_odkgog.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_odkgog.href) AS specialdateauthority,
    jsonb_agg(shared_airspacelayer_view_ghseyy.id) AS associatedlevels
from airspace.airspacelayerclass_pt 
inner join airspace.airspacelayerclass on airspace.airspacelayerclass_pt.airspacelayerclass_id = airspace.airspacelayerclass.id
left join master_join master_join_sxswjn on airspace.airspacelayerclass.id = master_join_sxswjn.source_id
left join shared.timesheet_view shared_timesheet_view_stuuvn on master_join_sxswjn.target_id = shared_timesheet_view_stuuvn.id
left join master_join master_join_ghibqq on airspace.airspacelayerclass.id = master_join_ghibqq.source_id
left join notes.note_view notes_note_view_hoqnaf on master_join_ghibqq.target_id = notes_note_view_hoqnaf.id
left join master_join master_join_eccwoj on airspace.airspacelayerclass.id = master_join_eccwoj.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_odkgog on master_join_eccwoj.target_id = organisation_organisationauthority_pt_odkgog.id
left join master_join master_join_ibhdqc on airspace.airspacelayerclass.id = master_join_ibhdqc.source_id
left join shared.airspacelayer_view shared_airspacelayer_view_ghseyy on master_join_ibhdqc.target_id = shared_airspacelayer_view_ghseyy.id
group by
    airspace.airspacelayerclass_pt.id,
    airspace.airspacelayerclass_pt.nilreason,
    airspace.airspacelayerclass.classification_value,
    airspace.airspacelayerclass.classification_nilreason;
-- AltimeterSourceStatusPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view airport_heliport.altimetersourcestatus_view as
select
    airport_heliport.altimetersourcestatus_pt.id,
    airport_heliport.altimetersourcestatus_pt.nilreason AS altimetersourcestatus_nilreason,
    coalesce(cast(airport_heliport.altimetersourcestatus.operationalstatus_value as varchar), '(' || airport_heliport.altimetersourcestatus.operationalstatus_nilreason || ')') as operationalstatus,
    jsonb_agg(notes_note_view_umbzjy.*) AS altimetersourcestatus_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_yytevc.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_yytevc.title AS varchar), '(' || organisation_organisationauthority_pt_yytevc.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_yytevc.href) AS specialdateauthority
from airport_heliport.altimetersourcestatus_pt 
inner join airport_heliport.altimetersourcestatus on airport_heliport.altimetersourcestatus_pt.altimetersourcestatus_id = airport_heliport.altimetersourcestatus.id
left join master_join master_join_xryhey on airport_heliport.altimetersourcestatus.id = master_join_xryhey.source_id
left join shared.timesheet_view shared_timesheet_view_jczxrw on master_join_xryhey.target_id = shared_timesheet_view_jczxrw.id
left join master_join master_join_jjavmi on airport_heliport.altimetersourcestatus.id = master_join_jjavmi.source_id
left join notes.note_view notes_note_view_umbzjy on master_join_jjavmi.target_id = notes_note_view_umbzjy.id
left join master_join master_join_ghfcca on airport_heliport.altimetersourcestatus.id = master_join_ghfcca.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_yytevc on master_join_ghfcca.target_id = organisation_organisationauthority_pt_yytevc.id
group by
    airport_heliport.altimetersourcestatus_pt.id,
    airport_heliport.altimetersourcestatus_pt.nilreason,
    airport_heliport.altimetersourcestatus.operationalstatus_value,
    airport_heliport.altimetersourcestatus.operationalstatus_nilreason;
-- CirclingRestrictionPropertyType
-- ['geometry.surface_view', 'shared.timesheet_view', 'notes.note_view', 'shared.circlesector_view']
create or replace view procedure.circlingrestriction_view as
select
    procedure.circlingrestriction_pt.id,
    procedure.circlingrestriction_pt.nilreason AS circlingrestriction_nilreason,
    shared_circlesector_view_usydfg.id AS sectordescription,
    geometry_surface_view_zsfqzx.geom AS geom,
    jsonb_agg(notes_note_view_hbfhud.*) AS circlingrestriction_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_uhmbst.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_uhmbst.title AS varchar), '(' || organisation_organisationauthority_pt_uhmbst.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_uhmbst.href) AS specialdateauthority
from procedure.circlingrestriction_pt 
inner join procedure.circlingrestriction on procedure.circlingrestriction_pt.circlingrestriction_id = procedure.circlingrestriction.id
left join shared.circlesector_view shared_circlesector_view_usydfg on procedure.circlingrestriction.sectordescription_id = shared_circlesector_view_usydfg.id
left join geometry.surface_view geometry_surface_view_zsfqzx on procedure.circlingrestriction.restrictionarea_id = geometry_surface_view_zsfqzx.id
left join master_join master_join_ghffhq on procedure.circlingrestriction.id = master_join_ghffhq.source_id
left join shared.timesheet_view shared_timesheet_view_munfze on master_join_ghffhq.target_id = shared_timesheet_view_munfze.id
left join master_join master_join_sauamh on procedure.circlingrestriction.id = master_join_sauamh.source_id
left join notes.note_view notes_note_view_hbfhud on master_join_sauamh.target_id = notes_note_view_hbfhud.id
left join master_join master_join_chchds on procedure.circlingrestriction.id = master_join_chchds.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_uhmbst on master_join_chchds.target_id = organisation_organisationauthority_pt_uhmbst.id
group by
    procedure.circlingrestriction_pt.id,
    procedure.circlingrestriction_pt.nilreason,
    shared_circlesector_view_usydfg.id,
    geometry_surface_view_zsfqzx.geom;
-- GroundLightingAvailabilityPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view airport_heliport.groundlightingavailability_view as
select
    airport_heliport.groundlightingavailability_pt.id,
    airport_heliport.groundlightingavailability_pt.nilreason AS groundlightingavailability_nilreason,
    coalesce(cast(airport_heliport.groundlightingavailability.operationalstatus_value as varchar), '(' || airport_heliport.groundlightingavailability.operationalstatus_nilreason || ')') as operationalstatus,
    jsonb_agg(notes_note_view_uozwvr.*) AS groundlightingavailability_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_hacsyh.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_hacsyh.title AS varchar), '(' || organisation_organisationauthority_pt_hacsyh.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_hacsyh.href) AS specialdateauthority
from airport_heliport.groundlightingavailability_pt 
inner join airport_heliport.groundlightingavailability on airport_heliport.groundlightingavailability_pt.groundlightingavailability_id = airport_heliport.groundlightingavailability.id
left join master_join master_join_oyyypo on airport_heliport.groundlightingavailability.id = master_join_oyyypo.source_id
left join shared.timesheet_view shared_timesheet_view_lyqedj on master_join_oyyypo.target_id = shared_timesheet_view_lyqedj.id
left join master_join master_join_mgmuil on airport_heliport.groundlightingavailability.id = master_join_mgmuil.source_id
left join notes.note_view notes_note_view_uozwvr on master_join_mgmuil.target_id = notes_note_view_uozwvr.id
left join master_join master_join_fchlkf on airport_heliport.groundlightingavailability.id = master_join_fchlkf.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_hacsyh on master_join_fchlkf.target_id = organisation_organisationauthority_pt_hacsyh.id
group by
    airport_heliport.groundlightingavailability_pt.id,
    airport_heliport.groundlightingavailability_pt.nilreason,
    airport_heliport.groundlightingavailability.operationalstatus_value,
    airport_heliport.groundlightingavailability.operationalstatus_nilreason;
-- LightElementStatusPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view shared.lightelementstatus_view as
select
    shared.lightelementstatus_pt.id,
    shared.lightelementstatus_pt.nilreason AS lightelementstatus_nilreason,
    coalesce(cast(shared.lightelementstatus.status_value as varchar), '(' || shared.lightelementstatus.status_nilreason || ')') as status,
    jsonb_agg(notes_note_view_nytzth.*) AS lightelementstatus_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_rvayul.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_rvayul.title AS varchar), '(' || organisation_organisationauthority_pt_rvayul.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_rvayul.href) AS specialdateauthority
from shared.lightelementstatus_pt 
inner join shared.lightelementstatus on shared.lightelementstatus_pt.lightelementstatus_id = shared.lightelementstatus.id
left join master_join master_join_brygmf on shared.lightelementstatus.id = master_join_brygmf.source_id
left join shared.timesheet_view shared_timesheet_view_zjtgus on master_join_brygmf.target_id = shared_timesheet_view_zjtgus.id
left join master_join master_join_vjplih on shared.lightelementstatus.id = master_join_vjplih.source_id
left join notes.note_view notes_note_view_nytzth on master_join_vjplih.target_id = notes_note_view_nytzth.id
left join master_join master_join_ikkuqn on shared.lightelementstatus.id = master_join_ikkuqn.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_rvayul on master_join_ikkuqn.target_id = organisation_organisationauthority_pt_rvayul.id
group by
    shared.lightelementstatus_pt.id,
    shared.lightelementstatus_pt.nilreason,
    shared.lightelementstatus.status_value,
    shared.lightelementstatus.status_nilreason;
-- NavaidEquipmentMonitoringPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view navaids_points.navaidequipmentmonitoring_view as
select
    navaids_points.navaidequipmentmonitoring_pt.id,
    navaids_points.navaidequipmentmonitoring_pt.nilreason AS navaidequipmentmonitoring_nilreason,
    coalesce(cast(navaids_points.navaidequipmentmonitoring.monitored_value as varchar), '(' || navaids_points.navaidequipmentmonitoring.monitored_nilreason || ')') as monitored,
    jsonb_agg(notes_note_view_ygqrjc.*) AS navaidequipmentmonitoring_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_quovfm.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_quovfm.title AS varchar), '(' || organisation_organisationauthority_pt_quovfm.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_quovfm.href) AS specialdateauthority
from navaids_points.navaidequipmentmonitoring_pt 
inner join navaids_points.navaidequipmentmonitoring on navaids_points.navaidequipmentmonitoring_pt.navaidequipmentmonitoring_id = navaids_points.navaidequipmentmonitoring.id
left join master_join master_join_nwkafi on navaids_points.navaidequipmentmonitoring.id = master_join_nwkafi.source_id
left join shared.timesheet_view shared_timesheet_view_fvbkku on master_join_nwkafi.target_id = shared_timesheet_view_fvbkku.id
left join master_join master_join_ufpbuu on navaids_points.navaidequipmentmonitoring.id = master_join_ufpbuu.source_id
left join notes.note_view notes_note_view_ygqrjc on master_join_ufpbuu.target_id = notes_note_view_ygqrjc.id
left join master_join master_join_qntasu on navaids_points.navaidequipmentmonitoring.id = master_join_qntasu.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_quovfm on master_join_qntasu.target_id = organisation_organisationauthority_pt_quovfm.id
group by
    navaids_points.navaidequipmentmonitoring_pt.id,
    navaids_points.navaidequipmentmonitoring_pt.nilreason,
    navaids_points.navaidequipmentmonitoring.monitored_value,
    navaids_points.navaidequipmentmonitoring.monitored_nilreason;
-- NavaidOperationalStatusPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view navaids_points.navaidoperationalstatus_view as
select
    navaids_points.navaidoperationalstatus_pt.id,
    navaids_points.navaidoperationalstatus_pt.nilreason AS navaidoperationalstatus_nilreason,
    coalesce(cast(navaids_points.navaidoperationalstatus.operationalstatus_value as varchar), '(' || navaids_points.navaidoperationalstatus.operationalstatus_nilreason || ')') as operationalstatus,
    coalesce(cast(navaids_points.navaidoperationalstatus.signaltype_value as varchar), '(' || navaids_points.navaidoperationalstatus.signaltype_nilreason || ')') as signaltype,
    jsonb_agg(notes_note_view_nbygnr.*) AS navaidoperationalstatus_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_vdmvue.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_vdmvue.title AS varchar), '(' || organisation_organisationauthority_pt_vdmvue.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_vdmvue.href) AS specialdateauthority
from navaids_points.navaidoperationalstatus_pt 
inner join navaids_points.navaidoperationalstatus on navaids_points.navaidoperationalstatus_pt.navaidoperationalstatus_id = navaids_points.navaidoperationalstatus.id
left join master_join master_join_gclfbw on navaids_points.navaidoperationalstatus.id = master_join_gclfbw.source_id
left join shared.timesheet_view shared_timesheet_view_iwsodn on master_join_gclfbw.target_id = shared_timesheet_view_iwsodn.id
left join master_join master_join_cocojh on navaids_points.navaidoperationalstatus.id = master_join_cocojh.source_id
left join notes.note_view notes_note_view_nbygnr on master_join_cocojh.target_id = notes_note_view_nbygnr.id
left join master_join master_join_clcbzb on navaids_points.navaidoperationalstatus.id = master_join_clcbzb.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_vdmvue on master_join_clcbzb.target_id = organisation_organisationauthority_pt_vdmvue.id
group by
    navaids_points.navaidoperationalstatus_pt.id,
    navaids_points.navaidoperationalstatus_pt.nilreason,
    navaids_points.navaidoperationalstatus.operationalstatus_value,
    navaids_points.navaidoperationalstatus.operationalstatus_nilreason,
    navaids_points.navaidoperationalstatus.signaltype_value,
    navaids_points.navaidoperationalstatus.signaltype_nilreason;
-- OnlineContactPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view shared.onlinecontact_view as
select
    shared.onlinecontact_pt.id,
    shared.onlinecontact_pt.nilreason AS onlinecontact_nilreason,
    coalesce(cast(shared.onlinecontact.network_value as varchar), '(' || shared.onlinecontact.network_nilreason || ')') as network,
    coalesce(cast(shared.onlinecontact.linkage_value as varchar), '(' || shared.onlinecontact.linkage_nilreason || ')') as linkage,
    coalesce(cast(shared.onlinecontact.protocol_value as varchar), '(' || shared.onlinecontact.protocol_nilreason || ')') as protocol,
    coalesce(cast(shared.onlinecontact.email_value as varchar), '(' || shared.onlinecontact.email_nilreason || ')') as email,
    jsonb_agg(notes_note_view_dtxvnu.*) AS onlinecontact_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_lpxljx.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_lpxljx.title AS varchar), '(' || organisation_organisationauthority_pt_lpxljx.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_lpxljx.href) AS specialdateauthority
from shared.onlinecontact_pt 
inner join shared.onlinecontact on shared.onlinecontact_pt.onlinecontact_id = shared.onlinecontact.id
left join master_join master_join_majovq on shared.onlinecontact.id = master_join_majovq.source_id
left join shared.timesheet_view shared_timesheet_view_nmhpth on master_join_majovq.target_id = shared_timesheet_view_nmhpth.id
left join master_join master_join_kmseyb on shared.onlinecontact.id = master_join_kmseyb.source_id
left join notes.note_view notes_note_view_dtxvnu on master_join_kmseyb.target_id = notes_note_view_dtxvnu.id
left join master_join master_join_dlnrnz on shared.onlinecontact.id = master_join_dlnrnz.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_lpxljx on master_join_dlnrnz.target_id = organisation_organisationauthority_pt_lpxljx.id
group by
    shared.onlinecontact_pt.id,
    shared.onlinecontact_pt.nilreason,
    shared.onlinecontact.network_value,
    shared.onlinecontact.network_nilreason,
    shared.onlinecontact.linkage_value,
    shared.onlinecontact.linkage_nilreason,
    shared.onlinecontact.protocol_value,
    shared.onlinecontact.protocol_nilreason,
    shared.onlinecontact.email_value,
    shared.onlinecontact.email_nilreason;
-- PostalAddressPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view shared.postaladdress_view as
select
    shared.postaladdress_pt.id,
    shared.postaladdress_pt.nilreason AS postaladdress_nilreason,
    coalesce(cast(shared.postaladdress.deliverypoint_value as varchar), '(' || shared.postaladdress.deliverypoint_nilreason || ')') as deliverypoint,
    coalesce(cast(shared.postaladdress.city_value as varchar), '(' || shared.postaladdress.city_nilreason || ')') as city,
    coalesce(cast(shared.postaladdress.administrativearea_value as varchar), '(' || shared.postaladdress.administrativearea_nilreason || ')') as administrativearea,
    coalesce(cast(shared.postaladdress.postalcode_value as varchar), '(' || shared.postaladdress.postalcode_nilreason || ')') as postalcode,
    coalesce(cast(shared.postaladdress.country_value as varchar), '(' || shared.postaladdress.country_nilreason || ')') as country,
    jsonb_agg(notes_note_view_aclgyw.*) AS postaladdress_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_szlaxf.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_szlaxf.title AS varchar), '(' || organisation_organisationauthority_pt_szlaxf.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_szlaxf.href) AS specialdateauthority
from shared.postaladdress_pt 
inner join shared.postaladdress on shared.postaladdress_pt.postaladdress_id = shared.postaladdress.id
left join master_join master_join_lywxmv on shared.postaladdress.id = master_join_lywxmv.source_id
left join shared.timesheet_view shared_timesheet_view_unurug on master_join_lywxmv.target_id = shared_timesheet_view_unurug.id
left join master_join master_join_zunoad on shared.postaladdress.id = master_join_zunoad.source_id
left join notes.note_view notes_note_view_aclgyw on master_join_zunoad.target_id = notes_note_view_aclgyw.id
left join master_join master_join_mxwkcy on shared.postaladdress.id = master_join_mxwkcy.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_szlaxf on master_join_mxwkcy.target_id = organisation_organisationauthority_pt_szlaxf.id
group by
    shared.postaladdress_pt.id,
    shared.postaladdress_pt.nilreason,
    shared.postaladdress.deliverypoint_value,
    shared.postaladdress.deliverypoint_nilreason,
    shared.postaladdress.city_value,
    shared.postaladdress.city_nilreason,
    shared.postaladdress.administrativearea_value,
    shared.postaladdress.administrativearea_nilreason,
    shared.postaladdress.postalcode_value,
    shared.postaladdress.postalcode_nilreason,
    shared.postaladdress.country_value,
    shared.postaladdress.country_nilreason;
-- ProcedureAvailabilityPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view procedure.procedureavailability_view as
select
    procedure.procedureavailability_pt.id,
    procedure.procedureavailability_pt.nilreason AS procedureavailability_nilreason,
    coalesce(cast(procedure.procedureavailability.status_value as varchar), '(' || procedure.procedureavailability.status_nilreason || ')') as status,
    jsonb_agg(notes_note_view_lwicji.*) AS procedureavailability_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_swgedo.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_swgedo.title AS varchar), '(' || organisation_organisationauthority_pt_swgedo.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_swgedo.href) AS specialdateauthority
from procedure.procedureavailability_pt 
inner join procedure.procedureavailability on procedure.procedureavailability_pt.procedureavailability_id = procedure.procedureavailability.id
left join master_join master_join_xoqdiw on procedure.procedureavailability.id = master_join_xoqdiw.source_id
left join shared.timesheet_view shared_timesheet_view_ivlwrf on master_join_xoqdiw.target_id = shared_timesheet_view_ivlwrf.id
left join master_join master_join_lztduk on procedure.procedureavailability.id = master_join_lztduk.source_id
left join notes.note_view notes_note_view_lwicji on master_join_lztduk.target_id = notes_note_view_lwicji.id
left join master_join master_join_qrfupw on procedure.procedureavailability.id = master_join_qrfupw.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_swgedo on master_join_qrfupw.target_id = organisation_organisationauthority_pt_swgedo.id
group by
    procedure.procedureavailability_pt.id,
    procedure.procedureavailability_pt.nilreason,
    procedure.procedureavailability.status_value,
    procedure.procedureavailability.status_nilreason;
-- RadioCommunicationOperationalStatusPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view service.radiocommunicationoperationalstatus_view as
select
    service.radiocommunicationoperationalstatus_pt.id,
    service.radiocommunicationoperationalstatus_pt.nilreason AS radiocommunicationoperationalstatus_nilreason,
    coalesce(cast(service.radiocommunicationoperationalstatus.operationalstatus_value as varchar), '(' || service.radiocommunicationoperationalstatus.operationalstatus_nilreason || ')') as operationalstatus,
    jsonb_agg(notes_note_view_uulpmc.*) AS radiocommunicationoperationalstatus_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_dwelkt.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_dwelkt.title AS varchar), '(' || organisation_organisationauthority_pt_dwelkt.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_dwelkt.href) AS specialdateauthority
from service.radiocommunicationoperationalstatus_pt 
inner join service.radiocommunicationoperationalstatus on service.radiocommunicationoperationalstatus_pt.radiocommunicationoperationalstatus_id = service.radiocommunicationoperationalstatus.id
left join master_join master_join_ovqthv on service.radiocommunicationoperationalstatus.id = master_join_ovqthv.source_id
left join shared.timesheet_view shared_timesheet_view_daiidk on master_join_ovqthv.target_id = shared_timesheet_view_daiidk.id
left join master_join master_join_dpwyow on service.radiocommunicationoperationalstatus.id = master_join_dpwyow.source_id
left join notes.note_view notes_note_view_uulpmc on master_join_dpwyow.target_id = notes_note_view_uulpmc.id
left join master_join master_join_afnirv on service.radiocommunicationoperationalstatus.id = master_join_afnirv.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_dwelkt on master_join_afnirv.target_id = organisation_organisationauthority_pt_dwelkt.id
group by
    service.radiocommunicationoperationalstatus_pt.id,
    service.radiocommunicationoperationalstatus_pt.nilreason,
    service.radiocommunicationoperationalstatus.operationalstatus_value,
    service.radiocommunicationoperationalstatus.operationalstatus_nilreason;
-- RouteAvailabilityPropertyType
-- ['shared.timesheet_view', 'notes.note_view', 'shared.airspacelayer_view']
create or replace view routes.routeavailability_view as
select
    routes.routeavailability_pt.id,
    routes.routeavailability_pt.nilreason AS routeavailability_nilreason,
    coalesce(cast(routes.routeavailability.direction_value as varchar), '(' || routes.routeavailability.direction_nilreason || ')') as direction,
    coalesce(cast(routes.routeavailability.cardinaldirection_value as varchar), '(' || routes.routeavailability.cardinaldirection_nilreason || ')') as cardinaldirection,
    coalesce(cast(routes.routeavailability.status_value as varchar), '(' || routes.routeavailability.status_nilreason || ')') as status,
    jsonb_agg(notes_note_view_cqohro.*) AS routeavailability_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_pidstc.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_pidstc.title AS varchar), '(' || organisation_organisationauthority_pt_pidstc.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_pidstc.href) AS specialdateauthority,
    jsonb_agg(shared_airspacelayer_view_otouwp.id) AS levels
from routes.routeavailability_pt 
inner join routes.routeavailability on routes.routeavailability_pt.routeavailability_id = routes.routeavailability.id
left join master_join master_join_osgwgt on routes.routeavailability.id = master_join_osgwgt.source_id
left join shared.timesheet_view shared_timesheet_view_ykmaux on master_join_osgwgt.target_id = shared_timesheet_view_ykmaux.id
left join master_join master_join_tmzqfe on routes.routeavailability.id = master_join_tmzqfe.source_id
left join notes.note_view notes_note_view_cqohro on master_join_tmzqfe.target_id = notes_note_view_cqohro.id
left join master_join master_join_kvmzui on routes.routeavailability.id = master_join_kvmzui.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_pidstc on master_join_kvmzui.target_id = organisation_organisationauthority_pt_pidstc.id
left join master_join master_join_jawpnt on routes.routeavailability.id = master_join_jawpnt.source_id
left join shared.airspacelayer_view shared_airspacelayer_view_otouwp on master_join_jawpnt.target_id = shared_airspacelayer_view_otouwp.id
group by
    routes.routeavailability_pt.id,
    routes.routeavailability_pt.nilreason,
    routes.routeavailability.direction_value,
    routes.routeavailability.direction_nilreason,
    routes.routeavailability.cardinaldirection_value,
    routes.routeavailability.cardinaldirection_nilreason,
    routes.routeavailability.status_value,
    routes.routeavailability.status_nilreason;
-- RunwayDeclaredDistanceValuePropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view airport_heliport.runwaydeclareddistancevalue_view as
select
    airport_heliport.runwaydeclareddistancevalue_pt.id,
    airport_heliport.runwaydeclareddistancevalue_pt.nilreason AS runwaydeclareddistancevalue_nilreason,
    coalesce(cast(airport_heliport.runwaydeclareddistancevalue.distance_value as varchar) || ' ' || airport_heliport.runwaydeclareddistancevalue.distance_uom, '(' || airport_heliport.runwaydeclareddistancevalue.distance_nilreason || ')') as distance,
    coalesce(cast(airport_heliport.runwaydeclareddistancevalue.distanceaccuracy_value as varchar) || ' ' || airport_heliport.runwaydeclareddistancevalue.distanceaccuracy_uom, '(' || airport_heliport.runwaydeclareddistancevalue.distanceaccuracy_nilreason || ')') as distanceaccuracy,
    jsonb_agg(notes_note_view_akkkqt.*) AS runwaydeclareddistancevalue_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_phiouk.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_phiouk.title AS varchar), '(' || organisation_organisationauthority_pt_phiouk.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_phiouk.href) AS specialdateauthority
from airport_heliport.runwaydeclareddistancevalue_pt 
inner join airport_heliport.runwaydeclareddistancevalue on airport_heliport.runwaydeclareddistancevalue_pt.runwaydeclareddistancevalue_id = airport_heliport.runwaydeclareddistancevalue.id
left join master_join master_join_plyqnd on airport_heliport.runwaydeclareddistancevalue.id = master_join_plyqnd.source_id
left join shared.timesheet_view shared_timesheet_view_lvmggf on master_join_plyqnd.target_id = shared_timesheet_view_lvmggf.id
left join master_join master_join_icqsnq on airport_heliport.runwaydeclareddistancevalue.id = master_join_icqsnq.source_id
left join notes.note_view notes_note_view_akkkqt on master_join_icqsnq.target_id = notes_note_view_akkkqt.id
left join master_join master_join_xlzxgh on airport_heliport.runwaydeclareddistancevalue.id = master_join_xlzxgh.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_phiouk on master_join_xlzxgh.target_id = organisation_organisationauthority_pt_phiouk.id
group by
    airport_heliport.runwaydeclareddistancevalue_pt.id,
    airport_heliport.runwaydeclareddistancevalue_pt.nilreason,
    airport_heliport.runwaydeclareddistancevalue.distance_value,
    airport_heliport.runwaydeclareddistancevalue.distance_uom,
    airport_heliport.runwaydeclareddistancevalue.distance_nilreason,
    airport_heliport.runwaydeclareddistancevalue.distanceaccuracy_value,
    airport_heliport.runwaydeclareddistancevalue.distanceaccuracy_uom,
    airport_heliport.runwaydeclareddistancevalue.distanceaccuracy_nilreason;
-- ServiceOperationalStatusPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view service.serviceoperationalstatus_view as
select
    service.serviceoperationalstatus_pt.id,
    service.serviceoperationalstatus_pt.nilreason AS serviceoperationalstatus_nilreason,
    coalesce(cast(service.serviceoperationalstatus.operationalstatus_value as varchar), '(' || service.serviceoperationalstatus.operationalstatus_nilreason || ')') as operationalstatus,
    jsonb_agg(notes_note_view_oemsbm.*) AS serviceoperationalstatus_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_fyuymn.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_fyuymn.title AS varchar), '(' || organisation_organisationauthority_pt_fyuymn.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_fyuymn.href) AS specialdateauthority
from service.serviceoperationalstatus_pt 
inner join service.serviceoperationalstatus on service.serviceoperationalstatus_pt.serviceoperationalstatus_id = service.serviceoperationalstatus.id
left join master_join master_join_hkyxoe on service.serviceoperationalstatus.id = master_join_hkyxoe.source_id
left join shared.timesheet_view shared_timesheet_view_vhwjok on master_join_hkyxoe.target_id = shared_timesheet_view_vhwjok.id
left join master_join master_join_kfyrlm on service.serviceoperationalstatus.id = master_join_kfyrlm.source_id
left join notes.note_view notes_note_view_oemsbm on master_join_kfyrlm.target_id = notes_note_view_oemsbm.id
left join master_join master_join_parjjn on service.serviceoperationalstatus.id = master_join_parjjn.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_fyuymn on master_join_parjjn.target_id = organisation_organisationauthority_pt_fyuymn.id
group by
    service.serviceoperationalstatus_pt.id,
    service.serviceoperationalstatus_pt.nilreason,
    service.serviceoperationalstatus.operationalstatus_value,
    service.serviceoperationalstatus.operationalstatus_nilreason;
-- SpecialNavigationStationStatusPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view navaids_points.specialnavigationstationstatus_view as
select
    navaids_points.specialnavigationstationstatus_pt.id,
    navaids_points.specialnavigationstationstatus_pt.nilreason AS specialnavigationstationstatus_nilreason,
    coalesce(cast(navaids_points.specialnavigationstationstatus.operationalstatus_value as varchar), '(' || navaids_points.specialnavigationstationstatus.operationalstatus_nilreason || ')') as operationalstatus,
    jsonb_agg(notes_note_view_pdygdn.*) AS specialnavigationstationstatus_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_dtadgh.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_dtadgh.title AS varchar), '(' || organisation_organisationauthority_pt_dtadgh.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_dtadgh.href) AS specialdateauthority
from navaids_points.specialnavigationstationstatus_pt 
inner join navaids_points.specialnavigationstationstatus on navaids_points.specialnavigationstationstatus_pt.specialnavigationstationstatus_id = navaids_points.specialnavigationstationstatus.id
left join master_join master_join_caztvd on navaids_points.specialnavigationstationstatus.id = master_join_caztvd.source_id
left join shared.timesheet_view shared_timesheet_view_xbcqfb on master_join_caztvd.target_id = shared_timesheet_view_xbcqfb.id
left join master_join master_join_tzjupd on navaids_points.specialnavigationstationstatus.id = master_join_tzjupd.source_id
left join notes.note_view notes_note_view_pdygdn on master_join_tzjupd.target_id = notes_note_view_pdygdn.id
left join master_join master_join_rpiald on navaids_points.specialnavigationstationstatus.id = master_join_rpiald.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_dtadgh on master_join_rpiald.target_id = organisation_organisationauthority_pt_dtadgh.id
group by
    navaids_points.specialnavigationstationstatus_pt.id,
    navaids_points.specialnavigationstationstatus_pt.nilreason,
    navaids_points.specialnavigationstationstatus.operationalstatus_value,
    navaids_points.specialnavigationstationstatus.operationalstatus_nilreason;
-- TelephoneContactPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view shared.telephonecontact_view as
select
    shared.telephonecontact_pt.id,
    shared.telephonecontact_pt.nilreason AS telephonecontact_nilreason,
    coalesce(cast(shared.telephonecontact.voice_value as varchar), '(' || shared.telephonecontact.voice_nilreason || ')') as voice,
    coalesce(cast(shared.telephonecontact.facsimile_value as varchar), '(' || shared.telephonecontact.facsimile_nilreason || ')') as facsimile,
    jsonb_agg(notes_note_view_uymfae.*) AS telephonecontact_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_qycpfl.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_qycpfl.title AS varchar), '(' || organisation_organisationauthority_pt_qycpfl.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_qycpfl.href) AS specialdateauthority
from shared.telephonecontact_pt 
inner join shared.telephonecontact on shared.telephonecontact_pt.telephonecontact_id = shared.telephonecontact.id
left join master_join master_join_qjmtzi on shared.telephonecontact.id = master_join_qjmtzi.source_id
left join shared.timesheet_view shared_timesheet_view_otbpis on master_join_qjmtzi.target_id = shared_timesheet_view_otbpis.id
left join master_join master_join_shunku on shared.telephonecontact.id = master_join_shunku.source_id
left join notes.note_view notes_note_view_uymfae on master_join_shunku.target_id = notes_note_view_uymfae.id
left join master_join master_join_nikqpg on shared.telephonecontact.id = master_join_nikqpg.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_qycpfl on master_join_nikqpg.target_id = organisation_organisationauthority_pt_qycpfl.id
group by
    shared.telephonecontact_pt.id,
    shared.telephonecontact_pt.nilreason,
    shared.telephonecontact.voice_value,
    shared.telephonecontact.voice_nilreason,
    shared.telephonecontact.facsimile_value,
    shared.telephonecontact.facsimile_nilreason;
-- UnitAvailabilityPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view organisation.unitavailability_view as
select
    organisation.unitavailability_pt.id,
    organisation.unitavailability_pt.nilreason AS unitavailability_nilreason,
    coalesce(cast(organisation.unitavailability.operationalstatus_value as varchar), '(' || organisation.unitavailability.operationalstatus_nilreason || ')') as operationalstatus,
    jsonb_agg(notes_note_view_rstqxr.*) AS unitavailability_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_abuxwj.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_abuxwj.title AS varchar), '(' || organisation_organisationauthority_pt_abuxwj.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_abuxwj.href) AS specialdateauthority
from organisation.unitavailability_pt 
inner join organisation.unitavailability on organisation.unitavailability_pt.unitavailability_id = organisation.unitavailability.id
left join master_join master_join_xsnyre on organisation.unitavailability.id = master_join_xsnyre.source_id
left join shared.timesheet_view shared_timesheet_view_algrxk on master_join_xsnyre.target_id = shared_timesheet_view_algrxk.id
left join master_join master_join_xajkqi on organisation.unitavailability.id = master_join_xajkqi.source_id
left join notes.note_view notes_note_view_rstqxr on master_join_xajkqi.target_id = notes_note_view_rstqxr.id
left join master_join master_join_azooyi on organisation.unitavailability.id = master_join_azooyi.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_abuxwj on master_join_azooyi.target_id = organisation_organisationauthority_pt_abuxwj.id
group by
    organisation.unitavailability_pt.id,
    organisation.unitavailability_pt.nilreason,
    organisation.unitavailability.operationalstatus_value,
    organisation.unitavailability.operationalstatus_nilreason;
-- VerticalStructureLightingStatusPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view obstacles.verticalstructurelightingstatus_view as
select
    obstacles.verticalstructurelightingstatus_pt.id,
    obstacles.verticalstructurelightingstatus_pt.nilreason AS verticalstructurelightingstatus_nilreason,
    coalesce(cast(obstacles.verticalstructurelightingstatus.status_value as varchar), '(' || obstacles.verticalstructurelightingstatus.status_nilreason || ')') as status,
    jsonb_agg(notes_note_view_pcsybr.*) AS verticalstructurelightingstatus_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_pfcopa.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_pfcopa.title AS varchar), '(' || organisation_organisationauthority_pt_pfcopa.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_pfcopa.href) AS specialdateauthority
from obstacles.verticalstructurelightingstatus_pt 
inner join obstacles.verticalstructurelightingstatus on obstacles.verticalstructurelightingstatus_pt.verticalstructurelightingstatus_id = obstacles.verticalstructurelightingstatus.id
left join master_join master_join_iyeeeb on obstacles.verticalstructurelightingstatus.id = master_join_iyeeeb.source_id
left join shared.timesheet_view shared_timesheet_view_rhveif on master_join_iyeeeb.target_id = shared_timesheet_view_rhveif.id
left join master_join master_join_qrcrun on obstacles.verticalstructurelightingstatus.id = master_join_qrcrun.source_id
left join notes.note_view notes_note_view_pcsybr on master_join_qrcrun.target_id = notes_note_view_pcsybr.id
left join master_join master_join_slehru on obstacles.verticalstructurelightingstatus.id = master_join_slehru.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_pfcopa on master_join_slehru.target_id = organisation_organisationauthority_pt_pfcopa.id
group by
    obstacles.verticalstructurelightingstatus_pt.id,
    obstacles.verticalstructurelightingstatus_pt.nilreason,
    obstacles.verticalstructurelightingstatus.status_value,
    obstacles.verticalstructurelightingstatus.status_nilreason;
-- WorkareaActivityPropertyType
-- ['shared.timesheet_view', 'notes.note_view']
create or replace view airport_heliport.workareaactivity_view as
select
    airport_heliport.workareaactivity_pt.id,
    airport_heliport.workareaactivity_pt.nilreason AS workareaactivity_nilreason,
    coalesce(cast(airport_heliport.workareaactivity.isactive_value as varchar), '(' || airport_heliport.workareaactivity.isactive_nilreason || ')') as isactive,
    jsonb_agg(notes_note_view_fmyhwk.*) AS workareaactivity_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_fsnvgw.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_fsnvgw.title AS varchar), '(' || organisation_organisationauthority_pt_fsnvgw.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_fsnvgw.href) AS specialdateauthority
from airport_heliport.workareaactivity_pt 
inner join airport_heliport.workareaactivity on airport_heliport.workareaactivity_pt.workareaactivity_id = airport_heliport.workareaactivity.id
left join master_join master_join_jusdrs on airport_heliport.workareaactivity.id = master_join_jusdrs.source_id
left join shared.timesheet_view shared_timesheet_view_vhmozj on master_join_jusdrs.target_id = shared_timesheet_view_vhmozj.id
left join master_join master_join_gnzcvk on airport_heliport.workareaactivity.id = master_join_gnzcvk.source_id
left join notes.note_view notes_note_view_fmyhwk on master_join_gnzcvk.target_id = notes_note_view_fmyhwk.id
left join master_join master_join_mgdvxd on airport_heliport.workareaactivity.id = master_join_mgdvxd.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_fsnvgw on master_join_mgdvxd.target_id = organisation_organisationauthority_pt_fsnvgw.id
group by
    airport_heliport.workareaactivity_pt.id,
    airport_heliport.workareaactivity_pt.nilreason,
    airport_heliport.workareaactivity.isactive_value,
    airport_heliport.workareaactivity.isactive_nilreason;
-- AircraftStandContaminationPropertyType
-- ['airport_heliport.surfacecontaminationlayer_view', 'notes.note_view', 'airport_heliport.ridge_view']
create or replace view airport_heliport.aircraftstandcontamination_view as
select
    airport_heliport.aircraftstandcontamination_pt.id,
    airport_heliport.aircraftstandcontamination_pt.nilreason AS aircraftstandcontamination_nilreason,
    coalesce(cast(airport_heliport.aircraftstandcontamination.frictioncoefficient_value as varchar), '(' || airport_heliport.aircraftstandcontamination.frictioncoefficient_nilreason || ')') as frictioncoefficient,
    coalesce(cast(airport_heliport.aircraftstandcontamination.frictionestimation_value as varchar), '(' || airport_heliport.aircraftstandcontamination.frictionestimation_nilreason || ')') as frictionestimation,
    coalesce(cast(airport_heliport.aircraftstandcontamination.frictiondevice_value as varchar), '(' || airport_heliport.aircraftstandcontamination.frictiondevice_nilreason || ')') as frictiondevice,
    coalesce(cast(airport_heliport.aircraftstandcontamination.obscuredlights_value as varchar), '(' || airport_heliport.aircraftstandcontamination.obscuredlights_nilreason || ')') as obscuredlights,
    coalesce(cast(airport_heliport.aircraftstandcontamination.furtherclearancetime_value as varchar), '(' || airport_heliport.aircraftstandcontamination.furtherclearancetime_nilreason || ')') as furtherclearancetime,
    coalesce(cast(airport_heliport.aircraftstandcontamination.furthertotalclearance_value as varchar), '(' || airport_heliport.aircraftstandcontamination.furthertotalclearance_nilreason || ')') as furthertotalclearance,
    coalesce(cast(airport_heliport.aircraftstandcontamination.proportion_value as varchar), '(' || airport_heliport.aircraftstandcontamination.proportion_nilreason || ')') as proportion,
    coalesce(cast(airport_heliport.aircraftstandcontamination.depth_value as varchar) || ' ' || airport_heliport.aircraftstandcontamination.depth_uom, '(' || airport_heliport.aircraftstandcontamination.depth_nilreason || ')') as depth,
    jsonb_agg(airport_heliport_ridge_view_kuiibt.id) AS criticalridge,
    jsonb_agg(airport_heliport_surfacecontaminationlayer_view_nrvlfv.id) AS layer,
    jsonb_agg(notes_note_view_tlfixt.*) AS aircraftstandcontamination_annotation
from airport_heliport.aircraftstandcontamination_pt 
inner join airport_heliport.aircraftstandcontamination on airport_heliport.aircraftstandcontamination_pt.aircraftstandcontamination_id = airport_heliport.aircraftstandcontamination.id
left join master_join master_join_xwbdax on airport_heliport.aircraftstandcontamination.id = master_join_xwbdax.source_id
left join airport_heliport.ridge_view airport_heliport_ridge_view_kuiibt on master_join_xwbdax.target_id = airport_heliport_ridge_view_kuiibt.id
left join master_join master_join_ugwfmo on airport_heliport.aircraftstandcontamination.id = master_join_ugwfmo.source_id
left join airport_heliport.surfacecontaminationlayer_view airport_heliport_surfacecontaminationlayer_view_nrvlfv on master_join_ugwfmo.target_id = airport_heliport_surfacecontaminationlayer_view_nrvlfv.id
left join master_join master_join_nmpdos on airport_heliport.aircraftstandcontamination.id = master_join_nmpdos.source_id
left join notes.note_view notes_note_view_tlfixt on master_join_nmpdos.target_id = notes_note_view_tlfixt.id
group by
    airport_heliport.aircraftstandcontamination_pt.id,
    airport_heliport.aircraftstandcontamination_pt.nilreason,
    airport_heliport.aircraftstandcontamination.frictioncoefficient_value,
    airport_heliport.aircraftstandcontamination.frictioncoefficient_nilreason,
    airport_heliport.aircraftstandcontamination.frictionestimation_value,
    airport_heliport.aircraftstandcontamination.frictionestimation_nilreason,
    airport_heliport.aircraftstandcontamination.frictiondevice_value,
    airport_heliport.aircraftstandcontamination.frictiondevice_nilreason,
    airport_heliport.aircraftstandcontamination.obscuredlights_value,
    airport_heliport.aircraftstandcontamination.obscuredlights_nilreason,
    airport_heliport.aircraftstandcontamination.furtherclearancetime_value,
    airport_heliport.aircraftstandcontamination.furtherclearancetime_nilreason,
    airport_heliport.aircraftstandcontamination.furthertotalclearance_value,
    airport_heliport.aircraftstandcontamination.furthertotalclearance_nilreason,
    airport_heliport.aircraftstandcontamination.proportion_value,
    airport_heliport.aircraftstandcontamination.proportion_nilreason,
    airport_heliport.aircraftstandcontamination.depth_value,
    airport_heliport.aircraftstandcontamination.depth_uom,
    airport_heliport.aircraftstandcontamination.depth_nilreason;
-- AirportHeliportContaminationPropertyType
-- ['airport_heliport.surfacecontaminationlayer_view', 'notes.note_view', 'airport_heliport.ridge_view']
create or replace view airport_heliport.airportheliportcontamination_view as
select
    airport_heliport.airportheliportcontamination_pt.id,
    airport_heliport.airportheliportcontamination_pt.nilreason AS airportheliportcontamination_nilreason,
    coalesce(cast(airport_heliport.airportheliportcontamination.frictioncoefficient_value as varchar), '(' || airport_heliport.airportheliportcontamination.frictioncoefficient_nilreason || ')') as frictioncoefficient,
    coalesce(cast(airport_heliport.airportheliportcontamination.frictionestimation_value as varchar), '(' || airport_heliport.airportheliportcontamination.frictionestimation_nilreason || ')') as frictionestimation,
    coalesce(cast(airport_heliport.airportheliportcontamination.frictiondevice_value as varchar), '(' || airport_heliport.airportheliportcontamination.frictiondevice_nilreason || ')') as frictiondevice,
    coalesce(cast(airport_heliport.airportheliportcontamination.obscuredlights_value as varchar), '(' || airport_heliport.airportheliportcontamination.obscuredlights_nilreason || ')') as obscuredlights,
    coalesce(cast(airport_heliport.airportheliportcontamination.furtherclearancetime_value as varchar), '(' || airport_heliport.airportheliportcontamination.furtherclearancetime_nilreason || ')') as furtherclearancetime,
    coalesce(cast(airport_heliport.airportheliportcontamination.furthertotalclearance_value as varchar), '(' || airport_heliport.airportheliportcontamination.furthertotalclearance_nilreason || ')') as furthertotalclearance,
    coalesce(cast(airport_heliport.airportheliportcontamination.proportion_value as varchar), '(' || airport_heliport.airportheliportcontamination.proportion_nilreason || ')') as proportion,
    coalesce(cast(airport_heliport.airportheliportcontamination.depth_value as varchar) || ' ' || airport_heliport.airportheliportcontamination.depth_uom, '(' || airport_heliport.airportheliportcontamination.depth_nilreason || ')') as depth,
    jsonb_agg(airport_heliport_ridge_view_zuwqcb.id) AS criticalridge,
    jsonb_agg(airport_heliport_surfacecontaminationlayer_view_tfjjta.id) AS layer,
    jsonb_agg(notes_note_view_ykosnh.*) AS airportheliportcontamination_annotation
from airport_heliport.airportheliportcontamination_pt 
inner join airport_heliport.airportheliportcontamination on airport_heliport.airportheliportcontamination_pt.airportheliportcontamination_id = airport_heliport.airportheliportcontamination.id
left join master_join master_join_qhtalf on airport_heliport.airportheliportcontamination.id = master_join_qhtalf.source_id
left join airport_heliport.ridge_view airport_heliport_ridge_view_zuwqcb on master_join_qhtalf.target_id = airport_heliport_ridge_view_zuwqcb.id
left join master_join master_join_vgsafz on airport_heliport.airportheliportcontamination.id = master_join_vgsafz.source_id
left join airport_heliport.surfacecontaminationlayer_view airport_heliport_surfacecontaminationlayer_view_tfjjta on master_join_vgsafz.target_id = airport_heliport_surfacecontaminationlayer_view_tfjjta.id
left join master_join master_join_cjsxgx on airport_heliport.airportheliportcontamination.id = master_join_cjsxgx.source_id
left join notes.note_view notes_note_view_ykosnh on master_join_cjsxgx.target_id = notes_note_view_ykosnh.id
group by
    airport_heliport.airportheliportcontamination_pt.id,
    airport_heliport.airportheliportcontamination_pt.nilreason,
    airport_heliport.airportheliportcontamination.frictioncoefficient_value,
    airport_heliport.airportheliportcontamination.frictioncoefficient_nilreason,
    airport_heliport.airportheliportcontamination.frictionestimation_value,
    airport_heliport.airportheliportcontamination.frictionestimation_nilreason,
    airport_heliport.airportheliportcontamination.frictiondevice_value,
    airport_heliport.airportheliportcontamination.frictiondevice_nilreason,
    airport_heliport.airportheliportcontamination.obscuredlights_value,
    airport_heliport.airportheliportcontamination.obscuredlights_nilreason,
    airport_heliport.airportheliportcontamination.furtherclearancetime_value,
    airport_heliport.airportheliportcontamination.furtherclearancetime_nilreason,
    airport_heliport.airportheliportcontamination.furthertotalclearance_value,
    airport_heliport.airportheliportcontamination.furthertotalclearance_nilreason,
    airport_heliport.airportheliportcontamination.proportion_value,
    airport_heliport.airportheliportcontamination.proportion_nilreason,
    airport_heliport.airportheliportcontamination.depth_value,
    airport_heliport.airportheliportcontamination.depth_uom,
    airport_heliport.airportheliportcontamination.depth_nilreason;
-- ApronContaminationPropertyType
-- ['airport_heliport.surfacecontaminationlayer_view', 'notes.note_view', 'airport_heliport.ridge_view']
create or replace view airport_heliport.aproncontamination_view as
select
    airport_heliport.aproncontamination_pt.id,
    airport_heliport.aproncontamination_pt.nilreason AS aproncontamination_nilreason,
    coalesce(cast(airport_heliport.aproncontamination.frictioncoefficient_value as varchar), '(' || airport_heliport.aproncontamination.frictioncoefficient_nilreason || ')') as frictioncoefficient,
    coalesce(cast(airport_heliport.aproncontamination.frictionestimation_value as varchar), '(' || airport_heliport.aproncontamination.frictionestimation_nilreason || ')') as frictionestimation,
    coalesce(cast(airport_heliport.aproncontamination.frictiondevice_value as varchar), '(' || airport_heliport.aproncontamination.frictiondevice_nilreason || ')') as frictiondevice,
    coalesce(cast(airport_heliport.aproncontamination.obscuredlights_value as varchar), '(' || airport_heliport.aproncontamination.obscuredlights_nilreason || ')') as obscuredlights,
    coalesce(cast(airport_heliport.aproncontamination.furtherclearancetime_value as varchar), '(' || airport_heliport.aproncontamination.furtherclearancetime_nilreason || ')') as furtherclearancetime,
    coalesce(cast(airport_heliport.aproncontamination.furthertotalclearance_value as varchar), '(' || airport_heliport.aproncontamination.furthertotalclearance_nilreason || ')') as furthertotalclearance,
    coalesce(cast(airport_heliport.aproncontamination.proportion_value as varchar), '(' || airport_heliport.aproncontamination.proportion_nilreason || ')') as proportion,
    coalesce(cast(airport_heliport.aproncontamination.depth_value as varchar) || ' ' || airport_heliport.aproncontamination.depth_uom, '(' || airport_heliport.aproncontamination.depth_nilreason || ')') as depth,
    jsonb_agg(airport_heliport_ridge_view_mzgbto.id) AS criticalridge,
    jsonb_agg(airport_heliport_surfacecontaminationlayer_view_opaxzg.id) AS layer,
    jsonb_agg(notes_note_view_rzkoli.*) AS aproncontamination_annotation
from airport_heliport.aproncontamination_pt 
inner join airport_heliport.aproncontamination on airport_heliport.aproncontamination_pt.aproncontamination_id = airport_heliport.aproncontamination.id
left join master_join master_join_hbqjft on airport_heliport.aproncontamination.id = master_join_hbqjft.source_id
left join airport_heliport.ridge_view airport_heliport_ridge_view_mzgbto on master_join_hbqjft.target_id = airport_heliport_ridge_view_mzgbto.id
left join master_join master_join_jkhukr on airport_heliport.aproncontamination.id = master_join_jkhukr.source_id
left join airport_heliport.surfacecontaminationlayer_view airport_heliport_surfacecontaminationlayer_view_opaxzg on master_join_jkhukr.target_id = airport_heliport_surfacecontaminationlayer_view_opaxzg.id
left join master_join master_join_rpkoou on airport_heliport.aproncontamination.id = master_join_rpkoou.source_id
left join notes.note_view notes_note_view_rzkoli on master_join_rpkoou.target_id = notes_note_view_rzkoli.id
group by
    airport_heliport.aproncontamination_pt.id,
    airport_heliport.aproncontamination_pt.nilreason,
    airport_heliport.aproncontamination.frictioncoefficient_value,
    airport_heliport.aproncontamination.frictioncoefficient_nilreason,
    airport_heliport.aproncontamination.frictionestimation_value,
    airport_heliport.aproncontamination.frictionestimation_nilreason,
    airport_heliport.aproncontamination.frictiondevice_value,
    airport_heliport.aproncontamination.frictiondevice_nilreason,
    airport_heliport.aproncontamination.obscuredlights_value,
    airport_heliport.aproncontamination.obscuredlights_nilreason,
    airport_heliport.aproncontamination.furtherclearancetime_value,
    airport_heliport.aproncontamination.furtherclearancetime_nilreason,
    airport_heliport.aproncontamination.furthertotalclearance_value,
    airport_heliport.aproncontamination.furthertotalclearance_nilreason,
    airport_heliport.aproncontamination.proportion_value,
    airport_heliport.aproncontamination.proportion_nilreason,
    airport_heliport.aproncontamination.depth_value,
    airport_heliport.aproncontamination.depth_uom,
    airport_heliport.aproncontamination.depth_nilreason;
-- RunwayContaminationPropertyType
-- ['airport_heliport.surfacecontaminationlayer_view', 'notes.note_view', 'airport_heliport.ridge_view']
create or replace view airport_heliport.runwaycontamination_view as
select
    airport_heliport.runwaycontamination_pt.id,
    airport_heliport.runwaycontamination_pt.nilreason AS runwaycontamination_nilreason,
    coalesce(cast(airport_heliport.runwaycontamination.frictioncoefficient_value as varchar), '(' || airport_heliport.runwaycontamination.frictioncoefficient_nilreason || ')') as frictioncoefficient,
    coalesce(cast(airport_heliport.runwaycontamination.frictionestimation_value as varchar), '(' || airport_heliport.runwaycontamination.frictionestimation_nilreason || ')') as frictionestimation,
    coalesce(cast(airport_heliport.runwaycontamination.frictiondevice_value as varchar), '(' || airport_heliport.runwaycontamination.frictiondevice_nilreason || ')') as frictiondevice,
    coalesce(cast(airport_heliport.runwaycontamination.obscuredlights_value as varchar), '(' || airport_heliport.runwaycontamination.obscuredlights_nilreason || ')') as obscuredlights,
    coalesce(cast(airport_heliport.runwaycontamination.furtherclearancetime_value as varchar), '(' || airport_heliport.runwaycontamination.furtherclearancetime_nilreason || ')') as furtherclearancetime,
    coalesce(cast(airport_heliport.runwaycontamination.furthertotalclearance_value as varchar), '(' || airport_heliport.runwaycontamination.furthertotalclearance_nilreason || ')') as furthertotalclearance,
    coalesce(cast(airport_heliport.runwaycontamination.proportion_value as varchar), '(' || airport_heliport.runwaycontamination.proportion_nilreason || ')') as proportion,
    coalesce(cast(airport_heliport.runwaycontamination.clearedside_value as varchar), '(' || airport_heliport.runwaycontamination.clearedside_nilreason || ')') as clearedside,
    coalesce(cast(airport_heliport.runwaycontamination.obscuredlightsside_value as varchar), '(' || airport_heliport.runwaycontamination.obscuredlightsside_nilreason || ')') as obscuredlightsside,
    coalesce(cast(airport_heliport.runwaycontamination.taxiwayavailable_value as varchar), '(' || airport_heliport.runwaycontamination.taxiwayavailable_nilreason || ')') as taxiwayavailable,
    coalesce(cast(airport_heliport.runwaycontamination.apronavailable_value as varchar), '(' || airport_heliport.runwaycontamination.apronavailable_nilreason || ')') as apronavailable,
    coalesce(cast(airport_heliport.runwaycontamination.depth_value as varchar) || ' ' || airport_heliport.runwaycontamination.depth_uom, '(' || airport_heliport.runwaycontamination.depth_nilreason || ')') as depth,
    coalesce(cast(airport_heliport.runwaycontamination.clearedlength_value as varchar) || ' ' || airport_heliport.runwaycontamination.clearedlength_uom, '(' || airport_heliport.runwaycontamination.clearedlength_nilreason || ')') as clearedlength,
    coalesce(cast(airport_heliport.runwaycontamination.clearedwidth_value as varchar) || ' ' || airport_heliport.runwaycontamination.clearedwidth_uom, '(' || airport_heliport.runwaycontamination.clearedwidth_nilreason || ')') as clearedwidth,
    coalesce(cast(airport_heliport.runwaycontamination.furtherclearancelength_value as varchar) || ' ' || airport_heliport.runwaycontamination.furtherclearancelength_uom, '(' || airport_heliport.runwaycontamination.furtherclearancelength_nilreason || ')') as furtherclearancelength,
    coalesce(cast(airport_heliport.runwaycontamination.furtherclearancewidth_value as varchar) || ' ' || airport_heliport.runwaycontamination.furtherclearancewidth_uom, '(' || airport_heliport.runwaycontamination.furtherclearancewidth_nilreason || ')') as furtherclearancewidth,
    coalesce(cast(airport_heliport.runwaycontamination.clearedlengthbegin_value as varchar) || ' ' || airport_heliport.runwaycontamination.clearedlengthbegin_uom, '(' || airport_heliport.runwaycontamination.clearedlengthbegin_nilreason || ')') as clearedlengthbegin,
    jsonb_agg(airport_heliport_ridge_view_ubgpna.id) AS criticalridge,
    jsonb_agg(airport_heliport_surfacecontaminationlayer_view_ryrjwq.id) AS layer,
    jsonb_agg(notes_note_view_wzohej.*) AS runwaycontamination_annotation
from airport_heliport.runwaycontamination_pt 
inner join airport_heliport.runwaycontamination on airport_heliport.runwaycontamination_pt.runwaycontamination_id = airport_heliport.runwaycontamination.id
left join master_join master_join_zqqezg on airport_heliport.runwaycontamination.id = master_join_zqqezg.source_id
left join airport_heliport.ridge_view airport_heliport_ridge_view_ubgpna on master_join_zqqezg.target_id = airport_heliport_ridge_view_ubgpna.id
left join master_join master_join_qcuizg on airport_heliport.runwaycontamination.id = master_join_qcuizg.source_id
left join airport_heliport.surfacecontaminationlayer_view airport_heliport_surfacecontaminationlayer_view_ryrjwq on master_join_qcuizg.target_id = airport_heliport_surfacecontaminationlayer_view_ryrjwq.id
left join master_join master_join_cnccmi on airport_heliport.runwaycontamination.id = master_join_cnccmi.source_id
left join notes.note_view notes_note_view_wzohej on master_join_cnccmi.target_id = notes_note_view_wzohej.id
group by
    airport_heliport.runwaycontamination_pt.id,
    airport_heliport.runwaycontamination_pt.nilreason,
    airport_heliport.runwaycontamination.frictioncoefficient_value,
    airport_heliport.runwaycontamination.frictioncoefficient_nilreason,
    airport_heliport.runwaycontamination.frictionestimation_value,
    airport_heliport.runwaycontamination.frictionestimation_nilreason,
    airport_heliport.runwaycontamination.frictiondevice_value,
    airport_heliport.runwaycontamination.frictiondevice_nilreason,
    airport_heliport.runwaycontamination.obscuredlights_value,
    airport_heliport.runwaycontamination.obscuredlights_nilreason,
    airport_heliport.runwaycontamination.furtherclearancetime_value,
    airport_heliport.runwaycontamination.furtherclearancetime_nilreason,
    airport_heliport.runwaycontamination.furthertotalclearance_value,
    airport_heliport.runwaycontamination.furthertotalclearance_nilreason,
    airport_heliport.runwaycontamination.proportion_value,
    airport_heliport.runwaycontamination.proportion_nilreason,
    airport_heliport.runwaycontamination.clearedside_value,
    airport_heliport.runwaycontamination.clearedside_nilreason,
    airport_heliport.runwaycontamination.obscuredlightsside_value,
    airport_heliport.runwaycontamination.obscuredlightsside_nilreason,
    airport_heliport.runwaycontamination.taxiwayavailable_value,
    airport_heliport.runwaycontamination.taxiwayavailable_nilreason,
    airport_heliport.runwaycontamination.apronavailable_value,
    airport_heliport.runwaycontamination.apronavailable_nilreason,
    airport_heliport.runwaycontamination.depth_value,
    airport_heliport.runwaycontamination.depth_uom,
    airport_heliport.runwaycontamination.depth_nilreason,
    airport_heliport.runwaycontamination.clearedlength_value,
    airport_heliport.runwaycontamination.clearedlength_uom,
    airport_heliport.runwaycontamination.clearedlength_nilreason,
    airport_heliport.runwaycontamination.clearedwidth_value,
    airport_heliport.runwaycontamination.clearedwidth_uom,
    airport_heliport.runwaycontamination.clearedwidth_nilreason,
    airport_heliport.runwaycontamination.furtherclearancelength_value,
    airport_heliport.runwaycontamination.furtherclearancelength_uom,
    airport_heliport.runwaycontamination.furtherclearancelength_nilreason,
    airport_heliport.runwaycontamination.furtherclearancewidth_value,
    airport_heliport.runwaycontamination.furtherclearancewidth_uom,
    airport_heliport.runwaycontamination.furtherclearancewidth_nilreason,
    airport_heliport.runwaycontamination.clearedlengthbegin_value,
    airport_heliport.runwaycontamination.clearedlengthbegin_uom,
    airport_heliport.runwaycontamination.clearedlengthbegin_nilreason;
-- RunwaySectionContaminationPropertyType
-- ['airport_heliport.surfacecontaminationlayer_view', 'notes.note_view', 'airport_heliport.ridge_view']
create or replace view airport_heliport.runwaysectioncontamination_view as
select
    airport_heliport.runwaysectioncontamination_pt.id,
    airport_heliport.runwaysectioncontamination_pt.nilreason AS runwaysectioncontamination_nilreason,
    coalesce(cast(airport_heliport.runwaysectioncontamination.frictioncoefficient_value as varchar), '(' || airport_heliport.runwaysectioncontamination.frictioncoefficient_nilreason || ')') as frictioncoefficient,
    coalesce(cast(airport_heliport.runwaysectioncontamination.frictionestimation_value as varchar), '(' || airport_heliport.runwaysectioncontamination.frictionestimation_nilreason || ')') as frictionestimation,
    coalesce(cast(airport_heliport.runwaysectioncontamination.frictiondevice_value as varchar), '(' || airport_heliport.runwaysectioncontamination.frictiondevice_nilreason || ')') as frictiondevice,
    coalesce(cast(airport_heliport.runwaysectioncontamination.obscuredlights_value as varchar), '(' || airport_heliport.runwaysectioncontamination.obscuredlights_nilreason || ')') as obscuredlights,
    coalesce(cast(airport_heliport.runwaysectioncontamination.furtherclearancetime_value as varchar), '(' || airport_heliport.runwaysectioncontamination.furtherclearancetime_nilreason || ')') as furtherclearancetime,
    coalesce(cast(airport_heliport.runwaysectioncontamination.furthertotalclearance_value as varchar), '(' || airport_heliport.runwaysectioncontamination.furthertotalclearance_nilreason || ')') as furthertotalclearance,
    coalesce(cast(airport_heliport.runwaysectioncontamination.proportion_value as varchar), '(' || airport_heliport.runwaysectioncontamination.proportion_nilreason || ')') as proportion,
    coalesce(cast(airport_heliport.runwaysectioncontamination.section_value as varchar), '(' || airport_heliport.runwaysectioncontamination.section_nilreason || ')') as section,
    coalesce(cast(airport_heliport.runwaysectioncontamination.depth_value as varchar) || ' ' || airport_heliport.runwaysectioncontamination.depth_uom, '(' || airport_heliport.runwaysectioncontamination.depth_nilreason || ')') as depth,
    jsonb_agg(airport_heliport_ridge_view_nlzfly.id) AS criticalridge,
    jsonb_agg(airport_heliport_surfacecontaminationlayer_view_fqpyud.id) AS layer,
    jsonb_agg(notes_note_view_gmuxnu.*) AS runwaysectioncontamination_annotation
from airport_heliport.runwaysectioncontamination_pt 
inner join airport_heliport.runwaysectioncontamination on airport_heliport.runwaysectioncontamination_pt.runwaysectioncontamination_id = airport_heliport.runwaysectioncontamination.id
left join master_join master_join_ugdahz on airport_heliport.runwaysectioncontamination.id = master_join_ugdahz.source_id
left join airport_heliport.ridge_view airport_heliport_ridge_view_nlzfly on master_join_ugdahz.target_id = airport_heliport_ridge_view_nlzfly.id
left join master_join master_join_cplwra on airport_heliport.runwaysectioncontamination.id = master_join_cplwra.source_id
left join airport_heliport.surfacecontaminationlayer_view airport_heliport_surfacecontaminationlayer_view_fqpyud on master_join_cplwra.target_id = airport_heliport_surfacecontaminationlayer_view_fqpyud.id
left join master_join master_join_oxcmpo on airport_heliport.runwaysectioncontamination.id = master_join_oxcmpo.source_id
left join notes.note_view notes_note_view_gmuxnu on master_join_oxcmpo.target_id = notes_note_view_gmuxnu.id
group by
    airport_heliport.runwaysectioncontamination_pt.id,
    airport_heliport.runwaysectioncontamination_pt.nilreason,
    airport_heliport.runwaysectioncontamination.frictioncoefficient_value,
    airport_heliport.runwaysectioncontamination.frictioncoefficient_nilreason,
    airport_heliport.runwaysectioncontamination.frictionestimation_value,
    airport_heliport.runwaysectioncontamination.frictionestimation_nilreason,
    airport_heliport.runwaysectioncontamination.frictiondevice_value,
    airport_heliport.runwaysectioncontamination.frictiondevice_nilreason,
    airport_heliport.runwaysectioncontamination.obscuredlights_value,
    airport_heliport.runwaysectioncontamination.obscuredlights_nilreason,
    airport_heliport.runwaysectioncontamination.furtherclearancetime_value,
    airport_heliport.runwaysectioncontamination.furtherclearancetime_nilreason,
    airport_heliport.runwaysectioncontamination.furthertotalclearance_value,
    airport_heliport.runwaysectioncontamination.furthertotalclearance_nilreason,
    airport_heliport.runwaysectioncontamination.proportion_value,
    airport_heliport.runwaysectioncontamination.proportion_nilreason,
    airport_heliport.runwaysectioncontamination.section_value,
    airport_heliport.runwaysectioncontamination.section_nilreason,
    airport_heliport.runwaysectioncontamination.depth_value,
    airport_heliport.runwaysectioncontamination.depth_uom,
    airport_heliport.runwaysectioncontamination.depth_nilreason;
-- TaxiwayContaminationPropertyType
-- ['airport_heliport.surfacecontaminationlayer_view', 'notes.note_view', 'airport_heliport.ridge_view']
create or replace view airport_heliport.taxiwaycontamination_view as
select
    airport_heliport.taxiwaycontamination_pt.id,
    airport_heliport.taxiwaycontamination_pt.nilreason AS taxiwaycontamination_nilreason,
    coalesce(cast(airport_heliport.taxiwaycontamination.frictioncoefficient_value as varchar), '(' || airport_heliport.taxiwaycontamination.frictioncoefficient_nilreason || ')') as frictioncoefficient,
    coalesce(cast(airport_heliport.taxiwaycontamination.frictionestimation_value as varchar), '(' || airport_heliport.taxiwaycontamination.frictionestimation_nilreason || ')') as frictionestimation,
    coalesce(cast(airport_heliport.taxiwaycontamination.frictiondevice_value as varchar), '(' || airport_heliport.taxiwaycontamination.frictiondevice_nilreason || ')') as frictiondevice,
    coalesce(cast(airport_heliport.taxiwaycontamination.obscuredlights_value as varchar), '(' || airport_heliport.taxiwaycontamination.obscuredlights_nilreason || ')') as obscuredlights,
    coalesce(cast(airport_heliport.taxiwaycontamination.furtherclearancetime_value as varchar), '(' || airport_heliport.taxiwaycontamination.furtherclearancetime_nilreason || ')') as furtherclearancetime,
    coalesce(cast(airport_heliport.taxiwaycontamination.furthertotalclearance_value as varchar), '(' || airport_heliport.taxiwaycontamination.furthertotalclearance_nilreason || ')') as furthertotalclearance,
    coalesce(cast(airport_heliport.taxiwaycontamination.proportion_value as varchar), '(' || airport_heliport.taxiwaycontamination.proportion_nilreason || ')') as proportion,
    coalesce(cast(airport_heliport.taxiwaycontamination.depth_value as varchar) || ' ' || airport_heliport.taxiwaycontamination.depth_uom, '(' || airport_heliport.taxiwaycontamination.depth_nilreason || ')') as depth,
    coalesce(cast(airport_heliport.taxiwaycontamination.clearedwidth_value as varchar) || ' ' || airport_heliport.taxiwaycontamination.clearedwidth_uom, '(' || airport_heliport.taxiwaycontamination.clearedwidth_nilreason || ')') as clearedwidth,
    jsonb_agg(airport_heliport_ridge_view_ouacdc.id) AS criticalridge,
    jsonb_agg(airport_heliport_surfacecontaminationlayer_view_rtzgxz.id) AS layer,
    jsonb_agg(notes_note_view_rhhhws.*) AS taxiwaycontamination_annotation
from airport_heliport.taxiwaycontamination_pt 
inner join airport_heliport.taxiwaycontamination on airport_heliport.taxiwaycontamination_pt.taxiwaycontamination_id = airport_heliport.taxiwaycontamination.id
left join master_join master_join_fwnwqt on airport_heliport.taxiwaycontamination.id = master_join_fwnwqt.source_id
left join airport_heliport.ridge_view airport_heliport_ridge_view_ouacdc on master_join_fwnwqt.target_id = airport_heliport_ridge_view_ouacdc.id
left join master_join master_join_hlzoyj on airport_heliport.taxiwaycontamination.id = master_join_hlzoyj.source_id
left join airport_heliport.surfacecontaminationlayer_view airport_heliport_surfacecontaminationlayer_view_rtzgxz on master_join_hlzoyj.target_id = airport_heliport_surfacecontaminationlayer_view_rtzgxz.id
left join master_join master_join_oggqwm on airport_heliport.taxiwaycontamination.id = master_join_oggqwm.source_id
left join notes.note_view notes_note_view_rhhhws on master_join_oggqwm.target_id = notes_note_view_rhhhws.id
group by
    airport_heliport.taxiwaycontamination_pt.id,
    airport_heliport.taxiwaycontamination_pt.nilreason,
    airport_heliport.taxiwaycontamination.frictioncoefficient_value,
    airport_heliport.taxiwaycontamination.frictioncoefficient_nilreason,
    airport_heliport.taxiwaycontamination.frictionestimation_value,
    airport_heliport.taxiwaycontamination.frictionestimation_nilreason,
    airport_heliport.taxiwaycontamination.frictiondevice_value,
    airport_heliport.taxiwaycontamination.frictiondevice_nilreason,
    airport_heliport.taxiwaycontamination.obscuredlights_value,
    airport_heliport.taxiwaycontamination.obscuredlights_nilreason,
    airport_heliport.taxiwaycontamination.furtherclearancetime_value,
    airport_heliport.taxiwaycontamination.furtherclearancetime_nilreason,
    airport_heliport.taxiwaycontamination.furthertotalclearance_value,
    airport_heliport.taxiwaycontamination.furthertotalclearance_nilreason,
    airport_heliport.taxiwaycontamination.proportion_value,
    airport_heliport.taxiwaycontamination.proportion_nilreason,
    airport_heliport.taxiwaycontamination.depth_value,
    airport_heliport.taxiwaycontamination.depth_uom,
    airport_heliport.taxiwaycontamination.depth_nilreason,
    airport_heliport.taxiwaycontamination.clearedwidth_value,
    airport_heliport.taxiwaycontamination.clearedwidth_uom,
    airport_heliport.taxiwaycontamination.clearedwidth_nilreason;
-- TouchDownLiftOffContaminationPropertyType
-- ['airport_heliport.surfacecontaminationlayer_view', 'notes.note_view', 'airport_heliport.ridge_view']
create or replace view airport_heliport.touchdownliftoffcontamination_view as
select
    airport_heliport.touchdownliftoffcontamination_pt.id,
    airport_heliport.touchdownliftoffcontamination_pt.nilreason AS touchdownliftoffcontamination_nilreason,
    coalesce(cast(airport_heliport.touchdownliftoffcontamination.frictioncoefficient_value as varchar), '(' || airport_heliport.touchdownliftoffcontamination.frictioncoefficient_nilreason || ')') as frictioncoefficient,
    coalesce(cast(airport_heliport.touchdownliftoffcontamination.frictionestimation_value as varchar), '(' || airport_heliport.touchdownliftoffcontamination.frictionestimation_nilreason || ')') as frictionestimation,
    coalesce(cast(airport_heliport.touchdownliftoffcontamination.frictiondevice_value as varchar), '(' || airport_heliport.touchdownliftoffcontamination.frictiondevice_nilreason || ')') as frictiondevice,
    coalesce(cast(airport_heliport.touchdownliftoffcontamination.obscuredlights_value as varchar), '(' || airport_heliport.touchdownliftoffcontamination.obscuredlights_nilreason || ')') as obscuredlights,
    coalesce(cast(airport_heliport.touchdownliftoffcontamination.furtherclearancetime_value as varchar), '(' || airport_heliport.touchdownliftoffcontamination.furtherclearancetime_nilreason || ')') as furtherclearancetime,
    coalesce(cast(airport_heliport.touchdownliftoffcontamination.furthertotalclearance_value as varchar), '(' || airport_heliport.touchdownliftoffcontamination.furthertotalclearance_nilreason || ')') as furthertotalclearance,
    coalesce(cast(airport_heliport.touchdownliftoffcontamination.proportion_value as varchar), '(' || airport_heliport.touchdownliftoffcontamination.proportion_nilreason || ')') as proportion,
    coalesce(cast(airport_heliport.touchdownliftoffcontamination.depth_value as varchar) || ' ' || airport_heliport.touchdownliftoffcontamination.depth_uom, '(' || airport_heliport.touchdownliftoffcontamination.depth_nilreason || ')') as depth,
    jsonb_agg(airport_heliport_ridge_view_jcotay.id) AS criticalridge,
    jsonb_agg(airport_heliport_surfacecontaminationlayer_view_idbocl.id) AS layer,
    jsonb_agg(notes_note_view_lftzpp.*) AS touchdownliftoffcontamination_annotation
from airport_heliport.touchdownliftoffcontamination_pt 
inner join airport_heliport.touchdownliftoffcontamination on airport_heliport.touchdownliftoffcontamination_pt.touchdownliftoffcontamination_id = airport_heliport.touchdownliftoffcontamination.id
left join master_join master_join_ztpmvq on airport_heliport.touchdownliftoffcontamination.id = master_join_ztpmvq.source_id
left join airport_heliport.ridge_view airport_heliport_ridge_view_jcotay on master_join_ztpmvq.target_id = airport_heliport_ridge_view_jcotay.id
left join master_join master_join_zccxfv on airport_heliport.touchdownliftoffcontamination.id = master_join_zccxfv.source_id
left join airport_heliport.surfacecontaminationlayer_view airport_heliport_surfacecontaminationlayer_view_idbocl on master_join_zccxfv.target_id = airport_heliport_surfacecontaminationlayer_view_idbocl.id
left join master_join master_join_qxizmi on airport_heliport.touchdownliftoffcontamination.id = master_join_qxizmi.source_id
left join notes.note_view notes_note_view_lftzpp on master_join_qxizmi.target_id = notes_note_view_lftzpp.id
group by
    airport_heliport.touchdownliftoffcontamination_pt.id,
    airport_heliport.touchdownliftoffcontamination_pt.nilreason,
    airport_heliport.touchdownliftoffcontamination.frictioncoefficient_value,
    airport_heliport.touchdownliftoffcontamination.frictioncoefficient_nilreason,
    airport_heliport.touchdownliftoffcontamination.frictionestimation_value,
    airport_heliport.touchdownliftoffcontamination.frictionestimation_nilreason,
    airport_heliport.touchdownliftoffcontamination.frictiondevice_value,
    airport_heliport.touchdownliftoffcontamination.frictiondevice_nilreason,
    airport_heliport.touchdownliftoffcontamination.obscuredlights_value,
    airport_heliport.touchdownliftoffcontamination.obscuredlights_nilreason,
    airport_heliport.touchdownliftoffcontamination.furtherclearancetime_value,
    airport_heliport.touchdownliftoffcontamination.furtherclearancetime_nilreason,
    airport_heliport.touchdownliftoffcontamination.furthertotalclearance_value,
    airport_heliport.touchdownliftoffcontamination.furthertotalclearance_nilreason,
    airport_heliport.touchdownliftoffcontamination.proportion_value,
    airport_heliport.touchdownliftoffcontamination.proportion_nilreason,
    airport_heliport.touchdownliftoffcontamination.depth_value,
    airport_heliport.touchdownliftoffcontamination.depth_uom,
    airport_heliport.touchdownliftoffcontamination.depth_nilreason;
-- MinimaPropertyType
-- ['procedure.equipmentunavailableadjustment_view', 'notes.note_view']
create or replace view procedure.minima_view as
select
    procedure.minima_pt.id,
    procedure.minima_pt.nilreason AS minima_nilreason,
    coalesce(cast(procedure.minima.altitudecode_value as varchar), '(' || procedure.minima.altitudecode_nilreason || ')') as altitudecode,
    coalesce(cast(procedure.minima.altitudereference_value as varchar), '(' || procedure.minima.altitudereference_nilreason || ')') as altitudereference,
    coalesce(cast(procedure.minima.heightcode_value as varchar), '(' || procedure.minima.heightcode_nilreason || ')') as heightcode,
    coalesce(cast(procedure.minima.heightreference_value as varchar), '(' || procedure.minima.heightreference_nilreason || ')') as heightreference,
    coalesce(cast(procedure.minima.mandatoryrvr_value as varchar), '(' || procedure.minima.mandatoryrvr_nilreason || ')') as mandatoryrvr,
    coalesce(cast(procedure.minima.remotealtimeterminima_value as varchar), '(' || procedure.minima.remotealtimeterminima_nilreason || ')') as remotealtimeterminima,
    coalesce(cast(procedure.minima.altitude_value as varchar) || ' ' || procedure.minima.altitude_uom, '(' || procedure.minima.altitude_nilreason || ')') as altitude,
    coalesce(cast(procedure.minima.height_value as varchar) || ' ' || procedure.minima.height_uom, '(' || procedure.minima.height_nilreason || ')') as height,
    coalesce(cast(procedure.minima.militaryheight_value as varchar) || ' ' || procedure.minima.militaryheight_uom, '(' || procedure.minima.militaryheight_nilreason || ')') as militaryheight,
    coalesce(cast(procedure.minima.radioheight_value as varchar) || ' ' || procedure.minima.radioheight_uom, '(' || procedure.minima.radioheight_nilreason || ')') as radioheight,
    coalesce(cast(procedure.minima.visibility_value as varchar) || ' ' || procedure.minima.visibility_uom, '(' || procedure.minima.visibility_nilreason || ')') as visibility,
    coalesce(cast(procedure.minima.militaryvisibility_value as varchar) || ' ' || procedure.minima.militaryvisibility_uom, '(' || procedure.minima.militaryvisibility_nilreason || ')') as militaryvisibility,
    jsonb_agg(procedure_equipmentunavailableadjustment_view_ojgsoi.id) AS adjustmentinop,
    jsonb_agg(notes_note_view_zuslde.*) AS minima_annotation
from procedure.minima_pt 
inner join procedure.minima on procedure.minima_pt.minima_id = procedure.minima.id
left join master_join master_join_ckwiue on procedure.minima.id = master_join_ckwiue.source_id
left join procedure.equipmentunavailableadjustment_view procedure_equipmentunavailableadjustment_view_ojgsoi on master_join_ckwiue.target_id = procedure_equipmentunavailableadjustment_view_ojgsoi.id
left join master_join master_join_adsrmc on procedure.minima.id = master_join_adsrmc.source_id
left join notes.note_view notes_note_view_zuslde on master_join_adsrmc.target_id = notes_note_view_zuslde.id
group by
    procedure.minima_pt.id,
    procedure.minima_pt.nilreason,
    procedure.minima.altitudecode_value,
    procedure.minima.altitudecode_nilreason,
    procedure.minima.altitudereference_value,
    procedure.minima.altitudereference_nilreason,
    procedure.minima.heightcode_value,
    procedure.minima.heightcode_nilreason,
    procedure.minima.heightreference_value,
    procedure.minima.heightreference_nilreason,
    procedure.minima.mandatoryrvr_value,
    procedure.minima.mandatoryrvr_nilreason,
    procedure.minima.remotealtimeterminima_value,
    procedure.minima.remotealtimeterminima_nilreason,
    procedure.minima.altitude_value,
    procedure.minima.altitude_uom,
    procedure.minima.altitude_nilreason,
    procedure.minima.height_value,
    procedure.minima.height_uom,
    procedure.minima.height_nilreason,
    procedure.minima.militaryheight_value,
    procedure.minima.militaryheight_uom,
    procedure.minima.militaryheight_nilreason,
    procedure.minima.radioheight_value,
    procedure.minima.radioheight_uom,
    procedure.minima.radioheight_nilreason,
    procedure.minima.visibility_value,
    procedure.minima.visibility_uom,
    procedure.minima.visibility_nilreason,
    procedure.minima.militaryvisibility_value,
    procedure.minima.militaryvisibility_uom,
    procedure.minima.militaryvisibility_nilreason;
-- NavigationAreaSectorPropertyType
-- ['procedure.sectordesign_view', 'geometry.surface_view', 'notes.note_view', 'shared.circlesector_view', 'shared.obstruction_view']
create or replace view procedure.navigationareasector_view as
select
    procedure.navigationareasector_pt.id,
    procedure.navigationareasector_pt.nilreason AS navigationareasector_nilreason,
    shared_circlesector_view_amalbe.id AS sectordefinition,
    geometry_surface_view_laiizt.geom AS geom,
    jsonb_agg(shared_obstruction_view_lfpume.id) AS significantobstacle,
    jsonb_agg(procedure_sectordesign_view_zmmxsb.id) AS sectorcriteria,
    jsonb_agg(notes_note_view_pochsu.*) AS navigationareasector_annotation
from procedure.navigationareasector_pt 
inner join procedure.navigationareasector on procedure.navigationareasector_pt.navigationareasector_id = procedure.navigationareasector.id
left join shared.circlesector_view shared_circlesector_view_amalbe on procedure.navigationareasector.sectordefinition_id = shared_circlesector_view_amalbe.id
left join geometry.surface_view geometry_surface_view_laiizt on procedure.navigationareasector.extent_id = geometry_surface_view_laiizt.id
left join master_join master_join_kmddgz on procedure.navigationareasector.id = master_join_kmddgz.source_id
left join shared.obstruction_view shared_obstruction_view_lfpume on master_join_kmddgz.target_id = shared_obstruction_view_lfpume.id
left join master_join master_join_bzapwd on procedure.navigationareasector.id = master_join_bzapwd.source_id
left join procedure.sectordesign_view procedure_sectordesign_view_zmmxsb on master_join_bzapwd.target_id = procedure_sectordesign_view_zmmxsb.id
left join master_join master_join_wcltas on procedure.navigationareasector.id = master_join_wcltas.source_id
left join notes.note_view notes_note_view_pochsu on master_join_wcltas.target_id = notes_note_view_pochsu.id
group by
    procedure.navigationareasector_pt.id,
    procedure.navigationareasector_pt.nilreason,
    shared_circlesector_view_amalbe.id,
    geometry_surface_view_laiizt.geom;
-- ObstacleAssessmentAreaPropertyType
-- ['geometry.surface_view', 'shared.aircraftcharacteristic_view', 'notes.note_view', 'geometry.curve_view', 'shared.obstruction_view']
create or replace view shared.obstacleassessmentarea_view as
select
    shared.obstacleassessmentarea_pt.id,
    shared.obstacleassessmentarea_pt.nilreason AS obstacleassessmentarea_nilreason,
    coalesce(cast(shared.obstacleassessmentarea.type_value as varchar), '(' || shared.obstacleassessmentarea.type_nilreason || ')') as type,
    coalesce(cast(shared.obstacleassessmentarea.sectionnumber_value as varchar), '(' || shared.obstacleassessmentarea.sectionnumber_nilreason || ')') as sectionnumber,
    coalesce(cast(shared.obstacleassessmentarea.slope_value as varchar), '(' || shared.obstacleassessmentarea.slope_nilreason || ')') as slope,
    coalesce(cast(shared.obstacleassessmentarea.gradientlowhigh_value as varchar), '(' || shared.obstacleassessmentarea.gradientlowhigh_nilreason || ')') as gradientlowhigh,
    coalesce(cast(shared.obstacleassessmentarea.surfacezone_value as varchar), '(' || shared.obstacleassessmentarea.surfacezone_nilreason || ')') as surfacezone,
    coalesce(cast(shared.obstacleassessmentarea.safetyregulation_value as varchar), '(' || shared.obstacleassessmentarea.safetyregulation_nilreason || ')') as safetyregulation,
    coalesce(cast(shared.obstacleassessmentarea.assessedaltitude_value as varchar) || ' ' || shared.obstacleassessmentarea.assessedaltitude_uom, '(' || shared.obstacleassessmentarea.assessedaltitude_nilreason || ')') as assessedaltitude,
    coalesce(cast(shared.obstacleassessmentarea.slopeloweraltitude_value as varchar) || ' ' || shared.obstacleassessmentarea.slopeloweraltitude_uom, '(' || shared.obstacleassessmentarea.slopeloweraltitude_nilreason || ')') as slopeloweraltitude,
    geometry_surface_view_xlradu.geom AS geom,
    geometry_curve_view_dshagc.geom AS geom,
    jsonb_agg(shared_aircraftcharacteristic_view_cgwdsj.id) AS aircraftcategory,
    jsonb_agg(shared_obstruction_view_aahkas.id) AS significantobstacle,
    jsonb_agg(notes_note_view_ohslke.*) AS obstacleassessmentarea_annotation
from shared.obstacleassessmentarea_pt 
inner join shared.obstacleassessmentarea on shared.obstacleassessmentarea_pt.obstacleassessmentarea_id = shared.obstacleassessmentarea.id
left join geometry.surface_view geometry_surface_view_xlradu on shared.obstacleassessmentarea.surface_id = geometry_surface_view_xlradu.id
left join geometry.curve_view geometry_curve_view_dshagc on shared.obstacleassessmentarea.startingcurve_id = geometry_curve_view_dshagc.id
left join master_join master_join_rmfumy on shared.obstacleassessmentarea.id = master_join_rmfumy.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_cgwdsj on master_join_rmfumy.target_id = shared_aircraftcharacteristic_view_cgwdsj.id
left join master_join master_join_obqcbm on shared.obstacleassessmentarea.id = master_join_obqcbm.source_id
left join shared.obstruction_view shared_obstruction_view_aahkas on master_join_obqcbm.target_id = shared_obstruction_view_aahkas.id
left join master_join master_join_mvkiwz on shared.obstacleassessmentarea.id = master_join_mvkiwz.source_id
left join notes.note_view notes_note_view_ohslke on master_join_mvkiwz.target_id = notes_note_view_ohslke.id
group by
    shared.obstacleassessmentarea_pt.id,
    shared.obstacleassessmentarea_pt.nilreason,
    shared.obstacleassessmentarea.type_value,
    shared.obstacleassessmentarea.type_nilreason,
    shared.obstacleassessmentarea.sectionnumber_value,
    shared.obstacleassessmentarea.sectionnumber_nilreason,
    shared.obstacleassessmentarea.slope_value,
    shared.obstacleassessmentarea.slope_nilreason,
    shared.obstacleassessmentarea.gradientlowhigh_value,
    shared.obstacleassessmentarea.gradientlowhigh_nilreason,
    shared.obstacleassessmentarea.surfacezone_value,
    shared.obstacleassessmentarea.surfacezone_nilreason,
    shared.obstacleassessmentarea.safetyregulation_value,
    shared.obstacleassessmentarea.safetyregulation_nilreason,
    shared.obstacleassessmentarea.assessedaltitude_value,
    shared.obstacleassessmentarea.assessedaltitude_uom,
    shared.obstacleassessmentarea.assessedaltitude_nilreason,
    shared.obstacleassessmentarea.slopeloweraltitude_value,
    shared.obstacleassessmentarea.slopeloweraltitude_uom,
    shared.obstacleassessmentarea.slopeloweraltitude_nilreason,
    geometry_surface_view_xlradu.geom,
    geometry_curve_view_dshagc.geom;
-- SafeAltitudeAreaSectorPropertyType
-- ['geometry.surface_view', 'shared.obstruction_view', 'notes.note_view', 'shared.circlesector_view']
create or replace view procedure.safealtitudeareasector_view as
select
    procedure.safealtitudeareasector_pt.id,
    procedure.safealtitudeareasector_pt.nilreason AS safealtitudeareasector_nilreason,
    coalesce(cast(procedure.safealtitudeareasector.bufferwidth_value as varchar) || ' ' || procedure.safealtitudeareasector.bufferwidth_uom, '(' || procedure.safealtitudeareasector.bufferwidth_nilreason || ')') as bufferwidth,
    geometry_surface_view_vebfma.geom AS geom,
    shared_circlesector_view_wlhqri.id AS sectordefinition,
    jsonb_agg(shared_obstruction_view_bxbtpf.id) AS significantobstacle,
    jsonb_agg(notes_note_view_wuskvk.*) AS safealtitudeareasector_annotation
from procedure.safealtitudeareasector_pt 
inner join procedure.safealtitudeareasector on procedure.safealtitudeareasector_pt.safealtitudeareasector_id = procedure.safealtitudeareasector.id
left join geometry.surface_view geometry_surface_view_vebfma on procedure.safealtitudeareasector.extent_id = geometry_surface_view_vebfma.id
left join shared.circlesector_view shared_circlesector_view_wlhqri on procedure.safealtitudeareasector.sectordefinition_id = shared_circlesector_view_wlhqri.id
left join master_join master_join_zlmzae on procedure.safealtitudeareasector.id = master_join_zlmzae.source_id
left join shared.obstruction_view shared_obstruction_view_bxbtpf on master_join_zlmzae.target_id = shared_obstruction_view_bxbtpf.id
left join master_join master_join_yymhgj on procedure.safealtitudeareasector.id = master_join_yymhgj.source_id
left join notes.note_view notes_note_view_wuskvk on master_join_yymhgj.target_id = notes_note_view_wuskvk.id
group by
    procedure.safealtitudeareasector_pt.id,
    procedure.safealtitudeareasector_pt.nilreason,
    procedure.safealtitudeareasector.bufferwidth_value,
    procedure.safealtitudeareasector.bufferwidth_uom,
    procedure.safealtitudeareasector.bufferwidth_nilreason,
    geometry_surface_view_vebfma.geom,
    shared_circlesector_view_wlhqri.id;
-- TerminalArrivalAreaSectorPropertyType
-- ['geometry.surface_view', 'shared.obstruction_view', 'notes.note_view', 'shared.circlesector_view']
create or replace view procedure.terminalarrivalareasector_view as
select
    procedure.terminalarrivalareasector_pt.id,
    procedure.terminalarrivalareasector_pt.nilreason AS terminalarrivalareasector_nilreason,
    coalesce(cast(procedure.terminalarrivalareasector.flybycode_value as varchar), '(' || procedure.terminalarrivalareasector.flybycode_nilreason || ')') as flybycode,
    coalesce(cast(procedure.terminalarrivalareasector.procedureturnrequired_value as varchar), '(' || procedure.terminalarrivalareasector.procedureturnrequired_nilreason || ')') as procedureturnrequired,
    coalesce(cast(procedure.terminalarrivalareasector.altitudedescription_value as varchar), '(' || procedure.terminalarrivalareasector.altitudedescription_nilreason || ')') as altitudedescription,
    shared_circlesector_view_cvykqk.id AS sectordefinition,
    geometry_surface_view_cmbzrn.geom AS geom,
    jsonb_agg(shared_obstruction_view_lrfmoa.id) AS significantobstacle,
    jsonb_agg(notes_note_view_anbwai.*) AS terminalarrivalareasector_annotation
from procedure.terminalarrivalareasector_pt 
inner join procedure.terminalarrivalareasector on procedure.terminalarrivalareasector_pt.terminalarrivalareasector_id = procedure.terminalarrivalareasector.id
left join shared.circlesector_view shared_circlesector_view_cvykqk on procedure.terminalarrivalareasector.sectordefinition_id = shared_circlesector_view_cvykqk.id
left join geometry.surface_view geometry_surface_view_cmbzrn on procedure.terminalarrivalareasector.extent_id = geometry_surface_view_cmbzrn.id
left join master_join master_join_afudrl on procedure.terminalarrivalareasector.id = master_join_afudrl.source_id
left join shared.obstruction_view shared_obstruction_view_lrfmoa on master_join_afudrl.target_id = shared_obstruction_view_lrfmoa.id
left join master_join master_join_yrldgo on procedure.terminalarrivalareasector.id = master_join_yrldgo.source_id
left join notes.note_view notes_note_view_anbwai on master_join_yrldgo.target_id = notes_note_view_anbwai.id
group by
    procedure.terminalarrivalareasector_pt.id,
    procedure.terminalarrivalareasector_pt.nilreason,
    procedure.terminalarrivalareasector.flybycode_value,
    procedure.terminalarrivalareasector.flybycode_nilreason,
    procedure.terminalarrivalareasector.procedureturnrequired_value,
    procedure.terminalarrivalareasector.procedureturnrequired_nilreason,
    procedure.terminalarrivalareasector.altitudedescription_value,
    procedure.terminalarrivalareasector.altitudedescription_nilreason,
    shared_circlesector_view_cvykqk.id,
    geometry_surface_view_cmbzrn.geom;
-- FlightRoutingElementPropertyType
-- ['routes.flightrestrictionlevel_view', 'geometry.point_view', 'routes.directflightsegment_view', 'notes.note_view', 'routes.routeportion_view']
create or replace view routes.flightroutingelement_view as
select
    routes.flightroutingelement_pt.id,
    routes.flightroutingelement_pt.nilreason AS flightroutingelement_nilreason,
    coalesce(cast(routes.flightroutingelement.ordernumber_value as varchar), '(' || routes.flightroutingelement.ordernumber_nilreason || ')') as ordernumber,
    coalesce(cast(routes.flightroutingelement.speedreference_value as varchar), '(' || routes.flightroutingelement.speedreference_nilreason || ')') as speedreference,
    coalesce(cast(routes.flightroutingelement.speedcriteria_value as varchar), '(' || routes.flightroutingelement.speedcriteria_nilreason || ')') as speedcriteria,
    coalesce(cast(routes.flightroutingelement.speed_value as varchar) || ' ' || routes.flightroutingelement.speed_uom, '(' || routes.flightroutingelement.speed_nilreason || ')') as speed,
    coalesce(cast(procedure_standardinstrumentarrival_pt_pnnfsf.title as varchar), '(' || procedure_standardinstrumentarrival_pt_pnnfsf.nilreason[1] || ')') AS elementstandardinstrumentarrivalelement,
    procedure_standardinstrumentarrival_pt_pnnfsf.href AS elementstandardinstrumentarrivalelement_href,
    coalesce(cast(airspace_airspace_pt_hvmymn.title as varchar), '(' || airspace_airspace_pt_hvmymn.nilreason[1] || ')') AS elementairspaceelement,
    airspace_airspace_pt_hvmymn.href AS elementairspaceelement_href,
    coalesce(cast(navaids_points_designatedpoint_pt_vxcxqr.title as varchar), '(' || navaids_points_designatedpoint_pt_vxcxqr.nilreason[1] || ')') AS pointelementfixdesignatedpoint,
    navaids_points_designatedpoint_pt_vxcxqr.href AS pointelementfixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_zdphzp.title as varchar), '(' || navaids_points_navaid_pt_zdphzp.nilreason[1] || ')') AS pointelementnavaidsystem,
    navaids_points_navaid_pt_zdphzp.href AS pointelementnavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_mhoybw.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_mhoybw.nilreason[1] || ')') AS pointelementaimingpoint,
    airport_heliport_touchdownliftoff_pt_mhoybw.href AS pointelementaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_gygcsn.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_gygcsn.nilreason[1] || ')') AS pointelementrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_gygcsn.href AS pointelementrunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_nsqjyd.title as varchar), '(' || airport_heliport_airportheliport_pt_nsqjyd.nilreason[1] || ')') AS pointelementairportreferencepoint,
    airport_heliport_airportheliport_pt_nsqjyd.href AS pointelementairportreferencepoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_cbstno.title as varchar), '(' || airport_heliport_airportheliport_pt_cbstno.nilreason[1] || ')') AS elementairportheliportelement,
    airport_heliport_airportheliport_pt_cbstno.href AS elementairportheliportelement_href,
    geometry_point_view_rfzpsd.geom AS geom,
    ST_X(geometry_point_view_rfzpsd.geom) AS longitude,
    ST_Y(geometry_point_view_rfzpsd.geom) AS latitude,
    geometry_point_view_rfzpsd.horizontalAccuracy,
    routes_directflightsegment_view_akttfy.id AS elementdirectflightelement,
    coalesce(cast(procedure_standardinstrumentdeparture_pt_aditpl.title as varchar), '(' || procedure_standardinstrumentdeparture_pt_aditpl.nilreason[1] || ')') AS elementstandardinstrumentdepartureelement,
    procedure_standardinstrumentdeparture_pt_aditpl.href AS elementstandardinstrumentdepartureelement_href,
    routes_routeportion_view_shetya.id AS elementrouteportionelement,
    coalesce(cast(aerial_refuelling_aerialrefuelling_pt_zknpko.title as varchar), '(' || aerial_refuelling_aerialrefuelling_pt_zknpko.nilreason[1] || ')') AS elementaerialrefuellingelement,
    aerial_refuelling_aerialrefuelling_pt_zknpko.href AS elementaerialrefuellingelement_href,
    jsonb_agg(routes_flightrestrictionlevel_view_lvanvx.id) AS flightlevel,
    jsonb_agg(notes_note_view_nnlxkj.*) AS flightroutingelement_annotation
from routes.flightroutingelement_pt 
inner join routes.flightroutingelement on routes.flightroutingelement_pt.flightroutingelement_id = routes.flightroutingelement.id
left join procedure.standardinstrumentarrival_pt procedure_standardinstrumentarrival_pt_pnnfsf on routes.flightroutingelement.element_standardinstrumentarrivalelement_id = procedure_standardinstrumentarrival_pt_pnnfsf.id
left join airspace.airspace_pt airspace_airspace_pt_hvmymn on routes.flightroutingelement.element_airspaceelement_id = airspace_airspace_pt_hvmymn.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_vxcxqr on routes.flightroutingelement.pointelement_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_vxcxqr.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_zdphzp on routes.flightroutingelement.pointelement_navaidsystem_id = navaids_points_navaid_pt_zdphzp.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_mhoybw on routes.flightroutingelement.pointelement_aimingpoint_id = airport_heliport_touchdownliftoff_pt_mhoybw.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_gygcsn on routes.flightroutingelement.pointelement_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_gygcsn.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_nsqjyd on routes.flightroutingelement.pointelement_airportreferencepoint_id = airport_heliport_airportheliport_pt_nsqjyd.id
left join geometry.point_view geometry_point_view_rfzpsd on routes.flightroutingelement.pointelement_position_id = geometry_point_view_rfzpsd.id
left join routes.directflightsegment_view routes_directflightsegment_view_akttfy on routes.flightroutingelement.element_directflightelement_id = routes_directflightsegment_view_akttfy.id
left join procedure.standardinstrumentdeparture_pt procedure_standardinstrumentdeparture_pt_aditpl on routes.flightroutingelement.element_standardinstrumentdepartureelement_id = procedure_standardinstrumentdeparture_pt_aditpl.id
left join routes.routeportion_view routes_routeportion_view_shetya on routes.flightroutingelement.element_routeportionelement_id = routes_routeportion_view_shetya.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_cbstno on routes.flightroutingelement.element_airportheliportelement_id = airport_heliport_airportheliport_pt_cbstno.id
left join aerial_refuelling.aerialrefuelling_pt aerial_refuelling_aerialrefuelling_pt_zknpko on routes.flightroutingelement.element_aerialrefuellingelement_id = aerial_refuelling_aerialrefuelling_pt_zknpko.id
left join master_join master_join_gxdtnk on routes.flightroutingelement.id = master_join_gxdtnk.source_id
left join routes.flightrestrictionlevel_view routes_flightrestrictionlevel_view_lvanvx on master_join_gxdtnk.target_id = routes_flightrestrictionlevel_view_lvanvx.id
left join master_join master_join_lqdvvg on routes.flightroutingelement.id = master_join_lqdvvg.source_id
left join notes.note_view notes_note_view_nnlxkj on master_join_lqdvvg.target_id = notes_note_view_nnlxkj.id
group by
    routes.flightroutingelement_pt.id,
    routes.flightroutingelement_pt.nilreason,
    routes.flightroutingelement.ordernumber_value,
    routes.flightroutingelement.ordernumber_nilreason,
    routes.flightroutingelement.speedreference_value,
    routes.flightroutingelement.speedreference_nilreason,
    routes.flightroutingelement.speedcriteria_value,
    routes.flightroutingelement.speedcriteria_nilreason,
    routes.flightroutingelement.speed_value,
    routes.flightroutingelement.speed_uom,
    routes.flightroutingelement.speed_nilreason,
    procedure_standardinstrumentarrival_pt_pnnfsf.title,
    procedure_standardinstrumentarrival_pt_pnnfsf.nilreason[1],
    procedure_standardinstrumentarrival_pt_pnnfsf.href,
    airspace_airspace_pt_hvmymn.title,
    airspace_airspace_pt_hvmymn.nilreason[1],
    airspace_airspace_pt_hvmymn.href,
    navaids_points_designatedpoint_pt_vxcxqr.title,
    navaids_points_designatedpoint_pt_vxcxqr.nilreason[1],
    navaids_points_designatedpoint_pt_vxcxqr.href,
    navaids_points_navaid_pt_zdphzp.title,
    navaids_points_navaid_pt_zdphzp.nilreason[1],
    navaids_points_navaid_pt_zdphzp.href,
    airport_heliport_touchdownliftoff_pt_mhoybw.title,
    airport_heliport_touchdownliftoff_pt_mhoybw.nilreason[1],
    airport_heliport_touchdownliftoff_pt_mhoybw.href,
    airport_heliport_runwaycentrelinepoint_pt_gygcsn.title,
    airport_heliport_runwaycentrelinepoint_pt_gygcsn.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_gygcsn.href,
    airport_heliport_airportheliport_pt_nsqjyd.title,
    airport_heliport_airportheliport_pt_nsqjyd.nilreason[1],
    airport_heliport_airportheliport_pt_nsqjyd.href,
    geometry_point_view_rfzpsd.geom,
    geometry_point_view_rfzpsd.horizontalAccuracy,
    routes_directflightsegment_view_akttfy.id,
    procedure_standardinstrumentdeparture_pt_aditpl.title,
    procedure_standardinstrumentdeparture_pt_aditpl.nilreason[1],
    procedure_standardinstrumentdeparture_pt_aditpl.href,
    routes_routeportion_view_shetya.id,
    airport_heliport_airportheliport_pt_cbstno.title,
    airport_heliport_airportheliport_pt_cbstno.nilreason[1],
    airport_heliport_airportheliport_pt_cbstno.href,
    aerial_refuelling_aerialrefuelling_pt_zknpko.title,
    aerial_refuelling_aerialrefuelling_pt_zknpko.nilreason[1],
    aerial_refuelling_aerialrefuelling_pt_zknpko.href;
-- AirspaceGeometryComponentPropertyType
-- ['notes.note_view', 'airspace.airspacevolume_view']
create or replace view airspace.airspacegeometrycomponent_view as
select
    airspace.airspacegeometrycomponent_pt.id,
    airspace.airspacegeometrycomponent_pt.nilreason AS airspacegeometrycomponent_nilreason,
    coalesce(cast(airspace.airspacegeometrycomponent.operation_value as varchar), '(' || airspace.airspacegeometrycomponent.operation_nilreason || ')') as operation,
    coalesce(cast(airspace.airspacegeometrycomponent.operationsequence_value as varchar), '(' || airspace.airspacegeometrycomponent.operationsequence_nilreason || ')') as operationsequence,
    airspace_airspacevolume_view_zflaym.id AS theairspacevolume,
    jsonb_agg(notes_note_view_rqnrfh.*) AS airspacegeometrycomponent_annotation
from airspace.airspacegeometrycomponent_pt 
inner join airspace.airspacegeometrycomponent on airspace.airspacegeometrycomponent_pt.airspacegeometrycomponent_id = airspace.airspacegeometrycomponent.id
left join airspace.airspacevolume_view airspace_airspacevolume_view_zflaym on airspace.airspacegeometrycomponent.theairspacevolume_id = airspace_airspacevolume_view_zflaym.id
left join master_join master_join_jjixym on airspace.airspacegeometrycomponent.id = master_join_jjixym.source_id
left join notes.note_view notes_note_view_rqnrfh on master_join_jjixym.target_id = notes_note_view_rqnrfh.id
group by
    airspace.airspacegeometrycomponent_pt.id,
    airspace.airspacegeometrycomponent_pt.nilreason,
    airspace.airspacegeometrycomponent.operation_value,
    airspace.airspacegeometrycomponent.operation_nilreason,
    airspace.airspacegeometrycomponent.operationsequence_value,
    airspace.airspacegeometrycomponent.operationsequence_nilreason,
    airspace_airspacevolume_view_zflaym.id;
-- AerialRefuellingPointPropertyType
-- ['navaids_points.pointreference_view', 'geometry.point_view', 'notes.note_view']
create or replace view aerial_refuelling.aerialrefuellingpoint_view as
select
    aerial_refuelling.aerialrefuellingpoint_pt.id,
    aerial_refuelling.aerialrefuellingpoint_pt.nilreason AS aerialrefuellingpoint_nilreason,
    coalesce(cast(aerial_refuelling.aerialrefuellingpoint.reportingatc_value as varchar), '(' || aerial_refuelling.aerialrefuellingpoint.reportingatc_nilreason || ')') as reportingatc,
    coalesce(cast(aerial_refuelling.aerialrefuellingpoint.flyover_value as varchar), '(' || aerial_refuelling.aerialrefuellingpoint.flyover_nilreason || ')') as flyover,
    coalesce(cast(aerial_refuelling.aerialrefuellingpoint.waypoint_value as varchar), '(' || aerial_refuelling.aerialrefuellingpoint.waypoint_nilreason || ')') as waypoint,
    coalesce(cast(aerial_refuelling.aerialrefuellingpoint.radarguidance_value as varchar), '(' || aerial_refuelling.aerialrefuellingpoint.radarguidance_nilreason || ')') as radarguidance,
    coalesce(cast(aerial_refuelling.aerialrefuellingpoint.sequence_value as varchar), '(' || aerial_refuelling.aerialrefuellingpoint.sequence_nilreason || ')') as sequence,
    coalesce(cast(aerial_refuelling.aerialrefuellingpoint.usagetype_value as varchar), '(' || aerial_refuelling.aerialrefuellingpoint.usagetype_nilreason || ')') as usagetype,
    coalesce(cast(navaids_points_designatedpoint_pt_hyjddk.title as varchar), '(' || navaids_points_designatedpoint_pt_hyjddk.nilreason[1] || ')') AS pointchoicefixdesignatedpoint,
    navaids_points_designatedpoint_pt_hyjddk.href AS pointchoicefixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_ffjbca.title as varchar), '(' || navaids_points_navaid_pt_ffjbca.nilreason[1] || ')') AS pointchoicenavaidsystem,
    navaids_points_navaid_pt_ffjbca.href AS pointchoicenavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_sedfhl.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_sedfhl.nilreason[1] || ')') AS pointchoiceaimingpoint,
    airport_heliport_touchdownliftoff_pt_sedfhl.href AS pointchoiceaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_mjzkry.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_mjzkry.nilreason[1] || ')') AS pointchoicerunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_mjzkry.href AS pointchoicerunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_qlfqio.title as varchar), '(' || airport_heliport_airportheliport_pt_qlfqio.nilreason[1] || ')') AS pointchoiceairportreferencepoint,
    airport_heliport_airportheliport_pt_qlfqio.href AS pointchoiceairportreferencepoint_href,
    geometry_point_view_antcyb.geom AS geom,
    ST_X(geometry_point_view_antcyb.geom) AS longitude,
    ST_Y(geometry_point_view_antcyb.geom) AS latitude,
    geometry_point_view_antcyb.horizontalAccuracy,
    coalesce(cast(shared_radiofrequencyarea_pt_qxehmw.title as varchar), '(' || shared_radiofrequencyarea_pt_qxehmw.nilreason[1] || ')') AS extendedservicevolume,
    shared_radiofrequencyarea_pt_qxehmw.href AS extendedservicevolume_href,
    jsonb_agg(navaids_points_pointreference_view_obmzkt.id) AS facilitymakeup,
    jsonb_agg(notes_note_view_cmtglv.*) AS aerialrefuellingpoint_annotation
from aerial_refuelling.aerialrefuellingpoint_pt 
inner join aerial_refuelling.aerialrefuellingpoint on aerial_refuelling.aerialrefuellingpoint_pt.aerialrefuellingpoint_id = aerial_refuelling.aerialrefuellingpoint.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_hyjddk on aerial_refuelling.aerialrefuellingpoint.aerialrefuellingpoint_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_hyjddk.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_ffjbca on aerial_refuelling.aerialrefuellingpoint.aerialrefuellingpoint_navaidsystem_id = navaids_points_navaid_pt_ffjbca.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_sedfhl on aerial_refuelling.aerialrefuellingpoint.aerialrefuellingpoint_aimingpoint_id = airport_heliport_touchdownliftoff_pt_sedfhl.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_mjzkry on aerial_refuelling.aerialrefuellingpoint.aerialrefuellingpoint_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_mjzkry.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_qlfqio on aerial_refuelling.aerialrefuellingpoint.aerialrefuellingpoint_airportreferencepoint_id = airport_heliport_airportheliport_pt_qlfqio.id
left join geometry.point_view geometry_point_view_antcyb on aerial_refuelling.aerialrefuellingpoint.aerialrefuellingpoint_position_id = geometry_point_view_antcyb.id
left join shared.radiofrequencyarea_pt shared_radiofrequencyarea_pt_qxehmw on aerial_refuelling.aerialrefuellingpoint.extendedservicevolume_id = shared_radiofrequencyarea_pt_qxehmw.id
left join master_join master_join_hajzyo on aerial_refuelling.aerialrefuellingpoint.id = master_join_hajzyo.source_id
left join navaids_points.pointreference_view navaids_points_pointreference_view_obmzkt on master_join_hajzyo.target_id = navaids_points_pointreference_view_obmzkt.id
left join master_join master_join_elgpvo on aerial_refuelling.aerialrefuellingpoint.id = master_join_elgpvo.source_id
left join notes.note_view notes_note_view_cmtglv on master_join_elgpvo.target_id = notes_note_view_cmtglv.id
group by
    aerial_refuelling.aerialrefuellingpoint_pt.id,
    aerial_refuelling.aerialrefuellingpoint_pt.nilreason,
    aerial_refuelling.aerialrefuellingpoint.reportingatc_value,
    aerial_refuelling.aerialrefuellingpoint.reportingatc_nilreason,
    aerial_refuelling.aerialrefuellingpoint.flyover_value,
    aerial_refuelling.aerialrefuellingpoint.flyover_nilreason,
    aerial_refuelling.aerialrefuellingpoint.waypoint_value,
    aerial_refuelling.aerialrefuellingpoint.waypoint_nilreason,
    aerial_refuelling.aerialrefuellingpoint.radarguidance_value,
    aerial_refuelling.aerialrefuellingpoint.radarguidance_nilreason,
    aerial_refuelling.aerialrefuellingpoint.sequence_value,
    aerial_refuelling.aerialrefuellingpoint.sequence_nilreason,
    aerial_refuelling.aerialrefuellingpoint.usagetype_value,
    aerial_refuelling.aerialrefuellingpoint.usagetype_nilreason,
    navaids_points_designatedpoint_pt_hyjddk.title,
    navaids_points_designatedpoint_pt_hyjddk.nilreason[1],
    navaids_points_designatedpoint_pt_hyjddk.href,
    navaids_points_navaid_pt_ffjbca.title,
    navaids_points_navaid_pt_ffjbca.nilreason[1],
    navaids_points_navaid_pt_ffjbca.href,
    airport_heliport_touchdownliftoff_pt_sedfhl.title,
    airport_heliport_touchdownliftoff_pt_sedfhl.nilreason[1],
    airport_heliport_touchdownliftoff_pt_sedfhl.href,
    airport_heliport_runwaycentrelinepoint_pt_mjzkry.title,
    airport_heliport_runwaycentrelinepoint_pt_mjzkry.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_mjzkry.href,
    airport_heliport_airportheliport_pt_qlfqio.title,
    airport_heliport_airportheliport_pt_qlfqio.nilreason[1],
    airport_heliport_airportheliport_pt_qlfqio.href,
    geometry_point_view_antcyb.geom,
    geometry_point_view_antcyb.horizontalAccuracy,
    shared_radiofrequencyarea_pt_qxehmw.title,
    shared_radiofrequencyarea_pt_qxehmw.nilreason[1],
    shared_radiofrequencyarea_pt_qxehmw.href;
-- EnRouteSegmentPointPropertyType
-- ['navaids_points.pointreference_view', 'geometry.point_view', 'notes.note_view']
create or replace view navaids_points.enroutesegmentpoint_view as
select
    navaids_points.enroutesegmentpoint_pt.id,
    navaids_points.enroutesegmentpoint_pt.nilreason AS enroutesegmentpoint_nilreason,
    coalesce(cast(navaids_points.enroutesegmentpoint.reportingatc_value as varchar), '(' || navaids_points.enroutesegmentpoint.reportingatc_nilreason || ')') as reportingatc,
    coalesce(cast(navaids_points.enroutesegmentpoint.flyover_value as varchar), '(' || navaids_points.enroutesegmentpoint.flyover_nilreason || ')') as flyover,
    coalesce(cast(navaids_points.enroutesegmentpoint.waypoint_value as varchar), '(' || navaids_points.enroutesegmentpoint.waypoint_nilreason || ')') as waypoint,
    coalesce(cast(navaids_points.enroutesegmentpoint.radarguidance_value as varchar), '(' || navaids_points.enroutesegmentpoint.radarguidance_nilreason || ')') as radarguidance,
    coalesce(cast(navaids_points.enroutesegmentpoint.rolefreeflight_value as varchar), '(' || navaids_points.enroutesegmentpoint.rolefreeflight_nilreason || ')') as rolefreeflight,
    coalesce(cast(navaids_points.enroutesegmentpoint.rolervsm_value as varchar), '(' || navaids_points.enroutesegmentpoint.rolervsm_nilreason || ')') as rolervsm,
    coalesce(cast(navaids_points.enroutesegmentpoint.rolemilitarytraining_value as varchar), '(' || navaids_points.enroutesegmentpoint.rolemilitarytraining_nilreason || ')') as rolemilitarytraining,
    coalesce(cast(navaids_points.enroutesegmentpoint.turnradius_value as varchar) || ' ' || navaids_points.enroutesegmentpoint.turnradius_uom, '(' || navaids_points.enroutesegmentpoint.turnradius_nilreason || ')') as turnradius,
    coalesce(cast(navaids_points_designatedpoint_pt_iqxpti.title as varchar), '(' || navaids_points_designatedpoint_pt_iqxpti.nilreason[1] || ')') AS pointchoicefixdesignatedpoint,
    navaids_points_designatedpoint_pt_iqxpti.href AS pointchoicefixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_mudrfl.title as varchar), '(' || navaids_points_navaid_pt_mudrfl.nilreason[1] || ')') AS pointchoicenavaidsystem,
    navaids_points_navaid_pt_mudrfl.href AS pointchoicenavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_rxrhkr.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_rxrhkr.nilreason[1] || ')') AS pointchoiceaimingpoint,
    airport_heliport_touchdownliftoff_pt_rxrhkr.href AS pointchoiceaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_otmaoc.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_otmaoc.nilreason[1] || ')') AS pointchoicerunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_otmaoc.href AS pointchoicerunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_yjyguh.title as varchar), '(' || airport_heliport_airportheliport_pt_yjyguh.nilreason[1] || ')') AS pointchoiceairportreferencepoint,
    airport_heliport_airportheliport_pt_yjyguh.href AS pointchoiceairportreferencepoint_href,
    geometry_point_view_dzdivj.geom AS geom,
    ST_X(geometry_point_view_dzdivj.geom) AS longitude,
    ST_Y(geometry_point_view_dzdivj.geom) AS latitude,
    geometry_point_view_dzdivj.horizontalAccuracy,
    coalesce(cast(shared_radiofrequencyarea_pt_bbecop.title as varchar), '(' || shared_radiofrequencyarea_pt_bbecop.nilreason[1] || ')') AS extendedservicevolume,
    shared_radiofrequencyarea_pt_bbecop.href AS extendedservicevolume_href,
    jsonb_agg(navaids_points_pointreference_view_enzdga.id) AS facilitymakeup,
    jsonb_agg(notes_note_view_kmwkjh.*) AS enroutesegmentpoint_annotation
from navaids_points.enroutesegmentpoint_pt 
inner join navaids_points.enroutesegmentpoint on navaids_points.enroutesegmentpoint_pt.enroutesegmentpoint_id = navaids_points.enroutesegmentpoint.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_iqxpti on navaids_points.enroutesegmentpoint.enroutesegmentpoint_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_iqxpti.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_mudrfl on navaids_points.enroutesegmentpoint.enroutesegmentpoint_navaidsystem_id = navaids_points_navaid_pt_mudrfl.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_rxrhkr on navaids_points.enroutesegmentpoint.enroutesegmentpoint_aimingpoint_id = airport_heliport_touchdownliftoff_pt_rxrhkr.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_otmaoc on navaids_points.enroutesegmentpoint.enroutesegmentpoint_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_otmaoc.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_yjyguh on navaids_points.enroutesegmentpoint.enroutesegmentpoint_airportreferencepoint_id = airport_heliport_airportheliport_pt_yjyguh.id
left join geometry.point_view geometry_point_view_dzdivj on navaids_points.enroutesegmentpoint.enroutesegmentpoint_position_id = geometry_point_view_dzdivj.id
left join shared.radiofrequencyarea_pt shared_radiofrequencyarea_pt_bbecop on navaids_points.enroutesegmentpoint.extendedservicevolume_id = shared_radiofrequencyarea_pt_bbecop.id
left join master_join master_join_tvxyze on navaids_points.enroutesegmentpoint.id = master_join_tvxyze.source_id
left join navaids_points.pointreference_view navaids_points_pointreference_view_enzdga on master_join_tvxyze.target_id = navaids_points_pointreference_view_enzdga.id
left join master_join master_join_zfvbcn on navaids_points.enroutesegmentpoint.id = master_join_zfvbcn.source_id
left join notes.note_view notes_note_view_kmwkjh on master_join_zfvbcn.target_id = notes_note_view_kmwkjh.id
group by
    navaids_points.enroutesegmentpoint_pt.id,
    navaids_points.enroutesegmentpoint_pt.nilreason,
    navaids_points.enroutesegmentpoint.reportingatc_value,
    navaids_points.enroutesegmentpoint.reportingatc_nilreason,
    navaids_points.enroutesegmentpoint.flyover_value,
    navaids_points.enroutesegmentpoint.flyover_nilreason,
    navaids_points.enroutesegmentpoint.waypoint_value,
    navaids_points.enroutesegmentpoint.waypoint_nilreason,
    navaids_points.enroutesegmentpoint.radarguidance_value,
    navaids_points.enroutesegmentpoint.radarguidance_nilreason,
    navaids_points.enroutesegmentpoint.rolefreeflight_value,
    navaids_points.enroutesegmentpoint.rolefreeflight_nilreason,
    navaids_points.enroutesegmentpoint.rolervsm_value,
    navaids_points.enroutesegmentpoint.rolervsm_nilreason,
    navaids_points.enroutesegmentpoint.rolemilitarytraining_value,
    navaids_points.enroutesegmentpoint.rolemilitarytraining_nilreason,
    navaids_points.enroutesegmentpoint.turnradius_value,
    navaids_points.enroutesegmentpoint.turnradius_uom,
    navaids_points.enroutesegmentpoint.turnradius_nilreason,
    navaids_points_designatedpoint_pt_iqxpti.title,
    navaids_points_designatedpoint_pt_iqxpti.nilreason[1],
    navaids_points_designatedpoint_pt_iqxpti.href,
    navaids_points_navaid_pt_mudrfl.title,
    navaids_points_navaid_pt_mudrfl.nilreason[1],
    navaids_points_navaid_pt_mudrfl.href,
    airport_heliport_touchdownliftoff_pt_rxrhkr.title,
    airport_heliport_touchdownliftoff_pt_rxrhkr.nilreason[1],
    airport_heliport_touchdownliftoff_pt_rxrhkr.href,
    airport_heliport_runwaycentrelinepoint_pt_otmaoc.title,
    airport_heliport_runwaycentrelinepoint_pt_otmaoc.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_otmaoc.href,
    airport_heliport_airportheliport_pt_yjyguh.title,
    airport_heliport_airportheliport_pt_yjyguh.nilreason[1],
    airport_heliport_airportheliport_pt_yjyguh.href,
    geometry_point_view_dzdivj.geom,
    geometry_point_view_dzdivj.horizontalAccuracy,
    shared_radiofrequencyarea_pt_bbecop.title,
    shared_radiofrequencyarea_pt_bbecop.nilreason[1],
    shared_radiofrequencyarea_pt_bbecop.href;
-- TerminalSegmentPointPropertyType
-- ['navaids_points.pointreference_view', 'geometry.point_view', 'notes.note_view']
create or replace view navaids_points.terminalsegmentpoint_view as
select
    navaids_points.terminalsegmentpoint_pt.id,
    navaids_points.terminalsegmentpoint_pt.nilreason AS terminalsegmentpoint_nilreason,
    coalesce(cast(navaids_points.terminalsegmentpoint.reportingatc_value as varchar), '(' || navaids_points.terminalsegmentpoint.reportingatc_nilreason || ')') as reportingatc,
    coalesce(cast(navaids_points.terminalsegmentpoint.flyover_value as varchar), '(' || navaids_points.terminalsegmentpoint.flyover_nilreason || ')') as flyover,
    coalesce(cast(navaids_points.terminalsegmentpoint.waypoint_value as varchar), '(' || navaids_points.terminalsegmentpoint.waypoint_nilreason || ')') as waypoint,
    coalesce(cast(navaids_points.terminalsegmentpoint.radarguidance_value as varchar), '(' || navaids_points.terminalsegmentpoint.radarguidance_nilreason || ')') as radarguidance,
    coalesce(cast(navaids_points.terminalsegmentpoint.role_value as varchar), '(' || navaids_points.terminalsegmentpoint.role_nilreason || ')') as role,
    coalesce(cast(navaids_points.terminalsegmentpoint.leadradial_value as varchar), '(' || navaids_points.terminalsegmentpoint.leadradial_nilreason || ')') as leadradial,
    coalesce(cast(navaids_points.terminalsegmentpoint.indicatorfacf_value as varchar), '(' || navaids_points.terminalsegmentpoint.indicatorfacf_nilreason || ')') as indicatorfacf,
    coalesce(cast(navaids_points.terminalsegmentpoint.leaddme_value as varchar) || ' ' || navaids_points.terminalsegmentpoint.leaddme_uom, '(' || navaids_points.terminalsegmentpoint.leaddme_nilreason || ')') as leaddme,
    coalesce(cast(navaids_points_designatedpoint_pt_rvvaec.title as varchar), '(' || navaids_points_designatedpoint_pt_rvvaec.nilreason[1] || ')') AS pointchoicefixdesignatedpoint,
    navaids_points_designatedpoint_pt_rvvaec.href AS pointchoicefixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_eaxrzu.title as varchar), '(' || navaids_points_navaid_pt_eaxrzu.nilreason[1] || ')') AS pointchoicenavaidsystem,
    navaids_points_navaid_pt_eaxrzu.href AS pointchoicenavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_mvtfxl.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_mvtfxl.nilreason[1] || ')') AS pointchoiceaimingpoint,
    airport_heliport_touchdownliftoff_pt_mvtfxl.href AS pointchoiceaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_kngvtu.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_kngvtu.nilreason[1] || ')') AS pointchoicerunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_kngvtu.href AS pointchoicerunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_mtakah.title as varchar), '(' || airport_heliport_airportheliport_pt_mtakah.nilreason[1] || ')') AS pointchoiceairportreferencepoint,
    airport_heliport_airportheliport_pt_mtakah.href AS pointchoiceairportreferencepoint_href,
    geometry_point_view_ullcwg.geom AS geom,
    ST_X(geometry_point_view_ullcwg.geom) AS longitude,
    ST_Y(geometry_point_view_ullcwg.geom) AS latitude,
    geometry_point_view_ullcwg.horizontalAccuracy,
    coalesce(cast(shared_radiofrequencyarea_pt_ulynfq.title as varchar), '(' || shared_radiofrequencyarea_pt_ulynfq.nilreason[1] || ')') AS extendedservicevolume,
    shared_radiofrequencyarea_pt_ulynfq.href AS extendedservicevolume_href,
    jsonb_agg(navaids_points_pointreference_view_ogdjvb.id) AS facilitymakeup,
    jsonb_agg(notes_note_view_krctbs.*) AS terminalsegmentpoint_annotation
from navaids_points.terminalsegmentpoint_pt 
inner join navaids_points.terminalsegmentpoint on navaids_points.terminalsegmentpoint_pt.terminalsegmentpoint_id = navaids_points.terminalsegmentpoint.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_rvvaec on navaids_points.terminalsegmentpoint.terminalsegmentpoint_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_rvvaec.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_eaxrzu on navaids_points.terminalsegmentpoint.terminalsegmentpoint_navaidsystem_id = navaids_points_navaid_pt_eaxrzu.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_mvtfxl on navaids_points.terminalsegmentpoint.terminalsegmentpoint_aimingpoint_id = airport_heliport_touchdownliftoff_pt_mvtfxl.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_kngvtu on navaids_points.terminalsegmentpoint.terminalsegmentpoint_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_kngvtu.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_mtakah on navaids_points.terminalsegmentpoint.terminalsegmentpoint_airportreferencepoint_id = airport_heliport_airportheliport_pt_mtakah.id
left join geometry.point_view geometry_point_view_ullcwg on navaids_points.terminalsegmentpoint.terminalsegmentpoint_position_id = geometry_point_view_ullcwg.id
left join shared.radiofrequencyarea_pt shared_radiofrequencyarea_pt_ulynfq on navaids_points.terminalsegmentpoint.extendedservicevolume_id = shared_radiofrequencyarea_pt_ulynfq.id
left join master_join master_join_fjzqcp on navaids_points.terminalsegmentpoint.id = master_join_fjzqcp.source_id
left join navaids_points.pointreference_view navaids_points_pointreference_view_ogdjvb on master_join_fjzqcp.target_id = navaids_points_pointreference_view_ogdjvb.id
left join master_join master_join_iofdac on navaids_points.terminalsegmentpoint.id = master_join_iofdac.source_id
left join notes.note_view notes_note_view_krctbs on master_join_iofdac.target_id = notes_note_view_krctbs.id
group by
    navaids_points.terminalsegmentpoint_pt.id,
    navaids_points.terminalsegmentpoint_pt.nilreason,
    navaids_points.terminalsegmentpoint.reportingatc_value,
    navaids_points.terminalsegmentpoint.reportingatc_nilreason,
    navaids_points.terminalsegmentpoint.flyover_value,
    navaids_points.terminalsegmentpoint.flyover_nilreason,
    navaids_points.terminalsegmentpoint.waypoint_value,
    navaids_points.terminalsegmentpoint.waypoint_nilreason,
    navaids_points.terminalsegmentpoint.radarguidance_value,
    navaids_points.terminalsegmentpoint.radarguidance_nilreason,
    navaids_points.terminalsegmentpoint.role_value,
    navaids_points.terminalsegmentpoint.role_nilreason,
    navaids_points.terminalsegmentpoint.leadradial_value,
    navaids_points.terminalsegmentpoint.leadradial_nilreason,
    navaids_points.terminalsegmentpoint.indicatorfacf_value,
    navaids_points.terminalsegmentpoint.indicatorfacf_nilreason,
    navaids_points.terminalsegmentpoint.leaddme_value,
    navaids_points.terminalsegmentpoint.leaddme_uom,
    navaids_points.terminalsegmentpoint.leaddme_nilreason,
    navaids_points_designatedpoint_pt_rvvaec.title,
    navaids_points_designatedpoint_pt_rvvaec.nilreason[1],
    navaids_points_designatedpoint_pt_rvvaec.href,
    navaids_points_navaid_pt_eaxrzu.title,
    navaids_points_navaid_pt_eaxrzu.nilreason[1],
    navaids_points_navaid_pt_eaxrzu.href,
    airport_heliport_touchdownliftoff_pt_mvtfxl.title,
    airport_heliport_touchdownliftoff_pt_mvtfxl.nilreason[1],
    airport_heliport_touchdownliftoff_pt_mvtfxl.href,
    airport_heliport_runwaycentrelinepoint_pt_kngvtu.title,
    airport_heliport_runwaycentrelinepoint_pt_kngvtu.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_kngvtu.href,
    airport_heliport_airportheliport_pt_mtakah.title,
    airport_heliport_airportheliport_pt_mtakah.nilreason[1],
    airport_heliport_airportheliport_pt_mtakah.href,
    geometry_point_view_ullcwg.geom,
    geometry_point_view_ullcwg.horizontalAccuracy,
    shared_radiofrequencyarea_pt_ulynfq.title,
    shared_radiofrequencyarea_pt_ulynfq.nilreason[1],
    shared_radiofrequencyarea_pt_ulynfq.href;
-- LightElementPropertyType
-- ['shared.lightelementstatus_view', 'notes.note_view', 'geometry.elevatedpoint_view']
create or replace view shared.lightelement_view as
select
    shared.lightelement_pt.id,
    shared.lightelement_pt.nilreason AS lightelement_nilreason,
    coalesce(cast(shared.lightelement.colour_value as varchar), '(' || shared.lightelement.colour_nilreason || ')') as colour,
    coalesce(cast(shared.lightelement.intensitylevel_value as varchar), '(' || shared.lightelement.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(shared.lightelement.type_value as varchar), '(' || shared.lightelement.type_nilreason || ')') as type,
    coalesce(cast(shared.lightelement.intensity_value as varchar) || ' ' || shared.lightelement.intensity_uom, '(' || shared.lightelement.intensity_nilreason || ')') as intensity,
    geometry_elevatedpoint_view_ciiqea.geom AS geom,
    ST_X(geometry_elevatedpoint_view_ciiqea.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_ciiqea.geom) AS latitude,
    geometry_elevatedpoint_view_ciiqea.elevation,
    geometry_elevatedpoint_view_ciiqea.geoidUndulation,
    geometry_elevatedpoint_view_ciiqea.verticalDatum,
    geometry_elevatedpoint_view_ciiqea.verticalAccuracy,
    geometry_elevatedpoint_view_ciiqea.horizontalAccuracy,
    jsonb_agg(notes_note_view_cdxxro.*) AS lightelement_annotation,
    jsonb_agg(shared_lightelementstatus_view_eahkmn.id) AS availability
from shared.lightelement_pt 
inner join shared.lightelement on shared.lightelement_pt.lightelement_id = shared.lightelement.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_ciiqea on shared.lightelement.location_id = geometry_elevatedpoint_view_ciiqea.id
left join master_join master_join_qdacym on shared.lightelement.id = master_join_qdacym.source_id
left join notes.note_view notes_note_view_cdxxro on master_join_qdacym.target_id = notes_note_view_cdxxro.id
left join master_join master_join_mljwxx on shared.lightelement.id = master_join_mljwxx.source_id
left join shared.lightelementstatus_view shared_lightelementstatus_view_eahkmn on master_join_mljwxx.target_id = shared_lightelementstatus_view_eahkmn.id
group by
    shared.lightelement_pt.id,
    shared.lightelement_pt.nilreason,
    shared.lightelement.colour_value,
    shared.lightelement.colour_nilreason,
    shared.lightelement.intensitylevel_value,
    shared.lightelement.intensitylevel_nilreason,
    shared.lightelement.type_value,
    shared.lightelement.type_nilreason,
    shared.lightelement.intensity_value,
    shared.lightelement.intensity_uom,
    shared.lightelement.intensity_nilreason,
    geometry_elevatedpoint_view_ciiqea.geom,
    geometry_elevatedpoint_view_ciiqea.elevation,
    geometry_elevatedpoint_view_ciiqea.geoidUndulation,
    geometry_elevatedpoint_view_ciiqea.verticalDatum,
    geometry_elevatedpoint_view_ciiqea.verticalAccuracy,
    geometry_elevatedpoint_view_ciiqea.horizontalAccuracy;
-- RunwayDeclaredDistancePropertyType
-- ['notes.note_view', 'airport_heliport.runwaydeclareddistancevalue_view']
create or replace view airport_heliport.runwaydeclareddistance_view as
select
    airport_heliport.runwaydeclareddistance_pt.id,
    airport_heliport.runwaydeclareddistance_pt.nilreason AS runwaydeclareddistance_nilreason,
    coalesce(cast(airport_heliport.runwaydeclareddistance.type_value as varchar), '(' || airport_heliport.runwaydeclareddistance.type_nilreason || ')') as type,
    jsonb_agg(airport_heliport_runwaydeclareddistancevalue_view_pvrsrm.id) AS declaredvalue,
    jsonb_agg(notes_note_view_nnurrb.*) AS runwaydeclareddistance_annotation
from airport_heliport.runwaydeclareddistance_pt 
inner join airport_heliport.runwaydeclareddistance on airport_heliport.runwaydeclareddistance_pt.runwaydeclareddistance_id = airport_heliport.runwaydeclareddistance.id
left join master_join master_join_vxkhsz on airport_heliport.runwaydeclareddistance.id = master_join_vxkhsz.source_id
left join airport_heliport.runwaydeclareddistancevalue_view airport_heliport_runwaydeclareddistancevalue_view_pvrsrm on master_join_vxkhsz.target_id = airport_heliport_runwaydeclareddistancevalue_view_pvrsrm.id
left join master_join master_join_ylxhco on airport_heliport.runwaydeclareddistance.id = master_join_ylxhco.source_id
left join notes.note_view notes_note_view_nnurrb on master_join_ylxhco.target_id = notes_note_view_nnurrb.id
group by
    airport_heliport.runwaydeclareddistance_pt.id,
    airport_heliport.runwaydeclareddistance_pt.nilreason,
    airport_heliport.runwaydeclareddistance.type_value,
    airport_heliport.runwaydeclareddistance.type_nilreason;
-- ContactInformationPropertyType
-- ['shared.telephonecontact_view', 'shared.postaladdress_view', 'shared.onlinecontact_view', 'notes.note_view']
-- Snowflake SQL : ContactInformationPropertyType 
-- ApproachConditionPropertyType
-- ['procedure.circlingrestriction_view', 'procedure.minima_view', 'shared.aircraftcharacteristic_view', 'notes.note_view', 'shared.obstacleassessmentarea_view', 'procedure.landingtakeoffareacollection_view']
create or replace view procedure.approachcondition_view as
select
    procedure.approachcondition_pt.id,
    procedure.approachcondition_pt.nilreason AS approachcondition_nilreason,
    coalesce(cast(procedure.approachcondition.finalapproachpath_value as varchar), '(' || procedure.approachcondition.finalapproachpath_nilreason || ')') as finalapproachpath,
    coalesce(cast(procedure.approachcondition.requirednavigationperformance_value as varchar), '(' || procedure.approachcondition.requirednavigationperformance_nilreason || ')') as requirednavigationperformance,
    coalesce(cast(procedure.approachcondition.climbgradient_value as varchar), '(' || procedure.approachcondition.climbgradient_nilreason || ')') as climbgradient,
    procedure_minima_view_lgahmt.id AS minimumset,
    coalesce(cast(airport_heliport_altimetersource_pt_iphlmf.title as varchar), '(' || airport_heliport_altimetersource_pt_iphlmf.nilreason[1] || ')') AS altimeter,
    airport_heliport_altimetersource_pt_iphlmf.href AS altimeter_href,
    jsonb_agg(procedure_circlingrestriction_view_dbqmjm.id) AS circlingrestriction,
    jsonb_agg(shared_aircraftcharacteristic_view_wnhgzf.id) AS aircraftcategory,
    jsonb_agg(procedure_landingtakeoffareacollection_view_rcbqwy.id) AS landingarea,
    jsonb_agg(shared_obstacleassessmentarea_view_lymdrt.id) AS designsurface,
    jsonb_agg(notes_note_view_rejlkg.*) AS approachcondition_annotation
from procedure.approachcondition_pt 
inner join procedure.approachcondition on procedure.approachcondition_pt.approachcondition_id = procedure.approachcondition.id
left join procedure.minima_view procedure_minima_view_lgahmt on procedure.approachcondition.minimumset_id = procedure_minima_view_lgahmt.id
left join airport_heliport.altimetersource_pt airport_heliport_altimetersource_pt_iphlmf on procedure.approachcondition.altimeter_id = airport_heliport_altimetersource_pt_iphlmf.id
left join master_join master_join_awegju on procedure.approachcondition.id = master_join_awegju.source_id
left join procedure.circlingrestriction_view procedure_circlingrestriction_view_dbqmjm on master_join_awegju.target_id = procedure_circlingrestriction_view_dbqmjm.id
left join master_join master_join_orvvxw on procedure.approachcondition.id = master_join_orvvxw.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_wnhgzf on master_join_orvvxw.target_id = shared_aircraftcharacteristic_view_wnhgzf.id
left join master_join master_join_jlojqg on procedure.approachcondition.id = master_join_jlojqg.source_id
left join procedure.landingtakeoffareacollection_view procedure_landingtakeoffareacollection_view_rcbqwy on master_join_jlojqg.target_id = procedure_landingtakeoffareacollection_view_rcbqwy.id
left join master_join master_join_nvwjra on procedure.approachcondition.id = master_join_nvwjra.source_id
left join shared.obstacleassessmentarea_view shared_obstacleassessmentarea_view_lymdrt on master_join_nvwjra.target_id = shared_obstacleassessmentarea_view_lymdrt.id
left join master_join master_join_vstyym on procedure.approachcondition.id = master_join_vstyym.source_id
left join notes.note_view notes_note_view_rejlkg on master_join_vstyym.target_id = notes_note_view_rejlkg.id
group by
    procedure.approachcondition_pt.id,
    procedure.approachcondition_pt.nilreason,
    procedure.approachcondition.finalapproachpath_value,
    procedure.approachcondition.finalapproachpath_nilreason,
    procedure.approachcondition.requirednavigationperformance_value,
    procedure.approachcondition.requirednavigationperformance_nilreason,
    procedure.approachcondition.climbgradient_value,
    procedure.approachcondition.climbgradient_nilreason,
    procedure_minima_view_lgahmt.id,
    airport_heliport_altimetersource_pt_iphlmf.title,
    airport_heliport_altimetersource_pt_iphlmf.nilreason[1],
    airport_heliport_altimetersource_pt_iphlmf.href;
-- AerialRefuellingAnchorPropertyType
-- ['aerial_refuelling.aerialrefuellingpoint_view', 'geometry.surface_view', 'notes.note_view', 'shared.airspacelayer_view']
create or replace view aerial_refuelling.aerialrefuellinganchor_view as
select
    aerial_refuelling.aerialrefuellinganchor_pt.id,
    aerial_refuelling.aerialrefuellinganchor_pt.nilreason AS aerialrefuellinganchor_nilreason,
    coalesce(cast(aerial_refuelling.aerialrefuellinganchor.outboundcourse_value as varchar), '(' || aerial_refuelling.aerialrefuellinganchor.outboundcourse_nilreason || ')') as outboundcourse,
    coalesce(cast(aerial_refuelling.aerialrefuellinganchor.outboundcoursetype_value as varchar), '(' || aerial_refuelling.aerialrefuellinganchor.outboundcoursetype_nilreason || ')') as outboundcoursetype,
    coalesce(cast(aerial_refuelling.aerialrefuellinganchor.inboundcourse_value as varchar), '(' || aerial_refuelling.aerialrefuellinganchor.inboundcourse_nilreason || ')') as inboundcourse,
    coalesce(cast(aerial_refuelling.aerialrefuellinganchor.turndirection_value as varchar), '(' || aerial_refuelling.aerialrefuellinganchor.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(aerial_refuelling.aerialrefuellinganchor.refuellingbaselevelreference_value as varchar), '(' || aerial_refuelling.aerialrefuellinganchor.refuellingbaselevelreference_nilreason || ')') as refuellingbaselevelreference,
    coalesce(cast(aerial_refuelling.aerialrefuellinganchor.speedlimit_value as varchar) || ' ' || aerial_refuelling.aerialrefuellinganchor.speedlimit_uom, '(' || aerial_refuelling.aerialrefuellinganchor.speedlimit_nilreason || ')') as speedlimit,
    coalesce(cast(aerial_refuelling.aerialrefuellinganchor.legseparation_value as varchar) || ' ' || aerial_refuelling.aerialrefuellinganchor.legseparation_uom, '(' || aerial_refuelling.aerialrefuellinganchor.legseparation_nilreason || ')') as legseparation,
    coalesce(cast(aerial_refuelling.aerialrefuellinganchor.leglength_value as varchar) || ' ' || aerial_refuelling.aerialrefuellinganchor.leglength_uom, '(' || aerial_refuelling.aerialrefuellinganchor.leglength_nilreason || ')') as leglength,
    coalesce(cast(aerial_refuelling.aerialrefuellinganchor.refuellingbaselevel_value as varchar) || ' ' || aerial_refuelling.aerialrefuellinganchor.refuellingbaselevel_uom, '(' || aerial_refuelling.aerialrefuellinganchor.refuellingbaselevel_nilreason || ')') as refuellingbaselevel,
    geometry_surface_view_xzppsu.geom AS geom,
    jsonb_agg(shared_airspacelayer_view_refhag.id) AS verticalextent,
    jsonb_agg(aerial_refuelling_aerialrefuellingpoint_view_jfwxdd.id) AS point,
    jsonb_agg(notes_note_view_ltynbl.*) AS aerialrefuellinganchor_annotation
from aerial_refuelling.aerialrefuellinganchor_pt 
inner join aerial_refuelling.aerialrefuellinganchor on aerial_refuelling.aerialrefuellinganchor_pt.aerialrefuellinganchor_id = aerial_refuelling.aerialrefuellinganchor.id
left join geometry.surface_view geometry_surface_view_xzppsu on aerial_refuelling.aerialrefuellinganchor.extent_id = geometry_surface_view_xzppsu.id
left join master_join master_join_txmcpk on aerial_refuelling.aerialrefuellinganchor.id = master_join_txmcpk.source_id
left join shared.airspacelayer_view shared_airspacelayer_view_refhag on master_join_txmcpk.target_id = shared_airspacelayer_view_refhag.id
left join master_join master_join_igxgpv on aerial_refuelling.aerialrefuellinganchor.id = master_join_igxgpv.source_id
left join aerial_refuelling.aerialrefuellingpoint_view aerial_refuelling_aerialrefuellingpoint_view_jfwxdd on master_join_igxgpv.target_id = aerial_refuelling_aerialrefuellingpoint_view_jfwxdd.id
left join master_join master_join_attxpr on aerial_refuelling.aerialrefuellinganchor.id = master_join_attxpr.source_id
left join notes.note_view notes_note_view_ltynbl on master_join_attxpr.target_id = notes_note_view_ltynbl.id
group by
    aerial_refuelling.aerialrefuellinganchor_pt.id,
    aerial_refuelling.aerialrefuellinganchor_pt.nilreason,
    aerial_refuelling.aerialrefuellinganchor.outboundcourse_value,
    aerial_refuelling.aerialrefuellinganchor.outboundcourse_nilreason,
    aerial_refuelling.aerialrefuellinganchor.outboundcoursetype_value,
    aerial_refuelling.aerialrefuellinganchor.outboundcoursetype_nilreason,
    aerial_refuelling.aerialrefuellinganchor.inboundcourse_value,
    aerial_refuelling.aerialrefuellinganchor.inboundcourse_nilreason,
    aerial_refuelling.aerialrefuellinganchor.turndirection_value,
    aerial_refuelling.aerialrefuellinganchor.turndirection_nilreason,
    aerial_refuelling.aerialrefuellinganchor.refuellingbaselevelreference_value,
    aerial_refuelling.aerialrefuellinganchor.refuellingbaselevelreference_nilreason,
    aerial_refuelling.aerialrefuellinganchor.speedlimit_value,
    aerial_refuelling.aerialrefuellinganchor.speedlimit_uom,
    aerial_refuelling.aerialrefuellinganchor.speedlimit_nilreason,
    aerial_refuelling.aerialrefuellinganchor.legseparation_value,
    aerial_refuelling.aerialrefuellinganchor.legseparation_uom,
    aerial_refuelling.aerialrefuellinganchor.legseparation_nilreason,
    aerial_refuelling.aerialrefuellinganchor.leglength_value,
    aerial_refuelling.aerialrefuellinganchor.leglength_uom,
    aerial_refuelling.aerialrefuellinganchor.leglength_nilreason,
    aerial_refuelling.aerialrefuellinganchor.refuellingbaselevel_value,
    aerial_refuelling.aerialrefuellinganchor.refuellingbaselevel_uom,
    aerial_refuelling.aerialrefuellinganchor.refuellingbaselevel_nilreason,
    geometry_surface_view_xzppsu.geom;
-- AerialRefuellingTrackPropertyType
-- ['geometry.curve_view', 'notes.note_view', 'aerial_refuelling.aerialrefuellingpoint_view', 'shared.airspacelayer_view']
create or replace view aerial_refuelling.aerialrefuellingtrack_view as
select
    aerial_refuelling.aerialrefuellingtrack_pt.id,
    aerial_refuelling.aerialrefuellingtrack_pt.nilreason AS aerialrefuellingtrack_nilreason,
    geometry_curve_view_ufuzbr.geom AS geom,
    jsonb_agg(aerial_refuelling_aerialrefuellingpoint_view_yzmxcg.id) AS point,
    jsonb_agg(shared_airspacelayer_view_cwqvii.id) AS verticalextent,
    jsonb_agg(notes_note_view_pucwwl.*) AS aerialrefuellingtrack_annotation
from aerial_refuelling.aerialrefuellingtrack_pt 
inner join aerial_refuelling.aerialrefuellingtrack on aerial_refuelling.aerialrefuellingtrack_pt.aerialrefuellingtrack_id = aerial_refuelling.aerialrefuellingtrack.id
left join geometry.curve_view geometry_curve_view_ufuzbr on aerial_refuelling.aerialrefuellingtrack.extent_id = geometry_curve_view_ufuzbr.id
left join master_join master_join_hcszum on aerial_refuelling.aerialrefuellingtrack.id = master_join_hcszum.source_id
left join aerial_refuelling.aerialrefuellingpoint_view aerial_refuelling_aerialrefuellingpoint_view_yzmxcg on master_join_hcszum.target_id = aerial_refuelling_aerialrefuellingpoint_view_yzmxcg.id
left join master_join master_join_htruit on aerial_refuelling.aerialrefuellingtrack.id = master_join_htruit.source_id
left join shared.airspacelayer_view shared_airspacelayer_view_cwqvii on master_join_htruit.target_id = shared_airspacelayer_view_cwqvii.id
left join master_join master_join_ifbpnl on aerial_refuelling.aerialrefuellingtrack.id = master_join_ifbpnl.source_id
left join notes.note_view notes_note_view_pucwwl on master_join_ifbpnl.target_id = notes_note_view_pucwwl.id
group by
    aerial_refuelling.aerialrefuellingtrack_pt.id,
    aerial_refuelling.aerialrefuellingtrack_pt.nilreason,
    geometry_curve_view_ufuzbr.geom;
-- VerticalStructurePartPropertyType
-- ['shared.lightelement_view', 'geometry.elevatedcurve_view', 'shared.timesheet_view', 'notes.note_view', 'geometry.elevatedsurface_view', 'geometry.elevatedpoint_view']
create or replace view obstacles.verticalstructurepart_view as
select
    obstacles.verticalstructurepart_pt.id,
    obstacles.verticalstructurepart_pt.nilreason AS verticalstructurepart_nilreason,
    coalesce(cast(obstacles.verticalstructurepart.type_value as varchar), '(' || obstacles.verticalstructurepart.type_nilreason || ')') as type,
    coalesce(cast(obstacles.verticalstructurepart.constructionstatus_value as varchar), '(' || obstacles.verticalstructurepart.constructionstatus_nilreason || ')') as constructionstatus,
    coalesce(cast(obstacles.verticalstructurepart.markingpattern_value as varchar), '(' || obstacles.verticalstructurepart.markingpattern_nilreason || ')') as markingpattern,
    coalesce(cast(obstacles.verticalstructurepart.markingfirstcolour_value as varchar), '(' || obstacles.verticalstructurepart.markingfirstcolour_nilreason || ')') as markingfirstcolour,
    coalesce(cast(obstacles.verticalstructurepart.markingsecondcolour_value as varchar), '(' || obstacles.verticalstructurepart.markingsecondcolour_nilreason || ')') as markingsecondcolour,
    coalesce(cast(obstacles.verticalstructurepart.mobile_value as varchar), '(' || obstacles.verticalstructurepart.mobile_nilreason || ')') as mobile,
    coalesce(cast(obstacles.verticalstructurepart.frangible_value as varchar), '(' || obstacles.verticalstructurepart.frangible_nilreason || ')') as frangible,
    coalesce(cast(obstacles.verticalstructurepart.visiblematerial_value as varchar), '(' || obstacles.verticalstructurepart.visiblematerial_nilreason || ')') as visiblematerial,
    coalesce(cast(obstacles.verticalstructurepart.designator_value as varchar), '(' || obstacles.verticalstructurepart.designator_nilreason || ')') as designator,
    coalesce(cast(obstacles.verticalstructurepart.verticalextent_value as varchar) || ' ' || obstacles.verticalstructurepart.verticalextent_uom, '(' || obstacles.verticalstructurepart.verticalextent_nilreason || ')') as verticalextent,
    coalesce(cast(obstacles.verticalstructurepart.verticalextentaccuracy_value as varchar) || ' ' || obstacles.verticalstructurepart.verticalextentaccuracy_uom, '(' || obstacles.verticalstructurepart.verticalextentaccuracy_nilreason || ')') as verticalextentaccuracy,
    geometry_elevatedpoint_view_qrmvvb.geom AS geom,
    ST_X(geometry_elevatedpoint_view_qrmvvb.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_qrmvvb.geom) AS latitude,
    geometry_elevatedpoint_view_qrmvvb.elevation,
    geometry_elevatedpoint_view_qrmvvb.geoidUndulation,
    geometry_elevatedpoint_view_qrmvvb.verticalDatum,
    geometry_elevatedpoint_view_qrmvvb.verticalAccuracy,
    geometry_elevatedpoint_view_qrmvvb.horizontalAccuracy,
    geometry_elevatedcurve_view_safxrf.geom AS geom,
    geometry_elevatedcurve_view_safxrf.elevation,
    geometry_elevatedcurve_view_safxrf.geoidUndulation,
    geometry_elevatedcurve_view_safxrf.verticalDatum,
    geometry_elevatedcurve_view_safxrf.verticalAccuracy,
    geometry_elevatedcurve_view_safxrf.horizontalAccuracy,
    geometry_elevatedsurface_view_amossx.geom AS geom,
    geometry_elevatedsurface_view_amossx.elevation,
    geometry_elevatedsurface_view_amossx.geoidUndulation,
    geometry_elevatedsurface_view_amossx.verticalDatum,
    geometry_elevatedsurface_view_amossx.verticalAccuracy,
    geometry_elevatedsurface_view_amossx.horizontalAccuracy,
    jsonb_agg(notes_note_view_lsbypt.*) AS verticalstructurepart_annotation,
    jsonb_build_object('id', organisation_organisationauthority_pt_orktfi.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_orktfi.title AS varchar), '(' || organisation_organisationauthority_pt_orktfi.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_orktfi.href) AS specialdateauthority,
    jsonb_agg(shared_lightelement_view_zjstzp.id) AS lighting
from obstacles.verticalstructurepart_pt 
inner join obstacles.verticalstructurepart on obstacles.verticalstructurepart_pt.verticalstructurepart_id = obstacles.verticalstructurepart.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_qrmvvb on obstacles.verticalstructurepart.horizontalprojection_location_id = geometry_elevatedpoint_view_qrmvvb.id
left join geometry.elevatedcurve_view geometry_elevatedcurve_view_safxrf on obstacles.verticalstructurepart.horizontalprojection_linearextent_id = geometry_elevatedcurve_view_safxrf.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_amossx on obstacles.verticalstructurepart.horizontalprojection_surfaceextent_id = geometry_elevatedsurface_view_amossx.id
left join master_join master_join_zdqyqj on obstacles.verticalstructurepart.id = master_join_zdqyqj.source_id
left join shared.timesheet_view shared_timesheet_view_crphcv on master_join_zdqyqj.target_id = shared_timesheet_view_crphcv.id
left join master_join master_join_mmvbzv on obstacles.verticalstructurepart.id = master_join_mmvbzv.source_id
left join notes.note_view notes_note_view_lsbypt on master_join_mmvbzv.target_id = notes_note_view_lsbypt.id
left join master_join master_join_gapner on obstacles.verticalstructurepart.id = master_join_gapner.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_orktfi on master_join_gapner.target_id = organisation_organisationauthority_pt_orktfi.id
left join master_join master_join_ybnrzq on obstacles.verticalstructurepart.id = master_join_ybnrzq.source_id
left join shared.lightelement_view shared_lightelement_view_zjstzp on master_join_ybnrzq.target_id = shared_lightelement_view_zjstzp.id
group by
    obstacles.verticalstructurepart_pt.id,
    obstacles.verticalstructurepart_pt.nilreason,
    obstacles.verticalstructurepart.type_value,
    obstacles.verticalstructurepart.type_nilreason,
    obstacles.verticalstructurepart.constructionstatus_value,
    obstacles.verticalstructurepart.constructionstatus_nilreason,
    obstacles.verticalstructurepart.markingpattern_value,
    obstacles.verticalstructurepart.markingpattern_nilreason,
    obstacles.verticalstructurepart.markingfirstcolour_value,
    obstacles.verticalstructurepart.markingfirstcolour_nilreason,
    obstacles.verticalstructurepart.markingsecondcolour_value,
    obstacles.verticalstructurepart.markingsecondcolour_nilreason,
    obstacles.verticalstructurepart.mobile_value,
    obstacles.verticalstructurepart.mobile_nilreason,
    obstacles.verticalstructurepart.frangible_value,
    obstacles.verticalstructurepart.frangible_nilreason,
    obstacles.verticalstructurepart.visiblematerial_value,
    obstacles.verticalstructurepart.visiblematerial_nilreason,
    obstacles.verticalstructurepart.designator_value,
    obstacles.verticalstructurepart.designator_nilreason,
    obstacles.verticalstructurepart.verticalextent_value,
    obstacles.verticalstructurepart.verticalextent_uom,
    obstacles.verticalstructurepart.verticalextent_nilreason,
    obstacles.verticalstructurepart.verticalextentaccuracy_value,
    obstacles.verticalstructurepart.verticalextentaccuracy_uom,
    obstacles.verticalstructurepart.verticalextentaccuracy_nilreason,
    geometry_elevatedpoint_view_qrmvvb.geom,
    geometry_elevatedpoint_view_qrmvvb.elevation,
    geometry_elevatedpoint_view_qrmvvb.geoidUndulation,
    geometry_elevatedpoint_view_qrmvvb.verticalDatum,
    geometry_elevatedpoint_view_qrmvvb.verticalAccuracy,
    geometry_elevatedpoint_view_qrmvvb.horizontalAccuracy,
    geometry_elevatedcurve_view_safxrf.geom,
    geometry_elevatedcurve_view_safxrf.elevation,
    geometry_elevatedcurve_view_safxrf.geoidUndulation,
    geometry_elevatedcurve_view_safxrf.verticalDatum,
    geometry_elevatedcurve_view_safxrf.verticalAccuracy,
    geometry_elevatedcurve_view_safxrf.horizontalAccuracy,
    geometry_elevatedsurface_view_amossx.geom,
    geometry_elevatedsurface_view_amossx.elevation,
    geometry_elevatedsurface_view_amossx.geoidUndulation,
    geometry_elevatedsurface_view_amossx.verticalDatum,
    geometry_elevatedsurface_view_amossx.verticalAccuracy,
    geometry_elevatedsurface_view_amossx.horizontalAccuracy;
-- FlightRestrictionRoutePropertyType
-- ['notes.note_view', 'routes.flightroutingelement_view', 'shared.contactinformation_view']
create or replace view routes.flightrestrictionroute_view as
select
    routes.flightrestrictionroute_pt.id,
    routes.flightrestrictionroute_pt.nilreason AS flightrestrictionroute_nilreason,
    coalesce(cast(routes.flightrestrictionroute.priorpermission_value as varchar), '(' || routes.flightrestrictionroute.priorpermission_nilreason || ')') as priorpermission,
    jsonb_agg(routes_flightroutingelement_view_oopqlv.id) AS routeelement,
    jsonb_agg(notes_note_view_qcrfjn.*) AS flightrestrictionroute_annotation
from routes.flightrestrictionroute_pt 
inner join routes.flightrestrictionroute on routes.flightrestrictionroute_pt.flightrestrictionroute_id = routes.flightrestrictionroute.id
left join master_join master_join_jyewej on routes.flightrestrictionroute.id = master_join_jyewej.source_id
left join routes.flightroutingelement_view routes_flightroutingelement_view_oopqlv on master_join_jyewej.target_id = routes_flightroutingelement_view_oopqlv.id
left join master_join master_join_adcptz on routes.flightrestrictionroute.id = master_join_adcptz.source_id
left join shared.contactinformation_view shared_contactinformation_view_uxtiil on master_join_adcptz.target_id = shared_contactinformation_view_uxtiil.id
left join master_join master_join_qlbwta on routes.flightrestrictionroute.id = master_join_qlbwta.source_id
left join notes.note_view notes_note_view_qcrfjn on master_join_qlbwta.target_id = notes_note_view_qcrfjn.id
group by
    routes.flightrestrictionroute_pt.id,
    routes.flightrestrictionroute_pt.nilreason,
    routes.flightrestrictionroute.priorpermission_value,
    routes.flightrestrictionroute.priorpermission_nilreason;
-- AerialRefuellingTimeSliceType
-- ['aerial_refuelling.aerialrefuellingtrack_view', 'notes.note_view', 'aerial_refuelling.aerialrefuellinganchor_view', 'routes.routeavailability_view', 'aerial_refuelling.authorityforaerialrefuelling_view']
create or replace view aerial_refuelling.aerialrefuelling_view as
select distinct on (aerialrefuelling.identifier,aerialrefuelling_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    aerial_refuelling.aerialrefuelling.id,
    aerial_refuelling.aerialrefuelling_ts.id as ts_id,
    aerial_refuelling.aerialrefuelling_tsp.id as tsp_id,
    aerial_refuelling.aerialrefuelling.identifier,
    aerial_refuelling.aerialrefuelling_ts.interpretation,
    aerial_refuelling.aerialrefuelling_ts.sequence_number,
    aerial_refuelling.aerialrefuelling_ts.correction_number,
    aerial_refuelling.aerialrefuelling_ts.valid_time_begin,
    aerial_refuelling.aerialrefuelling_ts.valid_time_end,
    aerial_refuelling.aerialrefuelling_ts.feature_lifetime_begin,
    aerial_refuelling.aerialrefuelling_ts.feature_lifetime_end,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.designatorprefix_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.designatorprefix_nilreason || ')') as designatorprefix,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.designatornumber_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.designatornumber_nilreason || ')') as designatornumber,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.designatorsuffix_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.designatorsuffix_nilreason || ')') as designatorsuffix,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.designatordirection_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.designatordirection_nilreason || ')') as designatordirection,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.name_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.name_nilreason || ')') as name,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.type_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.type_nilreason || ')') as type,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.radarbeaconsetting_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.radarbeaconsetting_nilreason || ')') as radarbeaconsetting,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.xbandradarsetting_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.xbandradarsetting_nilreason || ')') as xbandradarsetting,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.tankerchannel_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.tankerchannel_nilreason || ')') as tankerchannel,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.receiverchannel_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.receiverchannel_nilreason || ')') as receiverchannel,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.helicopterroute_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.helicopterroute_nilreason || ')') as helicopterroute,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.specialrefuelling_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.specialrefuelling_nilreason || ')') as specialrefuelling,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.bidirectionaluse_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.bidirectionaluse_nilreason || ')') as bidirectionaluse,
    coalesce(cast(aerial_refuelling.aerialrefuelling_ts.reversedirectionturn_value as varchar), '(' || aerial_refuelling.aerialrefuelling_ts.reversedirectionturn_nilreason || ')') as reversedirectionturn,
    coalesce(cast(aerial_refuelling_aerialrefuelling_pt_ckkysy.title as varchar), '(' || aerial_refuelling_aerialrefuelling_pt_ckkysy.nilreason[1] || ')') AS oppositetrack,
    aerial_refuelling_aerialrefuelling_pt_ckkysy.href AS oppositetrack_href,
    jsonb_agg(routes_routeavailability_view_tanxgf.id) AS availability,
    jsonb_build_object('id', airspace_airspace_pt_eegfpt.id,
    'title', coalesce(cast(airspace_airspace_pt_eegfpt.title AS varchar), '(' || airspace_airspace_pt_eegfpt.nilreason[1] || ')'),
    'href', airspace_airspace_pt_eegfpt.href) AS protectingairspace,
    jsonb_agg(aerial_refuelling_aerialrefuellingtrack_view_daebrs.id) AS track,
    jsonb_agg(aerial_refuelling_aerialrefuellinganchor_view_rivfxy.id) AS anchor,
    jsonb_agg(aerial_refuelling_authorityforaerialrefuelling_view_bivsxb.id) AS managingorganisation,
    jsonb_agg(notes_note_view_leaivk.*) AS aerialrefuelling_annotation
from aerial_refuelling.aerialrefuelling 
inner join master_join mj2 on aerial_refuelling.aerialrefuelling.id = mj2.source_id
inner join aerial_refuelling.aerialrefuelling_tsp on mj2.target_id = aerial_refuelling.aerialrefuelling_tsp.id
inner join aerial_refuelling.aerialrefuelling_ts on aerial_refuelling.aerialrefuelling_tsp.aerialrefuellingtimeslice_id = aerial_refuelling.aerialrefuelling_ts.id
left join aerial_refuelling.aerialrefuelling_pt aerial_refuelling_aerialrefuelling_pt_ckkysy on aerial_refuelling.aerialrefuelling_ts.oppositetrack_id = aerial_refuelling_aerialrefuelling_pt_ckkysy.id
left join master_join master_join_nkwxyi on aerial_refuelling.aerialrefuelling_ts.id = master_join_nkwxyi.source_id
left join routes.routeavailability_view routes_routeavailability_view_tanxgf on master_join_nkwxyi.target_id = routes_routeavailability_view_tanxgf.id
left join master_join master_join_zhbzgu on aerial_refuelling.aerialrefuelling_ts.id = master_join_zhbzgu.source_id
left join airspace.airspace_pt airspace_airspace_pt_eegfpt on master_join_zhbzgu.target_id = airspace_airspace_pt_eegfpt.id
left join master_join master_join_djnvax on aerial_refuelling.aerialrefuelling_ts.id = master_join_djnvax.source_id
left join aerial_refuelling.aerialrefuellingtrack_view aerial_refuelling_aerialrefuellingtrack_view_daebrs on master_join_djnvax.target_id = aerial_refuelling_aerialrefuellingtrack_view_daebrs.id
left join master_join master_join_sodiff on aerial_refuelling.aerialrefuelling_ts.id = master_join_sodiff.source_id
left join aerial_refuelling.aerialrefuellinganchor_view aerial_refuelling_aerialrefuellinganchor_view_rivfxy on master_join_sodiff.target_id = aerial_refuelling_aerialrefuellinganchor_view_rivfxy.id
left join master_join master_join_wjfjow on aerial_refuelling.aerialrefuelling_ts.id = master_join_wjfjow.source_id
left join aerial_refuelling.authorityforaerialrefuelling_view aerial_refuelling_authorityforaerialrefuelling_view_bivsxb on master_join_wjfjow.target_id = aerial_refuelling_authorityforaerialrefuelling_view_bivsxb.id
left join master_join master_join_uthulo on aerial_refuelling.aerialrefuelling_ts.id = master_join_uthulo.source_id
left join notes.note_view notes_note_view_leaivk on master_join_uthulo.target_id = notes_note_view_leaivk.id
where aerial_refuelling.aerialrefuelling.feature_status = 'APPROVED'
  and aerial_refuelling.aerialrefuelling_ts.feature_status = 'APPROVED'
group by
    aerial_refuelling.aerialrefuelling.id,
    aerial_refuelling.aerialrefuelling_ts.id,
    aerial_refuelling.aerialrefuelling_tsp.id,
    aerial_refuelling.aerialrefuelling.identifier,
    aerial_refuelling.aerialrefuelling_ts.interpretation,
    aerial_refuelling.aerialrefuelling_ts.sequence_number,
    aerial_refuelling.aerialrefuelling_ts.correction_number,
    aerial_refuelling.aerialrefuelling_ts.valid_time_begin,
    aerial_refuelling.aerialrefuelling_ts.valid_time_end,
    aerial_refuelling.aerialrefuelling_ts.feature_lifetime_begin,
    aerial_refuelling.aerialrefuelling_ts.feature_lifetime_end,
    aerial_refuelling.aerialrefuelling_ts.designatorprefix_value,
    aerial_refuelling.aerialrefuelling_ts.designatorprefix_nilreason,
    aerial_refuelling.aerialrefuelling_ts.designatornumber_value,
    aerial_refuelling.aerialrefuelling_ts.designatornumber_nilreason,
    aerial_refuelling.aerialrefuelling_ts.designatorsuffix_value,
    aerial_refuelling.aerialrefuelling_ts.designatorsuffix_nilreason,
    aerial_refuelling.aerialrefuelling_ts.designatordirection_value,
    aerial_refuelling.aerialrefuelling_ts.designatordirection_nilreason,
    aerial_refuelling.aerialrefuelling_ts.name_value,
    aerial_refuelling.aerialrefuelling_ts.name_nilreason,
    aerial_refuelling.aerialrefuelling_ts.type_value,
    aerial_refuelling.aerialrefuelling_ts.type_nilreason,
    aerial_refuelling.aerialrefuelling_ts.radarbeaconsetting_value,
    aerial_refuelling.aerialrefuelling_ts.radarbeaconsetting_nilreason,
    aerial_refuelling.aerialrefuelling_ts.xbandradarsetting_value,
    aerial_refuelling.aerialrefuelling_ts.xbandradarsetting_nilreason,
    aerial_refuelling.aerialrefuelling_ts.tankerchannel_value,
    aerial_refuelling.aerialrefuelling_ts.tankerchannel_nilreason,
    aerial_refuelling.aerialrefuelling_ts.receiverchannel_value,
    aerial_refuelling.aerialrefuelling_ts.receiverchannel_nilreason,
    aerial_refuelling.aerialrefuelling_ts.helicopterroute_value,
    aerial_refuelling.aerialrefuelling_ts.helicopterroute_nilreason,
    aerial_refuelling.aerialrefuelling_ts.specialrefuelling_value,
    aerial_refuelling.aerialrefuelling_ts.specialrefuelling_nilreason,
    aerial_refuelling.aerialrefuelling_ts.bidirectionaluse_value,
    aerial_refuelling.aerialrefuelling_ts.bidirectionaluse_nilreason,
    aerial_refuelling.aerialrefuelling_ts.reversedirectionturn_value,
    aerial_refuelling.aerialrefuelling_ts.reversedirectionturn_nilreason,
    aerial_refuelling_aerialrefuelling_pt_ckkysy.title,
    aerial_refuelling_aerialrefuelling_pt_ckkysy.nilreason[1],
    aerial_refuelling_aerialrefuelling_pt_ckkysy.href
order by aerialrefuelling.identifier, aerialrefuelling_ts.sequence_number, aerialrefuelling_ts.correction_number DESC;
-- AeronauticalGroundLightTimeSliceType
-- ['notes.note_view', 'geometry.elevatedpoint_view']
create or replace view navaids_points.aeronauticalgroundlight_view as
select distinct on (aeronauticalgroundlight.identifier,aeronauticalgroundlight_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.aeronauticalgroundlight.id,
    navaids_points.aeronauticalgroundlight_ts.id as ts_id,
    navaids_points.aeronauticalgroundlight_tsp.id as tsp_id,
    navaids_points.aeronauticalgroundlight.identifier,
    navaids_points.aeronauticalgroundlight_ts.interpretation,
    navaids_points.aeronauticalgroundlight_ts.sequence_number,
    navaids_points.aeronauticalgroundlight_ts.correction_number,
    navaids_points.aeronauticalgroundlight_ts.valid_time_begin,
    navaids_points.aeronauticalgroundlight_ts.valid_time_end,
    navaids_points.aeronauticalgroundlight_ts.feature_lifetime_begin,
    navaids_points.aeronauticalgroundlight_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.aeronauticalgroundlight_ts.name_value as varchar), '(' || navaids_points.aeronauticalgroundlight_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.aeronauticalgroundlight_ts.type_value as varchar), '(' || navaids_points.aeronauticalgroundlight_ts.type_nilreason || ')') as type,
    coalesce(cast(navaids_points.aeronauticalgroundlight_ts.colour_value as varchar), '(' || navaids_points.aeronauticalgroundlight_ts.colour_nilreason || ')') as colour,
    coalesce(cast(navaids_points.aeronauticalgroundlight_ts.flashing_value as varchar), '(' || navaids_points.aeronauticalgroundlight_ts.flashing_nilreason || ')') as flashing,
    coalesce(cast(obstacles_verticalstructure_pt_kdkoxf.title as varchar), '(' || obstacles_verticalstructure_pt_kdkoxf.nilreason[1] || ')') AS structurebeacon,
    obstacles_verticalstructure_pt_kdkoxf.href AS structurebeacon_href,
    coalesce(cast(airport_heliport_airportheliport_pt_rwfdid.title as varchar), '(' || airport_heliport_airportheliport_pt_rwfdid.nilreason[1] || ')') AS aerodromebeacon,
    airport_heliport_airportheliport_pt_rwfdid.href AS aerodromebeacon_href,
    geometry_elevatedpoint_view_zkhujl.geom AS geom,
    ST_X(geometry_elevatedpoint_view_zkhujl.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_zkhujl.geom) AS latitude,
    geometry_elevatedpoint_view_zkhujl.elevation,
    geometry_elevatedpoint_view_zkhujl.geoidUndulation,
    geometry_elevatedpoint_view_zkhujl.verticalDatum,
    geometry_elevatedpoint_view_zkhujl.verticalAccuracy,
    geometry_elevatedpoint_view_zkhujl.horizontalAccuracy,
    jsonb_agg(notes_note_view_rlujyt.*) AS aeronauticalgroundlight_annotation
from navaids_points.aeronauticalgroundlight 
inner join master_join mj2 on navaids_points.aeronauticalgroundlight.id = mj2.source_id
inner join navaids_points.aeronauticalgroundlight_tsp on mj2.target_id = navaids_points.aeronauticalgroundlight_tsp.id
inner join navaids_points.aeronauticalgroundlight_ts on navaids_points.aeronauticalgroundlight_tsp.aeronauticalgroundlighttimeslice_id = navaids_points.aeronauticalgroundlight_ts.id
left join obstacles.verticalstructure_pt obstacles_verticalstructure_pt_kdkoxf on navaids_points.aeronauticalgroundlight_ts.structurebeacon_id = obstacles_verticalstructure_pt_kdkoxf.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_rwfdid on navaids_points.aeronauticalgroundlight_ts.aerodromebeacon_id = airport_heliport_airportheliport_pt_rwfdid.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_zkhujl on navaids_points.aeronauticalgroundlight_ts.location_id = geometry_elevatedpoint_view_zkhujl.id
left join master_join master_join_dnfywq on navaids_points.aeronauticalgroundlight_ts.id = master_join_dnfywq.source_id
left join notes.note_view notes_note_view_rlujyt on master_join_dnfywq.target_id = notes_note_view_rlujyt.id
where navaids_points.aeronauticalgroundlight.feature_status = 'APPROVED'
  and navaids_points.aeronauticalgroundlight_ts.feature_status = 'APPROVED'
group by
    navaids_points.aeronauticalgroundlight.id,
    navaids_points.aeronauticalgroundlight_ts.id,
    navaids_points.aeronauticalgroundlight_tsp.id,
    navaids_points.aeronauticalgroundlight.identifier,
    navaids_points.aeronauticalgroundlight_ts.interpretation,
    navaids_points.aeronauticalgroundlight_ts.sequence_number,
    navaids_points.aeronauticalgroundlight_ts.correction_number,
    navaids_points.aeronauticalgroundlight_ts.valid_time_begin,
    navaids_points.aeronauticalgroundlight_ts.valid_time_end,
    navaids_points.aeronauticalgroundlight_ts.feature_lifetime_begin,
    navaids_points.aeronauticalgroundlight_ts.feature_lifetime_end,
    navaids_points.aeronauticalgroundlight_ts.name_value,
    navaids_points.aeronauticalgroundlight_ts.name_nilreason,
    navaids_points.aeronauticalgroundlight_ts.type_value,
    navaids_points.aeronauticalgroundlight_ts.type_nilreason,
    navaids_points.aeronauticalgroundlight_ts.colour_value,
    navaids_points.aeronauticalgroundlight_ts.colour_nilreason,
    navaids_points.aeronauticalgroundlight_ts.flashing_value,
    navaids_points.aeronauticalgroundlight_ts.flashing_nilreason,
    obstacles_verticalstructure_pt_kdkoxf.title,
    obstacles_verticalstructure_pt_kdkoxf.nilreason[1],
    obstacles_verticalstructure_pt_kdkoxf.href,
    airport_heliport_airportheliport_pt_rwfdid.title,
    airport_heliport_airportheliport_pt_rwfdid.nilreason[1],
    airport_heliport_airportheliport_pt_rwfdid.href,
    geometry_elevatedpoint_view_zkhujl.geom,
    geometry_elevatedpoint_view_zkhujl.elevation,
    geometry_elevatedpoint_view_zkhujl.geoidUndulation,
    geometry_elevatedpoint_view_zkhujl.verticalDatum,
    geometry_elevatedpoint_view_zkhujl.verticalAccuracy,
    geometry_elevatedpoint_view_zkhujl.horizontalAccuracy
order by aeronauticalgroundlight.identifier, aeronauticalgroundlight_ts.sequence_number, aeronauticalgroundlight_ts.correction_number DESC;
-- AircraftGroundServiceTimeSliceType
-- ['service.serviceoperationalstatus_view', 'notes.note_view', 'shared.contactinformation_view', 'geometry.elevatedpoint_view', 'service.callsigndetail_view']
create or replace view service.aircraftgroundservice_view as
select distinct on (aircraftgroundservice.identifier,aircraftgroundservice_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.aircraftgroundservice.id,
    service.aircraftgroundservice_ts.id as ts_id,
    service.aircraftgroundservice_tsp.id as tsp_id,
    service.aircraftgroundservice.identifier,
    service.aircraftgroundservice_ts.interpretation,
    service.aircraftgroundservice_ts.sequence_number,
    service.aircraftgroundservice_ts.correction_number,
    service.aircraftgroundservice_ts.valid_time_begin,
    service.aircraftgroundservice_ts.valid_time_end,
    service.aircraftgroundservice_ts.feature_lifetime_begin,
    service.aircraftgroundservice_ts.feature_lifetime_end,
    coalesce(cast(service.aircraftgroundservice_ts.flightoperations_value as varchar), '(' || service.aircraftgroundservice_ts.flightoperations_nilreason || ')') as flightoperations,
    coalesce(cast(service.aircraftgroundservice_ts.rank_value as varchar), '(' || service.aircraftgroundservice_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.aircraftgroundservice_ts.complianticao_value as varchar), '(' || service.aircraftgroundservice_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(service.aircraftgroundservice_ts.name_value as varchar), '(' || service.aircraftgroundservice_ts.name_nilreason || ')') as name,
    coalesce(cast(service.aircraftgroundservice_ts.type_value as varchar), '(' || service.aircraftgroundservice_ts.type_nilreason || ')') as type,
    geometry_elevatedpoint_view_suxdnv.geom AS geom,
    ST_X(geometry_elevatedpoint_view_suxdnv.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_suxdnv.geom) AS latitude,
    geometry_elevatedpoint_view_suxdnv.elevation,
    geometry_elevatedpoint_view_suxdnv.geoidUndulation,
    geometry_elevatedpoint_view_suxdnv.verticalDatum,
    geometry_elevatedpoint_view_suxdnv.verticalAccuracy,
    geometry_elevatedpoint_view_suxdnv.horizontalAccuracy,
    coalesce(cast(organisation_unit_pt_wifvdb.title as varchar), '(' || organisation_unit_pt_wifvdb.nilreason[1] || ')') AS serviceprovider,
    organisation_unit_pt_wifvdb.href AS serviceprovider_href,
    jsonb_agg(service_callsigndetail_view_vwfind.id) AS callsign,
    jsonb_build_object('id', service_radiocommunicationchannel_pt_bdqivl.id,
    'title', coalesce(cast(service_radiocommunicationchannel_pt_bdqivl.title AS varchar), '(' || service_radiocommunicationchannel_pt_bdqivl.nilreason[1] || ')'),
    'href', service_radiocommunicationchannel_pt_bdqivl.href) AS radiocommunication,
    jsonb_agg(service_serviceoperationalstatus_view_yggyaq.id) AS availability,
    jsonb_agg(notes_note_view_ctdttj.*) AS aircraftgroundservice_annotation,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_gmmsrv.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_gmmsrv.title AS varchar), '(' || airport_heliport_airportheliport_pt_gmmsrv.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_gmmsrv.href) AS airportheliport
from service.aircraftgroundservice 
inner join master_join mj2 on service.aircraftgroundservice.id = mj2.source_id
inner join service.aircraftgroundservice_tsp on mj2.target_id = service.aircraftgroundservice_tsp.id
inner join service.aircraftgroundservice_ts on service.aircraftgroundservice_tsp.aircraftgroundservicetimeslice_id = service.aircraftgroundservice_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_suxdnv on service.aircraftgroundservice_ts.location_id = geometry_elevatedpoint_view_suxdnv.id
left join organisation.unit_pt organisation_unit_pt_wifvdb on service.aircraftgroundservice_ts.serviceprovider_id = organisation_unit_pt_wifvdb.id
left join master_join master_join_wurnur on service.aircraftgroundservice_ts.id = master_join_wurnur.source_id
left join service.callsigndetail_view service_callsigndetail_view_vwfind on master_join_wurnur.target_id = service_callsigndetail_view_vwfind.id
left join master_join master_join_qjaurz on service.aircraftgroundservice_ts.id = master_join_qjaurz.source_id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_bdqivl on master_join_qjaurz.target_id = service_radiocommunicationchannel_pt_bdqivl.id
left join master_join master_join_qbeiyv on service.aircraftgroundservice_ts.id = master_join_qbeiyv.source_id
left join shared.contactinformation_view shared_contactinformation_view_wumgnd on master_join_qbeiyv.target_id = shared_contactinformation_view_wumgnd.id
left join master_join master_join_auszcs on service.aircraftgroundservice_ts.id = master_join_auszcs.source_id
left join service.serviceoperationalstatus_view service_serviceoperationalstatus_view_yggyaq on master_join_auszcs.target_id = service_serviceoperationalstatus_view_yggyaq.id
left join master_join master_join_dtsdgf on service.aircraftgroundservice_ts.id = master_join_dtsdgf.source_id
left join notes.note_view notes_note_view_ctdttj on master_join_dtsdgf.target_id = notes_note_view_ctdttj.id
left join master_join master_join_ttdlnb on service.aircraftgroundservice_ts.id = master_join_ttdlnb.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_gmmsrv on master_join_ttdlnb.target_id = airport_heliport_airportheliport_pt_gmmsrv.id
where service.aircraftgroundservice.feature_status = 'APPROVED'
  and service.aircraftgroundservice_ts.feature_status = 'APPROVED'
group by
    service.aircraftgroundservice.id,
    service.aircraftgroundservice_ts.id,
    service.aircraftgroundservice_tsp.id,
    service.aircraftgroundservice.identifier,
    service.aircraftgroundservice_ts.interpretation,
    service.aircraftgroundservice_ts.sequence_number,
    service.aircraftgroundservice_ts.correction_number,
    service.aircraftgroundservice_ts.valid_time_begin,
    service.aircraftgroundservice_ts.valid_time_end,
    service.aircraftgroundservice_ts.feature_lifetime_begin,
    service.aircraftgroundservice_ts.feature_lifetime_end,
    service.aircraftgroundservice_ts.flightoperations_value,
    service.aircraftgroundservice_ts.flightoperations_nilreason,
    service.aircraftgroundservice_ts.rank_value,
    service.aircraftgroundservice_ts.rank_nilreason,
    service.aircraftgroundservice_ts.complianticao_value,
    service.aircraftgroundservice_ts.complianticao_nilreason,
    service.aircraftgroundservice_ts.name_value,
    service.aircraftgroundservice_ts.name_nilreason,
    service.aircraftgroundservice_ts.type_value,
    service.aircraftgroundservice_ts.type_nilreason,
    geometry_elevatedpoint_view_suxdnv.geom,
    geometry_elevatedpoint_view_suxdnv.elevation,
    geometry_elevatedpoint_view_suxdnv.geoidUndulation,
    geometry_elevatedpoint_view_suxdnv.verticalDatum,
    geometry_elevatedpoint_view_suxdnv.verticalAccuracy,
    geometry_elevatedpoint_view_suxdnv.horizontalAccuracy,
    organisation_unit_pt_wifvdb.title,
    organisation_unit_pt_wifvdb.nilreason[1],
    organisation_unit_pt_wifvdb.href
order by aircraftgroundservice.identifier, aircraftgroundservice_ts.sequence_number, aircraftgroundservice_ts.correction_number DESC;
-- AircraftStandTimeSliceType
-- ['airport_heliport.aircraftstandcontamination_view', 'notes.note_view', 'geometry.elevatedsurface_view', 'geometry.elevatedpoint_view', 'airport_heliport.apronareaavailability_view']
create or replace view airport_heliport.aircraftstand_view as
select distinct on (aircraftstand.identifier,aircraftstand_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.aircraftstand.id,
    airport_heliport.aircraftstand_ts.id as ts_id,
    airport_heliport.aircraftstand_tsp.id as tsp_id,
    airport_heliport.aircraftstand.identifier,
    airport_heliport.aircraftstand_ts.interpretation,
    airport_heliport.aircraftstand_ts.sequence_number,
    airport_heliport.aircraftstand_ts.correction_number,
    airport_heliport.aircraftstand_ts.valid_time_begin,
    airport_heliport.aircraftstand_ts.valid_time_end,
    airport_heliport.aircraftstand_ts.feature_lifetime_begin,
    airport_heliport.aircraftstand_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.aircraftstand_ts.designator_value as varchar), '(' || airport_heliport.aircraftstand_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airport_heliport.aircraftstand_ts.type_value as varchar), '(' || airport_heliport.aircraftstand_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.aircraftstand_ts.visualdockingsystem_value as varchar), '(' || airport_heliport.aircraftstand_ts.visualdockingsystem_nilreason || ')') as visualdockingsystem,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_pbsdch.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_pbsdch.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_pbsdch.href AS surfaceproperties_href,
    geometry_elevatedpoint_view_bosplw.geom AS geom,
    ST_X(geometry_elevatedpoint_view_bosplw.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_bosplw.geom) AS latitude,
    geometry_elevatedpoint_view_bosplw.elevation,
    geometry_elevatedpoint_view_bosplw.geoidUndulation,
    geometry_elevatedpoint_view_bosplw.verticalDatum,
    geometry_elevatedpoint_view_bosplw.verticalAccuracy,
    geometry_elevatedpoint_view_bosplw.horizontalAccuracy,
    coalesce(cast(airport_heliport_apronelement_pt_jmmfwl.title as varchar), '(' || airport_heliport_apronelement_pt_jmmfwl.nilreason[1] || ')') AS apronlocation,
    airport_heliport_apronelement_pt_jmmfwl.href AS apronlocation_href,
    geometry_elevatedsurface_view_cpyyva.geom AS geom,
    geometry_elevatedsurface_view_cpyyva.elevation,
    geometry_elevatedsurface_view_cpyyva.geoidUndulation,
    geometry_elevatedsurface_view_cpyyva.verticalDatum,
    geometry_elevatedsurface_view_cpyyva.verticalAccuracy,
    geometry_elevatedsurface_view_cpyyva.horizontalAccuracy,
    jsonb_agg(airport_heliport_aircraftstandcontamination_view_gltepv.id) AS contaminant,
    jsonb_agg(notes_note_view_gxglux.*) AS aircraftstand_annotation,
    jsonb_agg(airport_heliport_apronareaavailability_view_kfdrve.id) AS availability
from airport_heliport.aircraftstand 
inner join master_join mj2 on airport_heliport.aircraftstand.id = mj2.source_id
inner join airport_heliport.aircraftstand_tsp on mj2.target_id = airport_heliport.aircraftstand_tsp.id
inner join airport_heliport.aircraftstand_ts on airport_heliport.aircraftstand_tsp.aircraftstandtimeslice_id = airport_heliport.aircraftstand_ts.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_pbsdch on airport_heliport.aircraftstand_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_pbsdch.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_bosplw on airport_heliport.aircraftstand_ts.location_id = geometry_elevatedpoint_view_bosplw.id
left join airport_heliport.apronelement_pt airport_heliport_apronelement_pt_jmmfwl on airport_heliport.aircraftstand_ts.apronlocation_id = airport_heliport_apronelement_pt_jmmfwl.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_cpyyva on airport_heliport.aircraftstand_ts.extent_id = geometry_elevatedsurface_view_cpyyva.id
left join master_join master_join_alyaae on airport_heliport.aircraftstand_ts.id = master_join_alyaae.source_id
left join airport_heliport.aircraftstandcontamination_view airport_heliport_aircraftstandcontamination_view_gltepv on master_join_alyaae.target_id = airport_heliport_aircraftstandcontamination_view_gltepv.id
left join master_join master_join_gybxfm on airport_heliport.aircraftstand_ts.id = master_join_gybxfm.source_id
left join notes.note_view notes_note_view_gxglux on master_join_gybxfm.target_id = notes_note_view_gxglux.id
left join master_join master_join_jwitzi on airport_heliport.aircraftstand_ts.id = master_join_jwitzi.source_id
left join airport_heliport.apronareaavailability_view airport_heliport_apronareaavailability_view_kfdrve on master_join_jwitzi.target_id = airport_heliport_apronareaavailability_view_kfdrve.id
where airport_heliport.aircraftstand.feature_status = 'APPROVED'
  and airport_heliport.aircraftstand_ts.feature_status = 'APPROVED'
group by
    airport_heliport.aircraftstand.id,
    airport_heliport.aircraftstand_ts.id,
    airport_heliport.aircraftstand_tsp.id,
    airport_heliport.aircraftstand.identifier,
    airport_heliport.aircraftstand_ts.interpretation,
    airport_heliport.aircraftstand_ts.sequence_number,
    airport_heliport.aircraftstand_ts.correction_number,
    airport_heliport.aircraftstand_ts.valid_time_begin,
    airport_heliport.aircraftstand_ts.valid_time_end,
    airport_heliport.aircraftstand_ts.feature_lifetime_begin,
    airport_heliport.aircraftstand_ts.feature_lifetime_end,
    airport_heliport.aircraftstand_ts.designator_value,
    airport_heliport.aircraftstand_ts.designator_nilreason,
    airport_heliport.aircraftstand_ts.type_value,
    airport_heliport.aircraftstand_ts.type_nilreason,
    airport_heliport.aircraftstand_ts.visualdockingsystem_value,
    airport_heliport.aircraftstand_ts.visualdockingsystem_nilreason,
    airport_heliport_surfacecharacteristics_pt_pbsdch.title,
    airport_heliport_surfacecharacteristics_pt_pbsdch.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_pbsdch.href,
    geometry_elevatedpoint_view_bosplw.geom,
    geometry_elevatedpoint_view_bosplw.elevation,
    geometry_elevatedpoint_view_bosplw.geoidUndulation,
    geometry_elevatedpoint_view_bosplw.verticalDatum,
    geometry_elevatedpoint_view_bosplw.verticalAccuracy,
    geometry_elevatedpoint_view_bosplw.horizontalAccuracy,
    airport_heliport_apronelement_pt_jmmfwl.title,
    airport_heliport_apronelement_pt_jmmfwl.nilreason[1],
    airport_heliport_apronelement_pt_jmmfwl.href,
    geometry_elevatedsurface_view_cpyyva.geom,
    geometry_elevatedsurface_view_cpyyva.elevation,
    geometry_elevatedsurface_view_cpyyva.geoidUndulation,
    geometry_elevatedsurface_view_cpyyva.verticalDatum,
    geometry_elevatedsurface_view_cpyyva.verticalAccuracy,
    geometry_elevatedsurface_view_cpyyva.horizontalAccuracy
order by aircraftstand.identifier, aircraftstand_ts.sequence_number, aircraftstand_ts.correction_number DESC;
-- AirportClearanceServiceTimeSliceType
-- ['service.serviceoperationalstatus_view', 'notes.note_view', 'shared.contactinformation_view', 'geometry.elevatedpoint_view', 'service.callsigndetail_view']
create or replace view service.airportclearanceservice_view as
select distinct on (airportclearanceservice.identifier,airportclearanceservice_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.airportclearanceservice.id,
    service.airportclearanceservice_ts.id as ts_id,
    service.airportclearanceservice_tsp.id as tsp_id,
    service.airportclearanceservice.identifier,
    service.airportclearanceservice_ts.interpretation,
    service.airportclearanceservice_ts.sequence_number,
    service.airportclearanceservice_ts.correction_number,
    service.airportclearanceservice_ts.valid_time_begin,
    service.airportclearanceservice_ts.valid_time_end,
    service.airportclearanceservice_ts.feature_lifetime_begin,
    service.airportclearanceservice_ts.feature_lifetime_end,
    coalesce(cast(service.airportclearanceservice_ts.flightoperations_value as varchar), '(' || service.airportclearanceservice_ts.flightoperations_nilreason || ')') as flightoperations,
    coalesce(cast(service.airportclearanceservice_ts.rank_value as varchar), '(' || service.airportclearanceservice_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.airportclearanceservice_ts.complianticao_value as varchar), '(' || service.airportclearanceservice_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(service.airportclearanceservice_ts.name_value as varchar), '(' || service.airportclearanceservice_ts.name_nilreason || ')') as name,
    coalesce(cast(service.airportclearanceservice_ts.snowplan_value as varchar), '(' || service.airportclearanceservice_ts.snowplan_nilreason || ')') as snowplan,
    geometry_elevatedpoint_view_uetnus.geom AS geom,
    ST_X(geometry_elevatedpoint_view_uetnus.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_uetnus.geom) AS latitude,
    geometry_elevatedpoint_view_uetnus.elevation,
    geometry_elevatedpoint_view_uetnus.geoidUndulation,
    geometry_elevatedpoint_view_uetnus.verticalDatum,
    geometry_elevatedpoint_view_uetnus.verticalAccuracy,
    geometry_elevatedpoint_view_uetnus.horizontalAccuracy,
    coalesce(cast(organisation_unit_pt_qgcalf.title as varchar), '(' || organisation_unit_pt_qgcalf.nilreason[1] || ')') AS serviceprovider,
    organisation_unit_pt_qgcalf.href AS serviceprovider_href,
    jsonb_agg(service_callsigndetail_view_bidbdv.id) AS callsign,
    jsonb_build_object('id', service_radiocommunicationchannel_pt_tfwncy.id,
    'title', coalesce(cast(service_radiocommunicationchannel_pt_tfwncy.title AS varchar), '(' || service_radiocommunicationchannel_pt_tfwncy.nilreason[1] || ')'),
    'href', service_radiocommunicationchannel_pt_tfwncy.href) AS radiocommunication,
    jsonb_agg(service_serviceoperationalstatus_view_uwdgnf.id) AS availability,
    jsonb_agg(notes_note_view_hnyvhg.*) AS airportclearanceservice_annotation,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_msdkcf.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_msdkcf.title AS varchar), '(' || airport_heliport_airportheliport_pt_msdkcf.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_msdkcf.href) AS airportheliport
from service.airportclearanceservice 
inner join master_join mj2 on service.airportclearanceservice.id = mj2.source_id
inner join service.airportclearanceservice_tsp on mj2.target_id = service.airportclearanceservice_tsp.id
inner join service.airportclearanceservice_ts on service.airportclearanceservice_tsp.airportclearanceservicetimeslice_id = service.airportclearanceservice_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_uetnus on service.airportclearanceservice_ts.location_id = geometry_elevatedpoint_view_uetnus.id
left join organisation.unit_pt organisation_unit_pt_qgcalf on service.airportclearanceservice_ts.serviceprovider_id = organisation_unit_pt_qgcalf.id
left join master_join master_join_iqhayt on service.airportclearanceservice_ts.id = master_join_iqhayt.source_id
left join service.callsigndetail_view service_callsigndetail_view_bidbdv on master_join_iqhayt.target_id = service_callsigndetail_view_bidbdv.id
left join master_join master_join_mzxino on service.airportclearanceservice_ts.id = master_join_mzxino.source_id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_tfwncy on master_join_mzxino.target_id = service_radiocommunicationchannel_pt_tfwncy.id
left join master_join master_join_qtbwwf on service.airportclearanceservice_ts.id = master_join_qtbwwf.source_id
left join shared.contactinformation_view shared_contactinformation_view_zeecsr on master_join_qtbwwf.target_id = shared_contactinformation_view_zeecsr.id
left join master_join master_join_kdecbv on service.airportclearanceservice_ts.id = master_join_kdecbv.source_id
left join service.serviceoperationalstatus_view service_serviceoperationalstatus_view_uwdgnf on master_join_kdecbv.target_id = service_serviceoperationalstatus_view_uwdgnf.id
left join master_join master_join_eqariw on service.airportclearanceservice_ts.id = master_join_eqariw.source_id
left join notes.note_view notes_note_view_hnyvhg on master_join_eqariw.target_id = notes_note_view_hnyvhg.id
left join master_join master_join_srempe on service.airportclearanceservice_ts.id = master_join_srempe.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_msdkcf on master_join_srempe.target_id = airport_heliport_airportheliport_pt_msdkcf.id
where service.airportclearanceservice.feature_status = 'APPROVED'
  and service.airportclearanceservice_ts.feature_status = 'APPROVED'
group by
    service.airportclearanceservice.id,
    service.airportclearanceservice_ts.id,
    service.airportclearanceservice_tsp.id,
    service.airportclearanceservice.identifier,
    service.airportclearanceservice_ts.interpretation,
    service.airportclearanceservice_ts.sequence_number,
    service.airportclearanceservice_ts.correction_number,
    service.airportclearanceservice_ts.valid_time_begin,
    service.airportclearanceservice_ts.valid_time_end,
    service.airportclearanceservice_ts.feature_lifetime_begin,
    service.airportclearanceservice_ts.feature_lifetime_end,
    service.airportclearanceservice_ts.flightoperations_value,
    service.airportclearanceservice_ts.flightoperations_nilreason,
    service.airportclearanceservice_ts.rank_value,
    service.airportclearanceservice_ts.rank_nilreason,
    service.airportclearanceservice_ts.complianticao_value,
    service.airportclearanceservice_ts.complianticao_nilreason,
    service.airportclearanceservice_ts.name_value,
    service.airportclearanceservice_ts.name_nilreason,
    service.airportclearanceservice_ts.snowplan_value,
    service.airportclearanceservice_ts.snowplan_nilreason,
    geometry_elevatedpoint_view_uetnus.geom,
    geometry_elevatedpoint_view_uetnus.elevation,
    geometry_elevatedpoint_view_uetnus.geoidUndulation,
    geometry_elevatedpoint_view_uetnus.verticalDatum,
    geometry_elevatedpoint_view_uetnus.verticalAccuracy,
    geometry_elevatedpoint_view_uetnus.horizontalAccuracy,
    organisation_unit_pt_qgcalf.title,
    organisation_unit_pt_qgcalf.nilreason[1],
    organisation_unit_pt_qgcalf.href
order by airportclearanceservice.identifier, airportclearanceservice_ts.sequence_number, airportclearanceservice_ts.correction_number DESC;
-- AirportHeliportCollocationTimeSliceType
-- ['notes.note_view']
create or replace view airport_heliport.airportheliportcollocation_view as
select distinct on (airportheliportcollocation.identifier,airportheliportcollocation_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.airportheliportcollocation.id,
    airport_heliport.airportheliportcollocation_ts.id as ts_id,
    airport_heliport.airportheliportcollocation_tsp.id as tsp_id,
    airport_heliport.airportheliportcollocation.identifier,
    airport_heliport.airportheliportcollocation_ts.interpretation,
    airport_heliport.airportheliportcollocation_ts.sequence_number,
    airport_heliport.airportheliportcollocation_ts.correction_number,
    airport_heliport.airportheliportcollocation_ts.valid_time_begin,
    airport_heliport.airportheliportcollocation_ts.valid_time_end,
    airport_heliport.airportheliportcollocation_ts.feature_lifetime_begin,
    airport_heliport.airportheliportcollocation_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.airportheliportcollocation_ts.type_value as varchar), '(' || airport_heliport.airportheliportcollocation_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport_airportheliport_pt_eshmjk.title as varchar), '(' || airport_heliport_airportheliport_pt_eshmjk.nilreason[1] || ')') AS hostairport,
    airport_heliport_airportheliport_pt_eshmjk.href AS hostairport_href,
    coalesce(cast(airport_heliport_airportheliport_pt_vsdvtv.title as varchar), '(' || airport_heliport_airportheliport_pt_vsdvtv.nilreason[1] || ')') AS dependentairport,
    airport_heliport_airportheliport_pt_vsdvtv.href AS dependentairport_href,
    jsonb_agg(notes_note_view_upgakd.*) AS airportheliportcollocation_annotation
from airport_heliport.airportheliportcollocation 
inner join master_join mj2 on airport_heliport.airportheliportcollocation.id = mj2.source_id
inner join airport_heliport.airportheliportcollocation_tsp on mj2.target_id = airport_heliport.airportheliportcollocation_tsp.id
inner join airport_heliport.airportheliportcollocation_ts on airport_heliport.airportheliportcollocation_tsp.airportheliportcollocationtimeslice_id = airport_heliport.airportheliportcollocation_ts.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_eshmjk on airport_heliport.airportheliportcollocation_ts.hostairport_id = airport_heliport_airportheliport_pt_eshmjk.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_vsdvtv on airport_heliport.airportheliportcollocation_ts.dependentairport_id = airport_heliport_airportheliport_pt_vsdvtv.id
left join master_join master_join_pllvry on airport_heliport.airportheliportcollocation_ts.id = master_join_pllvry.source_id
left join notes.note_view notes_note_view_upgakd on master_join_pllvry.target_id = notes_note_view_upgakd.id
where airport_heliport.airportheliportcollocation.feature_status = 'APPROVED'
  and airport_heliport.airportheliportcollocation_ts.feature_status = 'APPROVED'
group by
    airport_heliport.airportheliportcollocation.id,
    airport_heliport.airportheliportcollocation_ts.id,
    airport_heliport.airportheliportcollocation_tsp.id,
    airport_heliport.airportheliportcollocation.identifier,
    airport_heliport.airportheliportcollocation_ts.interpretation,
    airport_heliport.airportheliportcollocation_ts.sequence_number,
    airport_heliport.airportheliportcollocation_ts.correction_number,
    airport_heliport.airportheliportcollocation_ts.valid_time_begin,
    airport_heliport.airportheliportcollocation_ts.valid_time_end,
    airport_heliport.airportheliportcollocation_ts.feature_lifetime_begin,
    airport_heliport.airportheliportcollocation_ts.feature_lifetime_end,
    airport_heliport.airportheliportcollocation_ts.type_value,
    airport_heliport.airportheliportcollocation_ts.type_nilreason,
    airport_heliport_airportheliport_pt_eshmjk.title,
    airport_heliport_airportheliport_pt_eshmjk.nilreason[1],
    airport_heliport_airportheliport_pt_eshmjk.href,
    airport_heliport_airportheliport_pt_vsdvtv.title,
    airport_heliport_airportheliport_pt_vsdvtv.nilreason[1],
    airport_heliport_airportheliport_pt_vsdvtv.href
order by airportheliportcollocation.identifier, airportheliportcollocation_ts.sequence_number, airportheliportcollocation_ts.correction_number DESC;
-- AirportHeliportTimeSliceType
-- ['airport_heliport.airportheliportcontamination_view', 'shared.contactinformation_view', 'notes.note_view', 'airport_heliport.city_view', 'geometry.elevatedsurface_view', 'geometry.elevatedpoint_view', 'airport_heliport.airportheliportavailability_view']
create or replace view airport_heliport.airportheliport_view as
select distinct on (airportheliport.identifier,airportheliport_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.airportheliport.id,
    airport_heliport.airportheliport_ts.id as ts_id,
    airport_heliport.airportheliport_tsp.id as tsp_id,
    airport_heliport.airportheliport.identifier,
    airport_heliport.airportheliport_ts.interpretation,
    airport_heliport.airportheliport_ts.sequence_number,
    airport_heliport.airportheliport_ts.correction_number,
    airport_heliport.airportheliport_ts.valid_time_begin,
    airport_heliport.airportheliport_ts.valid_time_end,
    airport_heliport.airportheliport_ts.feature_lifetime_begin,
    airport_heliport.airportheliport_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.airportheliport_ts.designator_value as varchar), '(' || airport_heliport.airportheliport_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airport_heliport.airportheliport_ts.name_value as varchar), '(' || airport_heliport.airportheliport_ts.name_nilreason || ')') as name,
    coalesce(cast(airport_heliport.airportheliport_ts.locationindicatoricao_value as varchar), '(' || airport_heliport.airportheliport_ts.locationindicatoricao_nilreason || ')') as locationindicatoricao,
    coalesce(cast(airport_heliport.airportheliport_ts.designatoriata_value as varchar), '(' || airport_heliport.airportheliport_ts.designatoriata_nilreason || ')') as designatoriata,
    coalesce(cast(airport_heliport.airportheliport_ts.type_value as varchar), '(' || airport_heliport.airportheliport_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.airportheliport_ts.certifiedicao_value as varchar), '(' || airport_heliport.airportheliport_ts.certifiedicao_nilreason || ')') as certifiedicao,
    coalesce(cast(airport_heliport.airportheliport_ts.privateuse_value as varchar), '(' || airport_heliport.airportheliport_ts.privateuse_nilreason || ')') as privateuse,
    coalesce(cast(airport_heliport.airportheliport_ts.controltype_value as varchar), '(' || airport_heliport.airportheliport_ts.controltype_nilreason || ')') as controltype,
    coalesce(cast(airport_heliport.airportheliport_ts.verticaldatum_value as varchar), '(' || airport_heliport.airportheliport_ts.verticaldatum_nilreason || ')') as verticaldatum,
    coalesce(cast(airport_heliport.airportheliport_ts.magneticvariation_value as varchar), '(' || airport_heliport.airportheliport_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(airport_heliport.airportheliport_ts.magneticvariationaccuracy_value as varchar), '(' || airport_heliport.airportheliport_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(airport_heliport.airportheliport_ts.datemagneticvariation_value as varchar), '(' || airport_heliport.airportheliport_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(airport_heliport.airportheliport_ts.magneticvariationchange_value as varchar), '(' || airport_heliport.airportheliport_ts.magneticvariationchange_nilreason || ')') as magneticvariationchange,
    coalesce(cast(airport_heliport.airportheliport_ts.altimeterchecklocation_value as varchar), '(' || airport_heliport.airportheliport_ts.altimeterchecklocation_nilreason || ')') as altimeterchecklocation,
    coalesce(cast(airport_heliport.airportheliport_ts.secondarypowersupply_value as varchar), '(' || airport_heliport.airportheliport_ts.secondarypowersupply_nilreason || ')') as secondarypowersupply,
    coalesce(cast(airport_heliport.airportheliport_ts.winddirectionindicator_value as varchar), '(' || airport_heliport.airportheliport_ts.winddirectionindicator_nilreason || ')') as winddirectionindicator,
    coalesce(cast(airport_heliport.airportheliport_ts.landingdirectionindicator_value as varchar), '(' || airport_heliport.airportheliport_ts.landingdirectionindicator_nilreason || ')') as landingdirectionindicator,
    coalesce(cast(airport_heliport.airportheliport_ts.abandoned_value as varchar), '(' || airport_heliport.airportheliport_ts.abandoned_nilreason || ')') as abandoned,
    coalesce(cast(airport_heliport.airportheliport_ts.fieldelevation_value as varchar) || ' ' || airport_heliport.airportheliport_ts.fieldelevation_uom, '(' || airport_heliport.airportheliport_ts.fieldelevation_nilreason || ')') as fieldelevation,
    coalesce(cast(airport_heliport.airportheliport_ts.fieldelevationaccuracy_value as varchar) || ' ' || airport_heliport.airportheliport_ts.fieldelevationaccuracy_uom, '(' || airport_heliport.airportheliport_ts.fieldelevationaccuracy_nilreason || ')') as fieldelevationaccuracy,
    coalesce(cast(airport_heliport.airportheliport_ts.referencetemperature_value as varchar) || ' ' || airport_heliport.airportheliport_ts.referencetemperature_uom, '(' || airport_heliport.airportheliport_ts.referencetemperature_nilreason || ')') as referencetemperature,
    coalesce(cast(airport_heliport.airportheliport_ts.transitionaltitude_value as varchar) || ' ' || airport_heliport.airportheliport_ts.transitionaltitude_uom, '(' || airport_heliport.airportheliport_ts.transitionaltitude_nilreason || ')') as transitionaltitude,
    coalesce(cast(airport_heliport.airportheliport_ts.transitionlevel_value as varchar) || ' ' || airport_heliport.airportheliport_ts.transitionlevel_uom, '(' || airport_heliport.airportheliport_ts.transitionlevel_nilreason || ')') as transitionlevel,
    coalesce(cast(airport_heliport.airportheliport_ts.lowesttemperature_value as varchar) || ' ' || airport_heliport.airportheliport_ts.lowesttemperature_uom, '(' || airport_heliport.airportheliport_ts.lowesttemperature_nilreason || ')') as lowesttemperature,
    coalesce(cast(airport_heliport_airportheliportresponsibilityorganisation_pt_rtahdu.title as varchar), '(' || airport_heliport_airportheliportresponsibilityorganisation_pt_rtahdu.nilreason[1] || ')') AS responsibleorganisation,
    airport_heliport_airportheliportresponsibilityorganisation_pt_rtahdu.href AS responsibleorganisation_href,
    geometry_elevatedpoint_view_zlvbyv.geom AS geom,
    ST_X(geometry_elevatedpoint_view_zlvbyv.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_zlvbyv.geom) AS latitude,
    geometry_elevatedpoint_view_zlvbyv.elevation,
    geometry_elevatedpoint_view_zlvbyv.geoidUndulation,
    geometry_elevatedpoint_view_zlvbyv.verticalDatum,
    geometry_elevatedpoint_view_zlvbyv.verticalAccuracy,
    geometry_elevatedpoint_view_zlvbyv.horizontalAccuracy,
    geometry_elevatedsurface_view_ghkfny.geom AS geom,
    geometry_elevatedsurface_view_ghkfny.elevation,
    geometry_elevatedsurface_view_ghkfny.geoidUndulation,
    geometry_elevatedsurface_view_ghkfny.verticalDatum,
    geometry_elevatedsurface_view_ghkfny.verticalAccuracy,
    geometry_elevatedsurface_view_ghkfny.horizontalAccuracy,
    jsonb_agg(airport_heliport_airportheliportcontamination_view_drmfmd.id) AS contaminant,
    jsonb_agg(airport_heliport_city_view_jssthk.id) AS servedcity,
    jsonb_build_object('id', airport_heliport_altimetersource_pt_jngxuc.id,
    'title', coalesce(cast(airport_heliport_altimetersource_pt_jngxuc.title AS varchar), '(' || airport_heliport_altimetersource_pt_jngxuc.nilreason[1] || ')'),
    'href', airport_heliport_altimetersource_pt_jngxuc.href) AS altimetersource,
    jsonb_agg(airport_heliport_airportheliportavailability_view_fdlmpf.id) AS availability,
    jsonb_agg(notes_note_view_sbgerm.*) AS airportheliport_annotation
from airport_heliport.airportheliport 
inner join master_join mj2 on airport_heliport.airportheliport.id = mj2.source_id
inner join airport_heliport.airportheliport_tsp on mj2.target_id = airport_heliport.airportheliport_tsp.id
inner join airport_heliport.airportheliport_ts on airport_heliport.airportheliport_tsp.airportheliporttimeslice_id = airport_heliport.airportheliport_ts.id
left join airport_heliport.airportheliportresponsibilityorganisation_pt airport_heliport_airportheliportresponsibilityorganisation_pt_rtahdu on airport_heliport.airportheliport_ts.responsibleorganisation_id = airport_heliport_airportheliportresponsibilityorganisation_pt_rtahdu.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_zlvbyv on airport_heliport.airportheliport_ts.arp_id = geometry_elevatedpoint_view_zlvbyv.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_ghkfny on airport_heliport.airportheliport_ts.aviationboundary_id = geometry_elevatedsurface_view_ghkfny.id
left join master_join master_join_yqnmib on airport_heliport.airportheliport_ts.id = master_join_yqnmib.source_id
left join airport_heliport.airportheliportcontamination_view airport_heliport_airportheliportcontamination_view_drmfmd on master_join_yqnmib.target_id = airport_heliport_airportheliportcontamination_view_drmfmd.id
left join master_join master_join_vxllyj on airport_heliport.airportheliport_ts.id = master_join_vxllyj.source_id
left join airport_heliport.city_view airport_heliport_city_view_jssthk on master_join_vxllyj.target_id = airport_heliport_city_view_jssthk.id
left join master_join master_join_jykiso on airport_heliport.airportheliport_ts.id = master_join_jykiso.source_id
left join airport_heliport.altimetersource_pt airport_heliport_altimetersource_pt_jngxuc on master_join_jykiso.target_id = airport_heliport_altimetersource_pt_jngxuc.id
left join master_join master_join_stktnf on airport_heliport.airportheliport_ts.id = master_join_stktnf.source_id
left join shared.contactinformation_view shared_contactinformation_view_mtdymv on master_join_stktnf.target_id = shared_contactinformation_view_mtdymv.id
left join master_join master_join_ttpvux on airport_heliport.airportheliport_ts.id = master_join_ttpvux.source_id
left join airport_heliport.airportheliportavailability_view airport_heliport_airportheliportavailability_view_fdlmpf on master_join_ttpvux.target_id = airport_heliport_airportheliportavailability_view_fdlmpf.id
left join master_join master_join_myllyj on airport_heliport.airportheliport_ts.id = master_join_myllyj.source_id
left join notes.note_view notes_note_view_sbgerm on master_join_myllyj.target_id = notes_note_view_sbgerm.id
where airport_heliport.airportheliport.feature_status = 'APPROVED'
  and airport_heliport.airportheliport_ts.feature_status = 'APPROVED'
group by
    airport_heliport.airportheliport.id,
    airport_heliport.airportheliport_ts.id,
    airport_heliport.airportheliport_tsp.id,
    airport_heliport.airportheliport.identifier,
    airport_heliport.airportheliport_ts.interpretation,
    airport_heliport.airportheliport_ts.sequence_number,
    airport_heliport.airportheliport_ts.correction_number,
    airport_heliport.airportheliport_ts.valid_time_begin,
    airport_heliport.airportheliport_ts.valid_time_end,
    airport_heliport.airportheliport_ts.feature_lifetime_begin,
    airport_heliport.airportheliport_ts.feature_lifetime_end,
    airport_heliport.airportheliport_ts.designator_value,
    airport_heliport.airportheliport_ts.designator_nilreason,
    airport_heliport.airportheliport_ts.name_value,
    airport_heliport.airportheliport_ts.name_nilreason,
    airport_heliport.airportheliport_ts.locationindicatoricao_value,
    airport_heliport.airportheliport_ts.locationindicatoricao_nilreason,
    airport_heliport.airportheliport_ts.designatoriata_value,
    airport_heliport.airportheliport_ts.designatoriata_nilreason,
    airport_heliport.airportheliport_ts.type_value,
    airport_heliport.airportheliport_ts.type_nilreason,
    airport_heliport.airportheliport_ts.certifiedicao_value,
    airport_heliport.airportheliport_ts.certifiedicao_nilreason,
    airport_heliport.airportheliport_ts.privateuse_value,
    airport_heliport.airportheliport_ts.privateuse_nilreason,
    airport_heliport.airportheliport_ts.controltype_value,
    airport_heliport.airportheliport_ts.controltype_nilreason,
    airport_heliport.airportheliport_ts.verticaldatum_value,
    airport_heliport.airportheliport_ts.verticaldatum_nilreason,
    airport_heliport.airportheliport_ts.magneticvariation_value,
    airport_heliport.airportheliport_ts.magneticvariation_nilreason,
    airport_heliport.airportheliport_ts.magneticvariationaccuracy_value,
    airport_heliport.airportheliport_ts.magneticvariationaccuracy_nilreason,
    airport_heliport.airportheliport_ts.datemagneticvariation_value,
    airport_heliport.airportheliport_ts.datemagneticvariation_nilreason,
    airport_heliport.airportheliport_ts.magneticvariationchange_value,
    airport_heliport.airportheliport_ts.magneticvariationchange_nilreason,
    airport_heliport.airportheliport_ts.altimeterchecklocation_value,
    airport_heliport.airportheliport_ts.altimeterchecklocation_nilreason,
    airport_heliport.airportheliport_ts.secondarypowersupply_value,
    airport_heliport.airportheliport_ts.secondarypowersupply_nilreason,
    airport_heliport.airportheliport_ts.winddirectionindicator_value,
    airport_heliport.airportheliport_ts.winddirectionindicator_nilreason,
    airport_heliport.airportheliport_ts.landingdirectionindicator_value,
    airport_heliport.airportheliport_ts.landingdirectionindicator_nilreason,
    airport_heliport.airportheliport_ts.abandoned_value,
    airport_heliport.airportheliport_ts.abandoned_nilreason,
    airport_heliport.airportheliport_ts.fieldelevation_value,
    airport_heliport.airportheliport_ts.fieldelevation_uom,
    airport_heliport.airportheliport_ts.fieldelevation_nilreason,
    airport_heliport.airportheliport_ts.fieldelevationaccuracy_value,
    airport_heliport.airportheliport_ts.fieldelevationaccuracy_uom,
    airport_heliport.airportheliport_ts.fieldelevationaccuracy_nilreason,
    airport_heliport.airportheliport_ts.referencetemperature_value,
    airport_heliport.airportheliport_ts.referencetemperature_uom,
    airport_heliport.airportheliport_ts.referencetemperature_nilreason,
    airport_heliport.airportheliport_ts.transitionaltitude_value,
    airport_heliport.airportheliport_ts.transitionaltitude_uom,
    airport_heliport.airportheliport_ts.transitionaltitude_nilreason,
    airport_heliport.airportheliport_ts.transitionlevel_value,
    airport_heliport.airportheliport_ts.transitionlevel_uom,
    airport_heliport.airportheliport_ts.transitionlevel_nilreason,
    airport_heliport.airportheliport_ts.lowesttemperature_value,
    airport_heliport.airportheliport_ts.lowesttemperature_uom,
    airport_heliport.airportheliport_ts.lowesttemperature_nilreason,
    airport_heliport_airportheliportresponsibilityorganisation_pt_rtahdu.title,
    airport_heliport_airportheliportresponsibilityorganisation_pt_rtahdu.nilreason[1],
    airport_heliport_airportheliportresponsibilityorganisation_pt_rtahdu.href,
    geometry_elevatedpoint_view_zlvbyv.geom,
    geometry_elevatedpoint_view_zlvbyv.elevation,
    geometry_elevatedpoint_view_zlvbyv.geoidUndulation,
    geometry_elevatedpoint_view_zlvbyv.verticalDatum,
    geometry_elevatedpoint_view_zlvbyv.verticalAccuracy,
    geometry_elevatedpoint_view_zlvbyv.horizontalAccuracy,
    geometry_elevatedsurface_view_ghkfny.geom,
    geometry_elevatedsurface_view_ghkfny.elevation,
    geometry_elevatedsurface_view_ghkfny.geoidUndulation,
    geometry_elevatedsurface_view_ghkfny.verticalDatum,
    geometry_elevatedsurface_view_ghkfny.verticalAccuracy,
    geometry_elevatedsurface_view_ghkfny.horizontalAccuracy
order by airportheliport.identifier, airportheliport_ts.sequence_number, airportheliport_ts.correction_number DESC;
-- AirportHotSpotTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view']
create or replace view airport_heliport.airporthotspot_view as
select distinct on (airporthotspot.identifier,airporthotspot_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.airporthotspot.id,
    airport_heliport.airporthotspot_ts.id as ts_id,
    airport_heliport.airporthotspot_tsp.id as tsp_id,
    airport_heliport.airporthotspot.identifier,
    airport_heliport.airporthotspot_ts.interpretation,
    airport_heliport.airporthotspot_ts.sequence_number,
    airport_heliport.airporthotspot_ts.correction_number,
    airport_heliport.airporthotspot_ts.valid_time_begin,
    airport_heliport.airporthotspot_ts.valid_time_end,
    airport_heliport.airporthotspot_ts.feature_lifetime_begin,
    airport_heliport.airporthotspot_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.airporthotspot_ts.designator_value as varchar), '(' || airport_heliport.airporthotspot_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airport_heliport.airporthotspot_ts.instruction_value as varchar), '(' || airport_heliport.airporthotspot_ts.instruction_nilreason || ')') as instruction,
    geometry_elevatedsurface_view_svokib.geom AS geom,
    geometry_elevatedsurface_view_svokib.elevation,
    geometry_elevatedsurface_view_svokib.geoidUndulation,
    geometry_elevatedsurface_view_svokib.verticalDatum,
    geometry_elevatedsurface_view_svokib.verticalAccuracy,
    geometry_elevatedsurface_view_svokib.horizontalAccuracy,
    coalesce(cast(airport_heliport_airportheliport_pt_atyngp.title as varchar), '(' || airport_heliport_airportheliport_pt_atyngp.nilreason[1] || ')') AS affectedairport,
    airport_heliport_airportheliport_pt_atyngp.href AS affectedairport_href,
    jsonb_agg(notes_note_view_jxrksn.*) AS airporthotspot_annotation
from airport_heliport.airporthotspot 
inner join master_join mj2 on airport_heliport.airporthotspot.id = mj2.source_id
inner join airport_heliport.airporthotspot_tsp on mj2.target_id = airport_heliport.airporthotspot_tsp.id
inner join airport_heliport.airporthotspot_ts on airport_heliport.airporthotspot_tsp.airporthotspottimeslice_id = airport_heliport.airporthotspot_ts.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_svokib on airport_heliport.airporthotspot_ts.area_id = geometry_elevatedsurface_view_svokib.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_atyngp on airport_heliport.airporthotspot_ts.affectedairport_id = airport_heliport_airportheliport_pt_atyngp.id
left join master_join master_join_ygaxum on airport_heliport.airporthotspot_ts.id = master_join_ygaxum.source_id
left join notes.note_view notes_note_view_jxrksn on master_join_ygaxum.target_id = notes_note_view_jxrksn.id
where airport_heliport.airporthotspot.feature_status = 'APPROVED'
  and airport_heliport.airporthotspot_ts.feature_status = 'APPROVED'
group by
    airport_heliport.airporthotspot.id,
    airport_heliport.airporthotspot_ts.id,
    airport_heliport.airporthotspot_tsp.id,
    airport_heliport.airporthotspot.identifier,
    airport_heliport.airporthotspot_ts.interpretation,
    airport_heliport.airporthotspot_ts.sequence_number,
    airport_heliport.airporthotspot_ts.correction_number,
    airport_heliport.airporthotspot_ts.valid_time_begin,
    airport_heliport.airporthotspot_ts.valid_time_end,
    airport_heliport.airporthotspot_ts.feature_lifetime_begin,
    airport_heliport.airporthotspot_ts.feature_lifetime_end,
    airport_heliport.airporthotspot_ts.designator_value,
    airport_heliport.airporthotspot_ts.designator_nilreason,
    airport_heliport.airporthotspot_ts.instruction_value,
    airport_heliport.airporthotspot_ts.instruction_nilreason,
    geometry_elevatedsurface_view_svokib.geom,
    geometry_elevatedsurface_view_svokib.elevation,
    geometry_elevatedsurface_view_svokib.geoidUndulation,
    geometry_elevatedsurface_view_svokib.verticalDatum,
    geometry_elevatedsurface_view_svokib.verticalAccuracy,
    geometry_elevatedsurface_view_svokib.horizontalAccuracy,
    airport_heliport_airportheliport_pt_atyngp.title,
    airport_heliport_airportheliport_pt_atyngp.nilreason[1],
    airport_heliport_airportheliport_pt_atyngp.href
order by airporthotspot.identifier, airporthotspot_ts.sequence_number, airporthotspot_ts.correction_number DESC;
-- AirportProtectionAreaMarkingTimeSliceType
-- ['notes.note_view', 'airport_heliport.markingelement_view']
create or replace view airport_heliport.airportprotectionareamarking_view as
select distinct on (airportprotectionareamarking.identifier,airportprotectionareamarking_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.airportprotectionareamarking.id,
    airport_heliport.airportprotectionareamarking_ts.id as ts_id,
    airport_heliport.airportprotectionareamarking_tsp.id as tsp_id,
    airport_heliport.airportprotectionareamarking.identifier,
    airport_heliport.airportprotectionareamarking_ts.interpretation,
    airport_heliport.airportprotectionareamarking_ts.sequence_number,
    airport_heliport.airportprotectionareamarking_ts.correction_number,
    airport_heliport.airportprotectionareamarking_ts.valid_time_begin,
    airport_heliport.airportprotectionareamarking_ts.valid_time_end,
    airport_heliport.airportprotectionareamarking_ts.feature_lifetime_begin,
    airport_heliport.airportprotectionareamarking_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.airportprotectionareamarking_ts.markingicaostandard_value as varchar), '(' || airport_heliport.airportprotectionareamarking_ts.markingicaostandard_nilreason || ')') as markingicaostandard,
    coalesce(cast(airport_heliport.airportprotectionareamarking_ts.condition_value as varchar), '(' || airport_heliport.airportprotectionareamarking_ts.condition_nilreason || ')') as condition,
    coalesce(cast(airport_heliport.airportprotectionareamarking_ts.markinglocation_value as varchar), '(' || airport_heliport.airportprotectionareamarking_ts.markinglocation_nilreason || ')') as markinglocation,
    jsonb_agg(airport_heliport_markingelement_view_xjzgjl.id) AS element,
    jsonb_agg(notes_note_view_lxepov.*) AS airportprotectionareamarking_annotation
from airport_heliport.airportprotectionareamarking 
inner join master_join mj2 on airport_heliport.airportprotectionareamarking.id = mj2.source_id
inner join airport_heliport.airportprotectionareamarking_tsp on mj2.target_id = airport_heliport.airportprotectionareamarking_tsp.id
inner join airport_heliport.airportprotectionareamarking_ts on airport_heliport.airportprotectionareamarking_tsp.airportprotectionareamarkingtimeslice_id = airport_heliport.airportprotectionareamarking_ts.id
left join master_join master_join_dklxdv on airport_heliport.airportprotectionareamarking_ts.id = master_join_dklxdv.source_id
left join airport_heliport.markingelement_view airport_heliport_markingelement_view_xjzgjl on master_join_dklxdv.target_id = airport_heliport_markingelement_view_xjzgjl.id
left join master_join master_join_gkdyzu on airport_heliport.airportprotectionareamarking_ts.id = master_join_gkdyzu.source_id
left join notes.note_view notes_note_view_lxepov on master_join_gkdyzu.target_id = notes_note_view_lxepov.id
where airport_heliport.airportprotectionareamarking.feature_status = 'APPROVED'
  and airport_heliport.airportprotectionareamarking_ts.feature_status = 'APPROVED'
group by
    airport_heliport.airportprotectionareamarking.id,
    airport_heliport.airportprotectionareamarking_ts.id,
    airport_heliport.airportprotectionareamarking_tsp.id,
    airport_heliport.airportprotectionareamarking.identifier,
    airport_heliport.airportprotectionareamarking_ts.interpretation,
    airport_heliport.airportprotectionareamarking_ts.sequence_number,
    airport_heliport.airportprotectionareamarking_ts.correction_number,
    airport_heliport.airportprotectionareamarking_ts.valid_time_begin,
    airport_heliport.airportprotectionareamarking_ts.valid_time_end,
    airport_heliport.airportprotectionareamarking_ts.feature_lifetime_begin,
    airport_heliport.airportprotectionareamarking_ts.feature_lifetime_end,
    airport_heliport.airportprotectionareamarking_ts.markingicaostandard_value,
    airport_heliport.airportprotectionareamarking_ts.markingicaostandard_nilreason,
    airport_heliport.airportprotectionareamarking_ts.condition_value,
    airport_heliport.airportprotectionareamarking_ts.condition_nilreason,
    airport_heliport.airportprotectionareamarking_ts.markinglocation_value,
    airport_heliport.airportprotectionareamarking_ts.markinglocation_nilreason
order by airportprotectionareamarking.identifier, airportprotectionareamarking_ts.sequence_number, airportprotectionareamarking_ts.correction_number DESC;
-- AirportSuppliesServiceTimeSliceType
-- ['service.serviceoperationalstatus_view', 'service.fuel_view', 'notes.note_view', 'shared.contactinformation_view', 'service.oxygen_view', 'service.oil_view', 'geometry.elevatedpoint_view', 'service.callsigndetail_view', 'service.nitrogen_view']
create or replace view service.airportsuppliesservice_view as
select distinct on (airportsuppliesservice.identifier,airportsuppliesservice_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.airportsuppliesservice.id,
    service.airportsuppliesservice_ts.id as ts_id,
    service.airportsuppliesservice_tsp.id as tsp_id,
    service.airportsuppliesservice.identifier,
    service.airportsuppliesservice_ts.interpretation,
    service.airportsuppliesservice_ts.sequence_number,
    service.airportsuppliesservice_ts.correction_number,
    service.airportsuppliesservice_ts.valid_time_begin,
    service.airportsuppliesservice_ts.valid_time_end,
    service.airportsuppliesservice_ts.feature_lifetime_begin,
    service.airportsuppliesservice_ts.feature_lifetime_end,
    coalesce(cast(service.airportsuppliesservice_ts.flightoperations_value as varchar), '(' || service.airportsuppliesservice_ts.flightoperations_nilreason || ')') as flightoperations,
    coalesce(cast(service.airportsuppliesservice_ts.rank_value as varchar), '(' || service.airportsuppliesservice_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.airportsuppliesservice_ts.complianticao_value as varchar), '(' || service.airportsuppliesservice_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(service.airportsuppliesservice_ts.name_value as varchar), '(' || service.airportsuppliesservice_ts.name_nilreason || ')') as name,
    geometry_elevatedpoint_view_cbcfye.geom AS geom,
    ST_X(geometry_elevatedpoint_view_cbcfye.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_cbcfye.geom) AS latitude,
    geometry_elevatedpoint_view_cbcfye.elevation,
    geometry_elevatedpoint_view_cbcfye.geoidUndulation,
    geometry_elevatedpoint_view_cbcfye.verticalDatum,
    geometry_elevatedpoint_view_cbcfye.verticalAccuracy,
    geometry_elevatedpoint_view_cbcfye.horizontalAccuracy,
    coalesce(cast(organisation_unit_pt_sgssep.title as varchar), '(' || organisation_unit_pt_sgssep.nilreason[1] || ')') AS serviceprovider,
    organisation_unit_pt_sgssep.href AS serviceprovider_href,
    jsonb_agg(service_callsigndetail_view_bbpvhu.id) AS callsign,
    jsonb_build_object('id', service_radiocommunicationchannel_pt_byvwko.id,
    'title', coalesce(cast(service_radiocommunicationchannel_pt_byvwko.title AS varchar), '(' || service_radiocommunicationchannel_pt_byvwko.nilreason[1] || ')'),
    'href', service_radiocommunicationchannel_pt_byvwko.href) AS radiocommunication,
    jsonb_agg(service_serviceoperationalstatus_view_rydhdx.id) AS availability,
    jsonb_agg(notes_note_view_itjqhn.*) AS airportsuppliesservice_annotation,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_efhamp.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_efhamp.title AS varchar), '(' || airport_heliport_airportheliport_pt_efhamp.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_efhamp.href) AS airportheliport,
    jsonb_agg(service_fuel_view_mielku.id) AS fuelsupply,
    jsonb_agg(service_oil_view_bqmdsh.id) AS oilsupply,
    jsonb_agg(service_nitrogen_view_bvnajj.id) AS nitrogensupply,
    jsonb_agg(service_oxygen_view_vkfpig.id) AS oxygensupply
from service.airportsuppliesservice 
inner join master_join mj2 on service.airportsuppliesservice.id = mj2.source_id
inner join service.airportsuppliesservice_tsp on mj2.target_id = service.airportsuppliesservice_tsp.id
inner join service.airportsuppliesservice_ts on service.airportsuppliesservice_tsp.airportsuppliesservicetimeslice_id = service.airportsuppliesservice_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_cbcfye on service.airportsuppliesservice_ts.location_id = geometry_elevatedpoint_view_cbcfye.id
left join organisation.unit_pt organisation_unit_pt_sgssep on service.airportsuppliesservice_ts.serviceprovider_id = organisation_unit_pt_sgssep.id
left join master_join master_join_pfzirx on service.airportsuppliesservice_ts.id = master_join_pfzirx.source_id
left join service.callsigndetail_view service_callsigndetail_view_bbpvhu on master_join_pfzirx.target_id = service_callsigndetail_view_bbpvhu.id
left join master_join master_join_zgqpfj on service.airportsuppliesservice_ts.id = master_join_zgqpfj.source_id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_byvwko on master_join_zgqpfj.target_id = service_radiocommunicationchannel_pt_byvwko.id
left join master_join master_join_vtxrqj on service.airportsuppliesservice_ts.id = master_join_vtxrqj.source_id
left join shared.contactinformation_view shared_contactinformation_view_tocndm on master_join_vtxrqj.target_id = shared_contactinformation_view_tocndm.id
left join master_join master_join_hemtma on service.airportsuppliesservice_ts.id = master_join_hemtma.source_id
left join service.serviceoperationalstatus_view service_serviceoperationalstatus_view_rydhdx on master_join_hemtma.target_id = service_serviceoperationalstatus_view_rydhdx.id
left join master_join master_join_yjlunv on service.airportsuppliesservice_ts.id = master_join_yjlunv.source_id
left join notes.note_view notes_note_view_itjqhn on master_join_yjlunv.target_id = notes_note_view_itjqhn.id
left join master_join master_join_kvtxyd on service.airportsuppliesservice_ts.id = master_join_kvtxyd.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_efhamp on master_join_kvtxyd.target_id = airport_heliport_airportheliport_pt_efhamp.id
left join master_join master_join_ymmxuq on service.airportsuppliesservice_ts.id = master_join_ymmxuq.source_id
left join service.fuel_view service_fuel_view_mielku on master_join_ymmxuq.target_id = service_fuel_view_mielku.id
left join master_join master_join_wnmvxu on service.airportsuppliesservice_ts.id = master_join_wnmvxu.source_id
left join service.oil_view service_oil_view_bqmdsh on master_join_wnmvxu.target_id = service_oil_view_bqmdsh.id
left join master_join master_join_sliuja on service.airportsuppliesservice_ts.id = master_join_sliuja.source_id
left join service.nitrogen_view service_nitrogen_view_bvnajj on master_join_sliuja.target_id = service_nitrogen_view_bvnajj.id
left join master_join master_join_yeirao on service.airportsuppliesservice_ts.id = master_join_yeirao.source_id
left join service.oxygen_view service_oxygen_view_vkfpig on master_join_yeirao.target_id = service_oxygen_view_vkfpig.id
where service.airportsuppliesservice.feature_status = 'APPROVED'
  and service.airportsuppliesservice_ts.feature_status = 'APPROVED'
group by
    service.airportsuppliesservice.id,
    service.airportsuppliesservice_ts.id,
    service.airportsuppliesservice_tsp.id,
    service.airportsuppliesservice.identifier,
    service.airportsuppliesservice_ts.interpretation,
    service.airportsuppliesservice_ts.sequence_number,
    service.airportsuppliesservice_ts.correction_number,
    service.airportsuppliesservice_ts.valid_time_begin,
    service.airportsuppliesservice_ts.valid_time_end,
    service.airportsuppliesservice_ts.feature_lifetime_begin,
    service.airportsuppliesservice_ts.feature_lifetime_end,
    service.airportsuppliesservice_ts.flightoperations_value,
    service.airportsuppliesservice_ts.flightoperations_nilreason,
    service.airportsuppliesservice_ts.rank_value,
    service.airportsuppliesservice_ts.rank_nilreason,
    service.airportsuppliesservice_ts.complianticao_value,
    service.airportsuppliesservice_ts.complianticao_nilreason,
    service.airportsuppliesservice_ts.name_value,
    service.airportsuppliesservice_ts.name_nilreason,
    geometry_elevatedpoint_view_cbcfye.geom,
    geometry_elevatedpoint_view_cbcfye.elevation,
    geometry_elevatedpoint_view_cbcfye.geoidUndulation,
    geometry_elevatedpoint_view_cbcfye.verticalDatum,
    geometry_elevatedpoint_view_cbcfye.verticalAccuracy,
    geometry_elevatedpoint_view_cbcfye.horizontalAccuracy,
    organisation_unit_pt_sgssep.title,
    organisation_unit_pt_sgssep.nilreason[1],
    organisation_unit_pt_sgssep.href
order by airportsuppliesservice.identifier, airportsuppliesservice_ts.sequence_number, airportsuppliesservice_ts.correction_number DESC;
-- AirspaceBorderCrossingTimeSliceType
-- ['notes.note_view']
create or replace view routes.airspacebordercrossing_view as
select distinct on (airspacebordercrossing.identifier,airspacebordercrossing_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    routes.airspacebordercrossing.id,
    routes.airspacebordercrossing_ts.id as ts_id,
    routes.airspacebordercrossing_tsp.id as tsp_id,
    routes.airspacebordercrossing.identifier,
    routes.airspacebordercrossing_ts.interpretation,
    routes.airspacebordercrossing_ts.sequence_number,
    routes.airspacebordercrossing_ts.correction_number,
    routes.airspacebordercrossing_ts.valid_time_begin,
    routes.airspacebordercrossing_ts.valid_time_end,
    routes.airspacebordercrossing_ts.feature_lifetime_begin,
    routes.airspacebordercrossing_ts.feature_lifetime_end,
    coalesce(cast(airspace_airspace_pt_yexzan.title as varchar), '(' || airspace_airspace_pt_yexzan.nilreason[1] || ')') AS exitedairspace,
    airspace_airspace_pt_yexzan.href AS exitedairspace_href,
    coalesce(cast(airspace_airspace_pt_vchcjr.title as varchar), '(' || airspace_airspace_pt_vchcjr.nilreason[1] || ')') AS enteredairspace,
    airspace_airspace_pt_vchcjr.href AS enteredairspace_href,
    jsonb_agg(notes_note_view_dnltyi.*) AS airspacebordercrossing_annotation
from routes.airspacebordercrossing 
inner join master_join mj2 on routes.airspacebordercrossing.id = mj2.source_id
inner join routes.airspacebordercrossing_tsp on mj2.target_id = routes.airspacebordercrossing_tsp.id
inner join routes.airspacebordercrossing_ts on routes.airspacebordercrossing_tsp.airspacebordercrossingtimeslice_id = routes.airspacebordercrossing_ts.id
left join airspace.airspace_pt airspace_airspace_pt_yexzan on routes.airspacebordercrossing_ts.exitedairspace_id = airspace_airspace_pt_yexzan.id
left join airspace.airspace_pt airspace_airspace_pt_vchcjr on routes.airspacebordercrossing_ts.enteredairspace_id = airspace_airspace_pt_vchcjr.id
left join master_join master_join_bfwltz on routes.airspacebordercrossing_ts.id = master_join_bfwltz.source_id
left join notes.note_view notes_note_view_dnltyi on master_join_bfwltz.target_id = notes_note_view_dnltyi.id
where routes.airspacebordercrossing.feature_status = 'APPROVED'
  and routes.airspacebordercrossing_ts.feature_status = 'APPROVED'
group by
    routes.airspacebordercrossing.id,
    routes.airspacebordercrossing_ts.id,
    routes.airspacebordercrossing_tsp.id,
    routes.airspacebordercrossing.identifier,
    routes.airspacebordercrossing_ts.interpretation,
    routes.airspacebordercrossing_ts.sequence_number,
    routes.airspacebordercrossing_ts.correction_number,
    routes.airspacebordercrossing_ts.valid_time_begin,
    routes.airspacebordercrossing_ts.valid_time_end,
    routes.airspacebordercrossing_ts.feature_lifetime_begin,
    routes.airspacebordercrossing_ts.feature_lifetime_end,
    airspace_airspace_pt_yexzan.title,
    airspace_airspace_pt_yexzan.nilreason[1],
    airspace_airspace_pt_yexzan.href,
    airspace_airspace_pt_vchcjr.title,
    airspace_airspace_pt_vchcjr.nilreason[1],
    airspace_airspace_pt_vchcjr.href
order by airspacebordercrossing.identifier, airspacebordercrossing_ts.sequence_number, airspacebordercrossing_ts.correction_number DESC;
-- AirspaceTimeSliceType
-- ['airspace.airspacelayerclass_view', 'notes.note_view', 'airspace.airspacegeometrycomponent_view', 'airspace.airspaceactivation_view']
create or replace view airspace.airspace_view as
select distinct on (airspace.identifier,airspace_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airspace.airspace.id,
    airspace.airspace_ts.id as ts_id,
    airspace.airspace_tsp.id as tsp_id,
    airspace.airspace.identifier,
    airspace.airspace_ts.interpretation,
    airspace.airspace_ts.sequence_number,
    airspace.airspace_ts.correction_number,
    airspace.airspace_ts.valid_time_begin,
    airspace.airspace_ts.valid_time_end,
    airspace.airspace_ts.feature_lifetime_begin,
    airspace.airspace_ts.feature_lifetime_end,
    coalesce(cast(airspace.airspace_ts.type_value as varchar), '(' || airspace.airspace_ts.type_nilreason || ')') as type,
    coalesce(cast(airspace.airspace_ts.designator_value as varchar), '(' || airspace.airspace_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airspace.airspace_ts.localtype_value as varchar), '(' || airspace.airspace_ts.localtype_nilreason || ')') as localtype,
    coalesce(cast(airspace.airspace_ts.name_value as varchar), '(' || airspace.airspace_ts.name_nilreason || ')') as name,
    coalesce(cast(airspace.airspace_ts.designatoricao_value as varchar), '(' || airspace.airspace_ts.designatoricao_nilreason || ')') as designatoricao,
    coalesce(cast(airspace.airspace_ts.controltype_value as varchar), '(' || airspace.airspace_ts.controltype_nilreason || ')') as controltype,
    coalesce(cast(airspace.airspace_ts.upperlowerseparation_value as varchar) || ' ' || airspace.airspace_ts.upperlowerseparation_uom, '(' || airspace.airspace_ts.upperlowerseparation_nilreason || ')') as upperlowerseparation,
    coalesce(cast(routes_route_pt_ufghre.title as varchar), '(' || routes_route_pt_ufghre.nilreason[1] || ')') AS protectedroute,
    routes_route_pt_ufghre.href AS protectedroute_href,
    jsonb_agg(airspace_airspacelayerclass_view_zkxprq.id) AS clazz,
    jsonb_agg(airspace_airspacegeometrycomponent_view_oqmlox.id) AS geometrycomponent,
    jsonb_agg(airspace_airspaceactivation_view_ivxtqr.id) AS activation,
    jsonb_agg(notes_note_view_bwpget.*) AS airspace_annotation
from airspace.airspace 
inner join master_join mj2 on airspace.airspace.id = mj2.source_id
inner join airspace.airspace_tsp on mj2.target_id = airspace.airspace_tsp.id
inner join airspace.airspace_ts on airspace.airspace_tsp.airspacetimeslice_id = airspace.airspace_ts.id
left join routes.route_pt routes_route_pt_ufghre on airspace.airspace_ts.protectedroute_id = routes_route_pt_ufghre.id
left join master_join master_join_ruddie on airspace.airspace_ts.id = master_join_ruddie.source_id
left join airspace.airspacelayerclass_view airspace_airspacelayerclass_view_zkxprq on master_join_ruddie.target_id = airspace_airspacelayerclass_view_zkxprq.id
left join master_join master_join_poelxp on airspace.airspace_ts.id = master_join_poelxp.source_id
left join airspace.airspacegeometrycomponent_view airspace_airspacegeometrycomponent_view_oqmlox on master_join_poelxp.target_id = airspace_airspacegeometrycomponent_view_oqmlox.id
left join master_join master_join_yxssbl on airspace.airspace_ts.id = master_join_yxssbl.source_id
left join airspace.airspaceactivation_view airspace_airspaceactivation_view_ivxtqr on master_join_yxssbl.target_id = airspace_airspaceactivation_view_ivxtqr.id
left join master_join master_join_gmdfko on airspace.airspace_ts.id = master_join_gmdfko.source_id
left join notes.note_view notes_note_view_bwpget on master_join_gmdfko.target_id = notes_note_view_bwpget.id
where airspace.airspace.feature_status = 'APPROVED'
  and airspace.airspace_ts.feature_status = 'APPROVED'
group by
    airspace.airspace.id,
    airspace.airspace_ts.id,
    airspace.airspace_tsp.id,
    airspace.airspace.identifier,
    airspace.airspace_ts.interpretation,
    airspace.airspace_ts.sequence_number,
    airspace.airspace_ts.correction_number,
    airspace.airspace_ts.valid_time_begin,
    airspace.airspace_ts.valid_time_end,
    airspace.airspace_ts.feature_lifetime_begin,
    airspace.airspace_ts.feature_lifetime_end,
    airspace.airspace_ts.type_value,
    airspace.airspace_ts.type_nilreason,
    airspace.airspace_ts.designator_value,
    airspace.airspace_ts.designator_nilreason,
    airspace.airspace_ts.localtype_value,
    airspace.airspace_ts.localtype_nilreason,
    airspace.airspace_ts.name_value,
    airspace.airspace_ts.name_nilreason,
    airspace.airspace_ts.designatoricao_value,
    airspace.airspace_ts.designatoricao_nilreason,
    airspace.airspace_ts.controltype_value,
    airspace.airspace_ts.controltype_nilreason,
    airspace.airspace_ts.upperlowerseparation_value,
    airspace.airspace_ts.upperlowerseparation_uom,
    airspace.airspace_ts.upperlowerseparation_nilreason,
    routes_route_pt_ufghre.title,
    routes_route_pt_ufghre.nilreason[1],
    routes_route_pt_ufghre.href
order by airspace.identifier, airspace_ts.sequence_number, airspace_ts.correction_number DESC;
-- AirTrafficControlServiceTimeSliceType
-- ['service.serviceoperationalstatus_view', 'notes.note_view', 'shared.contactinformation_view', 'routes.routeportion_view', 'geometry.elevatedpoint_view', 'service.callsigndetail_view']
create or replace view service.airtrafficcontrolservice_view as
select distinct on (airtrafficcontrolservice.identifier,airtrafficcontrolservice_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.airtrafficcontrolservice.id,
    service.airtrafficcontrolservice_ts.id as ts_id,
    service.airtrafficcontrolservice_tsp.id as tsp_id,
    service.airtrafficcontrolservice.identifier,
    service.airtrafficcontrolservice_ts.interpretation,
    service.airtrafficcontrolservice_ts.sequence_number,
    service.airtrafficcontrolservice_ts.correction_number,
    service.airtrafficcontrolservice_ts.valid_time_begin,
    service.airtrafficcontrolservice_ts.valid_time_end,
    service.airtrafficcontrolservice_ts.feature_lifetime_begin,
    service.airtrafficcontrolservice_ts.feature_lifetime_end,
    coalesce(cast(service.airtrafficcontrolservice_ts.flightoperations_value as varchar), '(' || service.airtrafficcontrolservice_ts.flightoperations_nilreason || ')') as flightoperations,
    coalesce(cast(service.airtrafficcontrolservice_ts.rank_value as varchar), '(' || service.airtrafficcontrolservice_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.airtrafficcontrolservice_ts.complianticao_value as varchar), '(' || service.airtrafficcontrolservice_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(service.airtrafficcontrolservice_ts.name_value as varchar), '(' || service.airtrafficcontrolservice_ts.name_nilreason || ')') as name,
    coalesce(cast(service.airtrafficcontrolservice_ts.radarassisted_value as varchar), '(' || service.airtrafficcontrolservice_ts.radarassisted_nilreason || ')') as radarassisted,
    coalesce(cast(service.airtrafficcontrolservice_ts.datalinkenabled_value as varchar), '(' || service.airtrafficcontrolservice_ts.datalinkenabled_nilreason || ')') as datalinkenabled,
    coalesce(cast(service.airtrafficcontrolservice_ts.datalinkchannel_value as varchar), '(' || service.airtrafficcontrolservice_ts.datalinkchannel_nilreason || ')') as datalinkchannel,
    coalesce(cast(service.airtrafficcontrolservice_ts.type_value as varchar), '(' || service.airtrafficcontrolservice_ts.type_nilreason || ')') as type,
    geometry_elevatedpoint_view_eyfqem.geom AS geom,
    ST_X(geometry_elevatedpoint_view_eyfqem.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_eyfqem.geom) AS latitude,
    geometry_elevatedpoint_view_eyfqem.elevation,
    geometry_elevatedpoint_view_eyfqem.geoidUndulation,
    geometry_elevatedpoint_view_eyfqem.verticalDatum,
    geometry_elevatedpoint_view_eyfqem.verticalAccuracy,
    geometry_elevatedpoint_view_eyfqem.horizontalAccuracy,
    coalesce(cast(organisation_unit_pt_vehmsd.title as varchar), '(' || organisation_unit_pt_vehmsd.nilreason[1] || ')') AS serviceprovider,
    organisation_unit_pt_vehmsd.href AS serviceprovider_href,
    coalesce(cast(navaids_points_directionfinder_pt_rpgsay.title as varchar), '(' || navaids_points_directionfinder_pt_rpgsay.nilreason[1] || ')') AS aircraftlocator,
    navaids_points_directionfinder_pt_rpgsay.href AS aircraftlocator_href,
    jsonb_agg(service_callsigndetail_view_fqmhps.id) AS callsign,
    jsonb_build_object('id', service_radiocommunicationchannel_pt_sadfvr.id,
    'title', coalesce(cast(service_radiocommunicationchannel_pt_sadfvr.title AS varchar), '(' || service_radiocommunicationchannel_pt_sadfvr.nilreason[1] || ')'),
    'href', service_radiocommunicationchannel_pt_sadfvr.href) AS radiocommunication,
    jsonb_agg(service_serviceoperationalstatus_view_rpxkpp.id) AS availability,
    jsonb_agg(notes_note_view_jvlovj.*) AS airtrafficcontrolservice_annotation,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_etfanu.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_etfanu.title AS varchar), '(' || airport_heliport_airportheliport_pt_etfanu.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_etfanu.href) AS clientairport,
    jsonb_build_object('id', airspace_airspace_pt_qvkdsi.id,
    'title', coalesce(cast(airspace_airspace_pt_qvkdsi.title AS varchar), '(' || airspace_airspace_pt_qvkdsi.nilreason[1] || ')'),
    'href', airspace_airspace_pt_qvkdsi.href) AS clientairspace,
    jsonb_agg(routes_routeportion_view_stcrpo.id) AS clientroute,
    jsonb_build_object('id', holding_holdingpattern_pt_juelpg.id,
    'title', coalesce(cast(holding_holdingpattern_pt_juelpg.title AS varchar), '(' || holding_holdingpattern_pt_juelpg.nilreason[1] || ')'),
    'href', holding_holdingpattern_pt_juelpg.href) AS clientholding,
    jsonb_build_object('id', aerial_refuelling_aerialrefuelling_pt_ndsdmv.id,
    'title', coalesce(cast(aerial_refuelling_aerialrefuelling_pt_ndsdmv.title AS varchar), '(' || aerial_refuelling_aerialrefuelling_pt_ndsdmv.nilreason[1] || ')'),
    'href', aerial_refuelling_aerialrefuelling_pt_ndsdmv.href) AS clientaerialrefuelling
from service.airtrafficcontrolservice 
inner join master_join mj2 on service.airtrafficcontrolservice.id = mj2.source_id
inner join service.airtrafficcontrolservice_tsp on mj2.target_id = service.airtrafficcontrolservice_tsp.id
inner join service.airtrafficcontrolservice_ts on service.airtrafficcontrolservice_tsp.airtrafficcontrolservicetimeslice_id = service.airtrafficcontrolservice_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_eyfqem on service.airtrafficcontrolservice_ts.location_id = geometry_elevatedpoint_view_eyfqem.id
left join organisation.unit_pt organisation_unit_pt_vehmsd on service.airtrafficcontrolservice_ts.serviceprovider_id = organisation_unit_pt_vehmsd.id
left join navaids_points.directionfinder_pt navaids_points_directionfinder_pt_rpgsay on service.airtrafficcontrolservice_ts.aircraftlocator_id = navaids_points_directionfinder_pt_rpgsay.id
left join master_join master_join_imbgli on service.airtrafficcontrolservice_ts.id = master_join_imbgli.source_id
left join service.callsigndetail_view service_callsigndetail_view_fqmhps on master_join_imbgli.target_id = service_callsigndetail_view_fqmhps.id
left join master_join master_join_okdvgt on service.airtrafficcontrolservice_ts.id = master_join_okdvgt.source_id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_sadfvr on master_join_okdvgt.target_id = service_radiocommunicationchannel_pt_sadfvr.id
left join master_join master_join_ialyza on service.airtrafficcontrolservice_ts.id = master_join_ialyza.source_id
left join shared.contactinformation_view shared_contactinformation_view_voxwfq on master_join_ialyza.target_id = shared_contactinformation_view_voxwfq.id
left join master_join master_join_lzhmle on service.airtrafficcontrolservice_ts.id = master_join_lzhmle.source_id
left join service.serviceoperationalstatus_view service_serviceoperationalstatus_view_rpxkpp on master_join_lzhmle.target_id = service_serviceoperationalstatus_view_rpxkpp.id
left join master_join master_join_cveppa on service.airtrafficcontrolservice_ts.id = master_join_cveppa.source_id
left join notes.note_view notes_note_view_jvlovj on master_join_cveppa.target_id = notes_note_view_jvlovj.id
left join master_join master_join_hsujow on service.airtrafficcontrolservice_ts.id = master_join_hsujow.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_etfanu on master_join_hsujow.target_id = airport_heliport_airportheliport_pt_etfanu.id
left join master_join master_join_hpvxex on service.airtrafficcontrolservice_ts.id = master_join_hpvxex.source_id
left join airspace.airspace_pt airspace_airspace_pt_qvkdsi on master_join_hpvxex.target_id = airspace_airspace_pt_qvkdsi.id
left join master_join master_join_weagsd on service.airtrafficcontrolservice_ts.id = master_join_weagsd.source_id
left join routes.routeportion_view routes_routeportion_view_stcrpo on master_join_weagsd.target_id = routes_routeportion_view_stcrpo.id
left join master_join master_join_aoeswr on service.airtrafficcontrolservice_ts.id = master_join_aoeswr.source_id
left join holding.holdingpattern_pt holding_holdingpattern_pt_juelpg on master_join_aoeswr.target_id = holding_holdingpattern_pt_juelpg.id
left join master_join master_join_wmverm on service.airtrafficcontrolservice_ts.id = master_join_wmverm.source_id
left join aerial_refuelling.aerialrefuelling_pt aerial_refuelling_aerialrefuelling_pt_ndsdmv on master_join_wmverm.target_id = aerial_refuelling_aerialrefuelling_pt_ndsdmv.id
where service.airtrafficcontrolservice.feature_status = 'APPROVED'
  and service.airtrafficcontrolservice_ts.feature_status = 'APPROVED'
group by
    service.airtrafficcontrolservice.id,
    service.airtrafficcontrolservice_ts.id,
    service.airtrafficcontrolservice_tsp.id,
    service.airtrafficcontrolservice.identifier,
    service.airtrafficcontrolservice_ts.interpretation,
    service.airtrafficcontrolservice_ts.sequence_number,
    service.airtrafficcontrolservice_ts.correction_number,
    service.airtrafficcontrolservice_ts.valid_time_begin,
    service.airtrafficcontrolservice_ts.valid_time_end,
    service.airtrafficcontrolservice_ts.feature_lifetime_begin,
    service.airtrafficcontrolservice_ts.feature_lifetime_end,
    service.airtrafficcontrolservice_ts.flightoperations_value,
    service.airtrafficcontrolservice_ts.flightoperations_nilreason,
    service.airtrafficcontrolservice_ts.rank_value,
    service.airtrafficcontrolservice_ts.rank_nilreason,
    service.airtrafficcontrolservice_ts.complianticao_value,
    service.airtrafficcontrolservice_ts.complianticao_nilreason,
    service.airtrafficcontrolservice_ts.name_value,
    service.airtrafficcontrolservice_ts.name_nilreason,
    service.airtrafficcontrolservice_ts.radarassisted_value,
    service.airtrafficcontrolservice_ts.radarassisted_nilreason,
    service.airtrafficcontrolservice_ts.datalinkenabled_value,
    service.airtrafficcontrolservice_ts.datalinkenabled_nilreason,
    service.airtrafficcontrolservice_ts.datalinkchannel_value,
    service.airtrafficcontrolservice_ts.datalinkchannel_nilreason,
    service.airtrafficcontrolservice_ts.type_value,
    service.airtrafficcontrolservice_ts.type_nilreason,
    geometry_elevatedpoint_view_eyfqem.geom,
    geometry_elevatedpoint_view_eyfqem.elevation,
    geometry_elevatedpoint_view_eyfqem.geoidUndulation,
    geometry_elevatedpoint_view_eyfqem.verticalDatum,
    geometry_elevatedpoint_view_eyfqem.verticalAccuracy,
    geometry_elevatedpoint_view_eyfqem.horizontalAccuracy,
    organisation_unit_pt_vehmsd.title,
    organisation_unit_pt_vehmsd.nilreason[1],
    organisation_unit_pt_vehmsd.href,
    navaids_points_directionfinder_pt_rpgsay.title,
    navaids_points_directionfinder_pt_rpgsay.nilreason[1],
    navaids_points_directionfinder_pt_rpgsay.href
order by airtrafficcontrolservice.identifier, airtrafficcontrolservice_ts.sequence_number, airtrafficcontrolservice_ts.correction_number DESC;
-- AirTrafficManagementServiceTimeSliceType
-- ['service.serviceoperationalstatus_view', 'notes.note_view', 'shared.contactinformation_view', 'routes.routeportion_view', 'geometry.elevatedpoint_view', 'service.callsigndetail_view']
create or replace view service.airtrafficmanagementservice_view as
select distinct on (airtrafficmanagementservice.identifier,airtrafficmanagementservice_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.airtrafficmanagementservice.id,
    service.airtrafficmanagementservice_ts.id as ts_id,
    service.airtrafficmanagementservice_tsp.id as tsp_id,
    service.airtrafficmanagementservice.identifier,
    service.airtrafficmanagementservice_ts.interpretation,
    service.airtrafficmanagementservice_ts.sequence_number,
    service.airtrafficmanagementservice_ts.correction_number,
    service.airtrafficmanagementservice_ts.valid_time_begin,
    service.airtrafficmanagementservice_ts.valid_time_end,
    service.airtrafficmanagementservice_ts.feature_lifetime_begin,
    service.airtrafficmanagementservice_ts.feature_lifetime_end,
    coalesce(cast(service.airtrafficmanagementservice_ts.flightoperations_value as varchar), '(' || service.airtrafficmanagementservice_ts.flightoperations_nilreason || ')') as flightoperations,
    coalesce(cast(service.airtrafficmanagementservice_ts.rank_value as varchar), '(' || service.airtrafficmanagementservice_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.airtrafficmanagementservice_ts.complianticao_value as varchar), '(' || service.airtrafficmanagementservice_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(service.airtrafficmanagementservice_ts.name_value as varchar), '(' || service.airtrafficmanagementservice_ts.name_nilreason || ')') as name,
    coalesce(cast(service.airtrafficmanagementservice_ts.type_value as varchar), '(' || service.airtrafficmanagementservice_ts.type_nilreason || ')') as type,
    geometry_elevatedpoint_view_ozltiv.geom AS geom,
    ST_X(geometry_elevatedpoint_view_ozltiv.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_ozltiv.geom) AS latitude,
    geometry_elevatedpoint_view_ozltiv.elevation,
    geometry_elevatedpoint_view_ozltiv.geoidUndulation,
    geometry_elevatedpoint_view_ozltiv.verticalDatum,
    geometry_elevatedpoint_view_ozltiv.verticalAccuracy,
    geometry_elevatedpoint_view_ozltiv.horizontalAccuracy,
    coalesce(cast(organisation_unit_pt_vpzwnx.title as varchar), '(' || organisation_unit_pt_vpzwnx.nilreason[1] || ')') AS serviceprovider,
    organisation_unit_pt_vpzwnx.href AS serviceprovider_href,
    jsonb_agg(service_callsigndetail_view_euqytv.id) AS callsign,
    jsonb_build_object('id', service_radiocommunicationchannel_pt_enwbig.id,
    'title', coalesce(cast(service_radiocommunicationchannel_pt_enwbig.title AS varchar), '(' || service_radiocommunicationchannel_pt_enwbig.nilreason[1] || ')'),
    'href', service_radiocommunicationchannel_pt_enwbig.href) AS radiocommunication,
    jsonb_agg(service_serviceoperationalstatus_view_moslzu.id) AS availability,
    jsonb_agg(notes_note_view_myzrvt.*) AS airtrafficmanagementservice_annotation,
    jsonb_build_object('id', airspace_airspace_pt_wvboax.id,
    'title', coalesce(cast(airspace_airspace_pt_wvboax.title AS varchar), '(' || airspace_airspace_pt_wvboax.nilreason[1] || ')'),
    'href', airspace_airspace_pt_wvboax.href) AS clientairspace,
    jsonb_build_object('id', aerial_refuelling_aerialrefuelling_pt_nbckxy.id,
    'title', coalesce(cast(aerial_refuelling_aerialrefuelling_pt_nbckxy.title AS varchar), '(' || aerial_refuelling_aerialrefuelling_pt_nbckxy.nilreason[1] || ')'),
    'href', aerial_refuelling_aerialrefuelling_pt_nbckxy.href) AS clientaerialrefuelling,
    jsonb_agg(routes_routeportion_view_gewegd.id) AS clientroute
from service.airtrafficmanagementservice 
inner join master_join mj2 on service.airtrafficmanagementservice.id = mj2.source_id
inner join service.airtrafficmanagementservice_tsp on mj2.target_id = service.airtrafficmanagementservice_tsp.id
inner join service.airtrafficmanagementservice_ts on service.airtrafficmanagementservice_tsp.airtrafficmanagementservicetimeslice_id = service.airtrafficmanagementservice_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_ozltiv on service.airtrafficmanagementservice_ts.location_id = geometry_elevatedpoint_view_ozltiv.id
left join organisation.unit_pt organisation_unit_pt_vpzwnx on service.airtrafficmanagementservice_ts.serviceprovider_id = organisation_unit_pt_vpzwnx.id
left join master_join master_join_onfpqg on service.airtrafficmanagementservice_ts.id = master_join_onfpqg.source_id
left join service.callsigndetail_view service_callsigndetail_view_euqytv on master_join_onfpqg.target_id = service_callsigndetail_view_euqytv.id
left join master_join master_join_haahxs on service.airtrafficmanagementservice_ts.id = master_join_haahxs.source_id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_enwbig on master_join_haahxs.target_id = service_radiocommunicationchannel_pt_enwbig.id
left join master_join master_join_tsfwns on service.airtrafficmanagementservice_ts.id = master_join_tsfwns.source_id
left join shared.contactinformation_view shared_contactinformation_view_vjrhnk on master_join_tsfwns.target_id = shared_contactinformation_view_vjrhnk.id
left join master_join master_join_vmanqf on service.airtrafficmanagementservice_ts.id = master_join_vmanqf.source_id
left join service.serviceoperationalstatus_view service_serviceoperationalstatus_view_moslzu on master_join_vmanqf.target_id = service_serviceoperationalstatus_view_moslzu.id
left join master_join master_join_fejepb on service.airtrafficmanagementservice_ts.id = master_join_fejepb.source_id
left join notes.note_view notes_note_view_myzrvt on master_join_fejepb.target_id = notes_note_view_myzrvt.id
left join master_join master_join_vzbloy on service.airtrafficmanagementservice_ts.id = master_join_vzbloy.source_id
left join airspace.airspace_pt airspace_airspace_pt_wvboax on master_join_vzbloy.target_id = airspace_airspace_pt_wvboax.id
left join master_join master_join_olxquh on service.airtrafficmanagementservice_ts.id = master_join_olxquh.source_id
left join aerial_refuelling.aerialrefuelling_pt aerial_refuelling_aerialrefuelling_pt_nbckxy on master_join_olxquh.target_id = aerial_refuelling_aerialrefuelling_pt_nbckxy.id
left join master_join master_join_slosqb on service.airtrafficmanagementservice_ts.id = master_join_slosqb.source_id
left join routes.routeportion_view routes_routeportion_view_gewegd on master_join_slosqb.target_id = routes_routeportion_view_gewegd.id
where service.airtrafficmanagementservice.feature_status = 'APPROVED'
  and service.airtrafficmanagementservice_ts.feature_status = 'APPROVED'
group by
    service.airtrafficmanagementservice.id,
    service.airtrafficmanagementservice_ts.id,
    service.airtrafficmanagementservice_tsp.id,
    service.airtrafficmanagementservice.identifier,
    service.airtrafficmanagementservice_ts.interpretation,
    service.airtrafficmanagementservice_ts.sequence_number,
    service.airtrafficmanagementservice_ts.correction_number,
    service.airtrafficmanagementservice_ts.valid_time_begin,
    service.airtrafficmanagementservice_ts.valid_time_end,
    service.airtrafficmanagementservice_ts.feature_lifetime_begin,
    service.airtrafficmanagementservice_ts.feature_lifetime_end,
    service.airtrafficmanagementservice_ts.flightoperations_value,
    service.airtrafficmanagementservice_ts.flightoperations_nilreason,
    service.airtrafficmanagementservice_ts.rank_value,
    service.airtrafficmanagementservice_ts.rank_nilreason,
    service.airtrafficmanagementservice_ts.complianticao_value,
    service.airtrafficmanagementservice_ts.complianticao_nilreason,
    service.airtrafficmanagementservice_ts.name_value,
    service.airtrafficmanagementservice_ts.name_nilreason,
    service.airtrafficmanagementservice_ts.type_value,
    service.airtrafficmanagementservice_ts.type_nilreason,
    geometry_elevatedpoint_view_ozltiv.geom,
    geometry_elevatedpoint_view_ozltiv.elevation,
    geometry_elevatedpoint_view_ozltiv.geoidUndulation,
    geometry_elevatedpoint_view_ozltiv.verticalDatum,
    geometry_elevatedpoint_view_ozltiv.verticalAccuracy,
    geometry_elevatedpoint_view_ozltiv.horizontalAccuracy,
    organisation_unit_pt_vpzwnx.title,
    organisation_unit_pt_vpzwnx.nilreason[1],
    organisation_unit_pt_vpzwnx.href
order by airtrafficmanagementservice.identifier, airtrafficmanagementservice_ts.sequence_number, airtrafficmanagementservice_ts.correction_number DESC;
-- AltimeterSourceTimeSliceType
-- ['airport_heliport.altimetersourcestatus_view', 'notes.note_view']
create or replace view airport_heliport.altimetersource_view as
select distinct on (altimetersource.identifier,altimetersource_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.altimetersource.id,
    airport_heliport.altimetersource_ts.id as ts_id,
    airport_heliport.altimetersource_tsp.id as tsp_id,
    airport_heliport.altimetersource.identifier,
    airport_heliport.altimetersource_ts.interpretation,
    airport_heliport.altimetersource_ts.sequence_number,
    airport_heliport.altimetersource_ts.correction_number,
    airport_heliport.altimetersource_ts.valid_time_begin,
    airport_heliport.altimetersource_ts.valid_time_end,
    airport_heliport.altimetersource_ts.feature_lifetime_begin,
    airport_heliport.altimetersource_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.altimetersource_ts.isremote_value as varchar), '(' || airport_heliport.altimetersource_ts.isremote_nilreason || ')') as isremote,
    coalesce(cast(airport_heliport.altimetersource_ts.isprimary_value as varchar), '(' || airport_heliport.altimetersource_ts.isprimary_nilreason || ')') as isprimary,
    jsonb_agg(airport_heliport_altimetersourcestatus_view_ookbix.id) AS availability,
    jsonb_agg(notes_note_view_rqupby.*) AS altimetersource_annotation
from airport_heliport.altimetersource 
inner join master_join mj2 on airport_heliport.altimetersource.id = mj2.source_id
inner join airport_heliport.altimetersource_tsp on mj2.target_id = airport_heliport.altimetersource_tsp.id
inner join airport_heliport.altimetersource_ts on airport_heliport.altimetersource_tsp.altimetersourcetimeslice_id = airport_heliport.altimetersource_ts.id
left join master_join master_join_tscovd on airport_heliport.altimetersource_ts.id = master_join_tscovd.source_id
left join airport_heliport.altimetersourcestatus_view airport_heliport_altimetersourcestatus_view_ookbix on master_join_tscovd.target_id = airport_heliport_altimetersourcestatus_view_ookbix.id
left join master_join master_join_suzzyr on airport_heliport.altimetersource_ts.id = master_join_suzzyr.source_id
left join notes.note_view notes_note_view_rqupby on master_join_suzzyr.target_id = notes_note_view_rqupby.id
where airport_heliport.altimetersource.feature_status = 'APPROVED'
  and airport_heliport.altimetersource_ts.feature_status = 'APPROVED'
group by
    airport_heliport.altimetersource.id,
    airport_heliport.altimetersource_ts.id,
    airport_heliport.altimetersource_tsp.id,
    airport_heliport.altimetersource.identifier,
    airport_heliport.altimetersource_ts.interpretation,
    airport_heliport.altimetersource_ts.sequence_number,
    airport_heliport.altimetersource_ts.correction_number,
    airport_heliport.altimetersource_ts.valid_time_begin,
    airport_heliport.altimetersource_ts.valid_time_end,
    airport_heliport.altimetersource_ts.feature_lifetime_begin,
    airport_heliport.altimetersource_ts.feature_lifetime_end,
    airport_heliport.altimetersource_ts.isremote_value,
    airport_heliport.altimetersource_ts.isremote_nilreason,
    airport_heliport.altimetersource_ts.isprimary_value,
    airport_heliport.altimetersource_ts.isprimary_nilreason
order by altimetersource.identifier, altimetersource_ts.sequence_number, altimetersource_ts.correction_number DESC;
-- AngleIndicationTimeSliceType
-- ['geometry.point_view', 'notes.note_view']
create or replace view navaids_points.angleindication_view as
select distinct on (angleindication.identifier,angleindication_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.angleindication.id,
    navaids_points.angleindication_ts.id as ts_id,
    navaids_points.angleindication_tsp.id as tsp_id,
    navaids_points.angleindication.identifier,
    navaids_points.angleindication_ts.interpretation,
    navaids_points.angleindication_ts.sequence_number,
    navaids_points.angleindication_ts.correction_number,
    navaids_points.angleindication_ts.valid_time_begin,
    navaids_points.angleindication_ts.valid_time_end,
    navaids_points.angleindication_ts.feature_lifetime_begin,
    navaids_points.angleindication_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.angleindication_ts.angle_value as varchar), '(' || navaids_points.angleindication_ts.angle_nilreason || ')') as angle,
    coalesce(cast(navaids_points.angleindication_ts.angletype_value as varchar), '(' || navaids_points.angleindication_ts.angletype_nilreason || ')') as angletype,
    coalesce(cast(navaids_points.angleindication_ts.indicationdirection_value as varchar), '(' || navaids_points.angleindication_ts.indicationdirection_nilreason || ')') as indicationdirection,
    coalesce(cast(navaids_points.angleindication_ts.trueangle_value as varchar), '(' || navaids_points.angleindication_ts.trueangle_nilreason || ')') as trueangle,
    coalesce(cast(navaids_points.angleindication_ts.cardinaldirection_value as varchar), '(' || navaids_points.angleindication_ts.cardinaldirection_nilreason || ')') as cardinaldirection,
    coalesce(cast(navaids_points.angleindication_ts.minimumreceptionaltitude_value as varchar) || ' ' || navaids_points.angleindication_ts.minimumreceptionaltitude_uom, '(' || navaids_points.angleindication_ts.minimumreceptionaltitude_nilreason || ')') as minimumreceptionaltitude,
    coalesce(cast(navaids_points_designatedpoint_pt_bishhs.title as varchar), '(' || navaids_points_designatedpoint_pt_bishhs.nilreason[1] || ')') AS fix,
    navaids_points_designatedpoint_pt_bishhs.href AS fix_href,
    coalesce(cast(navaids_points_designatedpoint_pt_ifgivi.title as varchar), '(' || navaids_points_designatedpoint_pt_ifgivi.nilreason[1] || ')') AS pointchoicefixdesignatedpoint,
    navaids_points_designatedpoint_pt_ifgivi.href AS pointchoicefixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_dasnzc.title as varchar), '(' || navaids_points_navaid_pt_dasnzc.nilreason[1] || ')') AS pointchoicenavaidsystem,
    navaids_points_navaid_pt_dasnzc.href AS pointchoicenavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_abentk.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_abentk.nilreason[1] || ')') AS pointchoiceaimingpoint,
    airport_heliport_touchdownliftoff_pt_abentk.href AS pointchoiceaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_jnoqdo.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_jnoqdo.nilreason[1] || ')') AS pointchoicerunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_jnoqdo.href AS pointchoicerunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_iyndat.title as varchar), '(' || airport_heliport_airportheliport_pt_iyndat.nilreason[1] || ')') AS pointchoiceairportreferencepoint,
    airport_heliport_airportheliport_pt_iyndat.href AS pointchoiceairportreferencepoint_href,
    geometry_point_view_jqieqe.geom AS geom,
    ST_X(geometry_point_view_jqieqe.geom) AS longitude,
    ST_Y(geometry_point_view_jqieqe.geom) AS latitude,
    geometry_point_view_jqieqe.horizontalAccuracy,
    jsonb_agg(notes_note_view_fegqyh.*) AS angleindication_annotation
from navaids_points.angleindication 
inner join master_join mj2 on navaids_points.angleindication.id = mj2.source_id
inner join navaids_points.angleindication_tsp on mj2.target_id = navaids_points.angleindication_tsp.id
inner join navaids_points.angleindication_ts on navaids_points.angleindication_tsp.angleindicationtimeslice_id = navaids_points.angleindication_ts.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_bishhs on navaids_points.angleindication_ts.fix_id = navaids_points_designatedpoint_pt_bishhs.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_ifgivi on navaids_points.angleindication_ts.angleindication_ts_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_ifgivi.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_dasnzc on navaids_points.angleindication_ts.angleindication_ts_navaidsystem_id = navaids_points_navaid_pt_dasnzc.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_abentk on navaids_points.angleindication_ts.angleindication_ts_aimingpoint_id = airport_heliport_touchdownliftoff_pt_abentk.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_jnoqdo on navaids_points.angleindication_ts.angleindication_ts_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_jnoqdo.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_iyndat on navaids_points.angleindication_ts.angleindication_ts_airportreferencepoint_id = airport_heliport_airportheliport_pt_iyndat.id
left join geometry.point_view geometry_point_view_jqieqe on navaids_points.angleindication_ts.angleindication_ts_position_id = geometry_point_view_jqieqe.id
left join master_join master_join_xzynfc on navaids_points.angleindication_ts.id = master_join_xzynfc.source_id
left join notes.note_view notes_note_view_fegqyh on master_join_xzynfc.target_id = notes_note_view_fegqyh.id
where navaids_points.angleindication.feature_status = 'APPROVED'
  and navaids_points.angleindication_ts.feature_status = 'APPROVED'
group by
    navaids_points.angleindication.id,
    navaids_points.angleindication_ts.id,
    navaids_points.angleindication_tsp.id,
    navaids_points.angleindication.identifier,
    navaids_points.angleindication_ts.interpretation,
    navaids_points.angleindication_ts.sequence_number,
    navaids_points.angleindication_ts.correction_number,
    navaids_points.angleindication_ts.valid_time_begin,
    navaids_points.angleindication_ts.valid_time_end,
    navaids_points.angleindication_ts.feature_lifetime_begin,
    navaids_points.angleindication_ts.feature_lifetime_end,
    navaids_points.angleindication_ts.angle_value,
    navaids_points.angleindication_ts.angle_nilreason,
    navaids_points.angleindication_ts.angletype_value,
    navaids_points.angleindication_ts.angletype_nilreason,
    navaids_points.angleindication_ts.indicationdirection_value,
    navaids_points.angleindication_ts.indicationdirection_nilreason,
    navaids_points.angleindication_ts.trueangle_value,
    navaids_points.angleindication_ts.trueangle_nilreason,
    navaids_points.angleindication_ts.cardinaldirection_value,
    navaids_points.angleindication_ts.cardinaldirection_nilreason,
    navaids_points.angleindication_ts.minimumreceptionaltitude_value,
    navaids_points.angleindication_ts.minimumreceptionaltitude_uom,
    navaids_points.angleindication_ts.minimumreceptionaltitude_nilreason,
    navaids_points_designatedpoint_pt_bishhs.title,
    navaids_points_designatedpoint_pt_bishhs.nilreason[1],
    navaids_points_designatedpoint_pt_bishhs.href,
    navaids_points_designatedpoint_pt_ifgivi.title,
    navaids_points_designatedpoint_pt_ifgivi.nilreason[1],
    navaids_points_designatedpoint_pt_ifgivi.href,
    navaids_points_navaid_pt_dasnzc.title,
    navaids_points_navaid_pt_dasnzc.nilreason[1],
    navaids_points_navaid_pt_dasnzc.href,
    airport_heliport_touchdownliftoff_pt_abentk.title,
    airport_heliport_touchdownliftoff_pt_abentk.nilreason[1],
    airport_heliport_touchdownliftoff_pt_abentk.href,
    airport_heliport_runwaycentrelinepoint_pt_jnoqdo.title,
    airport_heliport_runwaycentrelinepoint_pt_jnoqdo.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_jnoqdo.href,
    airport_heliport_airportheliport_pt_iyndat.title,
    airport_heliport_airportheliport_pt_iyndat.nilreason[1],
    airport_heliport_airportheliport_pt_iyndat.href,
    geometry_point_view_jqieqe.geom,
    geometry_point_view_jqieqe.horizontalAccuracy
order by angleindication.identifier, angleindication_ts.sequence_number, angleindication_ts.correction_number DESC;
-- ApproachLightingSystemTimeSliceType
-- ['shared.lightelement_view', 'airport_heliport.groundlightingavailability_view', 'notes.note_view']
create or replace view airport_heliport.approachlightingsystem_view as
select distinct on (approachlightingsystem.identifier,approachlightingsystem_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.approachlightingsystem.id,
    airport_heliport.approachlightingsystem_ts.id as ts_id,
    airport_heliport.approachlightingsystem_tsp.id as tsp_id,
    airport_heliport.approachlightingsystem.identifier,
    airport_heliport.approachlightingsystem_ts.interpretation,
    airport_heliport.approachlightingsystem_ts.sequence_number,
    airport_heliport.approachlightingsystem_ts.correction_number,
    airport_heliport.approachlightingsystem_ts.valid_time_begin,
    airport_heliport.approachlightingsystem_ts.valid_time_end,
    airport_heliport.approachlightingsystem_ts.feature_lifetime_begin,
    airport_heliport.approachlightingsystem_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.approachlightingsystem_ts.emergencylighting_value as varchar), '(' || airport_heliport.approachlightingsystem_ts.emergencylighting_nilreason || ')') as emergencylighting,
    coalesce(cast(airport_heliport.approachlightingsystem_ts.intensitylevel_value as varchar), '(' || airport_heliport.approachlightingsystem_ts.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(airport_heliport.approachlightingsystem_ts.colour_value as varchar), '(' || airport_heliport.approachlightingsystem_ts.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport.approachlightingsystem_ts.classicao_value as varchar), '(' || airport_heliport.approachlightingsystem_ts.classicao_nilreason || ')') as classicao,
    coalesce(cast(airport_heliport.approachlightingsystem_ts.type_value as varchar), '(' || airport_heliport.approachlightingsystem_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.approachlightingsystem_ts.sequencedflashing_value as varchar), '(' || airport_heliport.approachlightingsystem_ts.sequencedflashing_nilreason || ')') as sequencedflashing,
    coalesce(cast(airport_heliport.approachlightingsystem_ts.alignmentindicator_value as varchar), '(' || airport_heliport.approachlightingsystem_ts.alignmentindicator_nilreason || ')') as alignmentindicator,
    coalesce(cast(airport_heliport.approachlightingsystem_ts.length_value as varchar) || ' ' || airport_heliport.approachlightingsystem_ts.length_uom, '(' || airport_heliport.approachlightingsystem_ts.length_nilreason || ')') as length,
    coalesce(cast(airport_heliport_runwaydirection_pt_qbabep.title as varchar), '(' || airport_heliport_runwaydirection_pt_qbabep.nilreason[1] || ')') AS servedrunwaydirection,
    airport_heliport_runwaydirection_pt_qbabep.href AS servedrunwaydirection_href,
    jsonb_agg(shared_lightelement_view_cjkdvm.id) AS element,
    jsonb_agg(airport_heliport_groundlightingavailability_view_qtfddg.id) AS availability,
    jsonb_agg(notes_note_view_zbolhe.*) AS approachlightingsystem_annotation
from airport_heliport.approachlightingsystem 
inner join master_join mj2 on airport_heliport.approachlightingsystem.id = mj2.source_id
inner join airport_heliport.approachlightingsystem_tsp on mj2.target_id = airport_heliport.approachlightingsystem_tsp.id
inner join airport_heliport.approachlightingsystem_ts on airport_heliport.approachlightingsystem_tsp.approachlightingsystemtimeslice_id = airport_heliport.approachlightingsystem_ts.id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_qbabep on airport_heliport.approachlightingsystem_ts.servedrunwaydirection_id = airport_heliport_runwaydirection_pt_qbabep.id
left join master_join master_join_ogejvp on airport_heliport.approachlightingsystem_ts.id = master_join_ogejvp.source_id
left join shared.lightelement_view shared_lightelement_view_cjkdvm on master_join_ogejvp.target_id = shared_lightelement_view_cjkdvm.id
left join master_join master_join_zguome on airport_heliport.approachlightingsystem_ts.id = master_join_zguome.source_id
left join airport_heliport.groundlightingavailability_view airport_heliport_groundlightingavailability_view_qtfddg on master_join_zguome.target_id = airport_heliport_groundlightingavailability_view_qtfddg.id
left join master_join master_join_hiuhid on airport_heliport.approachlightingsystem_ts.id = master_join_hiuhid.source_id
left join notes.note_view notes_note_view_zbolhe on master_join_hiuhid.target_id = notes_note_view_zbolhe.id
where airport_heliport.approachlightingsystem.feature_status = 'APPROVED'
  and airport_heliport.approachlightingsystem_ts.feature_status = 'APPROVED'
group by
    airport_heliport.approachlightingsystem.id,
    airport_heliport.approachlightingsystem_ts.id,
    airport_heliport.approachlightingsystem_tsp.id,
    airport_heliport.approachlightingsystem.identifier,
    airport_heliport.approachlightingsystem_ts.interpretation,
    airport_heliport.approachlightingsystem_ts.sequence_number,
    airport_heliport.approachlightingsystem_ts.correction_number,
    airport_heliport.approachlightingsystem_ts.valid_time_begin,
    airport_heliport.approachlightingsystem_ts.valid_time_end,
    airport_heliport.approachlightingsystem_ts.feature_lifetime_begin,
    airport_heliport.approachlightingsystem_ts.feature_lifetime_end,
    airport_heliport.approachlightingsystem_ts.emergencylighting_value,
    airport_heliport.approachlightingsystem_ts.emergencylighting_nilreason,
    airport_heliport.approachlightingsystem_ts.intensitylevel_value,
    airport_heliport.approachlightingsystem_ts.intensitylevel_nilreason,
    airport_heliport.approachlightingsystem_ts.colour_value,
    airport_heliport.approachlightingsystem_ts.colour_nilreason,
    airport_heliport.approachlightingsystem_ts.classicao_value,
    airport_heliport.approachlightingsystem_ts.classicao_nilreason,
    airport_heliport.approachlightingsystem_ts.type_value,
    airport_heliport.approachlightingsystem_ts.type_nilreason,
    airport_heliport.approachlightingsystem_ts.sequencedflashing_value,
    airport_heliport.approachlightingsystem_ts.sequencedflashing_nilreason,
    airport_heliport.approachlightingsystem_ts.alignmentindicator_value,
    airport_heliport.approachlightingsystem_ts.alignmentindicator_nilreason,
    airport_heliport.approachlightingsystem_ts.length_value,
    airport_heliport.approachlightingsystem_ts.length_uom,
    airport_heliport.approachlightingsystem_ts.length_nilreason,
    airport_heliport_runwaydirection_pt_qbabep.title,
    airport_heliport_runwaydirection_pt_qbabep.nilreason[1],
    airport_heliport_runwaydirection_pt_qbabep.href
order by approachlightingsystem.identifier, approachlightingsystem_ts.sequence_number, approachlightingsystem_ts.correction_number DESC;
-- ApronElementTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view', 'airport_heliport.apronareaavailability_view']
create or replace view airport_heliport.apronelement_view as
select distinct on (apronelement.identifier,apronelement_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.apronelement.id,
    airport_heliport.apronelement_ts.id as ts_id,
    airport_heliport.apronelement_tsp.id as tsp_id,
    airport_heliport.apronelement.identifier,
    airport_heliport.apronelement_ts.interpretation,
    airport_heliport.apronelement_ts.sequence_number,
    airport_heliport.apronelement_ts.correction_number,
    airport_heliport.apronelement_ts.valid_time_begin,
    airport_heliport.apronelement_ts.valid_time_end,
    airport_heliport.apronelement_ts.feature_lifetime_begin,
    airport_heliport.apronelement_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.apronelement_ts.type_value as varchar), '(' || airport_heliport.apronelement_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.apronelement_ts.jetwayavailability_value as varchar), '(' || airport_heliport.apronelement_ts.jetwayavailability_nilreason || ')') as jetwayavailability,
    coalesce(cast(airport_heliport.apronelement_ts.towingavailability_value as varchar), '(' || airport_heliport.apronelement_ts.towingavailability_nilreason || ')') as towingavailability,
    coalesce(cast(airport_heliport.apronelement_ts.dockingavailability_value as varchar), '(' || airport_heliport.apronelement_ts.dockingavailability_nilreason || ')') as dockingavailability,
    coalesce(cast(airport_heliport.apronelement_ts.groundpoweravailability_value as varchar), '(' || airport_heliport.apronelement_ts.groundpoweravailability_nilreason || ')') as groundpoweravailability,
    coalesce(cast(airport_heliport.apronelement_ts.length_value as varchar) || ' ' || airport_heliport.apronelement_ts.length_uom, '(' || airport_heliport.apronelement_ts.length_nilreason || ')') as length,
    coalesce(cast(airport_heliport.apronelement_ts.width_value as varchar) || ' ' || airport_heliport.apronelement_ts.width_uom, '(' || airport_heliport.apronelement_ts.width_nilreason || ')') as width,
    coalesce(cast(airport_heliport_apron_pt_qqcoys.title as varchar), '(' || airport_heliport_apron_pt_qqcoys.nilreason[1] || ')') AS associatedapron,
    airport_heliport_apron_pt_qqcoys.href AS associatedapron_href,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_iyvvnh.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_iyvvnh.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_iyvvnh.href AS surfaceproperties_href,
    geometry_elevatedsurface_view_xafqog.geom AS geom,
    geometry_elevatedsurface_view_xafqog.elevation,
    geometry_elevatedsurface_view_xafqog.geoidUndulation,
    geometry_elevatedsurface_view_xafqog.verticalDatum,
    geometry_elevatedsurface_view_xafqog.verticalAccuracy,
    geometry_elevatedsurface_view_xafqog.horizontalAccuracy,
    jsonb_build_object('id', service_airportsuppliesservice_pt_tjgttp.id,
    'title', coalesce(cast(service_airportsuppliesservice_pt_tjgttp.title AS varchar), '(' || service_airportsuppliesservice_pt_tjgttp.nilreason[1] || ')'),
    'href', service_airportsuppliesservice_pt_tjgttp.href) AS supplyservice,
    jsonb_agg(notes_note_view_fxvlya.*) AS apronelement_annotation,
    jsonb_agg(airport_heliport_apronareaavailability_view_bwbiif.id) AS availability
from airport_heliport.apronelement 
inner join master_join mj2 on airport_heliport.apronelement.id = mj2.source_id
inner join airport_heliport.apronelement_tsp on mj2.target_id = airport_heliport.apronelement_tsp.id
inner join airport_heliport.apronelement_ts on airport_heliport.apronelement_tsp.apronelementtimeslice_id = airport_heliport.apronelement_ts.id
left join airport_heliport.apron_pt airport_heliport_apron_pt_qqcoys on airport_heliport.apronelement_ts.associatedapron_id = airport_heliport_apron_pt_qqcoys.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_iyvvnh on airport_heliport.apronelement_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_iyvvnh.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_xafqog on airport_heliport.apronelement_ts.extent_id = geometry_elevatedsurface_view_xafqog.id
left join master_join master_join_dbquzm on airport_heliport.apronelement_ts.id = master_join_dbquzm.source_id
left join service.airportsuppliesservice_pt service_airportsuppliesservice_pt_tjgttp on master_join_dbquzm.target_id = service_airportsuppliesservice_pt_tjgttp.id
left join master_join master_join_zysisu on airport_heliport.apronelement_ts.id = master_join_zysisu.source_id
left join notes.note_view notes_note_view_fxvlya on master_join_zysisu.target_id = notes_note_view_fxvlya.id
left join master_join master_join_baylkb on airport_heliport.apronelement_ts.id = master_join_baylkb.source_id
left join airport_heliport.apronareaavailability_view airport_heliport_apronareaavailability_view_bwbiif on master_join_baylkb.target_id = airport_heliport_apronareaavailability_view_bwbiif.id
where airport_heliport.apronelement.feature_status = 'APPROVED'
  and airport_heliport.apronelement_ts.feature_status = 'APPROVED'
group by
    airport_heliport.apronelement.id,
    airport_heliport.apronelement_ts.id,
    airport_heliport.apronelement_tsp.id,
    airport_heliport.apronelement.identifier,
    airport_heliport.apronelement_ts.interpretation,
    airport_heliport.apronelement_ts.sequence_number,
    airport_heliport.apronelement_ts.correction_number,
    airport_heliport.apronelement_ts.valid_time_begin,
    airport_heliport.apronelement_ts.valid_time_end,
    airport_heliport.apronelement_ts.feature_lifetime_begin,
    airport_heliport.apronelement_ts.feature_lifetime_end,
    airport_heliport.apronelement_ts.type_value,
    airport_heliport.apronelement_ts.type_nilreason,
    airport_heliport.apronelement_ts.jetwayavailability_value,
    airport_heliport.apronelement_ts.jetwayavailability_nilreason,
    airport_heliport.apronelement_ts.towingavailability_value,
    airport_heliport.apronelement_ts.towingavailability_nilreason,
    airport_heliport.apronelement_ts.dockingavailability_value,
    airport_heliport.apronelement_ts.dockingavailability_nilreason,
    airport_heliport.apronelement_ts.groundpoweravailability_value,
    airport_heliport.apronelement_ts.groundpoweravailability_nilreason,
    airport_heliport.apronelement_ts.length_value,
    airport_heliport.apronelement_ts.length_uom,
    airport_heliport.apronelement_ts.length_nilreason,
    airport_heliport.apronelement_ts.width_value,
    airport_heliport.apronelement_ts.width_uom,
    airport_heliport.apronelement_ts.width_nilreason,
    airport_heliport_apron_pt_qqcoys.title,
    airport_heliport_apron_pt_qqcoys.nilreason[1],
    airport_heliport_apron_pt_qqcoys.href,
    airport_heliport_surfacecharacteristics_pt_iyvvnh.title,
    airport_heliport_surfacecharacteristics_pt_iyvvnh.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_iyvvnh.href,
    geometry_elevatedsurface_view_xafqog.geom,
    geometry_elevatedsurface_view_xafqog.elevation,
    geometry_elevatedsurface_view_xafqog.geoidUndulation,
    geometry_elevatedsurface_view_xafqog.verticalDatum,
    geometry_elevatedsurface_view_xafqog.verticalAccuracy,
    geometry_elevatedsurface_view_xafqog.horizontalAccuracy
order by apronelement.identifier, apronelement_ts.sequence_number, apronelement_ts.correction_number DESC;
-- ApronLightSystemTimeSliceType
-- ['shared.lightelement_view', 'airport_heliport.groundlightingavailability_view', 'notes.note_view']
create or replace view airport_heliport.apronlightsystem_view as
select distinct on (apronlightsystem.identifier,apronlightsystem_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.apronlightsystem.id,
    airport_heliport.apronlightsystem_ts.id as ts_id,
    airport_heliport.apronlightsystem_tsp.id as tsp_id,
    airport_heliport.apronlightsystem.identifier,
    airport_heliport.apronlightsystem_ts.interpretation,
    airport_heliport.apronlightsystem_ts.sequence_number,
    airport_heliport.apronlightsystem_ts.correction_number,
    airport_heliport.apronlightsystem_ts.valid_time_begin,
    airport_heliport.apronlightsystem_ts.valid_time_end,
    airport_heliport.apronlightsystem_ts.feature_lifetime_begin,
    airport_heliport.apronlightsystem_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.apronlightsystem_ts.emergencylighting_value as varchar), '(' || airport_heliport.apronlightsystem_ts.emergencylighting_nilreason || ')') as emergencylighting,
    coalesce(cast(airport_heliport.apronlightsystem_ts.intensitylevel_value as varchar), '(' || airport_heliport.apronlightsystem_ts.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(airport_heliport.apronlightsystem_ts.colour_value as varchar), '(' || airport_heliport.apronlightsystem_ts.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport.apronlightsystem_ts.position_value as varchar), '(' || airport_heliport.apronlightsystem_ts.position_nilreason || ')') as position,
    coalesce(cast(airport_heliport_apron_pt_vsmwuy.title as varchar), '(' || airport_heliport_apron_pt_vsmwuy.nilreason[1] || ')') AS lightedapron,
    airport_heliport_apron_pt_vsmwuy.href AS lightedapron_href,
    jsonb_agg(shared_lightelement_view_jhkzgf.id) AS element,
    jsonb_agg(airport_heliport_groundlightingavailability_view_vpkjrj.id) AS availability,
    jsonb_agg(notes_note_view_riovys.*) AS apronlightsystem_annotation
from airport_heliport.apronlightsystem 
inner join master_join mj2 on airport_heliport.apronlightsystem.id = mj2.source_id
inner join airport_heliport.apronlightsystem_tsp on mj2.target_id = airport_heliport.apronlightsystem_tsp.id
inner join airport_heliport.apronlightsystem_ts on airport_heliport.apronlightsystem_tsp.apronlightsystemtimeslice_id = airport_heliport.apronlightsystem_ts.id
left join airport_heliport.apron_pt airport_heliport_apron_pt_vsmwuy on airport_heliport.apronlightsystem_ts.lightedapron_id = airport_heliport_apron_pt_vsmwuy.id
left join master_join master_join_vglhrz on airport_heliport.apronlightsystem_ts.id = master_join_vglhrz.source_id
left join shared.lightelement_view shared_lightelement_view_jhkzgf on master_join_vglhrz.target_id = shared_lightelement_view_jhkzgf.id
left join master_join master_join_ormuwz on airport_heliport.apronlightsystem_ts.id = master_join_ormuwz.source_id
left join airport_heliport.groundlightingavailability_view airport_heliport_groundlightingavailability_view_vpkjrj on master_join_ormuwz.target_id = airport_heliport_groundlightingavailability_view_vpkjrj.id
left join master_join master_join_vwsnlg on airport_heliport.apronlightsystem_ts.id = master_join_vwsnlg.source_id
left join notes.note_view notes_note_view_riovys on master_join_vwsnlg.target_id = notes_note_view_riovys.id
where airport_heliport.apronlightsystem.feature_status = 'APPROVED'
  and airport_heliport.apronlightsystem_ts.feature_status = 'APPROVED'
group by
    airport_heliport.apronlightsystem.id,
    airport_heliport.apronlightsystem_ts.id,
    airport_heliport.apronlightsystem_tsp.id,
    airport_heliport.apronlightsystem.identifier,
    airport_heliport.apronlightsystem_ts.interpretation,
    airport_heliport.apronlightsystem_ts.sequence_number,
    airport_heliport.apronlightsystem_ts.correction_number,
    airport_heliport.apronlightsystem_ts.valid_time_begin,
    airport_heliport.apronlightsystem_ts.valid_time_end,
    airport_heliport.apronlightsystem_ts.feature_lifetime_begin,
    airport_heliport.apronlightsystem_ts.feature_lifetime_end,
    airport_heliport.apronlightsystem_ts.emergencylighting_value,
    airport_heliport.apronlightsystem_ts.emergencylighting_nilreason,
    airport_heliport.apronlightsystem_ts.intensitylevel_value,
    airport_heliport.apronlightsystem_ts.intensitylevel_nilreason,
    airport_heliport.apronlightsystem_ts.colour_value,
    airport_heliport.apronlightsystem_ts.colour_nilreason,
    airport_heliport.apronlightsystem_ts.position_value,
    airport_heliport.apronlightsystem_ts.position_nilreason,
    airport_heliport_apron_pt_vsmwuy.title,
    airport_heliport_apron_pt_vsmwuy.nilreason[1],
    airport_heliport_apron_pt_vsmwuy.href
order by apronlightsystem.identifier, apronlightsystem_ts.sequence_number, apronlightsystem_ts.correction_number DESC;
-- ApronMarkingTimeSliceType
-- ['notes.note_view', 'airport_heliport.markingelement_view']
create or replace view airport_heliport.apronmarking_view as
select distinct on (apronmarking.identifier,apronmarking_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.apronmarking.id,
    airport_heliport.apronmarking_ts.id as ts_id,
    airport_heliport.apronmarking_tsp.id as tsp_id,
    airport_heliport.apronmarking.identifier,
    airport_heliport.apronmarking_ts.interpretation,
    airport_heliport.apronmarking_ts.sequence_number,
    airport_heliport.apronmarking_ts.correction_number,
    airport_heliport.apronmarking_ts.valid_time_begin,
    airport_heliport.apronmarking_ts.valid_time_end,
    airport_heliport.apronmarking_ts.feature_lifetime_begin,
    airport_heliport.apronmarking_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.apronmarking_ts.markingicaostandard_value as varchar), '(' || airport_heliport.apronmarking_ts.markingicaostandard_nilreason || ')') as markingicaostandard,
    coalesce(cast(airport_heliport.apronmarking_ts.condition_value as varchar), '(' || airport_heliport.apronmarking_ts.condition_nilreason || ')') as condition,
    coalesce(cast(airport_heliport.apronmarking_ts.markinglocation_value as varchar), '(' || airport_heliport.apronmarking_ts.markinglocation_nilreason || ')') as markinglocation,
    coalesce(cast(airport_heliport_apron_pt_hbupuv.title as varchar), '(' || airport_heliport_apron_pt_hbupuv.nilreason[1] || ')') AS markedapron,
    airport_heliport_apron_pt_hbupuv.href AS markedapron_href,
    jsonb_agg(airport_heliport_markingelement_view_ayhewl.id) AS element,
    jsonb_agg(notes_note_view_nzkpqg.*) AS apronmarking_annotation
from airport_heliport.apronmarking 
inner join master_join mj2 on airport_heliport.apronmarking.id = mj2.source_id
inner join airport_heliport.apronmarking_tsp on mj2.target_id = airport_heliport.apronmarking_tsp.id
inner join airport_heliport.apronmarking_ts on airport_heliport.apronmarking_tsp.apronmarkingtimeslice_id = airport_heliport.apronmarking_ts.id
left join airport_heliport.apron_pt airport_heliport_apron_pt_hbupuv on airport_heliport.apronmarking_ts.markedapron_id = airport_heliport_apron_pt_hbupuv.id
left join master_join master_join_qzamyu on airport_heliport.apronmarking_ts.id = master_join_qzamyu.source_id
left join airport_heliport.markingelement_view airport_heliport_markingelement_view_ayhewl on master_join_qzamyu.target_id = airport_heliport_markingelement_view_ayhewl.id
left join master_join master_join_ojpwxo on airport_heliport.apronmarking_ts.id = master_join_ojpwxo.source_id
left join notes.note_view notes_note_view_nzkpqg on master_join_ojpwxo.target_id = notes_note_view_nzkpqg.id
where airport_heliport.apronmarking.feature_status = 'APPROVED'
  and airport_heliport.apronmarking_ts.feature_status = 'APPROVED'
group by
    airport_heliport.apronmarking.id,
    airport_heliport.apronmarking_ts.id,
    airport_heliport.apronmarking_tsp.id,
    airport_heliport.apronmarking.identifier,
    airport_heliport.apronmarking_ts.interpretation,
    airport_heliport.apronmarking_ts.sequence_number,
    airport_heliport.apronmarking_ts.correction_number,
    airport_heliport.apronmarking_ts.valid_time_begin,
    airport_heliport.apronmarking_ts.valid_time_end,
    airport_heliport.apronmarking_ts.feature_lifetime_begin,
    airport_heliport.apronmarking_ts.feature_lifetime_end,
    airport_heliport.apronmarking_ts.markingicaostandard_value,
    airport_heliport.apronmarking_ts.markingicaostandard_nilreason,
    airport_heliport.apronmarking_ts.condition_value,
    airport_heliport.apronmarking_ts.condition_nilreason,
    airport_heliport.apronmarking_ts.markinglocation_value,
    airport_heliport.apronmarking_ts.markinglocation_nilreason,
    airport_heliport_apron_pt_hbupuv.title,
    airport_heliport_apron_pt_hbupuv.nilreason[1],
    airport_heliport_apron_pt_hbupuv.href
order by apronmarking.identifier, apronmarking_ts.sequence_number, apronmarking_ts.correction_number DESC;
-- ApronTimeSliceType
-- ['airport_heliport.aproncontamination_view', 'notes.note_view', 'airport_heliport.apronareaavailability_view']
create or replace view airport_heliport.apron_view as
select distinct on (apron.identifier,apron_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.apron.id,
    airport_heliport.apron_ts.id as ts_id,
    airport_heliport.apron_tsp.id as tsp_id,
    airport_heliport.apron.identifier,
    airport_heliport.apron_ts.interpretation,
    airport_heliport.apron_ts.sequence_number,
    airport_heliport.apron_ts.correction_number,
    airport_heliport.apron_ts.valid_time_begin,
    airport_heliport.apron_ts.valid_time_end,
    airport_heliport.apron_ts.feature_lifetime_begin,
    airport_heliport.apron_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.apron_ts.name_value as varchar), '(' || airport_heliport.apron_ts.name_nilreason || ')') as name,
    coalesce(cast(airport_heliport.apron_ts.abandoned_value as varchar), '(' || airport_heliport.apron_ts.abandoned_nilreason || ')') as abandoned,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_cwyrdu.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_cwyrdu.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_cwyrdu.href AS surfaceproperties_href,
    coalesce(cast(airport_heliport_airportheliport_pt_gzqbog.title as varchar), '(' || airport_heliport_airportheliport_pt_gzqbog.nilreason[1] || ')') AS associatedairportheliport,
    airport_heliport_airportheliport_pt_gzqbog.href AS associatedairportheliport_href,
    jsonb_agg(airport_heliport_aproncontamination_view_vxydxp.id) AS contaminant,
    jsonb_agg(notes_note_view_ihynch.*) AS apron_annotation,
    jsonb_agg(airport_heliport_apronareaavailability_view_ghtxer.id) AS availability
from airport_heliport.apron 
inner join master_join mj2 on airport_heliport.apron.id = mj2.source_id
inner join airport_heliport.apron_tsp on mj2.target_id = airport_heliport.apron_tsp.id
inner join airport_heliport.apron_ts on airport_heliport.apron_tsp.aprontimeslice_id = airport_heliport.apron_ts.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_cwyrdu on airport_heliport.apron_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_cwyrdu.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_gzqbog on airport_heliport.apron_ts.associatedairportheliport_id = airport_heliport_airportheliport_pt_gzqbog.id
left join master_join master_join_mafyaj on airport_heliport.apron_ts.id = master_join_mafyaj.source_id
left join airport_heliport.aproncontamination_view airport_heliport_aproncontamination_view_vxydxp on master_join_mafyaj.target_id = airport_heliport_aproncontamination_view_vxydxp.id
left join master_join master_join_ynwkke on airport_heliport.apron_ts.id = master_join_ynwkke.source_id
left join notes.note_view notes_note_view_ihynch on master_join_ynwkke.target_id = notes_note_view_ihynch.id
left join master_join master_join_gahxew on airport_heliport.apron_ts.id = master_join_gahxew.source_id
left join airport_heliport.apronareaavailability_view airport_heliport_apronareaavailability_view_ghtxer on master_join_gahxew.target_id = airport_heliport_apronareaavailability_view_ghtxer.id
where airport_heliport.apron.feature_status = 'APPROVED'
  and airport_heliport.apron_ts.feature_status = 'APPROVED'
group by
    airport_heliport.apron.id,
    airport_heliport.apron_ts.id,
    airport_heliport.apron_tsp.id,
    airport_heliport.apron.identifier,
    airport_heliport.apron_ts.interpretation,
    airport_heliport.apron_ts.sequence_number,
    airport_heliport.apron_ts.correction_number,
    airport_heliport.apron_ts.valid_time_begin,
    airport_heliport.apron_ts.valid_time_end,
    airport_heliport.apron_ts.feature_lifetime_begin,
    airport_heliport.apron_ts.feature_lifetime_end,
    airport_heliport.apron_ts.name_value,
    airport_heliport.apron_ts.name_nilreason,
    airport_heliport.apron_ts.abandoned_value,
    airport_heliport.apron_ts.abandoned_nilreason,
    airport_heliport_surfacecharacteristics_pt_cwyrdu.title,
    airport_heliport_surfacecharacteristics_pt_cwyrdu.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_cwyrdu.href,
    airport_heliport_airportheliport_pt_gzqbog.title,
    airport_heliport_airportheliport_pt_gzqbog.nilreason[1],
    airport_heliport_airportheliport_pt_gzqbog.href
order by apron.identifier, apron_ts.sequence_number, apron_ts.correction_number DESC;
-- ArrestingGearTimeSliceType
-- ['geometry.elevatedsurface_view', 'geometry.elevatedcurve_view', 'notes.note_view', 'geometry.elevatedpoint_view']
create or replace view airport_heliport.arrestinggear_view as
select distinct on (arrestinggear.identifier,arrestinggear_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.arrestinggear.id,
    airport_heliport.arrestinggear_ts.id as ts_id,
    airport_heliport.arrestinggear_tsp.id as tsp_id,
    airport_heliport.arrestinggear.identifier,
    airport_heliport.arrestinggear_ts.interpretation,
    airport_heliport.arrestinggear_ts.sequence_number,
    airport_heliport.arrestinggear_ts.correction_number,
    airport_heliport.arrestinggear_ts.valid_time_begin,
    airport_heliport.arrestinggear_ts.valid_time_end,
    airport_heliport.arrestinggear_ts.feature_lifetime_begin,
    airport_heliport.arrestinggear_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.arrestinggear_ts.status_value as varchar), '(' || airport_heliport.arrestinggear_ts.status_nilreason || ')') as status,
    coalesce(cast(airport_heliport.arrestinggear_ts.engagedevice_value as varchar), '(' || airport_heliport.arrestinggear_ts.engagedevice_nilreason || ')') as engagedevice,
    coalesce(cast(airport_heliport.arrestinggear_ts.absorbtype_value as varchar), '(' || airport_heliport.arrestinggear_ts.absorbtype_nilreason || ')') as absorbtype,
    coalesce(cast(airport_heliport.arrestinggear_ts.bidirectional_value as varchar), '(' || airport_heliport.arrestinggear_ts.bidirectional_nilreason || ')') as bidirectional,
    coalesce(cast(airport_heliport.arrestinggear_ts.length_value as varchar) || ' ' || airport_heliport.arrestinggear_ts.length_uom, '(' || airport_heliport.arrestinggear_ts.length_nilreason || ')') as length,
    coalesce(cast(airport_heliport.arrestinggear_ts.width_value as varchar) || ' ' || airport_heliport.arrestinggear_ts.width_uom, '(' || airport_heliport.arrestinggear_ts.width_nilreason || ')') as width,
    coalesce(cast(airport_heliport.arrestinggear_ts.location_value as varchar) || ' ' || airport_heliport.arrestinggear_ts.location_uom, '(' || airport_heliport.arrestinggear_ts.location_nilreason || ')') as location,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_lnzaqa.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_lnzaqa.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_lnzaqa.href AS surfaceproperties_href,
    geometry_elevatedcurve_view_hawudw.geom AS geom,
    geometry_elevatedcurve_view_hawudw.elevation,
    geometry_elevatedcurve_view_hawudw.geoidUndulation,
    geometry_elevatedcurve_view_hawudw.verticalDatum,
    geometry_elevatedcurve_view_hawudw.verticalAccuracy,
    geometry_elevatedcurve_view_hawudw.horizontalAccuracy,
    geometry_elevatedsurface_view_gpkbry.geom AS geom,
    geometry_elevatedsurface_view_gpkbry.elevation,
    geometry_elevatedsurface_view_gpkbry.geoidUndulation,
    geometry_elevatedsurface_view_gpkbry.verticalDatum,
    geometry_elevatedsurface_view_gpkbry.verticalAccuracy,
    geometry_elevatedsurface_view_gpkbry.horizontalAccuracy,
    geometry_elevatedpoint_view_kdfott.geom AS geom,
    ST_X(geometry_elevatedpoint_view_kdfott.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_kdfott.geom) AS latitude,
    geometry_elevatedpoint_view_kdfott.elevation,
    geometry_elevatedpoint_view_kdfott.geoidUndulation,
    geometry_elevatedpoint_view_kdfott.verticalDatum,
    geometry_elevatedpoint_view_kdfott.verticalAccuracy,
    geometry_elevatedpoint_view_kdfott.horizontalAccuracy,
    jsonb_build_object('id', airport_heliport_runwaydirection_pt_harvax.id,
    'title', coalesce(cast(airport_heliport_runwaydirection_pt_harvax.title AS varchar), '(' || airport_heliport_runwaydirection_pt_harvax.nilreason[1] || ')'),
    'href', airport_heliport_runwaydirection_pt_harvax.href) AS runwaydirection,
    jsonb_agg(notes_note_view_gjzfzk.*) AS arrestinggear_annotation
from airport_heliport.arrestinggear 
inner join master_join mj2 on airport_heliport.arrestinggear.id = mj2.source_id
inner join airport_heliport.arrestinggear_tsp on mj2.target_id = airport_heliport.arrestinggear_tsp.id
inner join airport_heliport.arrestinggear_ts on airport_heliport.arrestinggear_tsp.arrestinggeartimeslice_id = airport_heliport.arrestinggear_ts.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_lnzaqa on airport_heliport.arrestinggear_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_lnzaqa.id
left join geometry.elevatedcurve_view geometry_elevatedcurve_view_hawudw on airport_heliport.arrestinggear_ts.extent_curveextent_id = geometry_elevatedcurve_view_hawudw.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_gpkbry on airport_heliport.arrestinggear_ts.extent_surfaceextent_id = geometry_elevatedsurface_view_gpkbry.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_kdfott on airport_heliport.arrestinggear_ts.extent_pointextent_id = geometry_elevatedpoint_view_kdfott.id
left join master_join master_join_ztbtye on airport_heliport.arrestinggear_ts.id = master_join_ztbtye.source_id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_harvax on master_join_ztbtye.target_id = airport_heliport_runwaydirection_pt_harvax.id
left join master_join master_join_jtmtgt on airport_heliport.arrestinggear_ts.id = master_join_jtmtgt.source_id
left join notes.note_view notes_note_view_gjzfzk on master_join_jtmtgt.target_id = notes_note_view_gjzfzk.id
where airport_heliport.arrestinggear.feature_status = 'APPROVED'
  and airport_heliport.arrestinggear_ts.feature_status = 'APPROVED'
group by
    airport_heliport.arrestinggear.id,
    airport_heliport.arrestinggear_ts.id,
    airport_heliport.arrestinggear_tsp.id,
    airport_heliport.arrestinggear.identifier,
    airport_heliport.arrestinggear_ts.interpretation,
    airport_heliport.arrestinggear_ts.sequence_number,
    airport_heliport.arrestinggear_ts.correction_number,
    airport_heliport.arrestinggear_ts.valid_time_begin,
    airport_heliport.arrestinggear_ts.valid_time_end,
    airport_heliport.arrestinggear_ts.feature_lifetime_begin,
    airport_heliport.arrestinggear_ts.feature_lifetime_end,
    airport_heliport.arrestinggear_ts.status_value,
    airport_heliport.arrestinggear_ts.status_nilreason,
    airport_heliport.arrestinggear_ts.engagedevice_value,
    airport_heliport.arrestinggear_ts.engagedevice_nilreason,
    airport_heliport.arrestinggear_ts.absorbtype_value,
    airport_heliport.arrestinggear_ts.absorbtype_nilreason,
    airport_heliport.arrestinggear_ts.bidirectional_value,
    airport_heliport.arrestinggear_ts.bidirectional_nilreason,
    airport_heliport.arrestinggear_ts.length_value,
    airport_heliport.arrestinggear_ts.length_uom,
    airport_heliport.arrestinggear_ts.length_nilreason,
    airport_heliport.arrestinggear_ts.width_value,
    airport_heliport.arrestinggear_ts.width_uom,
    airport_heliport.arrestinggear_ts.width_nilreason,
    airport_heliport.arrestinggear_ts.location_value,
    airport_heliport.arrestinggear_ts.location_uom,
    airport_heliport.arrestinggear_ts.location_nilreason,
    airport_heliport_surfacecharacteristics_pt_lnzaqa.title,
    airport_heliport_surfacecharacteristics_pt_lnzaqa.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_lnzaqa.href,
    geometry_elevatedcurve_view_hawudw.geom,
    geometry_elevatedcurve_view_hawudw.elevation,
    geometry_elevatedcurve_view_hawudw.geoidUndulation,
    geometry_elevatedcurve_view_hawudw.verticalDatum,
    geometry_elevatedcurve_view_hawudw.verticalAccuracy,
    geometry_elevatedcurve_view_hawudw.horizontalAccuracy,
    geometry_elevatedsurface_view_gpkbry.geom,
    geometry_elevatedsurface_view_gpkbry.elevation,
    geometry_elevatedsurface_view_gpkbry.geoidUndulation,
    geometry_elevatedsurface_view_gpkbry.verticalDatum,
    geometry_elevatedsurface_view_gpkbry.verticalAccuracy,
    geometry_elevatedsurface_view_gpkbry.horizontalAccuracy,
    geometry_elevatedpoint_view_kdfott.geom,
    geometry_elevatedpoint_view_kdfott.elevation,
    geometry_elevatedpoint_view_kdfott.geoidUndulation,
    geometry_elevatedpoint_view_kdfott.verticalDatum,
    geometry_elevatedpoint_view_kdfott.verticalAccuracy,
    geometry_elevatedpoint_view_kdfott.horizontalAccuracy
order by arrestinggear.identifier, arrestinggear_ts.sequence_number, arrestinggear_ts.correction_number DESC;
-- ArrivalFeederLegTimeSliceType
-- ['shared.obstacleassessmentarea_view', 'notes.note_view', 'geometry.curve_view', 'shared.aircraftcharacteristic_view']
create or replace view procedure.arrivalfeederleg_view as
select distinct on (arrivalfeederleg.identifier,arrivalfeederleg_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.arrivalfeederleg.id,
    procedure.arrivalfeederleg_ts.id as ts_id,
    procedure.arrivalfeederleg_tsp.id as tsp_id,
    procedure.arrivalfeederleg.identifier,
    procedure.arrivalfeederleg_ts.interpretation,
    procedure.arrivalfeederleg_ts.sequence_number,
    procedure.arrivalfeederleg_ts.correction_number,
    procedure.arrivalfeederleg_ts.valid_time_begin,
    procedure.arrivalfeederleg_ts.valid_time_end,
    procedure.arrivalfeederleg_ts.feature_lifetime_begin,
    procedure.arrivalfeederleg_ts.feature_lifetime_end,
    coalesce(cast(procedure.arrivalfeederleg_ts.endconditiondesignator_value as varchar), '(' || procedure.arrivalfeederleg_ts.endconditiondesignator_nilreason || ')') as endconditiondesignator,
    coalesce(cast(procedure.arrivalfeederleg_ts.legpath_value as varchar), '(' || procedure.arrivalfeederleg_ts.legpath_nilreason || ')') as legpath,
    coalesce(cast(procedure.arrivalfeederleg_ts.legtypearinc_value as varchar), '(' || procedure.arrivalfeederleg_ts.legtypearinc_nilreason || ')') as legtypearinc,
    coalesce(cast(procedure.arrivalfeederleg_ts.course_value as varchar), '(' || procedure.arrivalfeederleg_ts.course_nilreason || ')') as course,
    coalesce(cast(procedure.arrivalfeederleg_ts.coursetype_value as varchar), '(' || procedure.arrivalfeederleg_ts.coursetype_nilreason || ')') as coursetype,
    coalesce(cast(procedure.arrivalfeederleg_ts.coursedirection_value as varchar), '(' || procedure.arrivalfeederleg_ts.coursedirection_nilreason || ')') as coursedirection,
    coalesce(cast(procedure.arrivalfeederleg_ts.turndirection_value as varchar), '(' || procedure.arrivalfeederleg_ts.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(procedure.arrivalfeederleg_ts.speedreference_value as varchar), '(' || procedure.arrivalfeederleg_ts.speedreference_nilreason || ')') as speedreference,
    coalesce(cast(procedure.arrivalfeederleg_ts.speedinterpretation_value as varchar), '(' || procedure.arrivalfeederleg_ts.speedinterpretation_nilreason || ')') as speedinterpretation,
    coalesce(cast(procedure.arrivalfeederleg_ts.bankangle_value as varchar), '(' || procedure.arrivalfeederleg_ts.bankangle_nilreason || ')') as bankangle,
    coalesce(cast(procedure.arrivalfeederleg_ts.procedureturnrequired_value as varchar), '(' || procedure.arrivalfeederleg_ts.procedureturnrequired_nilreason || ')') as procedureturnrequired,
    coalesce(cast(procedure.arrivalfeederleg_ts.upperlimitreference_value as varchar), '(' || procedure.arrivalfeederleg_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(procedure.arrivalfeederleg_ts.lowerlimitreference_value as varchar), '(' || procedure.arrivalfeederleg_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(procedure.arrivalfeederleg_ts.altitudeinterpretation_value as varchar), '(' || procedure.arrivalfeederleg_ts.altitudeinterpretation_nilreason || ')') as altitudeinterpretation,
    coalesce(cast(procedure.arrivalfeederleg_ts.altitudeoverridereference_value as varchar), '(' || procedure.arrivalfeederleg_ts.altitudeoverridereference_nilreason || ')') as altitudeoverridereference,
    coalesce(cast(procedure.arrivalfeederleg_ts.verticalangle_value as varchar), '(' || procedure.arrivalfeederleg_ts.verticalangle_nilreason || ')') as verticalangle,
    coalesce(cast(procedure.arrivalfeederleg_ts.requirednavigationperformance_value as varchar), '(' || procedure.arrivalfeederleg_ts.requirednavigationperformance_nilreason || ')') as requirednavigationperformance,
    coalesce(cast(procedure.arrivalfeederleg_ts.speedlimit_value as varchar) || ' ' || procedure.arrivalfeederleg_ts.speedlimit_uom, '(' || procedure.arrivalfeederleg_ts.speedlimit_nilreason || ')') as speedlimit,
    coalesce(cast(procedure.arrivalfeederleg_ts.length_value as varchar) || ' ' || procedure.arrivalfeederleg_ts.length_uom, '(' || procedure.arrivalfeederleg_ts.length_nilreason || ')') as length,
    coalesce(cast(procedure.arrivalfeederleg_ts.duration_value as varchar) || ' ' || procedure.arrivalfeederleg_ts.duration_uom, '(' || procedure.arrivalfeederleg_ts.duration_nilreason || ')') as duration,
    coalesce(cast(procedure.arrivalfeederleg_ts.upperlimitaltitude_value as varchar) || ' ' || procedure.arrivalfeederleg_ts.upperlimitaltitude_uom, '(' || procedure.arrivalfeederleg_ts.upperlimitaltitude_nilreason || ')') as upperlimitaltitude,
    coalesce(cast(procedure.arrivalfeederleg_ts.lowerlimitaltitude_value as varchar) || ' ' || procedure.arrivalfeederleg_ts.lowerlimitaltitude_uom, '(' || procedure.arrivalfeederleg_ts.lowerlimitaltitude_nilreason || ')') as lowerlimitaltitude,
    coalesce(cast(procedure.arrivalfeederleg_ts.altitudeoverrideatc_value as varchar) || ' ' || procedure.arrivalfeederleg_ts.altitudeoverrideatc_uom, '(' || procedure.arrivalfeederleg_ts.altitudeoverrideatc_nilreason || ')') as altitudeoverrideatc,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_qcenkz.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_qcenkz.nilreason[1] || ')') AS startpoint,
    navaids_points_terminalsegmentpoint_pt_qcenkz.href AS startpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_xvvplv.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_xvvplv.nilreason[1] || ')') AS endpoint,
    navaids_points_terminalsegmentpoint_pt_xvvplv.href AS endpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_vkympm.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_vkympm.nilreason[1] || ')') AS arccentre,
    navaids_points_terminalsegmentpoint_pt_vkympm.href AS arccentre_href,
    geometry_curve_view_xpiygc.geom AS geom,
    coalesce(cast(navaids_points_angleindication_pt_tbntao.title as varchar), '(' || navaids_points_angleindication_pt_tbntao.nilreason[1] || ')') AS angle,
    navaids_points_angleindication_pt_tbntao.href AS angle_href,
    coalesce(cast(navaids_points_distanceindication_pt_xvwnbg.title as varchar), '(' || navaids_points_distanceindication_pt_xvwnbg.nilreason[1] || ')') AS distance,
    navaids_points_distanceindication_pt_xvwnbg.href AS distance_href,
    coalesce(cast(procedure_holdinguse_pt_ueovfr.title as varchar), '(' || procedure_holdinguse_pt_ueovfr.nilreason[1] || ')') AS holding,
    procedure_holdinguse_pt_ueovfr.href AS holding_href,
    coalesce(cast(procedure_instrumentapproachprocedure_pt_apyico.title as varchar), '(' || procedure_instrumentapproachprocedure_pt_apyico.nilreason[1] || ')') AS approach,
    procedure_instrumentapproachprocedure_pt_apyico.href AS approach_href,
    jsonb_agg(shared_aircraftcharacteristic_view_pviqoh.id) AS aircraftcategory,
    jsonb_agg(shared_obstacleassessmentarea_view_jdfdeb.id) AS designsurface,
    jsonb_agg(notes_note_view_xowmsz.*) AS arrivalfeederleg_annotation
from procedure.arrivalfeederleg 
inner join master_join mj2 on procedure.arrivalfeederleg.id = mj2.source_id
inner join procedure.arrivalfeederleg_tsp on mj2.target_id = procedure.arrivalfeederleg_tsp.id
inner join procedure.arrivalfeederleg_ts on procedure.arrivalfeederleg_tsp.arrivalfeederlegtimeslice_id = procedure.arrivalfeederleg_ts.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_qcenkz on procedure.arrivalfeederleg_ts.startpoint_id = navaids_points_terminalsegmentpoint_pt_qcenkz.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_xvvplv on procedure.arrivalfeederleg_ts.endpoint_id = navaids_points_terminalsegmentpoint_pt_xvvplv.id
left join geometry.curve_view geometry_curve_view_xpiygc on procedure.arrivalfeederleg_ts.trajectory_id = geometry_curve_view_xpiygc.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_vkympm on procedure.arrivalfeederleg_ts.arccentre_id = navaids_points_terminalsegmentpoint_pt_vkympm.id
left join navaids_points.angleindication_pt navaids_points_angleindication_pt_tbntao on procedure.arrivalfeederleg_ts.angle_id = navaids_points_angleindication_pt_tbntao.id
left join navaids_points.distanceindication_pt navaids_points_distanceindication_pt_xvwnbg on procedure.arrivalfeederleg_ts.distance_id = navaids_points_distanceindication_pt_xvwnbg.id
left join procedure.holdinguse_pt procedure_holdinguse_pt_ueovfr on procedure.arrivalfeederleg_ts.holding_id = procedure_holdinguse_pt_ueovfr.id
left join procedure.instrumentapproachprocedure_pt procedure_instrumentapproachprocedure_pt_apyico on procedure.arrivalfeederleg_ts.approach_id = procedure_instrumentapproachprocedure_pt_apyico.id
left join master_join master_join_didekw on procedure.arrivalfeederleg_ts.id = master_join_didekw.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_pviqoh on master_join_didekw.target_id = shared_aircraftcharacteristic_view_pviqoh.id
left join master_join master_join_dvznfp on procedure.arrivalfeederleg_ts.id = master_join_dvznfp.source_id
left join shared.obstacleassessmentarea_view shared_obstacleassessmentarea_view_jdfdeb on master_join_dvznfp.target_id = shared_obstacleassessmentarea_view_jdfdeb.id
left join master_join master_join_ytnast on procedure.arrivalfeederleg_ts.id = master_join_ytnast.source_id
left join notes.note_view notes_note_view_xowmsz on master_join_ytnast.target_id = notes_note_view_xowmsz.id
where procedure.arrivalfeederleg.feature_status = 'APPROVED'
  and procedure.arrivalfeederleg_ts.feature_status = 'APPROVED'
group by
    procedure.arrivalfeederleg.id,
    procedure.arrivalfeederleg_ts.id,
    procedure.arrivalfeederleg_tsp.id,
    procedure.arrivalfeederleg.identifier,
    procedure.arrivalfeederleg_ts.interpretation,
    procedure.arrivalfeederleg_ts.sequence_number,
    procedure.arrivalfeederleg_ts.correction_number,
    procedure.arrivalfeederleg_ts.valid_time_begin,
    procedure.arrivalfeederleg_ts.valid_time_end,
    procedure.arrivalfeederleg_ts.feature_lifetime_begin,
    procedure.arrivalfeederleg_ts.feature_lifetime_end,
    procedure.arrivalfeederleg_ts.endconditiondesignator_value,
    procedure.arrivalfeederleg_ts.endconditiondesignator_nilreason,
    procedure.arrivalfeederleg_ts.legpath_value,
    procedure.arrivalfeederleg_ts.legpath_nilreason,
    procedure.arrivalfeederleg_ts.legtypearinc_value,
    procedure.arrivalfeederleg_ts.legtypearinc_nilreason,
    procedure.arrivalfeederleg_ts.course_value,
    procedure.arrivalfeederleg_ts.course_nilreason,
    procedure.arrivalfeederleg_ts.coursetype_value,
    procedure.arrivalfeederleg_ts.coursetype_nilreason,
    procedure.arrivalfeederleg_ts.coursedirection_value,
    procedure.arrivalfeederleg_ts.coursedirection_nilreason,
    procedure.arrivalfeederleg_ts.turndirection_value,
    procedure.arrivalfeederleg_ts.turndirection_nilreason,
    procedure.arrivalfeederleg_ts.speedreference_value,
    procedure.arrivalfeederleg_ts.speedreference_nilreason,
    procedure.arrivalfeederleg_ts.speedinterpretation_value,
    procedure.arrivalfeederleg_ts.speedinterpretation_nilreason,
    procedure.arrivalfeederleg_ts.bankangle_value,
    procedure.arrivalfeederleg_ts.bankangle_nilreason,
    procedure.arrivalfeederleg_ts.procedureturnrequired_value,
    procedure.arrivalfeederleg_ts.procedureturnrequired_nilreason,
    procedure.arrivalfeederleg_ts.upperlimitreference_value,
    procedure.arrivalfeederleg_ts.upperlimitreference_nilreason,
    procedure.arrivalfeederleg_ts.lowerlimitreference_value,
    procedure.arrivalfeederleg_ts.lowerlimitreference_nilreason,
    procedure.arrivalfeederleg_ts.altitudeinterpretation_value,
    procedure.arrivalfeederleg_ts.altitudeinterpretation_nilreason,
    procedure.arrivalfeederleg_ts.altitudeoverridereference_value,
    procedure.arrivalfeederleg_ts.altitudeoverridereference_nilreason,
    procedure.arrivalfeederleg_ts.verticalangle_value,
    procedure.arrivalfeederleg_ts.verticalangle_nilreason,
    procedure.arrivalfeederleg_ts.requirednavigationperformance_value,
    procedure.arrivalfeederleg_ts.requirednavigationperformance_nilreason,
    procedure.arrivalfeederleg_ts.speedlimit_value,
    procedure.arrivalfeederleg_ts.speedlimit_uom,
    procedure.arrivalfeederleg_ts.speedlimit_nilreason,
    procedure.arrivalfeederleg_ts.length_value,
    procedure.arrivalfeederleg_ts.length_uom,
    procedure.arrivalfeederleg_ts.length_nilreason,
    procedure.arrivalfeederleg_ts.duration_value,
    procedure.arrivalfeederleg_ts.duration_uom,
    procedure.arrivalfeederleg_ts.duration_nilreason,
    procedure.arrivalfeederleg_ts.upperlimitaltitude_value,
    procedure.arrivalfeederleg_ts.upperlimitaltitude_uom,
    procedure.arrivalfeederleg_ts.upperlimitaltitude_nilreason,
    procedure.arrivalfeederleg_ts.lowerlimitaltitude_value,
    procedure.arrivalfeederleg_ts.lowerlimitaltitude_uom,
    procedure.arrivalfeederleg_ts.lowerlimitaltitude_nilreason,
    procedure.arrivalfeederleg_ts.altitudeoverrideatc_value,
    procedure.arrivalfeederleg_ts.altitudeoverrideatc_uom,
    procedure.arrivalfeederleg_ts.altitudeoverrideatc_nilreason,
    navaids_points_terminalsegmentpoint_pt_qcenkz.title,
    navaids_points_terminalsegmentpoint_pt_qcenkz.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_qcenkz.href,
    navaids_points_terminalsegmentpoint_pt_xvvplv.title,
    navaids_points_terminalsegmentpoint_pt_xvvplv.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_xvvplv.href,
    geometry_curve_view_xpiygc.geom,
    navaids_points_terminalsegmentpoint_pt_vkympm.title,
    navaids_points_terminalsegmentpoint_pt_vkympm.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_vkympm.href,
    navaids_points_angleindication_pt_tbntao.title,
    navaids_points_angleindication_pt_tbntao.nilreason[1],
    navaids_points_angleindication_pt_tbntao.href,
    navaids_points_distanceindication_pt_xvwnbg.title,
    navaids_points_distanceindication_pt_xvwnbg.nilreason[1],
    navaids_points_distanceindication_pt_xvwnbg.href,
    procedure_holdinguse_pt_ueovfr.title,
    procedure_holdinguse_pt_ueovfr.nilreason[1],
    procedure_holdinguse_pt_ueovfr.href,
    procedure_instrumentapproachprocedure_pt_apyico.title,
    procedure_instrumentapproachprocedure_pt_apyico.nilreason[1],
    procedure_instrumentapproachprocedure_pt_apyico.href
order by arrivalfeederleg.identifier, arrivalfeederleg_ts.sequence_number, arrivalfeederleg_ts.correction_number DESC;
-- ArrivalLegTimeSliceType
-- ['shared.obstacleassessmentarea_view', 'notes.note_view', 'geometry.curve_view', 'shared.aircraftcharacteristic_view']
create or replace view procedure.arrivalleg_view as
select distinct on (arrivalleg.identifier,arrivalleg_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.arrivalleg.id,
    procedure.arrivalleg_ts.id as ts_id,
    procedure.arrivalleg_tsp.id as tsp_id,
    procedure.arrivalleg.identifier,
    procedure.arrivalleg_ts.interpretation,
    procedure.arrivalleg_ts.sequence_number,
    procedure.arrivalleg_ts.correction_number,
    procedure.arrivalleg_ts.valid_time_begin,
    procedure.arrivalleg_ts.valid_time_end,
    procedure.arrivalleg_ts.feature_lifetime_begin,
    procedure.arrivalleg_ts.feature_lifetime_end,
    coalesce(cast(procedure.arrivalleg_ts.endconditiondesignator_value as varchar), '(' || procedure.arrivalleg_ts.endconditiondesignator_nilreason || ')') as endconditiondesignator,
    coalesce(cast(procedure.arrivalleg_ts.legpath_value as varchar), '(' || procedure.arrivalleg_ts.legpath_nilreason || ')') as legpath,
    coalesce(cast(procedure.arrivalleg_ts.legtypearinc_value as varchar), '(' || procedure.arrivalleg_ts.legtypearinc_nilreason || ')') as legtypearinc,
    coalesce(cast(procedure.arrivalleg_ts.course_value as varchar), '(' || procedure.arrivalleg_ts.course_nilreason || ')') as course,
    coalesce(cast(procedure.arrivalleg_ts.coursetype_value as varchar), '(' || procedure.arrivalleg_ts.coursetype_nilreason || ')') as coursetype,
    coalesce(cast(procedure.arrivalleg_ts.coursedirection_value as varchar), '(' || procedure.arrivalleg_ts.coursedirection_nilreason || ')') as coursedirection,
    coalesce(cast(procedure.arrivalleg_ts.turndirection_value as varchar), '(' || procedure.arrivalleg_ts.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(procedure.arrivalleg_ts.speedreference_value as varchar), '(' || procedure.arrivalleg_ts.speedreference_nilreason || ')') as speedreference,
    coalesce(cast(procedure.arrivalleg_ts.speedinterpretation_value as varchar), '(' || procedure.arrivalleg_ts.speedinterpretation_nilreason || ')') as speedinterpretation,
    coalesce(cast(procedure.arrivalleg_ts.bankangle_value as varchar), '(' || procedure.arrivalleg_ts.bankangle_nilreason || ')') as bankangle,
    coalesce(cast(procedure.arrivalleg_ts.procedureturnrequired_value as varchar), '(' || procedure.arrivalleg_ts.procedureturnrequired_nilreason || ')') as procedureturnrequired,
    coalesce(cast(procedure.arrivalleg_ts.upperlimitreference_value as varchar), '(' || procedure.arrivalleg_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(procedure.arrivalleg_ts.lowerlimitreference_value as varchar), '(' || procedure.arrivalleg_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(procedure.arrivalleg_ts.altitudeinterpretation_value as varchar), '(' || procedure.arrivalleg_ts.altitudeinterpretation_nilreason || ')') as altitudeinterpretation,
    coalesce(cast(procedure.arrivalleg_ts.altitudeoverridereference_value as varchar), '(' || procedure.arrivalleg_ts.altitudeoverridereference_nilreason || ')') as altitudeoverridereference,
    coalesce(cast(procedure.arrivalleg_ts.verticalangle_value as varchar), '(' || procedure.arrivalleg_ts.verticalangle_nilreason || ')') as verticalangle,
    coalesce(cast(procedure.arrivalleg_ts.requirednavigationperformance_value as varchar), '(' || procedure.arrivalleg_ts.requirednavigationperformance_nilreason || ')') as requirednavigationperformance,
    coalesce(cast(procedure.arrivalleg_ts.speedlimit_value as varchar) || ' ' || procedure.arrivalleg_ts.speedlimit_uom, '(' || procedure.arrivalleg_ts.speedlimit_nilreason || ')') as speedlimit,
    coalesce(cast(procedure.arrivalleg_ts.length_value as varchar) || ' ' || procedure.arrivalleg_ts.length_uom, '(' || procedure.arrivalleg_ts.length_nilreason || ')') as length,
    coalesce(cast(procedure.arrivalleg_ts.duration_value as varchar) || ' ' || procedure.arrivalleg_ts.duration_uom, '(' || procedure.arrivalleg_ts.duration_nilreason || ')') as duration,
    coalesce(cast(procedure.arrivalleg_ts.upperlimitaltitude_value as varchar) || ' ' || procedure.arrivalleg_ts.upperlimitaltitude_uom, '(' || procedure.arrivalleg_ts.upperlimitaltitude_nilreason || ')') as upperlimitaltitude,
    coalesce(cast(procedure.arrivalleg_ts.lowerlimitaltitude_value as varchar) || ' ' || procedure.arrivalleg_ts.lowerlimitaltitude_uom, '(' || procedure.arrivalleg_ts.lowerlimitaltitude_nilreason || ')') as lowerlimitaltitude,
    coalesce(cast(procedure.arrivalleg_ts.altitudeoverrideatc_value as varchar) || ' ' || procedure.arrivalleg_ts.altitudeoverrideatc_uom, '(' || procedure.arrivalleg_ts.altitudeoverrideatc_nilreason || ')') as altitudeoverrideatc,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_irzmyd.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_irzmyd.nilreason[1] || ')') AS startpoint,
    navaids_points_terminalsegmentpoint_pt_irzmyd.href AS startpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_qkdmsh.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_qkdmsh.nilreason[1] || ')') AS endpoint,
    navaids_points_terminalsegmentpoint_pt_qkdmsh.href AS endpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_kmizhp.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_kmizhp.nilreason[1] || ')') AS arccentre,
    navaids_points_terminalsegmentpoint_pt_kmizhp.href AS arccentre_href,
    geometry_curve_view_lsciue.geom AS geom,
    coalesce(cast(navaids_points_angleindication_pt_ztdckr.title as varchar), '(' || navaids_points_angleindication_pt_ztdckr.nilreason[1] || ')') AS angle,
    navaids_points_angleindication_pt_ztdckr.href AS angle_href,
    coalesce(cast(navaids_points_distanceindication_pt_wnfpfh.title as varchar), '(' || navaids_points_distanceindication_pt_wnfpfh.nilreason[1] || ')') AS distance,
    navaids_points_distanceindication_pt_wnfpfh.href AS distance_href,
    coalesce(cast(procedure_holdinguse_pt_fipjze.title as varchar), '(' || procedure_holdinguse_pt_fipjze.nilreason[1] || ')') AS holding,
    procedure_holdinguse_pt_fipjze.href AS holding_href,
    coalesce(cast(procedure_standardinstrumentarrival_pt_yokicz.title as varchar), '(' || procedure_standardinstrumentarrival_pt_yokicz.nilreason[1] || ')') AS arrival,
    procedure_standardinstrumentarrival_pt_yokicz.href AS arrival_href,
    jsonb_agg(shared_aircraftcharacteristic_view_vntqzw.id) AS aircraftcategory,
    jsonb_agg(shared_obstacleassessmentarea_view_ncmcfn.id) AS designsurface,
    jsonb_agg(notes_note_view_kjcoqb.*) AS arrivalleg_annotation
from procedure.arrivalleg 
inner join master_join mj2 on procedure.arrivalleg.id = mj2.source_id
inner join procedure.arrivalleg_tsp on mj2.target_id = procedure.arrivalleg_tsp.id
inner join procedure.arrivalleg_ts on procedure.arrivalleg_tsp.arrivallegtimeslice_id = procedure.arrivalleg_ts.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_irzmyd on procedure.arrivalleg_ts.startpoint_id = navaids_points_terminalsegmentpoint_pt_irzmyd.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_qkdmsh on procedure.arrivalleg_ts.endpoint_id = navaids_points_terminalsegmentpoint_pt_qkdmsh.id
left join geometry.curve_view geometry_curve_view_lsciue on procedure.arrivalleg_ts.trajectory_id = geometry_curve_view_lsciue.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_kmizhp on procedure.arrivalleg_ts.arccentre_id = navaids_points_terminalsegmentpoint_pt_kmizhp.id
left join navaids_points.angleindication_pt navaids_points_angleindication_pt_ztdckr on procedure.arrivalleg_ts.angle_id = navaids_points_angleindication_pt_ztdckr.id
left join navaids_points.distanceindication_pt navaids_points_distanceindication_pt_wnfpfh on procedure.arrivalleg_ts.distance_id = navaids_points_distanceindication_pt_wnfpfh.id
left join procedure.holdinguse_pt procedure_holdinguse_pt_fipjze on procedure.arrivalleg_ts.holding_id = procedure_holdinguse_pt_fipjze.id
left join procedure.standardinstrumentarrival_pt procedure_standardinstrumentarrival_pt_yokicz on procedure.arrivalleg_ts.arrival_id = procedure_standardinstrumentarrival_pt_yokicz.id
left join master_join master_join_unzhjl on procedure.arrivalleg_ts.id = master_join_unzhjl.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_vntqzw on master_join_unzhjl.target_id = shared_aircraftcharacteristic_view_vntqzw.id
left join master_join master_join_twqyxl on procedure.arrivalleg_ts.id = master_join_twqyxl.source_id
left join shared.obstacleassessmentarea_view shared_obstacleassessmentarea_view_ncmcfn on master_join_twqyxl.target_id = shared_obstacleassessmentarea_view_ncmcfn.id
left join master_join master_join_dxlakg on procedure.arrivalleg_ts.id = master_join_dxlakg.source_id
left join notes.note_view notes_note_view_kjcoqb on master_join_dxlakg.target_id = notes_note_view_kjcoqb.id
where procedure.arrivalleg.feature_status = 'APPROVED'
  and procedure.arrivalleg_ts.feature_status = 'APPROVED'
group by
    procedure.arrivalleg.id,
    procedure.arrivalleg_ts.id,
    procedure.arrivalleg_tsp.id,
    procedure.arrivalleg.identifier,
    procedure.arrivalleg_ts.interpretation,
    procedure.arrivalleg_ts.sequence_number,
    procedure.arrivalleg_ts.correction_number,
    procedure.arrivalleg_ts.valid_time_begin,
    procedure.arrivalleg_ts.valid_time_end,
    procedure.arrivalleg_ts.feature_lifetime_begin,
    procedure.arrivalleg_ts.feature_lifetime_end,
    procedure.arrivalleg_ts.endconditiondesignator_value,
    procedure.arrivalleg_ts.endconditiondesignator_nilreason,
    procedure.arrivalleg_ts.legpath_value,
    procedure.arrivalleg_ts.legpath_nilreason,
    procedure.arrivalleg_ts.legtypearinc_value,
    procedure.arrivalleg_ts.legtypearinc_nilreason,
    procedure.arrivalleg_ts.course_value,
    procedure.arrivalleg_ts.course_nilreason,
    procedure.arrivalleg_ts.coursetype_value,
    procedure.arrivalleg_ts.coursetype_nilreason,
    procedure.arrivalleg_ts.coursedirection_value,
    procedure.arrivalleg_ts.coursedirection_nilreason,
    procedure.arrivalleg_ts.turndirection_value,
    procedure.arrivalleg_ts.turndirection_nilreason,
    procedure.arrivalleg_ts.speedreference_value,
    procedure.arrivalleg_ts.speedreference_nilreason,
    procedure.arrivalleg_ts.speedinterpretation_value,
    procedure.arrivalleg_ts.speedinterpretation_nilreason,
    procedure.arrivalleg_ts.bankangle_value,
    procedure.arrivalleg_ts.bankangle_nilreason,
    procedure.arrivalleg_ts.procedureturnrequired_value,
    procedure.arrivalleg_ts.procedureturnrequired_nilreason,
    procedure.arrivalleg_ts.upperlimitreference_value,
    procedure.arrivalleg_ts.upperlimitreference_nilreason,
    procedure.arrivalleg_ts.lowerlimitreference_value,
    procedure.arrivalleg_ts.lowerlimitreference_nilreason,
    procedure.arrivalleg_ts.altitudeinterpretation_value,
    procedure.arrivalleg_ts.altitudeinterpretation_nilreason,
    procedure.arrivalleg_ts.altitudeoverridereference_value,
    procedure.arrivalleg_ts.altitudeoverridereference_nilreason,
    procedure.arrivalleg_ts.verticalangle_value,
    procedure.arrivalleg_ts.verticalangle_nilreason,
    procedure.arrivalleg_ts.requirednavigationperformance_value,
    procedure.arrivalleg_ts.requirednavigationperformance_nilreason,
    procedure.arrivalleg_ts.speedlimit_value,
    procedure.arrivalleg_ts.speedlimit_uom,
    procedure.arrivalleg_ts.speedlimit_nilreason,
    procedure.arrivalleg_ts.length_value,
    procedure.arrivalleg_ts.length_uom,
    procedure.arrivalleg_ts.length_nilreason,
    procedure.arrivalleg_ts.duration_value,
    procedure.arrivalleg_ts.duration_uom,
    procedure.arrivalleg_ts.duration_nilreason,
    procedure.arrivalleg_ts.upperlimitaltitude_value,
    procedure.arrivalleg_ts.upperlimitaltitude_uom,
    procedure.arrivalleg_ts.upperlimitaltitude_nilreason,
    procedure.arrivalleg_ts.lowerlimitaltitude_value,
    procedure.arrivalleg_ts.lowerlimitaltitude_uom,
    procedure.arrivalleg_ts.lowerlimitaltitude_nilreason,
    procedure.arrivalleg_ts.altitudeoverrideatc_value,
    procedure.arrivalleg_ts.altitudeoverrideatc_uom,
    procedure.arrivalleg_ts.altitudeoverrideatc_nilreason,
    navaids_points_terminalsegmentpoint_pt_irzmyd.title,
    navaids_points_terminalsegmentpoint_pt_irzmyd.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_irzmyd.href,
    navaids_points_terminalsegmentpoint_pt_qkdmsh.title,
    navaids_points_terminalsegmentpoint_pt_qkdmsh.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_qkdmsh.href,
    geometry_curve_view_lsciue.geom,
    navaids_points_terminalsegmentpoint_pt_kmizhp.title,
    navaids_points_terminalsegmentpoint_pt_kmizhp.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_kmizhp.href,
    navaids_points_angleindication_pt_ztdckr.title,
    navaids_points_angleindication_pt_ztdckr.nilreason[1],
    navaids_points_angleindication_pt_ztdckr.href,
    navaids_points_distanceindication_pt_wnfpfh.title,
    navaids_points_distanceindication_pt_wnfpfh.nilreason[1],
    navaids_points_distanceindication_pt_wnfpfh.href,
    procedure_holdinguse_pt_fipjze.title,
    procedure_holdinguse_pt_fipjze.nilreason[1],
    procedure_holdinguse_pt_fipjze.href,
    procedure_standardinstrumentarrival_pt_yokicz.title,
    procedure_standardinstrumentarrival_pt_yokicz.nilreason[1],
    procedure_standardinstrumentarrival_pt_yokicz.href
order by arrivalleg.identifier, arrivalleg_ts.sequence_number, arrivalleg_ts.correction_number DESC;
-- AuthorityForAirspaceTimeSliceType
-- ['notes.note_view']
create or replace view airspace.authorityforairspace_view as
select distinct on (authorityforairspace.identifier,authorityforairspace_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airspace.authorityforairspace.id,
    airspace.authorityforairspace_ts.id as ts_id,
    airspace.authorityforairspace_tsp.id as tsp_id,
    airspace.authorityforairspace.identifier,
    airspace.authorityforairspace_ts.interpretation,
    airspace.authorityforairspace_ts.sequence_number,
    airspace.authorityforairspace_ts.correction_number,
    airspace.authorityforairspace_ts.valid_time_begin,
    airspace.authorityforairspace_ts.valid_time_end,
    airspace.authorityforairspace_ts.feature_lifetime_begin,
    airspace.authorityforairspace_ts.feature_lifetime_end,
    coalesce(cast(airspace.authorityforairspace_ts.type_value as varchar), '(' || airspace.authorityforairspace_ts.type_nilreason || ')') as type,
    coalesce(cast(organisation_organisationauthority_pt_fgckau.title as varchar), '(' || organisation_organisationauthority_pt_fgckau.nilreason[1] || ')') AS responsibleorganisation,
    organisation_organisationauthority_pt_fgckau.href AS responsibleorganisation_href,
    coalesce(cast(airspace_airspace_pt_yokbbl.title as varchar), '(' || airspace_airspace_pt_yokbbl.nilreason[1] || ')') AS assignedairspace,
    airspace_airspace_pt_yokbbl.href AS assignedairspace_href,
    jsonb_agg(notes_note_view_hynncf.*) AS authorityforairspace_annotation
from airspace.authorityforairspace 
inner join master_join mj2 on airspace.authorityforairspace.id = mj2.source_id
inner join airspace.authorityforairspace_tsp on mj2.target_id = airspace.authorityforairspace_tsp.id
inner join airspace.authorityforairspace_ts on airspace.authorityforairspace_tsp.authorityforairspacetimeslice_id = airspace.authorityforairspace_ts.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_fgckau on airspace.authorityforairspace_ts.responsibleorganisation_id = organisation_organisationauthority_pt_fgckau.id
left join airspace.airspace_pt airspace_airspace_pt_yokbbl on airspace.authorityforairspace_ts.assignedairspace_id = airspace_airspace_pt_yokbbl.id
left join master_join master_join_ievpfg on airspace.authorityforairspace_ts.id = master_join_ievpfg.source_id
left join notes.note_view notes_note_view_hynncf on master_join_ievpfg.target_id = notes_note_view_hynncf.id
where airspace.authorityforairspace.feature_status = 'APPROVED'
  and airspace.authorityforairspace_ts.feature_status = 'APPROVED'
group by
    airspace.authorityforairspace.id,
    airspace.authorityforairspace_ts.id,
    airspace.authorityforairspace_tsp.id,
    airspace.authorityforairspace.identifier,
    airspace.authorityforairspace_ts.interpretation,
    airspace.authorityforairspace_ts.sequence_number,
    airspace.authorityforairspace_ts.correction_number,
    airspace.authorityforairspace_ts.valid_time_begin,
    airspace.authorityforairspace_ts.valid_time_end,
    airspace.authorityforairspace_ts.feature_lifetime_begin,
    airspace.authorityforairspace_ts.feature_lifetime_end,
    airspace.authorityforairspace_ts.type_value,
    airspace.authorityforairspace_ts.type_nilreason,
    organisation_organisationauthority_pt_fgckau.title,
    organisation_organisationauthority_pt_fgckau.nilreason[1],
    organisation_organisationauthority_pt_fgckau.href,
    airspace_airspace_pt_yokbbl.title,
    airspace_airspace_pt_yokbbl.nilreason[1],
    airspace_airspace_pt_yokbbl.href
order by authorityforairspace.identifier, authorityforairspace_ts.sequence_number, authorityforairspace_ts.correction_number DESC;
-- AzimuthTimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.azimuth_view as
select distinct on (azimuth.identifier,azimuth_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.azimuth.id,
    navaids_points.azimuth_ts.id as ts_id,
    navaids_points.azimuth_tsp.id as tsp_id,
    navaids_points.azimuth.identifier,
    navaids_points.azimuth_ts.interpretation,
    navaids_points.azimuth_ts.sequence_number,
    navaids_points.azimuth_ts.correction_number,
    navaids_points.azimuth_ts.valid_time_begin,
    navaids_points.azimuth_ts.valid_time_end,
    navaids_points.azimuth_ts.feature_lifetime_begin,
    navaids_points.azimuth_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.azimuth_ts.designator_value as varchar), '(' || navaids_points.azimuth_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.azimuth_ts.name_value as varchar), '(' || navaids_points.azimuth_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.azimuth_ts.emissionclass_value as varchar), '(' || navaids_points.azimuth_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.azimuth_ts.mobile_value as varchar), '(' || navaids_points.azimuth_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.azimuth_ts.magneticvariation_value as varchar), '(' || navaids_points.azimuth_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.azimuth_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.azimuth_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.azimuth_ts.datemagneticvariation_value as varchar), '(' || navaids_points.azimuth_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.azimuth_ts.flightchecked_value as varchar), '(' || navaids_points.azimuth_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.azimuth_ts.type_value as varchar), '(' || navaids_points.azimuth_ts.type_nilreason || ')') as type,
    coalesce(cast(navaids_points.azimuth_ts.truebearing_value as varchar), '(' || navaids_points.azimuth_ts.truebearing_nilreason || ')') as truebearing,
    coalesce(cast(navaids_points.azimuth_ts.truebearingaccuracy_value as varchar), '(' || navaids_points.azimuth_ts.truebearingaccuracy_nilreason || ')') as truebearingaccuracy,
    coalesce(cast(navaids_points.azimuth_ts.magneticbearing_value as varchar), '(' || navaids_points.azimuth_ts.magneticbearing_nilreason || ')') as magneticbearing,
    coalesce(cast(navaids_points.azimuth_ts.angleproportionalleft_value as varchar), '(' || navaids_points.azimuth_ts.angleproportionalleft_nilreason || ')') as angleproportionalleft,
    coalesce(cast(navaids_points.azimuth_ts.angleproportionalright_value as varchar), '(' || navaids_points.azimuth_ts.angleproportionalright_nilreason || ')') as angleproportionalright,
    coalesce(cast(navaids_points.azimuth_ts.anglecoverleft_value as varchar), '(' || navaids_points.azimuth_ts.anglecoverleft_nilreason || ')') as anglecoverleft,
    coalesce(cast(navaids_points.azimuth_ts.anglecoverright_value as varchar), '(' || navaids_points.azimuth_ts.anglecoverright_nilreason || ')') as anglecoverright,
    coalesce(cast(navaids_points.azimuth_ts.channel_value as varchar), '(' || navaids_points.azimuth_ts.channel_nilreason || ')') as channel,
    geometry_elevatedpoint_view_xnfies.geom AS geom,
    ST_X(geometry_elevatedpoint_view_xnfies.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_xnfies.geom) AS latitude,
    geometry_elevatedpoint_view_xnfies.elevation,
    geometry_elevatedpoint_view_xnfies.geoidUndulation,
    geometry_elevatedpoint_view_xnfies.verticalDatum,
    geometry_elevatedpoint_view_xnfies.verticalAccuracy,
    geometry_elevatedpoint_view_xnfies.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_bijrzf.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_cqsrha.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_cykhud.id) AS availability,
    jsonb_agg(notes_note_view_wovvkg.*) AS azimuth_annotation
from navaids_points.azimuth 
inner join master_join mj2 on navaids_points.azimuth.id = mj2.source_id
inner join navaids_points.azimuth_tsp on mj2.target_id = navaids_points.azimuth_tsp.id
inner join navaids_points.azimuth_ts on navaids_points.azimuth_tsp.azimuthtimeslice_id = navaids_points.azimuth_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_xnfies on navaids_points.azimuth_ts.location_id = geometry_elevatedpoint_view_xnfies.id
left join master_join master_join_aybynn on navaids_points.azimuth_ts.id = master_join_aybynn.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_bijrzf on master_join_aybynn.target_id = navaids_points_authorityfornavaidequipment_view_bijrzf.id
left join master_join master_join_lngjmy on navaids_points.azimuth_ts.id = master_join_lngjmy.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_cqsrha on master_join_lngjmy.target_id = navaids_points_navaidequipmentmonitoring_view_cqsrha.id
left join master_join master_join_ovorbg on navaids_points.azimuth_ts.id = master_join_ovorbg.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_cykhud on master_join_ovorbg.target_id = navaids_points_navaidoperationalstatus_view_cykhud.id
left join master_join master_join_sgosdv on navaids_points.azimuth_ts.id = master_join_sgosdv.source_id
left join notes.note_view notes_note_view_wovvkg on master_join_sgosdv.target_id = notes_note_view_wovvkg.id
where navaids_points.azimuth.feature_status = 'APPROVED'
  and navaids_points.azimuth_ts.feature_status = 'APPROVED'
group by
    navaids_points.azimuth.id,
    navaids_points.azimuth_ts.id,
    navaids_points.azimuth_tsp.id,
    navaids_points.azimuth.identifier,
    navaids_points.azimuth_ts.interpretation,
    navaids_points.azimuth_ts.sequence_number,
    navaids_points.azimuth_ts.correction_number,
    navaids_points.azimuth_ts.valid_time_begin,
    navaids_points.azimuth_ts.valid_time_end,
    navaids_points.azimuth_ts.feature_lifetime_begin,
    navaids_points.azimuth_ts.feature_lifetime_end,
    navaids_points.azimuth_ts.designator_value,
    navaids_points.azimuth_ts.designator_nilreason,
    navaids_points.azimuth_ts.name_value,
    navaids_points.azimuth_ts.name_nilreason,
    navaids_points.azimuth_ts.emissionclass_value,
    navaids_points.azimuth_ts.emissionclass_nilreason,
    navaids_points.azimuth_ts.mobile_value,
    navaids_points.azimuth_ts.mobile_nilreason,
    navaids_points.azimuth_ts.magneticvariation_value,
    navaids_points.azimuth_ts.magneticvariation_nilreason,
    navaids_points.azimuth_ts.magneticvariationaccuracy_value,
    navaids_points.azimuth_ts.magneticvariationaccuracy_nilreason,
    navaids_points.azimuth_ts.datemagneticvariation_value,
    navaids_points.azimuth_ts.datemagneticvariation_nilreason,
    navaids_points.azimuth_ts.flightchecked_value,
    navaids_points.azimuth_ts.flightchecked_nilreason,
    navaids_points.azimuth_ts.type_value,
    navaids_points.azimuth_ts.type_nilreason,
    navaids_points.azimuth_ts.truebearing_value,
    navaids_points.azimuth_ts.truebearing_nilreason,
    navaids_points.azimuth_ts.truebearingaccuracy_value,
    navaids_points.azimuth_ts.truebearingaccuracy_nilreason,
    navaids_points.azimuth_ts.magneticbearing_value,
    navaids_points.azimuth_ts.magneticbearing_nilreason,
    navaids_points.azimuth_ts.angleproportionalleft_value,
    navaids_points.azimuth_ts.angleproportionalleft_nilreason,
    navaids_points.azimuth_ts.angleproportionalright_value,
    navaids_points.azimuth_ts.angleproportionalright_nilreason,
    navaids_points.azimuth_ts.anglecoverleft_value,
    navaids_points.azimuth_ts.anglecoverleft_nilreason,
    navaids_points.azimuth_ts.anglecoverright_value,
    navaids_points.azimuth_ts.anglecoverright_nilreason,
    navaids_points.azimuth_ts.channel_value,
    navaids_points.azimuth_ts.channel_nilreason,
    geometry_elevatedpoint_view_xnfies.geom,
    geometry_elevatedpoint_view_xnfies.elevation,
    geometry_elevatedpoint_view_xnfies.geoidUndulation,
    geometry_elevatedpoint_view_xnfies.verticalDatum,
    geometry_elevatedpoint_view_xnfies.verticalAccuracy,
    geometry_elevatedpoint_view_xnfies.horizontalAccuracy
order by azimuth.identifier, azimuth_ts.sequence_number, azimuth_ts.correction_number DESC;
-- ChangeOverPointTimeSliceType
-- ['geometry.point_view', 'notes.note_view']
create or replace view routes.changeoverpoint_view as
select distinct on (changeoverpoint.identifier,changeoverpoint_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    routes.changeoverpoint.id,
    routes.changeoverpoint_ts.id as ts_id,
    routes.changeoverpoint_tsp.id as tsp_id,
    routes.changeoverpoint.identifier,
    routes.changeoverpoint_ts.interpretation,
    routes.changeoverpoint_ts.sequence_number,
    routes.changeoverpoint_ts.correction_number,
    routes.changeoverpoint_ts.valid_time_begin,
    routes.changeoverpoint_ts.valid_time_end,
    routes.changeoverpoint_ts.feature_lifetime_begin,
    routes.changeoverpoint_ts.feature_lifetime_end,
    coalesce(cast(routes.changeoverpoint_ts.distance_value as varchar) || ' ' || routes.changeoverpoint_ts.distance_uom, '(' || routes.changeoverpoint_ts.distance_nilreason || ')') as distance,
    coalesce(cast(navaids_points_designatedpoint_pt_ajiexr.title as varchar), '(' || navaids_points_designatedpoint_pt_ajiexr.nilreason[1] || ')') AS locationfixdesignatedpoint,
    navaids_points_designatedpoint_pt_ajiexr.href AS locationfixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_ohfzrx.title as varchar), '(' || navaids_points_navaid_pt_ohfzrx.nilreason[1] || ')') AS locationnavaidsystem,
    navaids_points_navaid_pt_ohfzrx.href AS locationnavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_klnieg.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_klnieg.nilreason[1] || ')') AS locationaimingpoint,
    airport_heliport_touchdownliftoff_pt_klnieg.href AS locationaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_vqlruo.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_vqlruo.nilreason[1] || ')') AS locationrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_vqlruo.href AS locationrunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_pebbsu.title as varchar), '(' || airport_heliport_airportheliport_pt_pebbsu.nilreason[1] || ')') AS locationairportreferencepoint,
    airport_heliport_airportheliport_pt_pebbsu.href AS locationairportreferencepoint_href,
    geometry_point_view_ihqcxv.geom AS geom,
    ST_X(geometry_point_view_ihqcxv.geom) AS longitude,
    ST_Y(geometry_point_view_ihqcxv.geom) AS latitude,
    geometry_point_view_ihqcxv.horizontalAccuracy,
    coalesce(cast(routes_routeportion_pt_onkvnv.title as varchar), '(' || routes_routeportion_pt_onkvnv.nilreason[1] || ')') AS applicablerouteportion,
    routes_routeportion_pt_onkvnv.href AS applicablerouteportion_href,
    jsonb_agg(notes_note_view_oczymm.*) AS changeoverpoint_annotation
from routes.changeoverpoint 
inner join master_join mj2 on routes.changeoverpoint.id = mj2.source_id
inner join routes.changeoverpoint_tsp on mj2.target_id = routes.changeoverpoint_tsp.id
inner join routes.changeoverpoint_ts on routes.changeoverpoint_tsp.changeoverpointtimeslice_id = routes.changeoverpoint_ts.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_ajiexr on routes.changeoverpoint_ts.location_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_ajiexr.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_ohfzrx on routes.changeoverpoint_ts.location_navaidsystem_id = navaids_points_navaid_pt_ohfzrx.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_klnieg on routes.changeoverpoint_ts.location_aimingpoint_id = airport_heliport_touchdownliftoff_pt_klnieg.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_vqlruo on routes.changeoverpoint_ts.location_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_vqlruo.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_pebbsu on routes.changeoverpoint_ts.location_airportreferencepoint_id = airport_heliport_airportheliport_pt_pebbsu.id
left join geometry.point_view geometry_point_view_ihqcxv on routes.changeoverpoint_ts.location_position_id = geometry_point_view_ihqcxv.id
left join routes.routeportion_pt routes_routeportion_pt_onkvnv on routes.changeoverpoint_ts.applicablerouteportion_id = routes_routeportion_pt_onkvnv.id
left join master_join master_join_cfstga on routes.changeoverpoint_ts.id = master_join_cfstga.source_id
left join notes.note_view notes_note_view_oczymm on master_join_cfstga.target_id = notes_note_view_oczymm.id
where routes.changeoverpoint.feature_status = 'APPROVED'
  and routes.changeoverpoint_ts.feature_status = 'APPROVED'
group by
    routes.changeoverpoint.id,
    routes.changeoverpoint_ts.id,
    routes.changeoverpoint_tsp.id,
    routes.changeoverpoint.identifier,
    routes.changeoverpoint_ts.interpretation,
    routes.changeoverpoint_ts.sequence_number,
    routes.changeoverpoint_ts.correction_number,
    routes.changeoverpoint_ts.valid_time_begin,
    routes.changeoverpoint_ts.valid_time_end,
    routes.changeoverpoint_ts.feature_lifetime_begin,
    routes.changeoverpoint_ts.feature_lifetime_end,
    routes.changeoverpoint_ts.distance_value,
    routes.changeoverpoint_ts.distance_uom,
    routes.changeoverpoint_ts.distance_nilreason,
    navaids_points_designatedpoint_pt_ajiexr.title,
    navaids_points_designatedpoint_pt_ajiexr.nilreason[1],
    navaids_points_designatedpoint_pt_ajiexr.href,
    navaids_points_navaid_pt_ohfzrx.title,
    navaids_points_navaid_pt_ohfzrx.nilreason[1],
    navaids_points_navaid_pt_ohfzrx.href,
    airport_heliport_touchdownliftoff_pt_klnieg.title,
    airport_heliport_touchdownliftoff_pt_klnieg.nilreason[1],
    airport_heliport_touchdownliftoff_pt_klnieg.href,
    airport_heliport_runwaycentrelinepoint_pt_vqlruo.title,
    airport_heliport_runwaycentrelinepoint_pt_vqlruo.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_vqlruo.href,
    airport_heliport_airportheliport_pt_pebbsu.title,
    airport_heliport_airportheliport_pt_pebbsu.nilreason[1],
    airport_heliport_airportheliport_pt_pebbsu.href,
    geometry_point_view_ihqcxv.geom,
    geometry_point_view_ihqcxv.horizontalAccuracy,
    routes_routeportion_pt_onkvnv.title,
    routes_routeportion_pt_onkvnv.nilreason[1],
    routes_routeportion_pt_onkvnv.href
order by changeoverpoint.identifier, changeoverpoint_ts.sequence_number, changeoverpoint_ts.correction_number DESC;
-- CheckpointINSTimeSliceType
-- ['notes.note_view', 'geometry.elevatedpoint_view']
create or replace view navaids_points.checkpointins_view as
select distinct on (checkpointins.identifier,checkpointins_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.checkpointins.id,
    navaids_points.checkpointins_ts.id as ts_id,
    navaids_points.checkpointins_tsp.id as tsp_id,
    navaids_points.checkpointins.identifier,
    navaids_points.checkpointins_ts.interpretation,
    navaids_points.checkpointins_ts.sequence_number,
    navaids_points.checkpointins_ts.correction_number,
    navaids_points.checkpointins_ts.valid_time_begin,
    navaids_points.checkpointins_ts.valid_time_end,
    navaids_points.checkpointins_ts.feature_lifetime_begin,
    navaids_points.checkpointins_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.checkpointins_ts.category_value as varchar), '(' || navaids_points.checkpointins_ts.category_nilreason || ')') as category,
    coalesce(cast(navaids_points.checkpointins_ts.upperlimitreference_value as varchar), '(' || navaids_points.checkpointins_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(navaids_points.checkpointins_ts.lowerlimitreference_value as varchar), '(' || navaids_points.checkpointins_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(navaids_points.checkpointins_ts.altitudeinterpretation_value as varchar), '(' || navaids_points.checkpointins_ts.altitudeinterpretation_nilreason || ')') as altitudeinterpretation,
    coalesce(cast(navaids_points.checkpointins_ts.angle_value as varchar), '(' || navaids_points.checkpointins_ts.angle_nilreason || ')') as angle,
    coalesce(cast(navaids_points.checkpointins_ts.upperlimit_value as varchar) || ' ' || navaids_points.checkpointins_ts.upperlimit_uom, '(' || navaids_points.checkpointins_ts.upperlimit_nilreason || ')') as upperlimit,
    coalesce(cast(navaids_points.checkpointins_ts.lowerlimit_value as varchar) || ' ' || navaids_points.checkpointins_ts.lowerlimit_uom, '(' || navaids_points.checkpointins_ts.lowerlimit_nilreason || ')') as lowerlimit,
    coalesce(cast(navaids_points.checkpointins_ts.distance_value as varchar) || ' ' || navaids_points.checkpointins_ts.distance_uom, '(' || navaids_points.checkpointins_ts.distance_nilreason || ')') as distance,
    geometry_elevatedpoint_view_rpidvz.geom AS geom,
    ST_X(geometry_elevatedpoint_view_rpidvz.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_rpidvz.geom) AS latitude,
    geometry_elevatedpoint_view_rpidvz.elevation,
    geometry_elevatedpoint_view_rpidvz.geoidUndulation,
    geometry_elevatedpoint_view_rpidvz.verticalDatum,
    geometry_elevatedpoint_view_rpidvz.verticalAccuracy,
    geometry_elevatedpoint_view_rpidvz.horizontalAccuracy,
    coalesce(cast(airport_heliport_airportheliport_pt_tpvsml.title as varchar), '(' || airport_heliport_airportheliport_pt_tpvsml.nilreason[1] || ')') AS airportheliport,
    airport_heliport_airportheliport_pt_tpvsml.href AS airportheliport_href,
    jsonb_agg(notes_note_view_jwrwkg.*) AS checkpointins_annotation
from navaids_points.checkpointins 
inner join master_join mj2 on navaids_points.checkpointins.id = mj2.source_id
inner join navaids_points.checkpointins_tsp on mj2.target_id = navaids_points.checkpointins_tsp.id
inner join navaids_points.checkpointins_ts on navaids_points.checkpointins_tsp.checkpointinstimeslice_id = navaids_points.checkpointins_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_rpidvz on navaids_points.checkpointins_ts.position_id = geometry_elevatedpoint_view_rpidvz.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_tpvsml on navaids_points.checkpointins_ts.airportheliport_id = airport_heliport_airportheliport_pt_tpvsml.id
left join master_join master_join_ycshfd on navaids_points.checkpointins_ts.id = master_join_ycshfd.source_id
left join notes.note_view notes_note_view_jwrwkg on master_join_ycshfd.target_id = notes_note_view_jwrwkg.id
where navaids_points.checkpointins.feature_status = 'APPROVED'
  and navaids_points.checkpointins_ts.feature_status = 'APPROVED'
group by
    navaids_points.checkpointins.id,
    navaids_points.checkpointins_ts.id,
    navaids_points.checkpointins_tsp.id,
    navaids_points.checkpointins.identifier,
    navaids_points.checkpointins_ts.interpretation,
    navaids_points.checkpointins_ts.sequence_number,
    navaids_points.checkpointins_ts.correction_number,
    navaids_points.checkpointins_ts.valid_time_begin,
    navaids_points.checkpointins_ts.valid_time_end,
    navaids_points.checkpointins_ts.feature_lifetime_begin,
    navaids_points.checkpointins_ts.feature_lifetime_end,
    navaids_points.checkpointins_ts.category_value,
    navaids_points.checkpointins_ts.category_nilreason,
    navaids_points.checkpointins_ts.upperlimitreference_value,
    navaids_points.checkpointins_ts.upperlimitreference_nilreason,
    navaids_points.checkpointins_ts.lowerlimitreference_value,
    navaids_points.checkpointins_ts.lowerlimitreference_nilreason,
    navaids_points.checkpointins_ts.altitudeinterpretation_value,
    navaids_points.checkpointins_ts.altitudeinterpretation_nilreason,
    navaids_points.checkpointins_ts.angle_value,
    navaids_points.checkpointins_ts.angle_nilreason,
    navaids_points.checkpointins_ts.upperlimit_value,
    navaids_points.checkpointins_ts.upperlimit_uom,
    navaids_points.checkpointins_ts.upperlimit_nilreason,
    navaids_points.checkpointins_ts.lowerlimit_value,
    navaids_points.checkpointins_ts.lowerlimit_uom,
    navaids_points.checkpointins_ts.lowerlimit_nilreason,
    navaids_points.checkpointins_ts.distance_value,
    navaids_points.checkpointins_ts.distance_uom,
    navaids_points.checkpointins_ts.distance_nilreason,
    geometry_elevatedpoint_view_rpidvz.geom,
    geometry_elevatedpoint_view_rpidvz.elevation,
    geometry_elevatedpoint_view_rpidvz.geoidUndulation,
    geometry_elevatedpoint_view_rpidvz.verticalDatum,
    geometry_elevatedpoint_view_rpidvz.verticalAccuracy,
    geometry_elevatedpoint_view_rpidvz.horizontalAccuracy,
    airport_heliport_airportheliport_pt_tpvsml.title,
    airport_heliport_airportheliport_pt_tpvsml.nilreason[1],
    airport_heliport_airportheliport_pt_tpvsml.href
order by checkpointins.identifier, checkpointins_ts.sequence_number, checkpointins_ts.correction_number DESC;
-- CheckpointVORTimeSliceType
-- ['notes.note_view', 'geometry.elevatedpoint_view']
create or replace view navaids_points.checkpointvor_view as
select distinct on (checkpointvor.identifier,checkpointvor_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.checkpointvor.id,
    navaids_points.checkpointvor_ts.id as ts_id,
    navaids_points.checkpointvor_tsp.id as tsp_id,
    navaids_points.checkpointvor.identifier,
    navaids_points.checkpointvor_ts.interpretation,
    navaids_points.checkpointvor_ts.sequence_number,
    navaids_points.checkpointvor_ts.correction_number,
    navaids_points.checkpointvor_ts.valid_time_begin,
    navaids_points.checkpointvor_ts.valid_time_end,
    navaids_points.checkpointvor_ts.feature_lifetime_begin,
    navaids_points.checkpointvor_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.checkpointvor_ts.category_value as varchar), '(' || navaids_points.checkpointvor_ts.category_nilreason || ')') as category,
    coalesce(cast(navaids_points.checkpointvor_ts.upperlimitreference_value as varchar), '(' || navaids_points.checkpointvor_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(navaids_points.checkpointvor_ts.lowerlimitreference_value as varchar), '(' || navaids_points.checkpointvor_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(navaids_points.checkpointvor_ts.altitudeinterpretation_value as varchar), '(' || navaids_points.checkpointvor_ts.altitudeinterpretation_nilreason || ')') as altitudeinterpretation,
    coalesce(cast(navaids_points.checkpointvor_ts.angle_value as varchar), '(' || navaids_points.checkpointvor_ts.angle_nilreason || ')') as angle,
    coalesce(cast(navaids_points.checkpointvor_ts.upperlimit_value as varchar) || ' ' || navaids_points.checkpointvor_ts.upperlimit_uom, '(' || navaids_points.checkpointvor_ts.upperlimit_nilreason || ')') as upperlimit,
    coalesce(cast(navaids_points.checkpointvor_ts.lowerlimit_value as varchar) || ' ' || navaids_points.checkpointvor_ts.lowerlimit_uom, '(' || navaids_points.checkpointvor_ts.lowerlimit_nilreason || ')') as lowerlimit,
    coalesce(cast(navaids_points.checkpointvor_ts.distance_value as varchar) || ' ' || navaids_points.checkpointvor_ts.distance_uom, '(' || navaids_points.checkpointvor_ts.distance_nilreason || ')') as distance,
    geometry_elevatedpoint_view_elktfr.geom AS geom,
    ST_X(geometry_elevatedpoint_view_elktfr.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_elktfr.geom) AS latitude,
    geometry_elevatedpoint_view_elktfr.elevation,
    geometry_elevatedpoint_view_elktfr.geoidUndulation,
    geometry_elevatedpoint_view_elktfr.verticalDatum,
    geometry_elevatedpoint_view_elktfr.verticalAccuracy,
    geometry_elevatedpoint_view_elktfr.horizontalAccuracy,
    coalesce(cast(airport_heliport_airportheliport_pt_mffjqb.title as varchar), '(' || airport_heliport_airportheliport_pt_mffjqb.nilreason[1] || ')') AS airportheliport,
    airport_heliport_airportheliport_pt_mffjqb.href AS airportheliport_href,
    coalesce(cast(navaids_points_vor_pt_uqqopz.title as varchar), '(' || navaids_points_vor_pt_uqqopz.nilreason[1] || ')') AS checkpointfacility,
    navaids_points_vor_pt_uqqopz.href AS checkpointfacility_href,
    jsonb_agg(notes_note_view_pmviyh.*) AS checkpointvor_annotation
from navaids_points.checkpointvor 
inner join master_join mj2 on navaids_points.checkpointvor.id = mj2.source_id
inner join navaids_points.checkpointvor_tsp on mj2.target_id = navaids_points.checkpointvor_tsp.id
inner join navaids_points.checkpointvor_ts on navaids_points.checkpointvor_tsp.checkpointvortimeslice_id = navaids_points.checkpointvor_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_elktfr on navaids_points.checkpointvor_ts.position_id = geometry_elevatedpoint_view_elktfr.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_mffjqb on navaids_points.checkpointvor_ts.airportheliport_id = airport_heliport_airportheliport_pt_mffjqb.id
left join navaids_points.vor_pt navaids_points_vor_pt_uqqopz on navaids_points.checkpointvor_ts.checkpointfacility_id = navaids_points_vor_pt_uqqopz.id
left join master_join master_join_deaqsl on navaids_points.checkpointvor_ts.id = master_join_deaqsl.source_id
left join notes.note_view notes_note_view_pmviyh on master_join_deaqsl.target_id = notes_note_view_pmviyh.id
where navaids_points.checkpointvor.feature_status = 'APPROVED'
  and navaids_points.checkpointvor_ts.feature_status = 'APPROVED'
group by
    navaids_points.checkpointvor.id,
    navaids_points.checkpointvor_ts.id,
    navaids_points.checkpointvor_tsp.id,
    navaids_points.checkpointvor.identifier,
    navaids_points.checkpointvor_ts.interpretation,
    navaids_points.checkpointvor_ts.sequence_number,
    navaids_points.checkpointvor_ts.correction_number,
    navaids_points.checkpointvor_ts.valid_time_begin,
    navaids_points.checkpointvor_ts.valid_time_end,
    navaids_points.checkpointvor_ts.feature_lifetime_begin,
    navaids_points.checkpointvor_ts.feature_lifetime_end,
    navaids_points.checkpointvor_ts.category_value,
    navaids_points.checkpointvor_ts.category_nilreason,
    navaids_points.checkpointvor_ts.upperlimitreference_value,
    navaids_points.checkpointvor_ts.upperlimitreference_nilreason,
    navaids_points.checkpointvor_ts.lowerlimitreference_value,
    navaids_points.checkpointvor_ts.lowerlimitreference_nilreason,
    navaids_points.checkpointvor_ts.altitudeinterpretation_value,
    navaids_points.checkpointvor_ts.altitudeinterpretation_nilreason,
    navaids_points.checkpointvor_ts.angle_value,
    navaids_points.checkpointvor_ts.angle_nilreason,
    navaids_points.checkpointvor_ts.upperlimit_value,
    navaids_points.checkpointvor_ts.upperlimit_uom,
    navaids_points.checkpointvor_ts.upperlimit_nilreason,
    navaids_points.checkpointvor_ts.lowerlimit_value,
    navaids_points.checkpointvor_ts.lowerlimit_uom,
    navaids_points.checkpointvor_ts.lowerlimit_nilreason,
    navaids_points.checkpointvor_ts.distance_value,
    navaids_points.checkpointvor_ts.distance_uom,
    navaids_points.checkpointvor_ts.distance_nilreason,
    geometry_elevatedpoint_view_elktfr.geom,
    geometry_elevatedpoint_view_elktfr.elevation,
    geometry_elevatedpoint_view_elktfr.geoidUndulation,
    geometry_elevatedpoint_view_elktfr.verticalDatum,
    geometry_elevatedpoint_view_elktfr.verticalAccuracy,
    geometry_elevatedpoint_view_elktfr.horizontalAccuracy,
    airport_heliport_airportheliport_pt_mffjqb.title,
    airport_heliport_airportheliport_pt_mffjqb.nilreason[1],
    airport_heliport_airportheliport_pt_mffjqb.href,
    navaids_points_vor_pt_uqqopz.title,
    navaids_points_vor_pt_uqqopz.nilreason[1],
    navaids_points_vor_pt_uqqopz.href
order by checkpointvor.identifier, checkpointvor_ts.sequence_number, checkpointvor_ts.correction_number DESC;
-- CirclingAreaTimeSliceType
-- ['shared.obstacleassessmentarea_view', 'geometry.surface_view', 'notes.note_view', 'procedure.approachcondition_view']
create or replace view public.circlingarea_view as
select distinct on (circlingarea.identifier,circlingarea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    public.circlingarea.id,
    public.circlingarea_ts.id as ts_id,
    public.circlingarea_tsp.id as tsp_id,
    public.circlingarea.identifier,
    public.circlingarea_ts.interpretation,
    public.circlingarea_ts.sequence_number,
    public.circlingarea_ts.correction_number,
    public.circlingarea_ts.valid_time_begin,
    public.circlingarea_ts.valid_time_end,
    public.circlingarea_ts.feature_lifetime_begin,
    public.circlingarea_ts.feature_lifetime_end,
    geometry_surface_view_iqoppq.geom AS geom,
    coalesce(cast(procedure_instrumentapproachprocedure_pt_sjbfzx.title as varchar), '(' || procedure_instrumentapproachprocedure_pt_sjbfzx.nilreason[1] || ')') AS approach,
    procedure_instrumentapproachprocedure_pt_sjbfzx.href AS approach_href,
    coalesce(cast(shared_aircraftcharacteristic_pt_zzpymv.title as varchar), '(' || shared_aircraftcharacteristic_pt_zzpymv.nilreason[1] || ')') AS aircraftcategory,
    shared_aircraftcharacteristic_pt_zzpymv.href AS aircraftcategory_href,
    jsonb_agg(procedure_approachcondition_view_btjsns.id) AS condition,
    jsonb_agg(shared_obstacleassessmentarea_view_mvyvmp.id) AS designsurface,
    jsonb_agg(notes_note_view_mcldoz.*) AS circlingarea_annotation
from public.circlingarea 
inner join master_join mj2 on public.circlingarea.id = mj2.source_id
inner join public.circlingarea_tsp on mj2.target_id = public.circlingarea_tsp.id
inner join public.circlingarea_ts on public.circlingarea_tsp.circlingareatimeslice_id = public.circlingarea_ts.id
left join geometry.surface_view geometry_surface_view_iqoppq on public.circlingarea_ts.extent_id = geometry_surface_view_iqoppq.id
left join procedure.instrumentapproachprocedure_pt procedure_instrumentapproachprocedure_pt_sjbfzx on public.circlingarea_ts.approach_id = procedure_instrumentapproachprocedure_pt_sjbfzx.id
left join shared.aircraftcharacteristic_pt shared_aircraftcharacteristic_pt_zzpymv on public.circlingarea_ts.aircraftcategory_id = shared_aircraftcharacteristic_pt_zzpymv.id
left join master_join master_join_axpzwi on public.circlingarea_ts.id = master_join_axpzwi.source_id
left join procedure.approachcondition_view procedure_approachcondition_view_btjsns on master_join_axpzwi.target_id = procedure_approachcondition_view_btjsns.id
left join master_join master_join_zxxhbu on public.circlingarea_ts.id = master_join_zxxhbu.source_id
left join shared.obstacleassessmentarea_view shared_obstacleassessmentarea_view_mvyvmp on master_join_zxxhbu.target_id = shared_obstacleassessmentarea_view_mvyvmp.id
left join master_join master_join_katnlk on public.circlingarea_ts.id = master_join_katnlk.source_id
left join notes.note_view notes_note_view_mcldoz on master_join_katnlk.target_id = notes_note_view_mcldoz.id
where public.circlingarea.feature_status = 'APPROVED'
  and public.circlingarea_ts.feature_status = 'APPROVED'
group by
    public.circlingarea.id,
    public.circlingarea_ts.id,
    public.circlingarea_tsp.id,
    public.circlingarea.identifier,
    public.circlingarea_ts.interpretation,
    public.circlingarea_ts.sequence_number,
    public.circlingarea_ts.correction_number,
    public.circlingarea_ts.valid_time_begin,
    public.circlingarea_ts.valid_time_end,
    public.circlingarea_ts.feature_lifetime_begin,
    public.circlingarea_ts.feature_lifetime_end,
    geometry_surface_view_iqoppq.geom,
    procedure_instrumentapproachprocedure_pt_sjbfzx.title,
    procedure_instrumentapproachprocedure_pt_sjbfzx.nilreason[1],
    procedure_instrumentapproachprocedure_pt_sjbfzx.href,
    shared_aircraftcharacteristic_pt_zzpymv.title,
    shared_aircraftcharacteristic_pt_zzpymv.nilreason[1],
    shared_aircraftcharacteristic_pt_zzpymv.href
order by circlingarea.identifier, circlingarea_ts.sequence_number, circlingarea_ts.correction_number DESC;
-- DeicingAreaMarkingTimeSliceType
-- ['notes.note_view', 'airport_heliport.markingelement_view']
create or replace view airport_heliport.deicingareamarking_view as
select distinct on (deicingareamarking.identifier,deicingareamarking_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.deicingareamarking.id,
    airport_heliport.deicingareamarking_ts.id as ts_id,
    airport_heliport.deicingareamarking_tsp.id as tsp_id,
    airport_heliport.deicingareamarking.identifier,
    airport_heliport.deicingareamarking_ts.interpretation,
    airport_heliport.deicingareamarking_ts.sequence_number,
    airport_heliport.deicingareamarking_ts.correction_number,
    airport_heliport.deicingareamarking_ts.valid_time_begin,
    airport_heliport.deicingareamarking_ts.valid_time_end,
    airport_heliport.deicingareamarking_ts.feature_lifetime_begin,
    airport_heliport.deicingareamarking_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.deicingareamarking_ts.markingicaostandard_value as varchar), '(' || airport_heliport.deicingareamarking_ts.markingicaostandard_nilreason || ')') as markingicaostandard,
    coalesce(cast(airport_heliport.deicingareamarking_ts.condition_value as varchar), '(' || airport_heliport.deicingareamarking_ts.condition_nilreason || ')') as condition,
    coalesce(cast(airport_heliport_deicingarea_pt_rjylwm.title as varchar), '(' || airport_heliport_deicingarea_pt_rjylwm.nilreason[1] || ')') AS markeddeicingarea,
    airport_heliport_deicingarea_pt_rjylwm.href AS markeddeicingarea_href,
    jsonb_agg(airport_heliport_markingelement_view_pcaycb.id) AS element,
    jsonb_agg(notes_note_view_glsdmm.*) AS deicingareamarking_annotation
from airport_heliport.deicingareamarking 
inner join master_join mj2 on airport_heliport.deicingareamarking.id = mj2.source_id
inner join airport_heliport.deicingareamarking_tsp on mj2.target_id = airport_heliport.deicingareamarking_tsp.id
inner join airport_heliport.deicingareamarking_ts on airport_heliport.deicingareamarking_tsp.deicingareamarkingtimeslice_id = airport_heliport.deicingareamarking_ts.id
left join airport_heliport.deicingarea_pt airport_heliport_deicingarea_pt_rjylwm on airport_heliport.deicingareamarking_ts.markeddeicingarea_id = airport_heliport_deicingarea_pt_rjylwm.id
left join master_join master_join_ltjszg on airport_heliport.deicingareamarking_ts.id = master_join_ltjszg.source_id
left join airport_heliport.markingelement_view airport_heliport_markingelement_view_pcaycb on master_join_ltjszg.target_id = airport_heliport_markingelement_view_pcaycb.id
left join master_join master_join_pudhgl on airport_heliport.deicingareamarking_ts.id = master_join_pudhgl.source_id
left join notes.note_view notes_note_view_glsdmm on master_join_pudhgl.target_id = notes_note_view_glsdmm.id
where airport_heliport.deicingareamarking.feature_status = 'APPROVED'
  and airport_heliport.deicingareamarking_ts.feature_status = 'APPROVED'
group by
    airport_heliport.deicingareamarking.id,
    airport_heliport.deicingareamarking_ts.id,
    airport_heliport.deicingareamarking_tsp.id,
    airport_heliport.deicingareamarking.identifier,
    airport_heliport.deicingareamarking_ts.interpretation,
    airport_heliport.deicingareamarking_ts.sequence_number,
    airport_heliport.deicingareamarking_ts.correction_number,
    airport_heliport.deicingareamarking_ts.valid_time_begin,
    airport_heliport.deicingareamarking_ts.valid_time_end,
    airport_heliport.deicingareamarking_ts.feature_lifetime_begin,
    airport_heliport.deicingareamarking_ts.feature_lifetime_end,
    airport_heliport.deicingareamarking_ts.markingicaostandard_value,
    airport_heliport.deicingareamarking_ts.markingicaostandard_nilreason,
    airport_heliport.deicingareamarking_ts.condition_value,
    airport_heliport.deicingareamarking_ts.condition_nilreason,
    airport_heliport_deicingarea_pt_rjylwm.title,
    airport_heliport_deicingarea_pt_rjylwm.nilreason[1],
    airport_heliport_deicingarea_pt_rjylwm.href
order by deicingareamarking.identifier, deicingareamarking_ts.sequence_number, deicingareamarking_ts.correction_number DESC;
-- DeicingAreaTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view', 'airport_heliport.apronareaavailability_view']
create or replace view airport_heliport.deicingarea_view as
select distinct on (deicingarea.identifier,deicingarea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.deicingarea.id,
    airport_heliport.deicingarea_ts.id as ts_id,
    airport_heliport.deicingarea_tsp.id as tsp_id,
    airport_heliport.deicingarea.identifier,
    airport_heliport.deicingarea_ts.interpretation,
    airport_heliport.deicingarea_ts.sequence_number,
    airport_heliport.deicingarea_ts.correction_number,
    airport_heliport.deicingarea_ts.valid_time_begin,
    airport_heliport.deicingarea_ts.valid_time_end,
    airport_heliport.deicingarea_ts.feature_lifetime_begin,
    airport_heliport.deicingarea_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport_apron_pt_dmhsdr.title as varchar), '(' || airport_heliport_apron_pt_dmhsdr.nilreason[1] || ')') AS associatedapron,
    airport_heliport_apron_pt_dmhsdr.href AS associatedapron_href,
    coalesce(cast(airport_heliport_taxiway_pt_ccmpzs.title as varchar), '(' || airport_heliport_taxiway_pt_ccmpzs.nilreason[1] || ')') AS taxiwaylocation,
    airport_heliport_taxiway_pt_ccmpzs.href AS taxiwaylocation_href,
    coalesce(cast(airport_heliport_aircraftstand_pt_mhbxlw.title as varchar), '(' || airport_heliport_aircraftstand_pt_mhbxlw.nilreason[1] || ')') AS standlocation,
    airport_heliport_aircraftstand_pt_mhbxlw.href AS standlocation_href,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_kffwfn.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_kffwfn.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_kffwfn.href AS surfaceproperties_href,
    geometry_elevatedsurface_view_cewtkw.geom AS geom,
    geometry_elevatedsurface_view_cewtkw.elevation,
    geometry_elevatedsurface_view_cewtkw.geoidUndulation,
    geometry_elevatedsurface_view_cewtkw.verticalDatum,
    geometry_elevatedsurface_view_cewtkw.verticalAccuracy,
    geometry_elevatedsurface_view_cewtkw.horizontalAccuracy,
    jsonb_agg(notes_note_view_ucgmgf.*) AS deicingarea_annotation,
    jsonb_agg(airport_heliport_apronareaavailability_view_ssjuot.id) AS availability
from airport_heliport.deicingarea 
inner join master_join mj2 on airport_heliport.deicingarea.id = mj2.source_id
inner join airport_heliport.deicingarea_tsp on mj2.target_id = airport_heliport.deicingarea_tsp.id
inner join airport_heliport.deicingarea_ts on airport_heliport.deicingarea_tsp.deicingareatimeslice_id = airport_heliport.deicingarea_ts.id
left join airport_heliport.apron_pt airport_heliport_apron_pt_dmhsdr on airport_heliport.deicingarea_ts.associatedapron_id = airport_heliport_apron_pt_dmhsdr.id
left join airport_heliport.taxiway_pt airport_heliport_taxiway_pt_ccmpzs on airport_heliport.deicingarea_ts.taxiwaylocation_id = airport_heliport_taxiway_pt_ccmpzs.id
left join airport_heliport.aircraftstand_pt airport_heliport_aircraftstand_pt_mhbxlw on airport_heliport.deicingarea_ts.standlocation_id = airport_heliport_aircraftstand_pt_mhbxlw.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_kffwfn on airport_heliport.deicingarea_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_kffwfn.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_cewtkw on airport_heliport.deicingarea_ts.extent_id = geometry_elevatedsurface_view_cewtkw.id
left join master_join master_join_kudggv on airport_heliport.deicingarea_ts.id = master_join_kudggv.source_id
left join notes.note_view notes_note_view_ucgmgf on master_join_kudggv.target_id = notes_note_view_ucgmgf.id
left join master_join master_join_numfeh on airport_heliport.deicingarea_ts.id = master_join_numfeh.source_id
left join airport_heliport.apronareaavailability_view airport_heliport_apronareaavailability_view_ssjuot on master_join_numfeh.target_id = airport_heliport_apronareaavailability_view_ssjuot.id
where airport_heliport.deicingarea.feature_status = 'APPROVED'
  and airport_heliport.deicingarea_ts.feature_status = 'APPROVED'
group by
    airport_heliport.deicingarea.id,
    airport_heliport.deicingarea_ts.id,
    airport_heliport.deicingarea_tsp.id,
    airport_heliport.deicingarea.identifier,
    airport_heliport.deicingarea_ts.interpretation,
    airport_heliport.deicingarea_ts.sequence_number,
    airport_heliport.deicingarea_ts.correction_number,
    airport_heliport.deicingarea_ts.valid_time_begin,
    airport_heliport.deicingarea_ts.valid_time_end,
    airport_heliport.deicingarea_ts.feature_lifetime_begin,
    airport_heliport.deicingarea_ts.feature_lifetime_end,
    airport_heliport_apron_pt_dmhsdr.title,
    airport_heliport_apron_pt_dmhsdr.nilreason[1],
    airport_heliport_apron_pt_dmhsdr.href,
    airport_heliport_taxiway_pt_ccmpzs.title,
    airport_heliport_taxiway_pt_ccmpzs.nilreason[1],
    airport_heliport_taxiway_pt_ccmpzs.href,
    airport_heliport_aircraftstand_pt_mhbxlw.title,
    airport_heliport_aircraftstand_pt_mhbxlw.nilreason[1],
    airport_heliport_aircraftstand_pt_mhbxlw.href,
    airport_heliport_surfacecharacteristics_pt_kffwfn.title,
    airport_heliport_surfacecharacteristics_pt_kffwfn.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_kffwfn.href,
    geometry_elevatedsurface_view_cewtkw.geom,
    geometry_elevatedsurface_view_cewtkw.elevation,
    geometry_elevatedsurface_view_cewtkw.geoidUndulation,
    geometry_elevatedsurface_view_cewtkw.verticalDatum,
    geometry_elevatedsurface_view_cewtkw.verticalAccuracy,
    geometry_elevatedsurface_view_cewtkw.horizontalAccuracy
order by deicingarea.identifier, deicingarea_ts.sequence_number, deicingarea_ts.correction_number DESC;
-- DepartureLegTimeSliceType
-- ['procedure.departurearrivalcondition_view', 'notes.note_view', 'shared.aircraftcharacteristic_view', 'shared.obstacleassessmentarea_view', 'geometry.curve_view']
create or replace view procedure.departureleg_view as
select distinct on (departureleg.identifier,departureleg_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.departureleg.id,
    procedure.departureleg_ts.id as ts_id,
    procedure.departureleg_tsp.id as tsp_id,
    procedure.departureleg.identifier,
    procedure.departureleg_ts.interpretation,
    procedure.departureleg_ts.sequence_number,
    procedure.departureleg_ts.correction_number,
    procedure.departureleg_ts.valid_time_begin,
    procedure.departureleg_ts.valid_time_end,
    procedure.departureleg_ts.feature_lifetime_begin,
    procedure.departureleg_ts.feature_lifetime_end,
    coalesce(cast(procedure.departureleg_ts.endconditiondesignator_value as varchar), '(' || procedure.departureleg_ts.endconditiondesignator_nilreason || ')') as endconditiondesignator,
    coalesce(cast(procedure.departureleg_ts.legpath_value as varchar), '(' || procedure.departureleg_ts.legpath_nilreason || ')') as legpath,
    coalesce(cast(procedure.departureleg_ts.legtypearinc_value as varchar), '(' || procedure.departureleg_ts.legtypearinc_nilreason || ')') as legtypearinc,
    coalesce(cast(procedure.departureleg_ts.course_value as varchar), '(' || procedure.departureleg_ts.course_nilreason || ')') as course,
    coalesce(cast(procedure.departureleg_ts.coursetype_value as varchar), '(' || procedure.departureleg_ts.coursetype_nilreason || ')') as coursetype,
    coalesce(cast(procedure.departureleg_ts.coursedirection_value as varchar), '(' || procedure.departureleg_ts.coursedirection_nilreason || ')') as coursedirection,
    coalesce(cast(procedure.departureleg_ts.turndirection_value as varchar), '(' || procedure.departureleg_ts.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(procedure.departureleg_ts.speedreference_value as varchar), '(' || procedure.departureleg_ts.speedreference_nilreason || ')') as speedreference,
    coalesce(cast(procedure.departureleg_ts.speedinterpretation_value as varchar), '(' || procedure.departureleg_ts.speedinterpretation_nilreason || ')') as speedinterpretation,
    coalesce(cast(procedure.departureleg_ts.bankangle_value as varchar), '(' || procedure.departureleg_ts.bankangle_nilreason || ')') as bankangle,
    coalesce(cast(procedure.departureleg_ts.procedureturnrequired_value as varchar), '(' || procedure.departureleg_ts.procedureturnrequired_nilreason || ')') as procedureturnrequired,
    coalesce(cast(procedure.departureleg_ts.upperlimitreference_value as varchar), '(' || procedure.departureleg_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(procedure.departureleg_ts.lowerlimitreference_value as varchar), '(' || procedure.departureleg_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(procedure.departureleg_ts.altitudeinterpretation_value as varchar), '(' || procedure.departureleg_ts.altitudeinterpretation_nilreason || ')') as altitudeinterpretation,
    coalesce(cast(procedure.departureleg_ts.altitudeoverridereference_value as varchar), '(' || procedure.departureleg_ts.altitudeoverridereference_nilreason || ')') as altitudeoverridereference,
    coalesce(cast(procedure.departureleg_ts.verticalangle_value as varchar), '(' || procedure.departureleg_ts.verticalangle_nilreason || ')') as verticalangle,
    coalesce(cast(procedure.departureleg_ts.requirednavigationperformance_value as varchar), '(' || procedure.departureleg_ts.requirednavigationperformance_nilreason || ')') as requirednavigationperformance,
    coalesce(cast(procedure.departureleg_ts.speedlimit_value as varchar) || ' ' || procedure.departureleg_ts.speedlimit_uom, '(' || procedure.departureleg_ts.speedlimit_nilreason || ')') as speedlimit,
    coalesce(cast(procedure.departureleg_ts.length_value as varchar) || ' ' || procedure.departureleg_ts.length_uom, '(' || procedure.departureleg_ts.length_nilreason || ')') as length,
    coalesce(cast(procedure.departureleg_ts.duration_value as varchar) || ' ' || procedure.departureleg_ts.duration_uom, '(' || procedure.departureleg_ts.duration_nilreason || ')') as duration,
    coalesce(cast(procedure.departureleg_ts.upperlimitaltitude_value as varchar) || ' ' || procedure.departureleg_ts.upperlimitaltitude_uom, '(' || procedure.departureleg_ts.upperlimitaltitude_nilreason || ')') as upperlimitaltitude,
    coalesce(cast(procedure.departureleg_ts.lowerlimitaltitude_value as varchar) || ' ' || procedure.departureleg_ts.lowerlimitaltitude_uom, '(' || procedure.departureleg_ts.lowerlimitaltitude_nilreason || ')') as lowerlimitaltitude,
    coalesce(cast(procedure.departureleg_ts.altitudeoverrideatc_value as varchar) || ' ' || procedure.departureleg_ts.altitudeoverrideatc_uom, '(' || procedure.departureleg_ts.altitudeoverrideatc_nilreason || ')') as altitudeoverrideatc,
    coalesce(cast(procedure.departureleg_ts.minimumobstacleclearancealtitude_value as varchar) || ' ' || procedure.departureleg_ts.minimumobstacleclearancealtitude_uom, '(' || procedure.departureleg_ts.minimumobstacleclearancealtitude_nilreason || ')') as minimumobstacleclearancealtitude,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_eytqtj.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_eytqtj.nilreason[1] || ')') AS startpoint,
    navaids_points_terminalsegmentpoint_pt_eytqtj.href AS startpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_durbzr.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_durbzr.nilreason[1] || ')') AS endpoint,
    navaids_points_terminalsegmentpoint_pt_durbzr.href AS endpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_ekrhmv.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_ekrhmv.nilreason[1] || ')') AS arccentre,
    navaids_points_terminalsegmentpoint_pt_ekrhmv.href AS arccentre_href,
    geometry_curve_view_mxexdu.geom AS geom,
    coalesce(cast(navaids_points_angleindication_pt_rfzfsg.title as varchar), '(' || navaids_points_angleindication_pt_rfzfsg.nilreason[1] || ')') AS angle,
    navaids_points_angleindication_pt_rfzfsg.href AS angle_href,
    coalesce(cast(navaids_points_distanceindication_pt_wvmraq.title as varchar), '(' || navaids_points_distanceindication_pt_wvmraq.nilreason[1] || ')') AS distance,
    navaids_points_distanceindication_pt_wvmraq.href AS distance_href,
    coalesce(cast(procedure_holdinguse_pt_wadhse.title as varchar), '(' || procedure_holdinguse_pt_wadhse.nilreason[1] || ')') AS holding,
    procedure_holdinguse_pt_wadhse.href AS holding_href,
    coalesce(cast(procedure_standardinstrumentdeparture_pt_smrner.title as varchar), '(' || procedure_standardinstrumentdeparture_pt_smrner.nilreason[1] || ')') AS departure,
    procedure_standardinstrumentdeparture_pt_smrner.href AS departure_href,
    jsonb_agg(shared_aircraftcharacteristic_view_faungx.id) AS aircraftcategory,
    jsonb_agg(shared_obstacleassessmentarea_view_muhfdv.id) AS designsurface,
    jsonb_agg(notes_note_view_ulgpae.*) AS departureleg_annotation,
    jsonb_agg(procedure_departurearrivalcondition_view_pvtvic.id) AS condition
from procedure.departureleg 
inner join master_join mj2 on procedure.departureleg.id = mj2.source_id
inner join procedure.departureleg_tsp on mj2.target_id = procedure.departureleg_tsp.id
inner join procedure.departureleg_ts on procedure.departureleg_tsp.departurelegtimeslice_id = procedure.departureleg_ts.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_eytqtj on procedure.departureleg_ts.startpoint_id = navaids_points_terminalsegmentpoint_pt_eytqtj.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_durbzr on procedure.departureleg_ts.endpoint_id = navaids_points_terminalsegmentpoint_pt_durbzr.id
left join geometry.curve_view geometry_curve_view_mxexdu on procedure.departureleg_ts.trajectory_id = geometry_curve_view_mxexdu.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_ekrhmv on procedure.departureleg_ts.arccentre_id = navaids_points_terminalsegmentpoint_pt_ekrhmv.id
left join navaids_points.angleindication_pt navaids_points_angleindication_pt_rfzfsg on procedure.departureleg_ts.angle_id = navaids_points_angleindication_pt_rfzfsg.id
left join navaids_points.distanceindication_pt navaids_points_distanceindication_pt_wvmraq on procedure.departureleg_ts.distance_id = navaids_points_distanceindication_pt_wvmraq.id
left join procedure.holdinguse_pt procedure_holdinguse_pt_wadhse on procedure.departureleg_ts.holding_id = procedure_holdinguse_pt_wadhse.id
left join procedure.standardinstrumentdeparture_pt procedure_standardinstrumentdeparture_pt_smrner on procedure.departureleg_ts.departure_id = procedure_standardinstrumentdeparture_pt_smrner.id
left join master_join master_join_twxpxd on procedure.departureleg_ts.id = master_join_twxpxd.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_faungx on master_join_twxpxd.target_id = shared_aircraftcharacteristic_view_faungx.id
left join master_join master_join_rddpgj on procedure.departureleg_ts.id = master_join_rddpgj.source_id
left join shared.obstacleassessmentarea_view shared_obstacleassessmentarea_view_muhfdv on master_join_rddpgj.target_id = shared_obstacleassessmentarea_view_muhfdv.id
left join master_join master_join_bbdowj on procedure.departureleg_ts.id = master_join_bbdowj.source_id
left join notes.note_view notes_note_view_ulgpae on master_join_bbdowj.target_id = notes_note_view_ulgpae.id
left join master_join master_join_prbyta on procedure.departureleg_ts.id = master_join_prbyta.source_id
left join procedure.departurearrivalcondition_view procedure_departurearrivalcondition_view_pvtvic on master_join_prbyta.target_id = procedure_departurearrivalcondition_view_pvtvic.id
where procedure.departureleg.feature_status = 'APPROVED'
  and procedure.departureleg_ts.feature_status = 'APPROVED'
group by
    procedure.departureleg.id,
    procedure.departureleg_ts.id,
    procedure.departureleg_tsp.id,
    procedure.departureleg.identifier,
    procedure.departureleg_ts.interpretation,
    procedure.departureleg_ts.sequence_number,
    procedure.departureleg_ts.correction_number,
    procedure.departureleg_ts.valid_time_begin,
    procedure.departureleg_ts.valid_time_end,
    procedure.departureleg_ts.feature_lifetime_begin,
    procedure.departureleg_ts.feature_lifetime_end,
    procedure.departureleg_ts.endconditiondesignator_value,
    procedure.departureleg_ts.endconditiondesignator_nilreason,
    procedure.departureleg_ts.legpath_value,
    procedure.departureleg_ts.legpath_nilreason,
    procedure.departureleg_ts.legtypearinc_value,
    procedure.departureleg_ts.legtypearinc_nilreason,
    procedure.departureleg_ts.course_value,
    procedure.departureleg_ts.course_nilreason,
    procedure.departureleg_ts.coursetype_value,
    procedure.departureleg_ts.coursetype_nilreason,
    procedure.departureleg_ts.coursedirection_value,
    procedure.departureleg_ts.coursedirection_nilreason,
    procedure.departureleg_ts.turndirection_value,
    procedure.departureleg_ts.turndirection_nilreason,
    procedure.departureleg_ts.speedreference_value,
    procedure.departureleg_ts.speedreference_nilreason,
    procedure.departureleg_ts.speedinterpretation_value,
    procedure.departureleg_ts.speedinterpretation_nilreason,
    procedure.departureleg_ts.bankangle_value,
    procedure.departureleg_ts.bankangle_nilreason,
    procedure.departureleg_ts.procedureturnrequired_value,
    procedure.departureleg_ts.procedureturnrequired_nilreason,
    procedure.departureleg_ts.upperlimitreference_value,
    procedure.departureleg_ts.upperlimitreference_nilreason,
    procedure.departureleg_ts.lowerlimitreference_value,
    procedure.departureleg_ts.lowerlimitreference_nilreason,
    procedure.departureleg_ts.altitudeinterpretation_value,
    procedure.departureleg_ts.altitudeinterpretation_nilreason,
    procedure.departureleg_ts.altitudeoverridereference_value,
    procedure.departureleg_ts.altitudeoverridereference_nilreason,
    procedure.departureleg_ts.verticalangle_value,
    procedure.departureleg_ts.verticalangle_nilreason,
    procedure.departureleg_ts.requirednavigationperformance_value,
    procedure.departureleg_ts.requirednavigationperformance_nilreason,
    procedure.departureleg_ts.speedlimit_value,
    procedure.departureleg_ts.speedlimit_uom,
    procedure.departureleg_ts.speedlimit_nilreason,
    procedure.departureleg_ts.length_value,
    procedure.departureleg_ts.length_uom,
    procedure.departureleg_ts.length_nilreason,
    procedure.departureleg_ts.duration_value,
    procedure.departureleg_ts.duration_uom,
    procedure.departureleg_ts.duration_nilreason,
    procedure.departureleg_ts.upperlimitaltitude_value,
    procedure.departureleg_ts.upperlimitaltitude_uom,
    procedure.departureleg_ts.upperlimitaltitude_nilreason,
    procedure.departureleg_ts.lowerlimitaltitude_value,
    procedure.departureleg_ts.lowerlimitaltitude_uom,
    procedure.departureleg_ts.lowerlimitaltitude_nilreason,
    procedure.departureleg_ts.altitudeoverrideatc_value,
    procedure.departureleg_ts.altitudeoverrideatc_uom,
    procedure.departureleg_ts.altitudeoverrideatc_nilreason,
    procedure.departureleg_ts.minimumobstacleclearancealtitude_value,
    procedure.departureleg_ts.minimumobstacleclearancealtitude_uom,
    procedure.departureleg_ts.minimumobstacleclearancealtitude_nilreason,
    navaids_points_terminalsegmentpoint_pt_eytqtj.title,
    navaids_points_terminalsegmentpoint_pt_eytqtj.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_eytqtj.href,
    navaids_points_terminalsegmentpoint_pt_durbzr.title,
    navaids_points_terminalsegmentpoint_pt_durbzr.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_durbzr.href,
    geometry_curve_view_mxexdu.geom,
    navaids_points_terminalsegmentpoint_pt_ekrhmv.title,
    navaids_points_terminalsegmentpoint_pt_ekrhmv.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_ekrhmv.href,
    navaids_points_angleindication_pt_rfzfsg.title,
    navaids_points_angleindication_pt_rfzfsg.nilreason[1],
    navaids_points_angleindication_pt_rfzfsg.href,
    navaids_points_distanceindication_pt_wvmraq.title,
    navaids_points_distanceindication_pt_wvmraq.nilreason[1],
    navaids_points_distanceindication_pt_wvmraq.href,
    procedure_holdinguse_pt_wadhse.title,
    procedure_holdinguse_pt_wadhse.nilreason[1],
    procedure_holdinguse_pt_wadhse.href,
    procedure_standardinstrumentdeparture_pt_smrner.title,
    procedure_standardinstrumentdeparture_pt_smrner.nilreason[1],
    procedure_standardinstrumentdeparture_pt_smrner.href
order by departureleg.identifier, departureleg_ts.sequence_number, departureleg_ts.correction_number DESC;
-- DesignatedPointTimeSliceType
-- ['geometry.point_view', 'notes.note_view']
create or replace view navaids_points.designatedpoint_view as
select distinct on (designatedpoint.identifier,designatedpoint_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.designatedpoint.id,
    navaids_points.designatedpoint_ts.id as ts_id,
    navaids_points.designatedpoint_tsp.id as tsp_id,
    navaids_points.designatedpoint.identifier,
    navaids_points.designatedpoint_ts.interpretation,
    navaids_points.designatedpoint_ts.sequence_number,
    navaids_points.designatedpoint_ts.correction_number,
    navaids_points.designatedpoint_ts.valid_time_begin,
    navaids_points.designatedpoint_ts.valid_time_end,
    navaids_points.designatedpoint_ts.feature_lifetime_begin,
    navaids_points.designatedpoint_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.designatedpoint_ts.designator_value as varchar), '(' || navaids_points.designatedpoint_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.designatedpoint_ts.type_value as varchar), '(' || navaids_points.designatedpoint_ts.type_nilreason || ')') as type,
    coalesce(cast(navaids_points.designatedpoint_ts.name_value as varchar), '(' || navaids_points.designatedpoint_ts.name_nilreason || ')') as name,
    geometry_point_view_tyuakw.geom AS geom,
    ST_X(geometry_point_view_tyuakw.geom) AS longitude,
    ST_Y(geometry_point_view_tyuakw.geom) AS latitude,
    geometry_point_view_tyuakw.horizontalAccuracy,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_ywcodj.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_ywcodj.nilreason[1] || ')') AS aimingpoint,
    airport_heliport_touchdownliftoff_pt_ywcodj.href AS aimingpoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_ljyzsh.title as varchar), '(' || airport_heliport_airportheliport_pt_ljyzsh.nilreason[1] || ')') AS airportheliport,
    airport_heliport_airportheliport_pt_ljyzsh.href AS airportheliport_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_ojridh.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_ojridh.nilreason[1] || ')') AS runwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_ojridh.href AS runwaypoint_href,
    jsonb_agg(notes_note_view_syhufn.*) AS designatedpoint_annotation
from navaids_points.designatedpoint 
inner join master_join mj2 on navaids_points.designatedpoint.id = mj2.source_id
inner join navaids_points.designatedpoint_tsp on mj2.target_id = navaids_points.designatedpoint_tsp.id
inner join navaids_points.designatedpoint_ts on navaids_points.designatedpoint_tsp.designatedpointtimeslice_id = navaids_points.designatedpoint_ts.id
left join geometry.point_view geometry_point_view_tyuakw on navaids_points.designatedpoint_ts.location_id = geometry_point_view_tyuakw.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_ywcodj on navaids_points.designatedpoint_ts.aimingpoint_id = airport_heliport_touchdownliftoff_pt_ywcodj.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_ljyzsh on navaids_points.designatedpoint_ts.airportheliport_id = airport_heliport_airportheliport_pt_ljyzsh.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_ojridh on navaids_points.designatedpoint_ts.runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_ojridh.id
left join master_join master_join_fapmpu on navaids_points.designatedpoint_ts.id = master_join_fapmpu.source_id
left join notes.note_view notes_note_view_syhufn on master_join_fapmpu.target_id = notes_note_view_syhufn.id
where navaids_points.designatedpoint.feature_status = 'APPROVED'
  and navaids_points.designatedpoint_ts.feature_status = 'APPROVED'
group by
    navaids_points.designatedpoint.id,
    navaids_points.designatedpoint_ts.id,
    navaids_points.designatedpoint_tsp.id,
    navaids_points.designatedpoint.identifier,
    navaids_points.designatedpoint_ts.interpretation,
    navaids_points.designatedpoint_ts.sequence_number,
    navaids_points.designatedpoint_ts.correction_number,
    navaids_points.designatedpoint_ts.valid_time_begin,
    navaids_points.designatedpoint_ts.valid_time_end,
    navaids_points.designatedpoint_ts.feature_lifetime_begin,
    navaids_points.designatedpoint_ts.feature_lifetime_end,
    navaids_points.designatedpoint_ts.designator_value,
    navaids_points.designatedpoint_ts.designator_nilreason,
    navaids_points.designatedpoint_ts.type_value,
    navaids_points.designatedpoint_ts.type_nilreason,
    navaids_points.designatedpoint_ts.name_value,
    navaids_points.designatedpoint_ts.name_nilreason,
    geometry_point_view_tyuakw.geom,
    geometry_point_view_tyuakw.horizontalAccuracy,
    airport_heliport_touchdownliftoff_pt_ywcodj.title,
    airport_heliport_touchdownliftoff_pt_ywcodj.nilreason[1],
    airport_heliport_touchdownliftoff_pt_ywcodj.href,
    airport_heliport_airportheliport_pt_ljyzsh.title,
    airport_heliport_airportheliport_pt_ljyzsh.nilreason[1],
    airport_heliport_airportheliport_pt_ljyzsh.href,
    airport_heliport_runwaycentrelinepoint_pt_ojridh.title,
    airport_heliport_runwaycentrelinepoint_pt_ojridh.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_ojridh.href
order by designatedpoint.identifier, designatedpoint_ts.sequence_number, designatedpoint_ts.correction_number DESC;
-- DirectionFinderTimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.directionfinder_view as
select distinct on (directionfinder.identifier,directionfinder_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.directionfinder.id,
    navaids_points.directionfinder_ts.id as ts_id,
    navaids_points.directionfinder_tsp.id as tsp_id,
    navaids_points.directionfinder.identifier,
    navaids_points.directionfinder_ts.interpretation,
    navaids_points.directionfinder_ts.sequence_number,
    navaids_points.directionfinder_ts.correction_number,
    navaids_points.directionfinder_ts.valid_time_begin,
    navaids_points.directionfinder_ts.valid_time_end,
    navaids_points.directionfinder_ts.feature_lifetime_begin,
    navaids_points.directionfinder_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.directionfinder_ts.designator_value as varchar), '(' || navaids_points.directionfinder_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.directionfinder_ts.name_value as varchar), '(' || navaids_points.directionfinder_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.directionfinder_ts.emissionclass_value as varchar), '(' || navaids_points.directionfinder_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.directionfinder_ts.mobile_value as varchar), '(' || navaids_points.directionfinder_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.directionfinder_ts.magneticvariation_value as varchar), '(' || navaids_points.directionfinder_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.directionfinder_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.directionfinder_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.directionfinder_ts.datemagneticvariation_value as varchar), '(' || navaids_points.directionfinder_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.directionfinder_ts.flightchecked_value as varchar), '(' || navaids_points.directionfinder_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.directionfinder_ts.doppler_value as varchar), '(' || navaids_points.directionfinder_ts.doppler_nilreason || ')') as doppler,
    geometry_elevatedpoint_view_pachjp.geom AS geom,
    ST_X(geometry_elevatedpoint_view_pachjp.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_pachjp.geom) AS latitude,
    geometry_elevatedpoint_view_pachjp.elevation,
    geometry_elevatedpoint_view_pachjp.geoidUndulation,
    geometry_elevatedpoint_view_pachjp.verticalDatum,
    geometry_elevatedpoint_view_pachjp.verticalAccuracy,
    geometry_elevatedpoint_view_pachjp.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_nbapkv.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_qlwnru.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_eifngf.id) AS availability,
    jsonb_agg(notes_note_view_tusrxy.*) AS directionfinder_annotation,
    jsonb_build_object('id', service_informationservice_pt_zazpuj.id,
    'title', coalesce(cast(service_informationservice_pt_zazpuj.title AS varchar), '(' || service_informationservice_pt_zazpuj.nilreason[1] || ')'),
    'href', service_informationservice_pt_zazpuj.href) AS informationprovision
from navaids_points.directionfinder 
inner join master_join mj2 on navaids_points.directionfinder.id = mj2.source_id
inner join navaids_points.directionfinder_tsp on mj2.target_id = navaids_points.directionfinder_tsp.id
inner join navaids_points.directionfinder_ts on navaids_points.directionfinder_tsp.directionfindertimeslice_id = navaids_points.directionfinder_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_pachjp on navaids_points.directionfinder_ts.location_id = geometry_elevatedpoint_view_pachjp.id
left join master_join master_join_crydrt on navaids_points.directionfinder_ts.id = master_join_crydrt.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_nbapkv on master_join_crydrt.target_id = navaids_points_authorityfornavaidequipment_view_nbapkv.id
left join master_join master_join_rehmnu on navaids_points.directionfinder_ts.id = master_join_rehmnu.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_qlwnru on master_join_rehmnu.target_id = navaids_points_navaidequipmentmonitoring_view_qlwnru.id
left join master_join master_join_hacemf on navaids_points.directionfinder_ts.id = master_join_hacemf.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_eifngf on master_join_hacemf.target_id = navaids_points_navaidoperationalstatus_view_eifngf.id
left join master_join master_join_oulanl on navaids_points.directionfinder_ts.id = master_join_oulanl.source_id
left join notes.note_view notes_note_view_tusrxy on master_join_oulanl.target_id = notes_note_view_tusrxy.id
left join master_join master_join_cdbqia on navaids_points.directionfinder_ts.id = master_join_cdbqia.source_id
left join service.informationservice_pt service_informationservice_pt_zazpuj on master_join_cdbqia.target_id = service_informationservice_pt_zazpuj.id
where navaids_points.directionfinder.feature_status = 'APPROVED'
  and navaids_points.directionfinder_ts.feature_status = 'APPROVED'
group by
    navaids_points.directionfinder.id,
    navaids_points.directionfinder_ts.id,
    navaids_points.directionfinder_tsp.id,
    navaids_points.directionfinder.identifier,
    navaids_points.directionfinder_ts.interpretation,
    navaids_points.directionfinder_ts.sequence_number,
    navaids_points.directionfinder_ts.correction_number,
    navaids_points.directionfinder_ts.valid_time_begin,
    navaids_points.directionfinder_ts.valid_time_end,
    navaids_points.directionfinder_ts.feature_lifetime_begin,
    navaids_points.directionfinder_ts.feature_lifetime_end,
    navaids_points.directionfinder_ts.designator_value,
    navaids_points.directionfinder_ts.designator_nilreason,
    navaids_points.directionfinder_ts.name_value,
    navaids_points.directionfinder_ts.name_nilreason,
    navaids_points.directionfinder_ts.emissionclass_value,
    navaids_points.directionfinder_ts.emissionclass_nilreason,
    navaids_points.directionfinder_ts.mobile_value,
    navaids_points.directionfinder_ts.mobile_nilreason,
    navaids_points.directionfinder_ts.magneticvariation_value,
    navaids_points.directionfinder_ts.magneticvariation_nilreason,
    navaids_points.directionfinder_ts.magneticvariationaccuracy_value,
    navaids_points.directionfinder_ts.magneticvariationaccuracy_nilreason,
    navaids_points.directionfinder_ts.datemagneticvariation_value,
    navaids_points.directionfinder_ts.datemagneticvariation_nilreason,
    navaids_points.directionfinder_ts.flightchecked_value,
    navaids_points.directionfinder_ts.flightchecked_nilreason,
    navaids_points.directionfinder_ts.doppler_value,
    navaids_points.directionfinder_ts.doppler_nilreason,
    geometry_elevatedpoint_view_pachjp.geom,
    geometry_elevatedpoint_view_pachjp.elevation,
    geometry_elevatedpoint_view_pachjp.geoidUndulation,
    geometry_elevatedpoint_view_pachjp.verticalDatum,
    geometry_elevatedpoint_view_pachjp.verticalAccuracy,
    geometry_elevatedpoint_view_pachjp.horizontalAccuracy
order by directionfinder.identifier, directionfinder_ts.sequence_number, directionfinder_ts.correction_number DESC;
-- DistanceIndicationTimeSliceType
-- ['geometry.point_view', 'notes.note_view']
create or replace view navaids_points.distanceindication_view as
select distinct on (distanceindication.identifier,distanceindication_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.distanceindication.id,
    navaids_points.distanceindication_ts.id as ts_id,
    navaids_points.distanceindication_tsp.id as tsp_id,
    navaids_points.distanceindication.identifier,
    navaids_points.distanceindication_ts.interpretation,
    navaids_points.distanceindication_ts.sequence_number,
    navaids_points.distanceindication_ts.correction_number,
    navaids_points.distanceindication_ts.valid_time_begin,
    navaids_points.distanceindication_ts.valid_time_end,
    navaids_points.distanceindication_ts.feature_lifetime_begin,
    navaids_points.distanceindication_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.distanceindication_ts.type_value as varchar), '(' || navaids_points.distanceindication_ts.type_nilreason || ')') as type,
    coalesce(cast(navaids_points.distanceindication_ts.distance_value as varchar) || ' ' || navaids_points.distanceindication_ts.distance_uom, '(' || navaids_points.distanceindication_ts.distance_nilreason || ')') as distance,
    coalesce(cast(navaids_points.distanceindication_ts.minimumreceptionaltitude_value as varchar) || ' ' || navaids_points.distanceindication_ts.minimumreceptionaltitude_uom, '(' || navaids_points.distanceindication_ts.minimumreceptionaltitude_nilreason || ')') as minimumreceptionaltitude,
    coalesce(cast(navaids_points_designatedpoint_pt_yadque.title as varchar), '(' || navaids_points_designatedpoint_pt_yadque.nilreason[1] || ')') AS fix,
    navaids_points_designatedpoint_pt_yadque.href AS fix_href,
    coalesce(cast(navaids_points_designatedpoint_pt_ojblfj.title as varchar), '(' || navaids_points_designatedpoint_pt_ojblfj.nilreason[1] || ')') AS pointchoicefixdesignatedpoint,
    navaids_points_designatedpoint_pt_ojblfj.href AS pointchoicefixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_eatklt.title as varchar), '(' || navaids_points_navaid_pt_eatklt.nilreason[1] || ')') AS pointchoicenavaidsystem,
    navaids_points_navaid_pt_eatklt.href AS pointchoicenavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_kbbion.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_kbbion.nilreason[1] || ')') AS pointchoiceaimingpoint,
    airport_heliport_touchdownliftoff_pt_kbbion.href AS pointchoiceaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_zfphcw.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_zfphcw.nilreason[1] || ')') AS pointchoicerunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_zfphcw.href AS pointchoicerunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_agasut.title as varchar), '(' || airport_heliport_airportheliport_pt_agasut.nilreason[1] || ')') AS pointchoiceairportreferencepoint,
    airport_heliport_airportheliport_pt_agasut.href AS pointchoiceairportreferencepoint_href,
    geometry_point_view_iotbzd.geom AS geom,
    ST_X(geometry_point_view_iotbzd.geom) AS longitude,
    ST_Y(geometry_point_view_iotbzd.geom) AS latitude,
    geometry_point_view_iotbzd.horizontalAccuracy,
    jsonb_agg(notes_note_view_gsursc.*) AS distanceindication_annotation
from navaids_points.distanceindication 
inner join master_join mj2 on navaids_points.distanceindication.id = mj2.source_id
inner join navaids_points.distanceindication_tsp on mj2.target_id = navaids_points.distanceindication_tsp.id
inner join navaids_points.distanceindication_ts on navaids_points.distanceindication_tsp.distanceindicationtimeslice_id = navaids_points.distanceindication_ts.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_yadque on navaids_points.distanceindication_ts.fix_id = navaids_points_designatedpoint_pt_yadque.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_ojblfj on navaids_points.distanceindication_ts.distanceindication_ts_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_ojblfj.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_eatklt on navaids_points.distanceindication_ts.distanceindication_ts_navaidsystem_id = navaids_points_navaid_pt_eatklt.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_kbbion on navaids_points.distanceindication_ts.distanceindication_ts_aimingpoint_id = airport_heliport_touchdownliftoff_pt_kbbion.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_zfphcw on navaids_points.distanceindication_ts.distanceindication_ts_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_zfphcw.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_agasut on navaids_points.distanceindication_ts.distanceindication_ts_airportreferencepoint_id = airport_heliport_airportheliport_pt_agasut.id
left join geometry.point_view geometry_point_view_iotbzd on navaids_points.distanceindication_ts.distanceindication_ts_position_id = geometry_point_view_iotbzd.id
left join master_join master_join_sophpj on navaids_points.distanceindication_ts.id = master_join_sophpj.source_id
left join notes.note_view notes_note_view_gsursc on master_join_sophpj.target_id = notes_note_view_gsursc.id
where navaids_points.distanceindication.feature_status = 'APPROVED'
  and navaids_points.distanceindication_ts.feature_status = 'APPROVED'
group by
    navaids_points.distanceindication.id,
    navaids_points.distanceindication_ts.id,
    navaids_points.distanceindication_tsp.id,
    navaids_points.distanceindication.identifier,
    navaids_points.distanceindication_ts.interpretation,
    navaids_points.distanceindication_ts.sequence_number,
    navaids_points.distanceindication_ts.correction_number,
    navaids_points.distanceindication_ts.valid_time_begin,
    navaids_points.distanceindication_ts.valid_time_end,
    navaids_points.distanceindication_ts.feature_lifetime_begin,
    navaids_points.distanceindication_ts.feature_lifetime_end,
    navaids_points.distanceindication_ts.type_value,
    navaids_points.distanceindication_ts.type_nilreason,
    navaids_points.distanceindication_ts.distance_value,
    navaids_points.distanceindication_ts.distance_uom,
    navaids_points.distanceindication_ts.distance_nilreason,
    navaids_points.distanceindication_ts.minimumreceptionaltitude_value,
    navaids_points.distanceindication_ts.minimumreceptionaltitude_uom,
    navaids_points.distanceindication_ts.minimumreceptionaltitude_nilreason,
    navaids_points_designatedpoint_pt_yadque.title,
    navaids_points_designatedpoint_pt_yadque.nilreason[1],
    navaids_points_designatedpoint_pt_yadque.href,
    navaids_points_designatedpoint_pt_ojblfj.title,
    navaids_points_designatedpoint_pt_ojblfj.nilreason[1],
    navaids_points_designatedpoint_pt_ojblfj.href,
    navaids_points_navaid_pt_eatklt.title,
    navaids_points_navaid_pt_eatklt.nilreason[1],
    navaids_points_navaid_pt_eatklt.href,
    airport_heliport_touchdownliftoff_pt_kbbion.title,
    airport_heliport_touchdownliftoff_pt_kbbion.nilreason[1],
    airport_heliport_touchdownliftoff_pt_kbbion.href,
    airport_heliport_runwaycentrelinepoint_pt_zfphcw.title,
    airport_heliport_runwaycentrelinepoint_pt_zfphcw.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_zfphcw.href,
    airport_heliport_airportheliport_pt_agasut.title,
    airport_heliport_airportheliport_pt_agasut.nilreason[1],
    airport_heliport_airportheliport_pt_agasut.href,
    geometry_point_view_iotbzd.geom,
    geometry_point_view_iotbzd.horizontalAccuracy
order by distanceindication.identifier, distanceindication_ts.sequence_number, distanceindication_ts.correction_number DESC;
-- DMETimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.dme_view as
select distinct on (dme.identifier,dme_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.dme.id,
    navaids_points.dme_ts.id as ts_id,
    navaids_points.dme_tsp.id as tsp_id,
    navaids_points.dme.identifier,
    navaids_points.dme_ts.interpretation,
    navaids_points.dme_ts.sequence_number,
    navaids_points.dme_ts.correction_number,
    navaids_points.dme_ts.valid_time_begin,
    navaids_points.dme_ts.valid_time_end,
    navaids_points.dme_ts.feature_lifetime_begin,
    navaids_points.dme_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.dme_ts.designator_value as varchar), '(' || navaids_points.dme_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.dme_ts.name_value as varchar), '(' || navaids_points.dme_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.dme_ts.emissionclass_value as varchar), '(' || navaids_points.dme_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.dme_ts.mobile_value as varchar), '(' || navaids_points.dme_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.dme_ts.magneticvariation_value as varchar), '(' || navaids_points.dme_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.dme_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.dme_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.dme_ts.datemagneticvariation_value as varchar), '(' || navaids_points.dme_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.dme_ts.flightchecked_value as varchar), '(' || navaids_points.dme_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.dme_ts.type_value as varchar), '(' || navaids_points.dme_ts.type_nilreason || ')') as type,
    coalesce(cast(navaids_points.dme_ts.channel_value as varchar), '(' || navaids_points.dme_ts.channel_nilreason || ')') as channel,
    coalesce(cast(navaids_points.dme_ts.ghostfrequency_value as varchar) || ' ' || navaids_points.dme_ts.ghostfrequency_uom, '(' || navaids_points.dme_ts.ghostfrequency_nilreason || ')') as ghostfrequency,
    coalesce(cast(navaids_points.dme_ts.displace_value as varchar) || ' ' || navaids_points.dme_ts.displace_uom, '(' || navaids_points.dme_ts.displace_nilreason || ')') as displace,
    geometry_elevatedpoint_view_yvhcya.geom AS geom,
    ST_X(geometry_elevatedpoint_view_yvhcya.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_yvhcya.geom) AS latitude,
    geometry_elevatedpoint_view_yvhcya.elevation,
    geometry_elevatedpoint_view_yvhcya.geoidUndulation,
    geometry_elevatedpoint_view_yvhcya.verticalDatum,
    geometry_elevatedpoint_view_yvhcya.verticalAccuracy,
    geometry_elevatedpoint_view_yvhcya.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_mvytid.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_zwekgj.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_dlnwxe.id) AS availability,
    jsonb_agg(notes_note_view_zzjiiv.*) AS dme_annotation
from navaids_points.dme 
inner join master_join mj2 on navaids_points.dme.id = mj2.source_id
inner join navaids_points.dme_tsp on mj2.target_id = navaids_points.dme_tsp.id
inner join navaids_points.dme_ts on navaids_points.dme_tsp.dmetimeslice_id = navaids_points.dme_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_yvhcya on navaids_points.dme_ts.location_id = geometry_elevatedpoint_view_yvhcya.id
left join master_join master_join_fqffno on navaids_points.dme_ts.id = master_join_fqffno.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_mvytid on master_join_fqffno.target_id = navaids_points_authorityfornavaidequipment_view_mvytid.id
left join master_join master_join_qfccea on navaids_points.dme_ts.id = master_join_qfccea.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_zwekgj on master_join_qfccea.target_id = navaids_points_navaidequipmentmonitoring_view_zwekgj.id
left join master_join master_join_kwwpeu on navaids_points.dme_ts.id = master_join_kwwpeu.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_dlnwxe on master_join_kwwpeu.target_id = navaids_points_navaidoperationalstatus_view_dlnwxe.id
left join master_join master_join_zvfeda on navaids_points.dme_ts.id = master_join_zvfeda.source_id
left join notes.note_view notes_note_view_zzjiiv on master_join_zvfeda.target_id = notes_note_view_zzjiiv.id
where navaids_points.dme.feature_status = 'APPROVED'
  and navaids_points.dme_ts.feature_status = 'APPROVED'
group by
    navaids_points.dme.id,
    navaids_points.dme_ts.id,
    navaids_points.dme_tsp.id,
    navaids_points.dme.identifier,
    navaids_points.dme_ts.interpretation,
    navaids_points.dme_ts.sequence_number,
    navaids_points.dme_ts.correction_number,
    navaids_points.dme_ts.valid_time_begin,
    navaids_points.dme_ts.valid_time_end,
    navaids_points.dme_ts.feature_lifetime_begin,
    navaids_points.dme_ts.feature_lifetime_end,
    navaids_points.dme_ts.designator_value,
    navaids_points.dme_ts.designator_nilreason,
    navaids_points.dme_ts.name_value,
    navaids_points.dme_ts.name_nilreason,
    navaids_points.dme_ts.emissionclass_value,
    navaids_points.dme_ts.emissionclass_nilreason,
    navaids_points.dme_ts.mobile_value,
    navaids_points.dme_ts.mobile_nilreason,
    navaids_points.dme_ts.magneticvariation_value,
    navaids_points.dme_ts.magneticvariation_nilreason,
    navaids_points.dme_ts.magneticvariationaccuracy_value,
    navaids_points.dme_ts.magneticvariationaccuracy_nilreason,
    navaids_points.dme_ts.datemagneticvariation_value,
    navaids_points.dme_ts.datemagneticvariation_nilreason,
    navaids_points.dme_ts.flightchecked_value,
    navaids_points.dme_ts.flightchecked_nilreason,
    navaids_points.dme_ts.type_value,
    navaids_points.dme_ts.type_nilreason,
    navaids_points.dme_ts.channel_value,
    navaids_points.dme_ts.channel_nilreason,
    navaids_points.dme_ts.ghostfrequency_value,
    navaids_points.dme_ts.ghostfrequency_uom,
    navaids_points.dme_ts.ghostfrequency_nilreason,
    navaids_points.dme_ts.displace_value,
    navaids_points.dme_ts.displace_uom,
    navaids_points.dme_ts.displace_nilreason,
    geometry_elevatedpoint_view_yvhcya.geom,
    geometry_elevatedpoint_view_yvhcya.elevation,
    geometry_elevatedpoint_view_yvhcya.geoidUndulation,
    geometry_elevatedpoint_view_yvhcya.verticalDatum,
    geometry_elevatedpoint_view_yvhcya.verticalAccuracy,
    geometry_elevatedpoint_view_yvhcya.horizontalAccuracy
order by dme.identifier, dme_ts.sequence_number, dme_ts.correction_number DESC;
-- ElevationTimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.elevation_view as
select distinct on (elevation.identifier,elevation_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.elevation.id,
    navaids_points.elevation_ts.id as ts_id,
    navaids_points.elevation_tsp.id as tsp_id,
    navaids_points.elevation.identifier,
    navaids_points.elevation_ts.interpretation,
    navaids_points.elevation_ts.sequence_number,
    navaids_points.elevation_ts.correction_number,
    navaids_points.elevation_ts.valid_time_begin,
    navaids_points.elevation_ts.valid_time_end,
    navaids_points.elevation_ts.feature_lifetime_begin,
    navaids_points.elevation_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.elevation_ts.designator_value as varchar), '(' || navaids_points.elevation_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.elevation_ts.name_value as varchar), '(' || navaids_points.elevation_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.elevation_ts.emissionclass_value as varchar), '(' || navaids_points.elevation_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.elevation_ts.mobile_value as varchar), '(' || navaids_points.elevation_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.elevation_ts.magneticvariation_value as varchar), '(' || navaids_points.elevation_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.elevation_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.elevation_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.elevation_ts.datemagneticvariation_value as varchar), '(' || navaids_points.elevation_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.elevation_ts.flightchecked_value as varchar), '(' || navaids_points.elevation_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.elevation_ts.anglenominal_value as varchar), '(' || navaids_points.elevation_ts.anglenominal_nilreason || ')') as anglenominal,
    coalesce(cast(navaids_points.elevation_ts.angleminimum_value as varchar), '(' || navaids_points.elevation_ts.angleminimum_nilreason || ')') as angleminimum,
    coalesce(cast(navaids_points.elevation_ts.anglespan_value as varchar), '(' || navaids_points.elevation_ts.anglespan_nilreason || ')') as anglespan,
    coalesce(cast(navaids_points.elevation_ts.angleaccuracy_value as varchar), '(' || navaids_points.elevation_ts.angleaccuracy_nilreason || ')') as angleaccuracy,
    geometry_elevatedpoint_view_idcpnp.geom AS geom,
    ST_X(geometry_elevatedpoint_view_idcpnp.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_idcpnp.geom) AS latitude,
    geometry_elevatedpoint_view_idcpnp.elevation,
    geometry_elevatedpoint_view_idcpnp.geoidUndulation,
    geometry_elevatedpoint_view_idcpnp.verticalDatum,
    geometry_elevatedpoint_view_idcpnp.verticalAccuracy,
    geometry_elevatedpoint_view_idcpnp.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_ctugue.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_giqapx.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_ocstrd.id) AS availability,
    jsonb_agg(notes_note_view_gybddp.*) AS elevation_annotation
from navaids_points.elevation 
inner join master_join mj2 on navaids_points.elevation.id = mj2.source_id
inner join navaids_points.elevation_tsp on mj2.target_id = navaids_points.elevation_tsp.id
inner join navaids_points.elevation_ts on navaids_points.elevation_tsp.elevationtimeslice_id = navaids_points.elevation_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_idcpnp on navaids_points.elevation_ts.location_id = geometry_elevatedpoint_view_idcpnp.id
left join master_join master_join_khuxen on navaids_points.elevation_ts.id = master_join_khuxen.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_ctugue on master_join_khuxen.target_id = navaids_points_authorityfornavaidequipment_view_ctugue.id
left join master_join master_join_alfivg on navaids_points.elevation_ts.id = master_join_alfivg.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_giqapx on master_join_alfivg.target_id = navaids_points_navaidequipmentmonitoring_view_giqapx.id
left join master_join master_join_wiuldd on navaids_points.elevation_ts.id = master_join_wiuldd.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_ocstrd on master_join_wiuldd.target_id = navaids_points_navaidoperationalstatus_view_ocstrd.id
left join master_join master_join_vbgdpe on navaids_points.elevation_ts.id = master_join_vbgdpe.source_id
left join notes.note_view notes_note_view_gybddp on master_join_vbgdpe.target_id = notes_note_view_gybddp.id
where navaids_points.elevation.feature_status = 'APPROVED'
  and navaids_points.elevation_ts.feature_status = 'APPROVED'
group by
    navaids_points.elevation.id,
    navaids_points.elevation_ts.id,
    navaids_points.elevation_tsp.id,
    navaids_points.elevation.identifier,
    navaids_points.elevation_ts.interpretation,
    navaids_points.elevation_ts.sequence_number,
    navaids_points.elevation_ts.correction_number,
    navaids_points.elevation_ts.valid_time_begin,
    navaids_points.elevation_ts.valid_time_end,
    navaids_points.elevation_ts.feature_lifetime_begin,
    navaids_points.elevation_ts.feature_lifetime_end,
    navaids_points.elevation_ts.designator_value,
    navaids_points.elevation_ts.designator_nilreason,
    navaids_points.elevation_ts.name_value,
    navaids_points.elevation_ts.name_nilreason,
    navaids_points.elevation_ts.emissionclass_value,
    navaids_points.elevation_ts.emissionclass_nilreason,
    navaids_points.elevation_ts.mobile_value,
    navaids_points.elevation_ts.mobile_nilreason,
    navaids_points.elevation_ts.magneticvariation_value,
    navaids_points.elevation_ts.magneticvariation_nilreason,
    navaids_points.elevation_ts.magneticvariationaccuracy_value,
    navaids_points.elevation_ts.magneticvariationaccuracy_nilreason,
    navaids_points.elevation_ts.datemagneticvariation_value,
    navaids_points.elevation_ts.datemagneticvariation_nilreason,
    navaids_points.elevation_ts.flightchecked_value,
    navaids_points.elevation_ts.flightchecked_nilreason,
    navaids_points.elevation_ts.anglenominal_value,
    navaids_points.elevation_ts.anglenominal_nilreason,
    navaids_points.elevation_ts.angleminimum_value,
    navaids_points.elevation_ts.angleminimum_nilreason,
    navaids_points.elevation_ts.anglespan_value,
    navaids_points.elevation_ts.anglespan_nilreason,
    navaids_points.elevation_ts.angleaccuracy_value,
    navaids_points.elevation_ts.angleaccuracy_nilreason,
    geometry_elevatedpoint_view_idcpnp.geom,
    geometry_elevatedpoint_view_idcpnp.elevation,
    geometry_elevatedpoint_view_idcpnp.geoidUndulation,
    geometry_elevatedpoint_view_idcpnp.verticalDatum,
    geometry_elevatedpoint_view_idcpnp.verticalAccuracy,
    geometry_elevatedpoint_view_idcpnp.horizontalAccuracy
order by elevation.identifier, elevation_ts.sequence_number, elevation_ts.correction_number DESC;
-- FinalLegTimeSliceType
-- ['procedure.approachcondition_view', 'geometry.point_view', 'notes.note_view', 'shared.aircraftcharacteristic_view', 'shared.obstacleassessmentarea_view', 'geometry.curve_view']
create or replace view procedure.finalleg_view as
select distinct on (finalleg.identifier,finalleg_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.finalleg.id,
    procedure.finalleg_ts.id as ts_id,
    procedure.finalleg_tsp.id as tsp_id,
    procedure.finalleg.identifier,
    procedure.finalleg_ts.interpretation,
    procedure.finalleg_ts.sequence_number,
    procedure.finalleg_ts.correction_number,
    procedure.finalleg_ts.valid_time_begin,
    procedure.finalleg_ts.valid_time_end,
    procedure.finalleg_ts.feature_lifetime_begin,
    procedure.finalleg_ts.feature_lifetime_end,
    coalesce(cast(procedure.finalleg_ts.endconditiondesignator_value as varchar), '(' || procedure.finalleg_ts.endconditiondesignator_nilreason || ')') as endconditiondesignator,
    coalesce(cast(procedure.finalleg_ts.legpath_value as varchar), '(' || procedure.finalleg_ts.legpath_nilreason || ')') as legpath,
    coalesce(cast(procedure.finalleg_ts.legtypearinc_value as varchar), '(' || procedure.finalleg_ts.legtypearinc_nilreason || ')') as legtypearinc,
    coalesce(cast(procedure.finalleg_ts.course_value as varchar), '(' || procedure.finalleg_ts.course_nilreason || ')') as course,
    coalesce(cast(procedure.finalleg_ts.coursetype_value as varchar), '(' || procedure.finalleg_ts.coursetype_nilreason || ')') as coursetype,
    coalesce(cast(procedure.finalleg_ts.coursedirection_value as varchar), '(' || procedure.finalleg_ts.coursedirection_nilreason || ')') as coursedirection,
    coalesce(cast(procedure.finalleg_ts.turndirection_value as varchar), '(' || procedure.finalleg_ts.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(procedure.finalleg_ts.speedreference_value as varchar), '(' || procedure.finalleg_ts.speedreference_nilreason || ')') as speedreference,
    coalesce(cast(procedure.finalleg_ts.speedinterpretation_value as varchar), '(' || procedure.finalleg_ts.speedinterpretation_nilreason || ')') as speedinterpretation,
    coalesce(cast(procedure.finalleg_ts.bankangle_value as varchar), '(' || procedure.finalleg_ts.bankangle_nilreason || ')') as bankangle,
    coalesce(cast(procedure.finalleg_ts.procedureturnrequired_value as varchar), '(' || procedure.finalleg_ts.procedureturnrequired_nilreason || ')') as procedureturnrequired,
    coalesce(cast(procedure.finalleg_ts.upperlimitreference_value as varchar), '(' || procedure.finalleg_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(procedure.finalleg_ts.lowerlimitreference_value as varchar), '(' || procedure.finalleg_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(procedure.finalleg_ts.altitudeinterpretation_value as varchar), '(' || procedure.finalleg_ts.altitudeinterpretation_nilreason || ')') as altitudeinterpretation,
    coalesce(cast(procedure.finalleg_ts.altitudeoverridereference_value as varchar), '(' || procedure.finalleg_ts.altitudeoverridereference_nilreason || ')') as altitudeoverridereference,
    coalesce(cast(procedure.finalleg_ts.verticalangle_value as varchar), '(' || procedure.finalleg_ts.verticalangle_nilreason || ')') as verticalangle,
    coalesce(cast(procedure.finalleg_ts.guidancesystem_value as varchar), '(' || procedure.finalleg_ts.guidancesystem_nilreason || ')') as guidancesystem,
    coalesce(cast(procedure.finalleg_ts.landingsystemcategory_value as varchar), '(' || procedure.finalleg_ts.landingsystemcategory_nilreason || ')') as landingsystemcategory,
    coalesce(cast(procedure.finalleg_ts.rnpdmeauthorized_value as varchar), '(' || procedure.finalleg_ts.rnpdmeauthorized_nilreason || ')') as rnpdmeauthorized,
    coalesce(cast(procedure.finalleg_ts.courseoffsetangle_value as varchar), '(' || procedure.finalleg_ts.courseoffsetangle_nilreason || ')') as courseoffsetangle,
    coalesce(cast(procedure.finalleg_ts.courseoffsetside_value as varchar), '(' || procedure.finalleg_ts.courseoffsetside_nilreason || ')') as courseoffsetside,
    coalesce(cast(procedure.finalleg_ts.coursecentrelineintersect_value as varchar), '(' || procedure.finalleg_ts.coursecentrelineintersect_nilreason || ')') as coursecentrelineintersect,
    coalesce(cast(procedure.finalleg_ts.speedlimit_value as varchar) || ' ' || procedure.finalleg_ts.speedlimit_uom, '(' || procedure.finalleg_ts.speedlimit_nilreason || ')') as speedlimit,
    coalesce(cast(procedure.finalleg_ts.length_value as varchar) || ' ' || procedure.finalleg_ts.length_uom, '(' || procedure.finalleg_ts.length_nilreason || ')') as length,
    coalesce(cast(procedure.finalleg_ts.duration_value as varchar) || ' ' || procedure.finalleg_ts.duration_uom, '(' || procedure.finalleg_ts.duration_nilreason || ')') as duration,
    coalesce(cast(procedure.finalleg_ts.upperlimitaltitude_value as varchar) || ' ' || procedure.finalleg_ts.upperlimitaltitude_uom, '(' || procedure.finalleg_ts.upperlimitaltitude_nilreason || ')') as upperlimitaltitude,
    coalesce(cast(procedure.finalleg_ts.lowerlimitaltitude_value as varchar) || ' ' || procedure.finalleg_ts.lowerlimitaltitude_uom, '(' || procedure.finalleg_ts.lowerlimitaltitude_nilreason || ')') as lowerlimitaltitude,
    coalesce(cast(procedure.finalleg_ts.altitudeoverrideatc_value as varchar) || ' ' || procedure.finalleg_ts.altitudeoverrideatc_uom, '(' || procedure.finalleg_ts.altitudeoverrideatc_nilreason || ')') as altitudeoverrideatc,
    coalesce(cast(procedure.finalleg_ts.minimumbarovnavtemperature_value as varchar) || ' ' || procedure.finalleg_ts.minimumbarovnavtemperature_uom, '(' || procedure.finalleg_ts.minimumbarovnavtemperature_nilreason || ')') as minimumbarovnavtemperature,
    coalesce(cast(procedure.finalleg_ts.coursecentrelinedistance_value as varchar) || ' ' || procedure.finalleg_ts.coursecentrelinedistance_uom, '(' || procedure.finalleg_ts.coursecentrelinedistance_nilreason || ')') as coursecentrelinedistance,
    coalesce(cast(procedure.finalleg_ts.courseoffsetdistance_value as varchar) || ' ' || procedure.finalleg_ts.courseoffsetdistance_uom, '(' || procedure.finalleg_ts.courseoffsetdistance_nilreason || ')') as courseoffsetdistance,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_duzrrc.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_duzrrc.nilreason[1] || ')') AS startpoint,
    navaids_points_terminalsegmentpoint_pt_duzrrc.href AS startpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_vuphlz.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_vuphlz.nilreason[1] || ')') AS endpoint,
    navaids_points_terminalsegmentpoint_pt_vuphlz.href AS endpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_qrjwow.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_qrjwow.nilreason[1] || ')') AS arccentre,
    navaids_points_terminalsegmentpoint_pt_qrjwow.href AS arccentre_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_hqokfc.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_hqokfc.nilreason[1] || ')') AS visualdescentpoint,
    navaids_points_terminalsegmentpoint_pt_hqokfc.href AS visualdescentpoint_href,
    geometry_curve_view_hkfwok.geom AS geom,
    coalesce(cast(navaids_points_angleindication_pt_oiiltx.title as varchar), '(' || navaids_points_angleindication_pt_oiiltx.nilreason[1] || ')') AS angle,
    navaids_points_angleindication_pt_oiiltx.href AS angle_href,
    coalesce(cast(navaids_points_distanceindication_pt_vcmlot.title as varchar), '(' || navaids_points_distanceindication_pt_vcmlot.nilreason[1] || ')') AS distance,
    navaids_points_distanceindication_pt_vcmlot.href AS distance_href,
    coalesce(cast(procedure_holdinguse_pt_rspugm.title as varchar), '(' || procedure_holdinguse_pt_rspugm.nilreason[1] || ')') AS holding,
    procedure_holdinguse_pt_rspugm.href AS holding_href,
    coalesce(cast(procedure_instrumentapproachprocedure_pt_bjakmb.title as varchar), '(' || procedure_instrumentapproachprocedure_pt_bjakmb.nilreason[1] || ')') AS approach,
    procedure_instrumentapproachprocedure_pt_bjakmb.href AS approach_href,
    coalesce(cast(navaids_points_designatedpoint_pt_wjjats.title as varchar), '(' || navaids_points_designatedpoint_pt_wjjats.nilreason[1] || ')') AS finalpathalignmentpointfixdesignatedpoint,
    navaids_points_designatedpoint_pt_wjjats.href AS finalpathalignmentpointfixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_ctztep.title as varchar), '(' || navaids_points_navaid_pt_ctztep.nilreason[1] || ')') AS finalpathalignmentpointnavaidsystem,
    navaids_points_navaid_pt_ctztep.href AS finalpathalignmentpointnavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_mabswm.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_mabswm.nilreason[1] || ')') AS finalpathalignmentpointaimingpoint,
    airport_heliport_touchdownliftoff_pt_mabswm.href AS finalpathalignmentpointaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_cskmgf.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_cskmgf.nilreason[1] || ')') AS finalpathalignmentpointrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_cskmgf.href AS finalpathalignmentpointrunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_pwbzpl.title as varchar), '(' || airport_heliport_airportheliport_pt_pwbzpl.nilreason[1] || ')') AS finalpathalignmentpointairportreferencepoint,
    airport_heliport_airportheliport_pt_pwbzpl.href AS finalpathalignmentpointairportreferencepoint_href,
    geometry_point_view_deocjf.geom AS geom,
    ST_X(geometry_point_view_deocjf.geom) AS longitude,
    ST_Y(geometry_point_view_deocjf.geom) AS latitude,
    geometry_point_view_deocjf.horizontalAccuracy,
    coalesce(cast(public_fasdatablock_pt_fyxdwc.title as varchar), '(' || public_fasdatablock_pt_fyxdwc.nilreason[1] || ')') AS fasdata,
    public_fasdatablock_pt_fyxdwc.href AS fasdata_href,
    jsonb_agg(shared_aircraftcharacteristic_view_wglbyh.id) AS aircraftcategory,
    jsonb_agg(shared_obstacleassessmentarea_view_mlavuv.id) AS designsurface,
    jsonb_agg(notes_note_view_ljbpix.*) AS finalleg_annotation,
    jsonb_agg(procedure_approachcondition_view_lkfxna.id) AS condition
from procedure.finalleg 
inner join master_join mj2 on procedure.finalleg.id = mj2.source_id
inner join procedure.finalleg_tsp on mj2.target_id = procedure.finalleg_tsp.id
inner join procedure.finalleg_ts on procedure.finalleg_tsp.finallegtimeslice_id = procedure.finalleg_ts.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_duzrrc on procedure.finalleg_ts.startpoint_id = navaids_points_terminalsegmentpoint_pt_duzrrc.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_vuphlz on procedure.finalleg_ts.endpoint_id = navaids_points_terminalsegmentpoint_pt_vuphlz.id
left join geometry.curve_view geometry_curve_view_hkfwok on procedure.finalleg_ts.trajectory_id = geometry_curve_view_hkfwok.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_qrjwow on procedure.finalleg_ts.arccentre_id = navaids_points_terminalsegmentpoint_pt_qrjwow.id
left join navaids_points.angleindication_pt navaids_points_angleindication_pt_oiiltx on procedure.finalleg_ts.angle_id = navaids_points_angleindication_pt_oiiltx.id
left join navaids_points.distanceindication_pt navaids_points_distanceindication_pt_vcmlot on procedure.finalleg_ts.distance_id = navaids_points_distanceindication_pt_vcmlot.id
left join procedure.holdinguse_pt procedure_holdinguse_pt_rspugm on procedure.finalleg_ts.holding_id = procedure_holdinguse_pt_rspugm.id
left join procedure.instrumentapproachprocedure_pt procedure_instrumentapproachprocedure_pt_bjakmb on procedure.finalleg_ts.approach_id = procedure_instrumentapproachprocedure_pt_bjakmb.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_wjjats on procedure.finalleg_ts.finalpathalignmentpoint_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_wjjats.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_ctztep on procedure.finalleg_ts.finalpathalignmentpoint_navaidsystem_id = navaids_points_navaid_pt_ctztep.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_mabswm on procedure.finalleg_ts.finalpathalignmentpoint_aimingpoint_id = airport_heliport_touchdownliftoff_pt_mabswm.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_cskmgf on procedure.finalleg_ts.finalpathalignmentpoint_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_cskmgf.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_pwbzpl on procedure.finalleg_ts.finalpathalignmentpoint_airportreferencepoint_id = airport_heliport_airportheliport_pt_pwbzpl.id
left join geometry.point_view geometry_point_view_deocjf on procedure.finalleg_ts.finalpathalignmentpoint_position_id = geometry_point_view_deocjf.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_hqokfc on procedure.finalleg_ts.visualdescentpoint_id = navaids_points_terminalsegmentpoint_pt_hqokfc.id
left join public.fasdatablock_pt public_fasdatablock_pt_fyxdwc on procedure.finalleg_ts.fasdata_id = public_fasdatablock_pt_fyxdwc.id
left join master_join master_join_ppvyti on procedure.finalleg_ts.id = master_join_ppvyti.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_wglbyh on master_join_ppvyti.target_id = shared_aircraftcharacteristic_view_wglbyh.id
left join master_join master_join_wicanl on procedure.finalleg_ts.id = master_join_wicanl.source_id
left join shared.obstacleassessmentarea_view shared_obstacleassessmentarea_view_mlavuv on master_join_wicanl.target_id = shared_obstacleassessmentarea_view_mlavuv.id
left join master_join master_join_mvvusn on procedure.finalleg_ts.id = master_join_mvvusn.source_id
left join notes.note_view notes_note_view_ljbpix on master_join_mvvusn.target_id = notes_note_view_ljbpix.id
left join master_join master_join_mveuza on procedure.finalleg_ts.id = master_join_mveuza.source_id
left join procedure.approachcondition_view procedure_approachcondition_view_lkfxna on master_join_mveuza.target_id = procedure_approachcondition_view_lkfxna.id
where procedure.finalleg.feature_status = 'APPROVED'
  and procedure.finalleg_ts.feature_status = 'APPROVED'
group by
    procedure.finalleg.id,
    procedure.finalleg_ts.id,
    procedure.finalleg_tsp.id,
    procedure.finalleg.identifier,
    procedure.finalleg_ts.interpretation,
    procedure.finalleg_ts.sequence_number,
    procedure.finalleg_ts.correction_number,
    procedure.finalleg_ts.valid_time_begin,
    procedure.finalleg_ts.valid_time_end,
    procedure.finalleg_ts.feature_lifetime_begin,
    procedure.finalleg_ts.feature_lifetime_end,
    procedure.finalleg_ts.endconditiondesignator_value,
    procedure.finalleg_ts.endconditiondesignator_nilreason,
    procedure.finalleg_ts.legpath_value,
    procedure.finalleg_ts.legpath_nilreason,
    procedure.finalleg_ts.legtypearinc_value,
    procedure.finalleg_ts.legtypearinc_nilreason,
    procedure.finalleg_ts.course_value,
    procedure.finalleg_ts.course_nilreason,
    procedure.finalleg_ts.coursetype_value,
    procedure.finalleg_ts.coursetype_nilreason,
    procedure.finalleg_ts.coursedirection_value,
    procedure.finalleg_ts.coursedirection_nilreason,
    procedure.finalleg_ts.turndirection_value,
    procedure.finalleg_ts.turndirection_nilreason,
    procedure.finalleg_ts.speedreference_value,
    procedure.finalleg_ts.speedreference_nilreason,
    procedure.finalleg_ts.speedinterpretation_value,
    procedure.finalleg_ts.speedinterpretation_nilreason,
    procedure.finalleg_ts.bankangle_value,
    procedure.finalleg_ts.bankangle_nilreason,
    procedure.finalleg_ts.procedureturnrequired_value,
    procedure.finalleg_ts.procedureturnrequired_nilreason,
    procedure.finalleg_ts.upperlimitreference_value,
    procedure.finalleg_ts.upperlimitreference_nilreason,
    procedure.finalleg_ts.lowerlimitreference_value,
    procedure.finalleg_ts.lowerlimitreference_nilreason,
    procedure.finalleg_ts.altitudeinterpretation_value,
    procedure.finalleg_ts.altitudeinterpretation_nilreason,
    procedure.finalleg_ts.altitudeoverridereference_value,
    procedure.finalleg_ts.altitudeoverridereference_nilreason,
    procedure.finalleg_ts.verticalangle_value,
    procedure.finalleg_ts.verticalangle_nilreason,
    procedure.finalleg_ts.guidancesystem_value,
    procedure.finalleg_ts.guidancesystem_nilreason,
    procedure.finalleg_ts.landingsystemcategory_value,
    procedure.finalleg_ts.landingsystemcategory_nilreason,
    procedure.finalleg_ts.rnpdmeauthorized_value,
    procedure.finalleg_ts.rnpdmeauthorized_nilreason,
    procedure.finalleg_ts.courseoffsetangle_value,
    procedure.finalleg_ts.courseoffsetangle_nilreason,
    procedure.finalleg_ts.courseoffsetside_value,
    procedure.finalleg_ts.courseoffsetside_nilreason,
    procedure.finalleg_ts.coursecentrelineintersect_value,
    procedure.finalleg_ts.coursecentrelineintersect_nilreason,
    procedure.finalleg_ts.speedlimit_value,
    procedure.finalleg_ts.speedlimit_uom,
    procedure.finalleg_ts.speedlimit_nilreason,
    procedure.finalleg_ts.length_value,
    procedure.finalleg_ts.length_uom,
    procedure.finalleg_ts.length_nilreason,
    procedure.finalleg_ts.duration_value,
    procedure.finalleg_ts.duration_uom,
    procedure.finalleg_ts.duration_nilreason,
    procedure.finalleg_ts.upperlimitaltitude_value,
    procedure.finalleg_ts.upperlimitaltitude_uom,
    procedure.finalleg_ts.upperlimitaltitude_nilreason,
    procedure.finalleg_ts.lowerlimitaltitude_value,
    procedure.finalleg_ts.lowerlimitaltitude_uom,
    procedure.finalleg_ts.lowerlimitaltitude_nilreason,
    procedure.finalleg_ts.altitudeoverrideatc_value,
    procedure.finalleg_ts.altitudeoverrideatc_uom,
    procedure.finalleg_ts.altitudeoverrideatc_nilreason,
    procedure.finalleg_ts.minimumbarovnavtemperature_value,
    procedure.finalleg_ts.minimumbarovnavtemperature_uom,
    procedure.finalleg_ts.minimumbarovnavtemperature_nilreason,
    procedure.finalleg_ts.coursecentrelinedistance_value,
    procedure.finalleg_ts.coursecentrelinedistance_uom,
    procedure.finalleg_ts.coursecentrelinedistance_nilreason,
    procedure.finalleg_ts.courseoffsetdistance_value,
    procedure.finalleg_ts.courseoffsetdistance_uom,
    procedure.finalleg_ts.courseoffsetdistance_nilreason,
    navaids_points_terminalsegmentpoint_pt_duzrrc.title,
    navaids_points_terminalsegmentpoint_pt_duzrrc.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_duzrrc.href,
    navaids_points_terminalsegmentpoint_pt_vuphlz.title,
    navaids_points_terminalsegmentpoint_pt_vuphlz.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_vuphlz.href,
    geometry_curve_view_hkfwok.geom,
    navaids_points_terminalsegmentpoint_pt_qrjwow.title,
    navaids_points_terminalsegmentpoint_pt_qrjwow.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_qrjwow.href,
    navaids_points_angleindication_pt_oiiltx.title,
    navaids_points_angleindication_pt_oiiltx.nilreason[1],
    navaids_points_angleindication_pt_oiiltx.href,
    navaids_points_distanceindication_pt_vcmlot.title,
    navaids_points_distanceindication_pt_vcmlot.nilreason[1],
    navaids_points_distanceindication_pt_vcmlot.href,
    procedure_holdinguse_pt_rspugm.title,
    procedure_holdinguse_pt_rspugm.nilreason[1],
    procedure_holdinguse_pt_rspugm.href,
    procedure_instrumentapproachprocedure_pt_bjakmb.title,
    procedure_instrumentapproachprocedure_pt_bjakmb.nilreason[1],
    procedure_instrumentapproachprocedure_pt_bjakmb.href,
    navaids_points_designatedpoint_pt_wjjats.title,
    navaids_points_designatedpoint_pt_wjjats.nilreason[1],
    navaids_points_designatedpoint_pt_wjjats.href,
    navaids_points_navaid_pt_ctztep.title,
    navaids_points_navaid_pt_ctztep.nilreason[1],
    navaids_points_navaid_pt_ctztep.href,
    airport_heliport_touchdownliftoff_pt_mabswm.title,
    airport_heliport_touchdownliftoff_pt_mabswm.nilreason[1],
    airport_heliport_touchdownliftoff_pt_mabswm.href,
    airport_heliport_runwaycentrelinepoint_pt_cskmgf.title,
    airport_heliport_runwaycentrelinepoint_pt_cskmgf.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_cskmgf.href,
    airport_heliport_airportheliport_pt_pwbzpl.title,
    airport_heliport_airportheliport_pt_pwbzpl.nilreason[1],
    airport_heliport_airportheliport_pt_pwbzpl.href,
    geometry_point_view_deocjf.geom,
    geometry_point_view_deocjf.horizontalAccuracy,
    navaids_points_terminalsegmentpoint_pt_hqokfc.title,
    navaids_points_terminalsegmentpoint_pt_hqokfc.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_hqokfc.href,
    public_fasdatablock_pt_fyxdwc.title,
    public_fasdatablock_pt_fyxdwc.nilreason[1],
    public_fasdatablock_pt_fyxdwc.href
order by finalleg.identifier, finalleg_ts.sequence_number, finalleg_ts.correction_number DESC;
-- FireFightingServiceTimeSliceType
-- ['service.serviceoperationalstatus_view', 'notes.note_view', 'shared.contactinformation_view', 'geometry.elevatedpoint_view', 'service.callsigndetail_view']
create or replace view service.firefightingservice_view as
select distinct on (firefightingservice.identifier,firefightingservice_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.firefightingservice.id,
    service.firefightingservice_ts.id as ts_id,
    service.firefightingservice_tsp.id as tsp_id,
    service.firefightingservice.identifier,
    service.firefightingservice_ts.interpretation,
    service.firefightingservice_ts.sequence_number,
    service.firefightingservice_ts.correction_number,
    service.firefightingservice_ts.valid_time_begin,
    service.firefightingservice_ts.valid_time_end,
    service.firefightingservice_ts.feature_lifetime_begin,
    service.firefightingservice_ts.feature_lifetime_end,
    coalesce(cast(service.firefightingservice_ts.flightoperations_value as varchar), '(' || service.firefightingservice_ts.flightoperations_nilreason || ')') as flightoperations,
    coalesce(cast(service.firefightingservice_ts.rank_value as varchar), '(' || service.firefightingservice_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.firefightingservice_ts.complianticao_value as varchar), '(' || service.firefightingservice_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(service.firefightingservice_ts.name_value as varchar), '(' || service.firefightingservice_ts.name_nilreason || ')') as name,
    coalesce(cast(service.firefightingservice_ts.category_value as varchar), '(' || service.firefightingservice_ts.category_nilreason || ')') as category,
    coalesce(cast(service.firefightingservice_ts.standard_value as varchar), '(' || service.firefightingservice_ts.standard_nilreason || ')') as standard,
    geometry_elevatedpoint_view_tlvxat.geom AS geom,
    ST_X(geometry_elevatedpoint_view_tlvxat.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_tlvxat.geom) AS latitude,
    geometry_elevatedpoint_view_tlvxat.elevation,
    geometry_elevatedpoint_view_tlvxat.geoidUndulation,
    geometry_elevatedpoint_view_tlvxat.verticalDatum,
    geometry_elevatedpoint_view_tlvxat.verticalAccuracy,
    geometry_elevatedpoint_view_tlvxat.horizontalAccuracy,
    coalesce(cast(organisation_unit_pt_xosvmi.title as varchar), '(' || organisation_unit_pt_xosvmi.nilreason[1] || ')') AS serviceprovider,
    organisation_unit_pt_xosvmi.href AS serviceprovider_href,
    jsonb_agg(service_callsigndetail_view_qppdnn.id) AS callsign,
    jsonb_build_object('id', service_radiocommunicationchannel_pt_hbkyci.id,
    'title', coalesce(cast(service_radiocommunicationchannel_pt_hbkyci.title AS varchar), '(' || service_radiocommunicationchannel_pt_hbkyci.nilreason[1] || ')'),
    'href', service_radiocommunicationchannel_pt_hbkyci.href) AS radiocommunication,
    jsonb_agg(service_serviceoperationalstatus_view_oeqbth.id) AS availability,
    jsonb_agg(notes_note_view_umrexq.*) AS firefightingservice_annotation,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_wdjuui.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_wdjuui.title AS varchar), '(' || airport_heliport_airportheliport_pt_wdjuui.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_wdjuui.href) AS airportheliport
from service.firefightingservice 
inner join master_join mj2 on service.firefightingservice.id = mj2.source_id
inner join service.firefightingservice_tsp on mj2.target_id = service.firefightingservice_tsp.id
inner join service.firefightingservice_ts on service.firefightingservice_tsp.firefightingservicetimeslice_id = service.firefightingservice_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_tlvxat on service.firefightingservice_ts.location_id = geometry_elevatedpoint_view_tlvxat.id
left join organisation.unit_pt organisation_unit_pt_xosvmi on service.firefightingservice_ts.serviceprovider_id = organisation_unit_pt_xosvmi.id
left join master_join master_join_rjwies on service.firefightingservice_ts.id = master_join_rjwies.source_id
left join service.callsigndetail_view service_callsigndetail_view_qppdnn on master_join_rjwies.target_id = service_callsigndetail_view_qppdnn.id
left join master_join master_join_wxtkor on service.firefightingservice_ts.id = master_join_wxtkor.source_id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_hbkyci on master_join_wxtkor.target_id = service_radiocommunicationchannel_pt_hbkyci.id
left join master_join master_join_jiamjs on service.firefightingservice_ts.id = master_join_jiamjs.source_id
left join shared.contactinformation_view shared_contactinformation_view_xbaddc on master_join_jiamjs.target_id = shared_contactinformation_view_xbaddc.id
left join master_join master_join_rwxvud on service.firefightingservice_ts.id = master_join_rwxvud.source_id
left join service.serviceoperationalstatus_view service_serviceoperationalstatus_view_oeqbth on master_join_rwxvud.target_id = service_serviceoperationalstatus_view_oeqbth.id
left join master_join master_join_vwrqrv on service.firefightingservice_ts.id = master_join_vwrqrv.source_id
left join notes.note_view notes_note_view_umrexq on master_join_vwrqrv.target_id = notes_note_view_umrexq.id
left join master_join master_join_mtwnvb on service.firefightingservice_ts.id = master_join_mtwnvb.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_wdjuui on master_join_mtwnvb.target_id = airport_heliport_airportheliport_pt_wdjuui.id
where service.firefightingservice.feature_status = 'APPROVED'
  and service.firefightingservice_ts.feature_status = 'APPROVED'
group by
    service.firefightingservice.id,
    service.firefightingservice_ts.id,
    service.firefightingservice_tsp.id,
    service.firefightingservice.identifier,
    service.firefightingservice_ts.interpretation,
    service.firefightingservice_ts.sequence_number,
    service.firefightingservice_ts.correction_number,
    service.firefightingservice_ts.valid_time_begin,
    service.firefightingservice_ts.valid_time_end,
    service.firefightingservice_ts.feature_lifetime_begin,
    service.firefightingservice_ts.feature_lifetime_end,
    service.firefightingservice_ts.flightoperations_value,
    service.firefightingservice_ts.flightoperations_nilreason,
    service.firefightingservice_ts.rank_value,
    service.firefightingservice_ts.rank_nilreason,
    service.firefightingservice_ts.complianticao_value,
    service.firefightingservice_ts.complianticao_nilreason,
    service.firefightingservice_ts.name_value,
    service.firefightingservice_ts.name_nilreason,
    service.firefightingservice_ts.category_value,
    service.firefightingservice_ts.category_nilreason,
    service.firefightingservice_ts.standard_value,
    service.firefightingservice_ts.standard_nilreason,
    geometry_elevatedpoint_view_tlvxat.geom,
    geometry_elevatedpoint_view_tlvxat.elevation,
    geometry_elevatedpoint_view_tlvxat.geoidUndulation,
    geometry_elevatedpoint_view_tlvxat.verticalDatum,
    geometry_elevatedpoint_view_tlvxat.verticalAccuracy,
    geometry_elevatedpoint_view_tlvxat.horizontalAccuracy,
    organisation_unit_pt_xosvmi.title,
    organisation_unit_pt_xosvmi.nilreason[1],
    organisation_unit_pt_xosvmi.href
order by firefightingservice.identifier, firefightingservice_ts.sequence_number, firefightingservice_ts.correction_number DESC;
-- FlightRestrictionTimeSliceType
-- ['routes.flightrestrictionroute_view', 'notes.note_view']
create or replace view routes.flightrestriction_view as
select distinct on (flightrestriction.identifier,flightrestriction_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    routes.flightrestriction.id,
    routes.flightrestriction_ts.id as ts_id,
    routes.flightrestriction_tsp.id as tsp_id,
    routes.flightrestriction.identifier,
    routes.flightrestriction_ts.interpretation,
    routes.flightrestriction_ts.sequence_number,
    routes.flightrestriction_ts.correction_number,
    routes.flightrestriction_ts.valid_time_begin,
    routes.flightrestriction_ts.valid_time_end,
    routes.flightrestriction_ts.feature_lifetime_begin,
    routes.flightrestriction_ts.feature_lifetime_end,
    coalesce(cast(routes.flightrestriction_ts.designator_value as varchar), '(' || routes.flightrestriction_ts.designator_nilreason || ')') as designator,
    coalesce(cast(routes.flightrestriction_ts.type_value as varchar), '(' || routes.flightrestriction_ts.type_nilreason || ')') as type,
    coalesce(cast(routes.flightrestriction_ts.instruction_value as varchar), '(' || routes.flightrestriction_ts.instruction_nilreason || ')') as instruction,
    coalesce(cast(routes_flightconditioncombination_pt_fwlrad.title as varchar), '(' || routes_flightconditioncombination_pt_fwlrad.nilreason[1] || ')') AS flight,
    routes_flightconditioncombination_pt_fwlrad.href AS flight_href,
    jsonb_agg(routes_flightrestrictionroute_view_ynvcyt.id) AS regulatedroute,
    jsonb_agg(notes_note_view_ejtkfe.*) AS flightrestriction_annotation
from routes.flightrestriction 
inner join master_join mj2 on routes.flightrestriction.id = mj2.source_id
inner join routes.flightrestriction_tsp on mj2.target_id = routes.flightrestriction_tsp.id
inner join routes.flightrestriction_ts on routes.flightrestriction_tsp.flightrestrictiontimeslice_id = routes.flightrestriction_ts.id
left join routes.flightconditioncombination_pt routes_flightconditioncombination_pt_fwlrad on routes.flightrestriction_ts.flight_id = routes_flightconditioncombination_pt_fwlrad.id
left join master_join master_join_byxsoh on routes.flightrestriction_ts.id = master_join_byxsoh.source_id
left join routes.flightrestrictionroute_view routes_flightrestrictionroute_view_ynvcyt on master_join_byxsoh.target_id = routes_flightrestrictionroute_view_ynvcyt.id
left join master_join master_join_imfksp on routes.flightrestriction_ts.id = master_join_imfksp.source_id
left join notes.note_view notes_note_view_ejtkfe on master_join_imfksp.target_id = notes_note_view_ejtkfe.id
where routes.flightrestriction.feature_status = 'APPROVED'
  and routes.flightrestriction_ts.feature_status = 'APPROVED'
group by
    routes.flightrestriction.id,
    routes.flightrestriction_ts.id,
    routes.flightrestriction_tsp.id,
    routes.flightrestriction.identifier,
    routes.flightrestriction_ts.interpretation,
    routes.flightrestriction_ts.sequence_number,
    routes.flightrestriction_ts.correction_number,
    routes.flightrestriction_ts.valid_time_begin,
    routes.flightrestriction_ts.valid_time_end,
    routes.flightrestriction_ts.feature_lifetime_begin,
    routes.flightrestriction_ts.feature_lifetime_end,
    routes.flightrestriction_ts.designator_value,
    routes.flightrestriction_ts.designator_nilreason,
    routes.flightrestriction_ts.type_value,
    routes.flightrestriction_ts.type_nilreason,
    routes.flightrestriction_ts.instruction_value,
    routes.flightrestriction_ts.instruction_nilreason,
    routes_flightconditioncombination_pt_fwlrad.title,
    routes_flightconditioncombination_pt_fwlrad.nilreason[1],
    routes_flightconditioncombination_pt_fwlrad.href
order by flightrestriction.identifier, flightrestriction_ts.sequence_number, flightrestriction_ts.correction_number DESC;
-- FloatingDockSiteTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view']
create or replace view airport_heliport.floatingdocksite_view as
select distinct on (floatingdocksite.identifier,floatingdocksite_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.floatingdocksite.id,
    airport_heliport.floatingdocksite_ts.id as ts_id,
    airport_heliport.floatingdocksite_tsp.id as tsp_id,
    airport_heliport.floatingdocksite.identifier,
    airport_heliport.floatingdocksite_ts.interpretation,
    airport_heliport.floatingdocksite_ts.sequence_number,
    airport_heliport.floatingdocksite_ts.correction_number,
    airport_heliport.floatingdocksite_ts.valid_time_begin,
    airport_heliport.floatingdocksite_ts.valid_time_end,
    airport_heliport.floatingdocksite_ts.feature_lifetime_begin,
    airport_heliport.floatingdocksite_ts.feature_lifetime_end,
    geometry_elevatedsurface_view_vdfxnu.geom AS geom,
    geometry_elevatedsurface_view_vdfxnu.elevation,
    geometry_elevatedsurface_view_vdfxnu.geoidUndulation,
    geometry_elevatedsurface_view_vdfxnu.verticalDatum,
    geometry_elevatedsurface_view_vdfxnu.verticalAccuracy,
    geometry_elevatedsurface_view_vdfxnu.horizontalAccuracy,
    jsonb_agg(notes_note_view_rsyafc.*) AS floatingdocksite_annotation
from airport_heliport.floatingdocksite 
inner join master_join mj2 on airport_heliport.floatingdocksite.id = mj2.source_id
inner join airport_heliport.floatingdocksite_tsp on mj2.target_id = airport_heliport.floatingdocksite_tsp.id
inner join airport_heliport.floatingdocksite_ts on airport_heliport.floatingdocksite_tsp.floatingdocksitetimeslice_id = airport_heliport.floatingdocksite_ts.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_vdfxnu on airport_heliport.floatingdocksite_ts.extent_id = geometry_elevatedsurface_view_vdfxnu.id
left join master_join master_join_gxplai on airport_heliport.floatingdocksite_ts.id = master_join_gxplai.source_id
left join notes.note_view notes_note_view_rsyafc on master_join_gxplai.target_id = notes_note_view_rsyafc.id
where airport_heliport.floatingdocksite.feature_status = 'APPROVED'
  and airport_heliport.floatingdocksite_ts.feature_status = 'APPROVED'
group by
    airport_heliport.floatingdocksite.id,
    airport_heliport.floatingdocksite_ts.id,
    airport_heliport.floatingdocksite_tsp.id,
    airport_heliport.floatingdocksite.identifier,
    airport_heliport.floatingdocksite_ts.interpretation,
    airport_heliport.floatingdocksite_ts.sequence_number,
    airport_heliport.floatingdocksite_ts.correction_number,
    airport_heliport.floatingdocksite_ts.valid_time_begin,
    airport_heliport.floatingdocksite_ts.valid_time_end,
    airport_heliport.floatingdocksite_ts.feature_lifetime_begin,
    airport_heliport.floatingdocksite_ts.feature_lifetime_end,
    geometry_elevatedsurface_view_vdfxnu.geom,
    geometry_elevatedsurface_view_vdfxnu.elevation,
    geometry_elevatedsurface_view_vdfxnu.geoidUndulation,
    geometry_elevatedsurface_view_vdfxnu.verticalDatum,
    geometry_elevatedsurface_view_vdfxnu.verticalAccuracy,
    geometry_elevatedsurface_view_vdfxnu.horizontalAccuracy
order by floatingdocksite.identifier, floatingdocksite_ts.sequence_number, floatingdocksite_ts.correction_number DESC;
-- GeoBorderTimeSliceType
-- ['geometry.curve_view', 'notes.note_view']
create or replace view airspace.geoborder_view as
select distinct on (geoborder.identifier,geoborder_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airspace.geoborder.id,
    airspace.geoborder_ts.id as ts_id,
    airspace.geoborder_tsp.id as tsp_id,
    airspace.geoborder.identifier,
    airspace.geoborder_ts.interpretation,
    airspace.geoborder_ts.sequence_number,
    airspace.geoborder_ts.correction_number,
    airspace.geoborder_ts.valid_time_begin,
    airspace.geoborder_ts.valid_time_end,
    airspace.geoborder_ts.feature_lifetime_begin,
    airspace.geoborder_ts.feature_lifetime_end,
    coalesce(cast(airspace.geoborder_ts.name_value as varchar), '(' || airspace.geoborder_ts.name_nilreason || ')') as name,
    coalesce(cast(airspace.geoborder_ts.type_value as varchar), '(' || airspace.geoborder_ts.type_nilreason || ')') as type,
    geometry_curve_view_iladke.geom AS geom,
    jsonb_agg(notes_note_view_ymqnev.*) AS geoborder_annotation
from airspace.geoborder 
inner join master_join mj2 on airspace.geoborder.id = mj2.source_id
inner join airspace.geoborder_tsp on mj2.target_id = airspace.geoborder_tsp.id
inner join airspace.geoborder_ts on airspace.geoborder_tsp.geobordertimeslice_id = airspace.geoborder_ts.id
left join geometry.curve_view geometry_curve_view_iladke on airspace.geoborder_ts.border_id = geometry_curve_view_iladke.id
left join master_join master_join_okdtuq on airspace.geoborder_ts.id = master_join_okdtuq.source_id
left join notes.note_view notes_note_view_ymqnev on master_join_okdtuq.target_id = notes_note_view_ymqnev.id
where airspace.geoborder.feature_status = 'APPROVED'
  and airspace.geoborder_ts.feature_status = 'APPROVED'
group by
    airspace.geoborder.id,
    airspace.geoborder_ts.id,
    airspace.geoborder_tsp.id,
    airspace.geoborder.identifier,
    airspace.geoborder_ts.interpretation,
    airspace.geoborder_ts.sequence_number,
    airspace.geoborder_ts.correction_number,
    airspace.geoborder_ts.valid_time_begin,
    airspace.geoborder_ts.valid_time_end,
    airspace.geoborder_ts.feature_lifetime_begin,
    airspace.geoborder_ts.feature_lifetime_end,
    airspace.geoborder_ts.name_value,
    airspace.geoborder_ts.name_nilreason,
    airspace.geoborder_ts.type_value,
    airspace.geoborder_ts.type_nilreason,
    geometry_curve_view_iladke.geom
order by geoborder.identifier, geoborder_ts.sequence_number, geoborder_ts.correction_number DESC;
-- GlidepathTimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.glidepath_view as
select distinct on (glidepath.identifier,glidepath_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.glidepath.id,
    navaids_points.glidepath_ts.id as ts_id,
    navaids_points.glidepath_tsp.id as tsp_id,
    navaids_points.glidepath.identifier,
    navaids_points.glidepath_ts.interpretation,
    navaids_points.glidepath_ts.sequence_number,
    navaids_points.glidepath_ts.correction_number,
    navaids_points.glidepath_ts.valid_time_begin,
    navaids_points.glidepath_ts.valid_time_end,
    navaids_points.glidepath_ts.feature_lifetime_begin,
    navaids_points.glidepath_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.glidepath_ts.designator_value as varchar), '(' || navaids_points.glidepath_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.glidepath_ts.name_value as varchar), '(' || navaids_points.glidepath_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.glidepath_ts.emissionclass_value as varchar), '(' || navaids_points.glidepath_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.glidepath_ts.mobile_value as varchar), '(' || navaids_points.glidepath_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.glidepath_ts.magneticvariation_value as varchar), '(' || navaids_points.glidepath_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.glidepath_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.glidepath_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.glidepath_ts.datemagneticvariation_value as varchar), '(' || navaids_points.glidepath_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.glidepath_ts.flightchecked_value as varchar), '(' || navaids_points.glidepath_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.glidepath_ts.slope_value as varchar), '(' || navaids_points.glidepath_ts.slope_nilreason || ')') as slope,
    coalesce(cast(navaids_points.glidepath_ts.angleaccuracy_value as varchar), '(' || navaids_points.glidepath_ts.angleaccuracy_nilreason || ')') as angleaccuracy,
    coalesce(cast(navaids_points.glidepath_ts.frequency_value as varchar) || ' ' || navaids_points.glidepath_ts.frequency_uom, '(' || navaids_points.glidepath_ts.frequency_nilreason || ')') as frequency,
    coalesce(cast(navaids_points.glidepath_ts.rdh_value as varchar) || ' ' || navaids_points.glidepath_ts.rdh_uom, '(' || navaids_points.glidepath_ts.rdh_nilreason || ')') as rdh,
    coalesce(cast(navaids_points.glidepath_ts.rdhaccuracy_value as varchar) || ' ' || navaids_points.glidepath_ts.rdhaccuracy_uom, '(' || navaids_points.glidepath_ts.rdhaccuracy_nilreason || ')') as rdhaccuracy,
    geometry_elevatedpoint_view_trbkwf.geom AS geom,
    ST_X(geometry_elevatedpoint_view_trbkwf.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_trbkwf.geom) AS latitude,
    geometry_elevatedpoint_view_trbkwf.elevation,
    geometry_elevatedpoint_view_trbkwf.geoidUndulation,
    geometry_elevatedpoint_view_trbkwf.verticalDatum,
    geometry_elevatedpoint_view_trbkwf.verticalAccuracy,
    geometry_elevatedpoint_view_trbkwf.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_upszey.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_ywznwk.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_szqmgf.id) AS availability,
    jsonb_agg(notes_note_view_bqkpld.*) AS glidepath_annotation
from navaids_points.glidepath 
inner join master_join mj2 on navaids_points.glidepath.id = mj2.source_id
inner join navaids_points.glidepath_tsp on mj2.target_id = navaids_points.glidepath_tsp.id
inner join navaids_points.glidepath_ts on navaids_points.glidepath_tsp.glidepathtimeslice_id = navaids_points.glidepath_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_trbkwf on navaids_points.glidepath_ts.location_id = geometry_elevatedpoint_view_trbkwf.id
left join master_join master_join_vmgyec on navaids_points.glidepath_ts.id = master_join_vmgyec.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_upszey on master_join_vmgyec.target_id = navaids_points_authorityfornavaidequipment_view_upszey.id
left join master_join master_join_zkmsiy on navaids_points.glidepath_ts.id = master_join_zkmsiy.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_ywznwk on master_join_zkmsiy.target_id = navaids_points_navaidequipmentmonitoring_view_ywznwk.id
left join master_join master_join_mddbft on navaids_points.glidepath_ts.id = master_join_mddbft.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_szqmgf on master_join_mddbft.target_id = navaids_points_navaidoperationalstatus_view_szqmgf.id
left join master_join master_join_lrfsuw on navaids_points.glidepath_ts.id = master_join_lrfsuw.source_id
left join notes.note_view notes_note_view_bqkpld on master_join_lrfsuw.target_id = notes_note_view_bqkpld.id
where navaids_points.glidepath.feature_status = 'APPROVED'
  and navaids_points.glidepath_ts.feature_status = 'APPROVED'
group by
    navaids_points.glidepath.id,
    navaids_points.glidepath_ts.id,
    navaids_points.glidepath_tsp.id,
    navaids_points.glidepath.identifier,
    navaids_points.glidepath_ts.interpretation,
    navaids_points.glidepath_ts.sequence_number,
    navaids_points.glidepath_ts.correction_number,
    navaids_points.glidepath_ts.valid_time_begin,
    navaids_points.glidepath_ts.valid_time_end,
    navaids_points.glidepath_ts.feature_lifetime_begin,
    navaids_points.glidepath_ts.feature_lifetime_end,
    navaids_points.glidepath_ts.designator_value,
    navaids_points.glidepath_ts.designator_nilreason,
    navaids_points.glidepath_ts.name_value,
    navaids_points.glidepath_ts.name_nilreason,
    navaids_points.glidepath_ts.emissionclass_value,
    navaids_points.glidepath_ts.emissionclass_nilreason,
    navaids_points.glidepath_ts.mobile_value,
    navaids_points.glidepath_ts.mobile_nilreason,
    navaids_points.glidepath_ts.magneticvariation_value,
    navaids_points.glidepath_ts.magneticvariation_nilreason,
    navaids_points.glidepath_ts.magneticvariationaccuracy_value,
    navaids_points.glidepath_ts.magneticvariationaccuracy_nilreason,
    navaids_points.glidepath_ts.datemagneticvariation_value,
    navaids_points.glidepath_ts.datemagneticvariation_nilreason,
    navaids_points.glidepath_ts.flightchecked_value,
    navaids_points.glidepath_ts.flightchecked_nilreason,
    navaids_points.glidepath_ts.slope_value,
    navaids_points.glidepath_ts.slope_nilreason,
    navaids_points.glidepath_ts.angleaccuracy_value,
    navaids_points.glidepath_ts.angleaccuracy_nilreason,
    navaids_points.glidepath_ts.frequency_value,
    navaids_points.glidepath_ts.frequency_uom,
    navaids_points.glidepath_ts.frequency_nilreason,
    navaids_points.glidepath_ts.rdh_value,
    navaids_points.glidepath_ts.rdh_uom,
    navaids_points.glidepath_ts.rdh_nilreason,
    navaids_points.glidepath_ts.rdhaccuracy_value,
    navaids_points.glidepath_ts.rdhaccuracy_uom,
    navaids_points.glidepath_ts.rdhaccuracy_nilreason,
    geometry_elevatedpoint_view_trbkwf.geom,
    geometry_elevatedpoint_view_trbkwf.elevation,
    geometry_elevatedpoint_view_trbkwf.geoidUndulation,
    geometry_elevatedpoint_view_trbkwf.verticalDatum,
    geometry_elevatedpoint_view_trbkwf.verticalAccuracy,
    geometry_elevatedpoint_view_trbkwf.horizontalAccuracy
order by glidepath.identifier, glidepath_ts.sequence_number, glidepath_ts.correction_number DESC;
-- GroundTrafficControlServiceTimeSliceType
-- ['service.serviceoperationalstatus_view', 'notes.note_view', 'shared.contactinformation_view', 'geometry.elevatedpoint_view', 'service.callsigndetail_view']
create or replace view service.groundtrafficcontrolservice_view as
select distinct on (groundtrafficcontrolservice.identifier,groundtrafficcontrolservice_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.groundtrafficcontrolservice.id,
    service.groundtrafficcontrolservice_ts.id as ts_id,
    service.groundtrafficcontrolservice_tsp.id as tsp_id,
    service.groundtrafficcontrolservice.identifier,
    service.groundtrafficcontrolservice_ts.interpretation,
    service.groundtrafficcontrolservice_ts.sequence_number,
    service.groundtrafficcontrolservice_ts.correction_number,
    service.groundtrafficcontrolservice_ts.valid_time_begin,
    service.groundtrafficcontrolservice_ts.valid_time_end,
    service.groundtrafficcontrolservice_ts.feature_lifetime_begin,
    service.groundtrafficcontrolservice_ts.feature_lifetime_end,
    coalesce(cast(service.groundtrafficcontrolservice_ts.flightoperations_value as varchar), '(' || service.groundtrafficcontrolservice_ts.flightoperations_nilreason || ')') as flightoperations,
    coalesce(cast(service.groundtrafficcontrolservice_ts.rank_value as varchar), '(' || service.groundtrafficcontrolservice_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.groundtrafficcontrolservice_ts.complianticao_value as varchar), '(' || service.groundtrafficcontrolservice_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(service.groundtrafficcontrolservice_ts.name_value as varchar), '(' || service.groundtrafficcontrolservice_ts.name_nilreason || ')') as name,
    coalesce(cast(service.groundtrafficcontrolservice_ts.radarassisted_value as varchar), '(' || service.groundtrafficcontrolservice_ts.radarassisted_nilreason || ')') as radarassisted,
    coalesce(cast(service.groundtrafficcontrolservice_ts.datalinkenabled_value as varchar), '(' || service.groundtrafficcontrolservice_ts.datalinkenabled_nilreason || ')') as datalinkenabled,
    coalesce(cast(service.groundtrafficcontrolservice_ts.datalinkchannel_value as varchar), '(' || service.groundtrafficcontrolservice_ts.datalinkchannel_nilreason || ')') as datalinkchannel,
    coalesce(cast(service.groundtrafficcontrolservice_ts.type_value as varchar), '(' || service.groundtrafficcontrolservice_ts.type_nilreason || ')') as type,
    geometry_elevatedpoint_view_ajleqc.geom AS geom,
    ST_X(geometry_elevatedpoint_view_ajleqc.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_ajleqc.geom) AS latitude,
    geometry_elevatedpoint_view_ajleqc.elevation,
    geometry_elevatedpoint_view_ajleqc.geoidUndulation,
    geometry_elevatedpoint_view_ajleqc.verticalDatum,
    geometry_elevatedpoint_view_ajleqc.verticalAccuracy,
    geometry_elevatedpoint_view_ajleqc.horizontalAccuracy,
    coalesce(cast(organisation_unit_pt_ylxgtt.title as varchar), '(' || organisation_unit_pt_ylxgtt.nilreason[1] || ')') AS serviceprovider,
    organisation_unit_pt_ylxgtt.href AS serviceprovider_href,
    coalesce(cast(airport_heliport_airportheliport_pt_fakepb.title as varchar), '(' || airport_heliport_airportheliport_pt_fakepb.nilreason[1] || ')') AS clientairport,
    airport_heliport_airportheliport_pt_fakepb.href AS clientairport_href,
    jsonb_agg(service_callsigndetail_view_nirpxn.id) AS callsign,
    jsonb_build_object('id', service_radiocommunicationchannel_pt_sajqzc.id,
    'title', coalesce(cast(service_radiocommunicationchannel_pt_sajqzc.title AS varchar), '(' || service_radiocommunicationchannel_pt_sajqzc.nilreason[1] || ')'),
    'href', service_radiocommunicationchannel_pt_sajqzc.href) AS radiocommunication,
    jsonb_agg(service_serviceoperationalstatus_view_avigtm.id) AS availability,
    jsonb_agg(notes_note_view_qfxwek.*) AS groundtrafficcontrolservice_annotation
from service.groundtrafficcontrolservice 
inner join master_join mj2 on service.groundtrafficcontrolservice.id = mj2.source_id
inner join service.groundtrafficcontrolservice_tsp on mj2.target_id = service.groundtrafficcontrolservice_tsp.id
inner join service.groundtrafficcontrolservice_ts on service.groundtrafficcontrolservice_tsp.groundtrafficcontrolservicetimeslice_id = service.groundtrafficcontrolservice_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_ajleqc on service.groundtrafficcontrolservice_ts.location_id = geometry_elevatedpoint_view_ajleqc.id
left join organisation.unit_pt organisation_unit_pt_ylxgtt on service.groundtrafficcontrolservice_ts.serviceprovider_id = organisation_unit_pt_ylxgtt.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_fakepb on service.groundtrafficcontrolservice_ts.clientairport_id = airport_heliport_airportheliport_pt_fakepb.id
left join master_join master_join_fraepf on service.groundtrafficcontrolservice_ts.id = master_join_fraepf.source_id
left join service.callsigndetail_view service_callsigndetail_view_nirpxn on master_join_fraepf.target_id = service_callsigndetail_view_nirpxn.id
left join master_join master_join_hwgvsv on service.groundtrafficcontrolservice_ts.id = master_join_hwgvsv.source_id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_sajqzc on master_join_hwgvsv.target_id = service_radiocommunicationchannel_pt_sajqzc.id
left join master_join master_join_tdgzig on service.groundtrafficcontrolservice_ts.id = master_join_tdgzig.source_id
left join shared.contactinformation_view shared_contactinformation_view_xhheey on master_join_tdgzig.target_id = shared_contactinformation_view_xhheey.id
left join master_join master_join_suemtn on service.groundtrafficcontrolservice_ts.id = master_join_suemtn.source_id
left join service.serviceoperationalstatus_view service_serviceoperationalstatus_view_avigtm on master_join_suemtn.target_id = service_serviceoperationalstatus_view_avigtm.id
left join master_join master_join_pudtop on service.groundtrafficcontrolservice_ts.id = master_join_pudtop.source_id
left join notes.note_view notes_note_view_qfxwek on master_join_pudtop.target_id = notes_note_view_qfxwek.id
where service.groundtrafficcontrolservice.feature_status = 'APPROVED'
  and service.groundtrafficcontrolservice_ts.feature_status = 'APPROVED'
group by
    service.groundtrafficcontrolservice.id,
    service.groundtrafficcontrolservice_ts.id,
    service.groundtrafficcontrolservice_tsp.id,
    service.groundtrafficcontrolservice.identifier,
    service.groundtrafficcontrolservice_ts.interpretation,
    service.groundtrafficcontrolservice_ts.sequence_number,
    service.groundtrafficcontrolservice_ts.correction_number,
    service.groundtrafficcontrolservice_ts.valid_time_begin,
    service.groundtrafficcontrolservice_ts.valid_time_end,
    service.groundtrafficcontrolservice_ts.feature_lifetime_begin,
    service.groundtrafficcontrolservice_ts.feature_lifetime_end,
    service.groundtrafficcontrolservice_ts.flightoperations_value,
    service.groundtrafficcontrolservice_ts.flightoperations_nilreason,
    service.groundtrafficcontrolservice_ts.rank_value,
    service.groundtrafficcontrolservice_ts.rank_nilreason,
    service.groundtrafficcontrolservice_ts.complianticao_value,
    service.groundtrafficcontrolservice_ts.complianticao_nilreason,
    service.groundtrafficcontrolservice_ts.name_value,
    service.groundtrafficcontrolservice_ts.name_nilreason,
    service.groundtrafficcontrolservice_ts.radarassisted_value,
    service.groundtrafficcontrolservice_ts.radarassisted_nilreason,
    service.groundtrafficcontrolservice_ts.datalinkenabled_value,
    service.groundtrafficcontrolservice_ts.datalinkenabled_nilreason,
    service.groundtrafficcontrolservice_ts.datalinkchannel_value,
    service.groundtrafficcontrolservice_ts.datalinkchannel_nilreason,
    service.groundtrafficcontrolservice_ts.type_value,
    service.groundtrafficcontrolservice_ts.type_nilreason,
    geometry_elevatedpoint_view_ajleqc.geom,
    geometry_elevatedpoint_view_ajleqc.elevation,
    geometry_elevatedpoint_view_ajleqc.geoidUndulation,
    geometry_elevatedpoint_view_ajleqc.verticalDatum,
    geometry_elevatedpoint_view_ajleqc.verticalAccuracy,
    geometry_elevatedpoint_view_ajleqc.horizontalAccuracy,
    organisation_unit_pt_ylxgtt.title,
    organisation_unit_pt_ylxgtt.nilreason[1],
    organisation_unit_pt_ylxgtt.href,
    airport_heliport_airportheliport_pt_fakepb.title,
    airport_heliport_airportheliport_pt_fakepb.nilreason[1],
    airport_heliport_airportheliport_pt_fakepb.href
order by groundtrafficcontrolservice.identifier, groundtrafficcontrolservice_ts.sequence_number, groundtrafficcontrolservice_ts.correction_number DESC;
-- GuidanceLineLightSystemTimeSliceType
-- ['shared.lightelement_view', 'airport_heliport.groundlightingavailability_view', 'notes.note_view']
create or replace view airport_heliport.guidancelinelightsystem_view as
select distinct on (guidancelinelightsystem.identifier,guidancelinelightsystem_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.guidancelinelightsystem.id,
    airport_heliport.guidancelinelightsystem_ts.id as ts_id,
    airport_heliport.guidancelinelightsystem_tsp.id as tsp_id,
    airport_heliport.guidancelinelightsystem.identifier,
    airport_heliport.guidancelinelightsystem_ts.interpretation,
    airport_heliport.guidancelinelightsystem_ts.sequence_number,
    airport_heliport.guidancelinelightsystem_ts.correction_number,
    airport_heliport.guidancelinelightsystem_ts.valid_time_begin,
    airport_heliport.guidancelinelightsystem_ts.valid_time_end,
    airport_heliport.guidancelinelightsystem_ts.feature_lifetime_begin,
    airport_heliport.guidancelinelightsystem_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.guidancelinelightsystem_ts.emergencylighting_value as varchar), '(' || airport_heliport.guidancelinelightsystem_ts.emergencylighting_nilreason || ')') as emergencylighting,
    coalesce(cast(airport_heliport.guidancelinelightsystem_ts.intensitylevel_value as varchar), '(' || airport_heliport.guidancelinelightsystem_ts.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(airport_heliport.guidancelinelightsystem_ts.colour_value as varchar), '(' || airport_heliport.guidancelinelightsystem_ts.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport_guidanceline_pt_gydeqn.title as varchar), '(' || airport_heliport_guidanceline_pt_gydeqn.nilreason[1] || ')') AS lightedguidanceline,
    airport_heliport_guidanceline_pt_gydeqn.href AS lightedguidanceline_href,
    jsonb_agg(shared_lightelement_view_inhbvz.id) AS element,
    jsonb_agg(airport_heliport_groundlightingavailability_view_kzirbu.id) AS availability,
    jsonb_agg(notes_note_view_vuwjqo.*) AS guidancelinelightsystem_annotation
from airport_heliport.guidancelinelightsystem 
inner join master_join mj2 on airport_heliport.guidancelinelightsystem.id = mj2.source_id
inner join airport_heliport.guidancelinelightsystem_tsp on mj2.target_id = airport_heliport.guidancelinelightsystem_tsp.id
inner join airport_heliport.guidancelinelightsystem_ts on airport_heliport.guidancelinelightsystem_tsp.guidancelinelightsystemtimeslice_id = airport_heliport.guidancelinelightsystem_ts.id
left join airport_heliport.guidanceline_pt airport_heliport_guidanceline_pt_gydeqn on airport_heliport.guidancelinelightsystem_ts.lightedguidanceline_id = airport_heliport_guidanceline_pt_gydeqn.id
left join master_join master_join_fbgrpi on airport_heliport.guidancelinelightsystem_ts.id = master_join_fbgrpi.source_id
left join shared.lightelement_view shared_lightelement_view_inhbvz on master_join_fbgrpi.target_id = shared_lightelement_view_inhbvz.id
left join master_join master_join_qrdlro on airport_heliport.guidancelinelightsystem_ts.id = master_join_qrdlro.source_id
left join airport_heliport.groundlightingavailability_view airport_heliport_groundlightingavailability_view_kzirbu on master_join_qrdlro.target_id = airport_heliport_groundlightingavailability_view_kzirbu.id
left join master_join master_join_rgrjow on airport_heliport.guidancelinelightsystem_ts.id = master_join_rgrjow.source_id
left join notes.note_view notes_note_view_vuwjqo on master_join_rgrjow.target_id = notes_note_view_vuwjqo.id
where airport_heliport.guidancelinelightsystem.feature_status = 'APPROVED'
  and airport_heliport.guidancelinelightsystem_ts.feature_status = 'APPROVED'
group by
    airport_heliport.guidancelinelightsystem.id,
    airport_heliport.guidancelinelightsystem_ts.id,
    airport_heliport.guidancelinelightsystem_tsp.id,
    airport_heliport.guidancelinelightsystem.identifier,
    airport_heliport.guidancelinelightsystem_ts.interpretation,
    airport_heliport.guidancelinelightsystem_ts.sequence_number,
    airport_heliport.guidancelinelightsystem_ts.correction_number,
    airport_heliport.guidancelinelightsystem_ts.valid_time_begin,
    airport_heliport.guidancelinelightsystem_ts.valid_time_end,
    airport_heliport.guidancelinelightsystem_ts.feature_lifetime_begin,
    airport_heliport.guidancelinelightsystem_ts.feature_lifetime_end,
    airport_heliport.guidancelinelightsystem_ts.emergencylighting_value,
    airport_heliport.guidancelinelightsystem_ts.emergencylighting_nilreason,
    airport_heliport.guidancelinelightsystem_ts.intensitylevel_value,
    airport_heliport.guidancelinelightsystem_ts.intensitylevel_nilreason,
    airport_heliport.guidancelinelightsystem_ts.colour_value,
    airport_heliport.guidancelinelightsystem_ts.colour_nilreason,
    airport_heliport_guidanceline_pt_gydeqn.title,
    airport_heliport_guidanceline_pt_gydeqn.nilreason[1],
    airport_heliport_guidanceline_pt_gydeqn.href
order by guidancelinelightsystem.identifier, guidancelinelightsystem_ts.sequence_number, guidancelinelightsystem_ts.correction_number DESC;
-- GuidanceLineMarkingTimeSliceType
-- ['notes.note_view', 'airport_heliport.markingelement_view']
create or replace view airport_heliport.guidancelinemarking_view as
select distinct on (guidancelinemarking.identifier,guidancelinemarking_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.guidancelinemarking.id,
    airport_heliport.guidancelinemarking_ts.id as ts_id,
    airport_heliport.guidancelinemarking_tsp.id as tsp_id,
    airport_heliport.guidancelinemarking.identifier,
    airport_heliport.guidancelinemarking_ts.interpretation,
    airport_heliport.guidancelinemarking_ts.sequence_number,
    airport_heliport.guidancelinemarking_ts.correction_number,
    airport_heliport.guidancelinemarking_ts.valid_time_begin,
    airport_heliport.guidancelinemarking_ts.valid_time_end,
    airport_heliport.guidancelinemarking_ts.feature_lifetime_begin,
    airport_heliport.guidancelinemarking_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.guidancelinemarking_ts.markingicaostandard_value as varchar), '(' || airport_heliport.guidancelinemarking_ts.markingicaostandard_nilreason || ')') as markingicaostandard,
    coalesce(cast(airport_heliport.guidancelinemarking_ts.condition_value as varchar), '(' || airport_heliport.guidancelinemarking_ts.condition_nilreason || ')') as condition,
    coalesce(cast(airport_heliport_guidanceline_pt_bgatny.title as varchar), '(' || airport_heliport_guidanceline_pt_bgatny.nilreason[1] || ')') AS markedguidanceline,
    airport_heliport_guidanceline_pt_bgatny.href AS markedguidanceline_href,
    jsonb_agg(airport_heliport_markingelement_view_mivryl.id) AS element,
    jsonb_agg(notes_note_view_pdsbkl.*) AS guidancelinemarking_annotation
from airport_heliport.guidancelinemarking 
inner join master_join mj2 on airport_heliport.guidancelinemarking.id = mj2.source_id
inner join airport_heliport.guidancelinemarking_tsp on mj2.target_id = airport_heliport.guidancelinemarking_tsp.id
inner join airport_heliport.guidancelinemarking_ts on airport_heliport.guidancelinemarking_tsp.guidancelinemarkingtimeslice_id = airport_heliport.guidancelinemarking_ts.id
left join airport_heliport.guidanceline_pt airport_heliport_guidanceline_pt_bgatny on airport_heliport.guidancelinemarking_ts.markedguidanceline_id = airport_heliport_guidanceline_pt_bgatny.id
left join master_join master_join_dyqokv on airport_heliport.guidancelinemarking_ts.id = master_join_dyqokv.source_id
left join airport_heliport.markingelement_view airport_heliport_markingelement_view_mivryl on master_join_dyqokv.target_id = airport_heliport_markingelement_view_mivryl.id
left join master_join master_join_okegwe on airport_heliport.guidancelinemarking_ts.id = master_join_okegwe.source_id
left join notes.note_view notes_note_view_pdsbkl on master_join_okegwe.target_id = notes_note_view_pdsbkl.id
where airport_heliport.guidancelinemarking.feature_status = 'APPROVED'
  and airport_heliport.guidancelinemarking_ts.feature_status = 'APPROVED'
group by
    airport_heliport.guidancelinemarking.id,
    airport_heliport.guidancelinemarking_ts.id,
    airport_heliport.guidancelinemarking_tsp.id,
    airport_heliport.guidancelinemarking.identifier,
    airport_heliport.guidancelinemarking_ts.interpretation,
    airport_heliport.guidancelinemarking_ts.sequence_number,
    airport_heliport.guidancelinemarking_ts.correction_number,
    airport_heliport.guidancelinemarking_ts.valid_time_begin,
    airport_heliport.guidancelinemarking_ts.valid_time_end,
    airport_heliport.guidancelinemarking_ts.feature_lifetime_begin,
    airport_heliport.guidancelinemarking_ts.feature_lifetime_end,
    airport_heliport.guidancelinemarking_ts.markingicaostandard_value,
    airport_heliport.guidancelinemarking_ts.markingicaostandard_nilreason,
    airport_heliport.guidancelinemarking_ts.condition_value,
    airport_heliport.guidancelinemarking_ts.condition_nilreason,
    airport_heliport_guidanceline_pt_bgatny.title,
    airport_heliport_guidanceline_pt_bgatny.nilreason[1],
    airport_heliport_guidanceline_pt_bgatny.href
order by guidancelinemarking.identifier, guidancelinemarking_ts.sequence_number, guidancelinemarking_ts.correction_number DESC;
-- GuidanceLineTimeSliceType
-- ['geometry.elevatedcurve_view', 'notes.note_view']
create or replace view airport_heliport.guidanceline_view as
select distinct on (guidanceline.identifier,guidanceline_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.guidanceline.id,
    airport_heliport.guidanceline_ts.id as ts_id,
    airport_heliport.guidanceline_tsp.id as tsp_id,
    airport_heliport.guidanceline.identifier,
    airport_heliport.guidanceline_ts.interpretation,
    airport_heliport.guidanceline_ts.sequence_number,
    airport_heliport.guidanceline_ts.correction_number,
    airport_heliport.guidanceline_ts.valid_time_begin,
    airport_heliport.guidanceline_ts.valid_time_end,
    airport_heliport.guidanceline_ts.feature_lifetime_begin,
    airport_heliport.guidanceline_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.guidanceline_ts.designator_value as varchar), '(' || airport_heliport.guidanceline_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airport_heliport.guidanceline_ts.type_value as varchar), '(' || airport_heliport.guidanceline_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.guidanceline_ts.usagedirection_value as varchar), '(' || airport_heliport.guidanceline_ts.usagedirection_nilreason || ')') as usagedirection,
    coalesce(cast(airport_heliport.guidanceline_ts.maxspeed_value as varchar) || ' ' || airport_heliport.guidanceline_ts.maxspeed_uom, '(' || airport_heliport.guidanceline_ts.maxspeed_nilreason || ')') as maxspeed,
    geometry_elevatedcurve_view_qhqnuu.geom AS geom,
    geometry_elevatedcurve_view_qhqnuu.elevation,
    geometry_elevatedcurve_view_qhqnuu.geoidUndulation,
    geometry_elevatedcurve_view_qhqnuu.verticalDatum,
    geometry_elevatedcurve_view_qhqnuu.verticalAccuracy,
    geometry_elevatedcurve_view_qhqnuu.horizontalAccuracy,
    jsonb_build_object('id', airport_heliport_touchdownliftoff_pt_wtgbov.id,
    'title', coalesce(cast(airport_heliport_touchdownliftoff_pt_wtgbov.title AS varchar), '(' || airport_heliport_touchdownliftoff_pt_wtgbov.nilreason[1] || ')'),
    'href', airport_heliport_touchdownliftoff_pt_wtgbov.href) AS connectedtouchdownliftoff,
    jsonb_build_object('id', airport_heliport_runwaycentrelinepoint_pt_evazkx.id,
    'title', coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_evazkx.title AS varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_evazkx.nilreason[1] || ')'),
    'href', airport_heliport_runwaycentrelinepoint_pt_evazkx.href) AS connectedrunwaycentrelinepoint,
    jsonb_build_object('id', airport_heliport_apron_pt_eidhdi.id,
    'title', coalesce(cast(airport_heliport_apron_pt_eidhdi.title AS varchar), '(' || airport_heliport_apron_pt_eidhdi.nilreason[1] || ')'),
    'href', airport_heliport_apron_pt_eidhdi.href) AS connectedapron,
    jsonb_build_object('id', airport_heliport_aircraftstand_pt_dvcvak.id,
    'title', coalesce(cast(airport_heliport_aircraftstand_pt_dvcvak.title AS varchar), '(' || airport_heliport_aircraftstand_pt_dvcvak.nilreason[1] || ')'),
    'href', airport_heliport_aircraftstand_pt_dvcvak.href) AS connectedstand,
    jsonb_build_object('id', airport_heliport_taxiway_pt_wpdjow.id,
    'title', coalesce(cast(airport_heliport_taxiway_pt_wpdjow.title AS varchar), '(' || airport_heliport_taxiway_pt_wpdjow.nilreason[1] || ')'),
    'href', airport_heliport_taxiway_pt_wpdjow.href) AS connectedtaxiway,
    jsonb_agg(notes_note_view_iaemcl.*) AS guidanceline_annotation
from airport_heliport.guidanceline 
inner join master_join mj2 on airport_heliport.guidanceline.id = mj2.source_id
inner join airport_heliport.guidanceline_tsp on mj2.target_id = airport_heliport.guidanceline_tsp.id
inner join airport_heliport.guidanceline_ts on airport_heliport.guidanceline_tsp.guidancelinetimeslice_id = airport_heliport.guidanceline_ts.id
left join geometry.elevatedcurve_view geometry_elevatedcurve_view_qhqnuu on airport_heliport.guidanceline_ts.extent_id = geometry_elevatedcurve_view_qhqnuu.id
left join master_join master_join_xfesmu on airport_heliport.guidanceline_ts.id = master_join_xfesmu.source_id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_wtgbov on master_join_xfesmu.target_id = airport_heliport_touchdownliftoff_pt_wtgbov.id
left join master_join master_join_tfglyq on airport_heliport.guidanceline_ts.id = master_join_tfglyq.source_id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_evazkx on master_join_tfglyq.target_id = airport_heliport_runwaycentrelinepoint_pt_evazkx.id
left join master_join master_join_hoifzb on airport_heliport.guidanceline_ts.id = master_join_hoifzb.source_id
left join airport_heliport.apron_pt airport_heliport_apron_pt_eidhdi on master_join_hoifzb.target_id = airport_heliport_apron_pt_eidhdi.id
left join master_join master_join_lckvtj on airport_heliport.guidanceline_ts.id = master_join_lckvtj.source_id
left join airport_heliport.aircraftstand_pt airport_heliport_aircraftstand_pt_dvcvak on master_join_lckvtj.target_id = airport_heliport_aircraftstand_pt_dvcvak.id
left join master_join master_join_tffvnb on airport_heliport.guidanceline_ts.id = master_join_tffvnb.source_id
left join airport_heliport.taxiway_pt airport_heliport_taxiway_pt_wpdjow on master_join_tffvnb.target_id = airport_heliport_taxiway_pt_wpdjow.id
left join master_join master_join_doynew on airport_heliport.guidanceline_ts.id = master_join_doynew.source_id
left join notes.note_view notes_note_view_iaemcl on master_join_doynew.target_id = notes_note_view_iaemcl.id
where airport_heliport.guidanceline.feature_status = 'APPROVED'
  and airport_heliport.guidanceline_ts.feature_status = 'APPROVED'
group by
    airport_heliport.guidanceline.id,
    airport_heliport.guidanceline_ts.id,
    airport_heliport.guidanceline_tsp.id,
    airport_heliport.guidanceline.identifier,
    airport_heliport.guidanceline_ts.interpretation,
    airport_heliport.guidanceline_ts.sequence_number,
    airport_heliport.guidanceline_ts.correction_number,
    airport_heliport.guidanceline_ts.valid_time_begin,
    airport_heliport.guidanceline_ts.valid_time_end,
    airport_heliport.guidanceline_ts.feature_lifetime_begin,
    airport_heliport.guidanceline_ts.feature_lifetime_end,
    airport_heliport.guidanceline_ts.designator_value,
    airport_heliport.guidanceline_ts.designator_nilreason,
    airport_heliport.guidanceline_ts.type_value,
    airport_heliport.guidanceline_ts.type_nilreason,
    airport_heliport.guidanceline_ts.usagedirection_value,
    airport_heliport.guidanceline_ts.usagedirection_nilreason,
    airport_heliport.guidanceline_ts.maxspeed_value,
    airport_heliport.guidanceline_ts.maxspeed_uom,
    airport_heliport.guidanceline_ts.maxspeed_nilreason,
    geometry_elevatedcurve_view_qhqnuu.geom,
    geometry_elevatedcurve_view_qhqnuu.elevation,
    geometry_elevatedcurve_view_qhqnuu.geoidUndulation,
    geometry_elevatedcurve_view_qhqnuu.verticalDatum,
    geometry_elevatedcurve_view_qhqnuu.verticalAccuracy,
    geometry_elevatedcurve_view_qhqnuu.horizontalAccuracy
order by guidanceline.identifier, guidanceline_ts.sequence_number, guidanceline_ts.correction_number DESC;
-- HoldingAssessmentTimeSliceType
-- ['shared.obstacleassessmentarea_view', 'notes.note_view']
create or replace view shared.holdingassessment_view as
select distinct on (holdingassessment.identifier,holdingassessment_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    shared.holdingassessment.id,
    shared.holdingassessment_ts.id as ts_id,
    shared.holdingassessment_tsp.id as tsp_id,
    shared.holdingassessment.identifier,
    shared.holdingassessment_ts.interpretation,
    shared.holdingassessment_ts.sequence_number,
    shared.holdingassessment_ts.correction_number,
    shared.holdingassessment_ts.valid_time_begin,
    shared.holdingassessment_ts.valid_time_end,
    shared.holdingassessment_ts.feature_lifetime_begin,
    shared.holdingassessment_ts.feature_lifetime_end,
    coalesce(cast(shared.holdingassessment_ts.upperlimitreference_value as varchar), '(' || shared.holdingassessment_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(shared.holdingassessment_ts.lowerlimitreference_value as varchar), '(' || shared.holdingassessment_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(shared.holdingassessment_ts.patterntemplate_value as varchar), '(' || shared.holdingassessment_ts.patterntemplate_nilreason || ')') as patterntemplate,
    coalesce(cast(shared.holdingassessment_ts.turbulentair_value as varchar), '(' || shared.holdingassessment_ts.turbulentair_nilreason || ')') as turbulentair,
    coalesce(cast(shared.holdingassessment_ts.upperlimit_value as varchar) || ' ' || shared.holdingassessment_ts.upperlimit_uom, '(' || shared.holdingassessment_ts.upperlimit_nilreason || ')') as upperlimit,
    coalesce(cast(shared.holdingassessment_ts.lowerlimit_value as varchar) || ' ' || shared.holdingassessment_ts.lowerlimit_uom, '(' || shared.holdingassessment_ts.lowerlimit_nilreason || ')') as lowerlimit,
    coalesce(cast(shared.holdingassessment_ts.speedlimit_value as varchar) || ' ' || shared.holdingassessment_ts.speedlimit_uom, '(' || shared.holdingassessment_ts.speedlimit_nilreason || ')') as speedlimit,
    coalesce(cast(shared.holdingassessment_ts.leglengthtoward_value as varchar) || ' ' || shared.holdingassessment_ts.leglengthtoward_uom, '(' || shared.holdingassessment_ts.leglengthtoward_nilreason || ')') as leglengthtoward,
    coalesce(cast(shared.holdingassessment_ts.leglengthaway_value as varchar) || ' ' || shared.holdingassessment_ts.leglengthaway_uom, '(' || shared.holdingassessment_ts.leglengthaway_nilreason || ')') as leglengthaway,
    coalesce(cast(holding_unplannedholding_pt_lsarpw.title as varchar), '(' || holding_unplannedholding_pt_lsarpw.nilreason[1] || ')') AS unplannedholding,
    holding_unplannedholding_pt_lsarpw.href AS unplannedholding_href,
    coalesce(cast(holding_holdingpattern_pt_vbfryu.title as varchar), '(' || holding_holdingpattern_pt_vbfryu.nilreason[1] || ')') AS assessedholdingpattern,
    holding_holdingpattern_pt_vbfryu.href AS assessedholdingpattern_href,
    jsonb_agg(shared_obstacleassessmentarea_view_xqnyue.id) AS obstacleassessment,
    jsonb_agg(notes_note_view_nscpwd.*) AS holdingassessment_annotation
from shared.holdingassessment 
inner join master_join mj2 on shared.holdingassessment.id = mj2.source_id
inner join shared.holdingassessment_tsp on mj2.target_id = shared.holdingassessment_tsp.id
inner join shared.holdingassessment_ts on shared.holdingassessment_tsp.holdingassessmenttimeslice_id = shared.holdingassessment_ts.id
left join holding.unplannedholding_pt holding_unplannedholding_pt_lsarpw on shared.holdingassessment_ts.unplannedholding_id = holding_unplannedholding_pt_lsarpw.id
left join holding.holdingpattern_pt holding_holdingpattern_pt_vbfryu on shared.holdingassessment_ts.assessedholdingpattern_id = holding_holdingpattern_pt_vbfryu.id
left join master_join master_join_wpmuoc on shared.holdingassessment_ts.id = master_join_wpmuoc.source_id
left join shared.obstacleassessmentarea_view shared_obstacleassessmentarea_view_xqnyue on master_join_wpmuoc.target_id = shared_obstacleassessmentarea_view_xqnyue.id
left join master_join master_join_djzlgf on shared.holdingassessment_ts.id = master_join_djzlgf.source_id
left join notes.note_view notes_note_view_nscpwd on master_join_djzlgf.target_id = notes_note_view_nscpwd.id
where shared.holdingassessment.feature_status = 'APPROVED'
  and shared.holdingassessment_ts.feature_status = 'APPROVED'
group by
    shared.holdingassessment.id,
    shared.holdingassessment_ts.id,
    shared.holdingassessment_tsp.id,
    shared.holdingassessment.identifier,
    shared.holdingassessment_ts.interpretation,
    shared.holdingassessment_ts.sequence_number,
    shared.holdingassessment_ts.correction_number,
    shared.holdingassessment_ts.valid_time_begin,
    shared.holdingassessment_ts.valid_time_end,
    shared.holdingassessment_ts.feature_lifetime_begin,
    shared.holdingassessment_ts.feature_lifetime_end,
    shared.holdingassessment_ts.upperlimitreference_value,
    shared.holdingassessment_ts.upperlimitreference_nilreason,
    shared.holdingassessment_ts.lowerlimitreference_value,
    shared.holdingassessment_ts.lowerlimitreference_nilreason,
    shared.holdingassessment_ts.patterntemplate_value,
    shared.holdingassessment_ts.patterntemplate_nilreason,
    shared.holdingassessment_ts.turbulentair_value,
    shared.holdingassessment_ts.turbulentair_nilreason,
    shared.holdingassessment_ts.upperlimit_value,
    shared.holdingassessment_ts.upperlimit_uom,
    shared.holdingassessment_ts.upperlimit_nilreason,
    shared.holdingassessment_ts.lowerlimit_value,
    shared.holdingassessment_ts.lowerlimit_uom,
    shared.holdingassessment_ts.lowerlimit_nilreason,
    shared.holdingassessment_ts.speedlimit_value,
    shared.holdingassessment_ts.speedlimit_uom,
    shared.holdingassessment_ts.speedlimit_nilreason,
    shared.holdingassessment_ts.leglengthtoward_value,
    shared.holdingassessment_ts.leglengthtoward_uom,
    shared.holdingassessment_ts.leglengthtoward_nilreason,
    shared.holdingassessment_ts.leglengthaway_value,
    shared.holdingassessment_ts.leglengthaway_uom,
    shared.holdingassessment_ts.leglengthaway_nilreason,
    holding_unplannedholding_pt_lsarpw.title,
    holding_unplannedholding_pt_lsarpw.nilreason[1],
    holding_unplannedholding_pt_lsarpw.href,
    holding_holdingpattern_pt_vbfryu.title,
    holding_holdingpattern_pt_vbfryu.nilreason[1],
    holding_holdingpattern_pt_vbfryu.href
order by holdingassessment.identifier, holdingassessment_ts.sequence_number, holdingassessment_ts.correction_number DESC;
-- HoldingPatternTimeSliceType
-- ['geometry.curve_view', 'notes.note_view']
create or replace view holding.holdingpattern_view as
select distinct on (holdingpattern.identifier,holdingpattern_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    holding.holdingpattern.id,
    holding.holdingpattern_ts.id as ts_id,
    holding.holdingpattern_tsp.id as tsp_id,
    holding.holdingpattern.identifier,
    holding.holdingpattern_ts.interpretation,
    holding.holdingpattern_ts.sequence_number,
    holding.holdingpattern_ts.correction_number,
    holding.holdingpattern_ts.valid_time_begin,
    holding.holdingpattern_ts.valid_time_end,
    holding.holdingpattern_ts.feature_lifetime_begin,
    holding.holdingpattern_ts.feature_lifetime_end,
    coalesce(cast(holding.holdingpattern_ts.type_value as varchar), '(' || holding.holdingpattern_ts.type_nilreason || ')') as type,
    coalesce(cast(holding.holdingpattern_ts.outboundcourse_value as varchar), '(' || holding.holdingpattern_ts.outboundcourse_nilreason || ')') as outboundcourse,
    coalesce(cast(holding.holdingpattern_ts.outboundcoursetype_value as varchar), '(' || holding.holdingpattern_ts.outboundcoursetype_nilreason || ')') as outboundcoursetype,
    coalesce(cast(holding.holdingpattern_ts.inboundcourse_value as varchar), '(' || holding.holdingpattern_ts.inboundcourse_nilreason || ')') as inboundcourse,
    coalesce(cast(holding.holdingpattern_ts.turndirection_value as varchar), '(' || holding.holdingpattern_ts.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(holding.holdingpattern_ts.upperlimitreference_value as varchar), '(' || holding.holdingpattern_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(holding.holdingpattern_ts.lowerlimitreference_value as varchar), '(' || holding.holdingpattern_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(holding.holdingpattern_ts.instruction_value as varchar), '(' || holding.holdingpattern_ts.instruction_nilreason || ')') as instruction,
    coalesce(cast(holding.holdingpattern_ts.nonstandardholding_value as varchar), '(' || holding.holdingpattern_ts.nonstandardholding_nilreason || ')') as nonstandardholding,
    coalesce(cast(holding.holdingpattern_ts.upperlimit_value as varchar) || ' ' || holding.holdingpattern_ts.upperlimit_uom, '(' || holding.holdingpattern_ts.upperlimit_nilreason || ')') as upperlimit,
    coalesce(cast(holding.holdingpattern_ts.lowerlimit_value as varchar) || ' ' || holding.holdingpattern_ts.lowerlimit_uom, '(' || holding.holdingpattern_ts.lowerlimit_nilreason || ')') as lowerlimit,
    coalesce(cast(holding.holdingpattern_ts.speedlimit_value as varchar) || ' ' || holding.holdingpattern_ts.speedlimit_uom, '(' || holding.holdingpattern_ts.speedlimit_nilreason || ')') as speedlimit,
    coalesce(cast(holding_holdingpatternduration_pt_bhrphc.title as varchar), '(' || holding_holdingpatternduration_pt_bhrphc.nilreason[1] || ')') AS outboundlegspanendtime,
    holding_holdingpatternduration_pt_bhrphc.href AS outboundlegspanendtime_href,
    coalesce(cast(holding_holdingpatterndistance_pt_yntgbu.title as varchar), '(' || holding_holdingpatterndistance_pt_yntgbu.nilreason[1] || ')') AS outboundlegspanenddistance,
    holding_holdingpatterndistance_pt_yntgbu.href AS outboundlegspanenddistance_href,
    geometry_curve_view_ilxgmd.geom AS geom,
    jsonb_agg(notes_note_view_iqtodl.*) AS holdingpattern_annotation
from holding.holdingpattern 
inner join master_join mj2 on holding.holdingpattern.id = mj2.source_id
inner join holding.holdingpattern_tsp on mj2.target_id = holding.holdingpattern_tsp.id
inner join holding.holdingpattern_ts on holding.holdingpattern_tsp.holdingpatterntimeslice_id = holding.holdingpattern_ts.id
left join holding.holdingpatternduration_pt holding_holdingpatternduration_pt_bhrphc on holding.holdingpattern_ts.outboundlegspan_endtime_id = holding_holdingpatternduration_pt_bhrphc.id
left join holding.holdingpatterndistance_pt holding_holdingpatterndistance_pt_yntgbu on holding.holdingpattern_ts.outboundlegspan_enddistance_id = holding_holdingpatterndistance_pt_yntgbu.id
left join geometry.curve_view geometry_curve_view_ilxgmd on holding.holdingpattern_ts.extent_id = geometry_curve_view_ilxgmd.id
left join master_join master_join_tyrjmx on holding.holdingpattern_ts.id = master_join_tyrjmx.source_id
left join notes.note_view notes_note_view_iqtodl on master_join_tyrjmx.target_id = notes_note_view_iqtodl.id
where holding.holdingpattern.feature_status = 'APPROVED'
  and holding.holdingpattern_ts.feature_status = 'APPROVED'
group by
    holding.holdingpattern.id,
    holding.holdingpattern_ts.id,
    holding.holdingpattern_tsp.id,
    holding.holdingpattern.identifier,
    holding.holdingpattern_ts.interpretation,
    holding.holdingpattern_ts.sequence_number,
    holding.holdingpattern_ts.correction_number,
    holding.holdingpattern_ts.valid_time_begin,
    holding.holdingpattern_ts.valid_time_end,
    holding.holdingpattern_ts.feature_lifetime_begin,
    holding.holdingpattern_ts.feature_lifetime_end,
    holding.holdingpattern_ts.type_value,
    holding.holdingpattern_ts.type_nilreason,
    holding.holdingpattern_ts.outboundcourse_value,
    holding.holdingpattern_ts.outboundcourse_nilreason,
    holding.holdingpattern_ts.outboundcoursetype_value,
    holding.holdingpattern_ts.outboundcoursetype_nilreason,
    holding.holdingpattern_ts.inboundcourse_value,
    holding.holdingpattern_ts.inboundcourse_nilreason,
    holding.holdingpattern_ts.turndirection_value,
    holding.holdingpattern_ts.turndirection_nilreason,
    holding.holdingpattern_ts.upperlimitreference_value,
    holding.holdingpattern_ts.upperlimitreference_nilreason,
    holding.holdingpattern_ts.lowerlimitreference_value,
    holding.holdingpattern_ts.lowerlimitreference_nilreason,
    holding.holdingpattern_ts.instruction_value,
    holding.holdingpattern_ts.instruction_nilreason,
    holding.holdingpattern_ts.nonstandardholding_value,
    holding.holdingpattern_ts.nonstandardholding_nilreason,
    holding.holdingpattern_ts.upperlimit_value,
    holding.holdingpattern_ts.upperlimit_uom,
    holding.holdingpattern_ts.upperlimit_nilreason,
    holding.holdingpattern_ts.lowerlimit_value,
    holding.holdingpattern_ts.lowerlimit_uom,
    holding.holdingpattern_ts.lowerlimit_nilreason,
    holding.holdingpattern_ts.speedlimit_value,
    holding.holdingpattern_ts.speedlimit_uom,
    holding.holdingpattern_ts.speedlimit_nilreason,
    holding_holdingpatternduration_pt_bhrphc.title,
    holding_holdingpatternduration_pt_bhrphc.nilreason[1],
    holding_holdingpatternduration_pt_bhrphc.href,
    holding_holdingpatterndistance_pt_yntgbu.title,
    holding_holdingpatterndistance_pt_yntgbu.nilreason[1],
    holding_holdingpatterndistance_pt_yntgbu.href,
    geometry_curve_view_ilxgmd.geom
order by holdingpattern.identifier, holdingpattern_ts.sequence_number, holdingpattern_ts.correction_number DESC;
-- InformationServiceTimeSliceType
-- ['service.serviceoperationalstatus_view', 'notes.note_view', 'shared.contactinformation_view', 'routes.routeportion_view', 'geometry.elevatedpoint_view', 'service.callsigndetail_view']
create or replace view service.informationservice_view as
select distinct on (informationservice.identifier,informationservice_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.informationservice.id,
    service.informationservice_ts.id as ts_id,
    service.informationservice_tsp.id as tsp_id,
    service.informationservice.identifier,
    service.informationservice_ts.interpretation,
    service.informationservice_ts.sequence_number,
    service.informationservice_ts.correction_number,
    service.informationservice_ts.valid_time_begin,
    service.informationservice_ts.valid_time_end,
    service.informationservice_ts.feature_lifetime_begin,
    service.informationservice_ts.feature_lifetime_end,
    coalesce(cast(service.informationservice_ts.flightoperations_value as varchar), '(' || service.informationservice_ts.flightoperations_nilreason || ')') as flightoperations,
    coalesce(cast(service.informationservice_ts.rank_value as varchar), '(' || service.informationservice_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.informationservice_ts.complianticao_value as varchar), '(' || service.informationservice_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(service.informationservice_ts.name_value as varchar), '(' || service.informationservice_ts.name_nilreason || ')') as name,
    coalesce(cast(service.informationservice_ts.type_value as varchar), '(' || service.informationservice_ts.type_nilreason || ')') as type,
    coalesce(cast(service.informationservice_ts.voice_value as varchar), '(' || service.informationservice_ts.voice_nilreason || ')') as voice,
    coalesce(cast(service.informationservice_ts.datalink_value as varchar), '(' || service.informationservice_ts.datalink_nilreason || ')') as datalink,
    coalesce(cast(service.informationservice_ts.recorded_value as varchar), '(' || service.informationservice_ts.recorded_nilreason || ')') as recorded,
    geometry_elevatedpoint_view_mlrlpf.geom AS geom,
    ST_X(geometry_elevatedpoint_view_mlrlpf.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_mlrlpf.geom) AS latitude,
    geometry_elevatedpoint_view_mlrlpf.elevation,
    geometry_elevatedpoint_view_mlrlpf.geoidUndulation,
    geometry_elevatedpoint_view_mlrlpf.verticalDatum,
    geometry_elevatedpoint_view_mlrlpf.verticalAccuracy,
    geometry_elevatedpoint_view_mlrlpf.horizontalAccuracy,
    coalesce(cast(organisation_unit_pt_rqarls.title as varchar), '(' || organisation_unit_pt_rqarls.nilreason[1] || ')') AS serviceprovider,
    organisation_unit_pt_rqarls.href AS serviceprovider_href,
    jsonb_agg(service_callsigndetail_view_zgklej.id) AS callsign,
    jsonb_build_object('id', service_radiocommunicationchannel_pt_nzvwzh.id,
    'title', coalesce(cast(service_radiocommunicationchannel_pt_nzvwzh.title AS varchar), '(' || service_radiocommunicationchannel_pt_nzvwzh.nilreason[1] || ')'),
    'href', service_radiocommunicationchannel_pt_nzvwzh.href) AS radiocommunication,
    jsonb_agg(service_serviceoperationalstatus_view_sqzzas.id) AS availability,
    jsonb_agg(notes_note_view_uduxeu.*) AS informationservice_annotation,
    jsonb_build_object('id', navaids_points_vor_pt_gbeipz.id,
    'title', coalesce(cast(navaids_points_vor_pt_gbeipz.title AS varchar), '(' || navaids_points_vor_pt_gbeipz.nilreason[1] || ')'),
    'href', navaids_points_vor_pt_gbeipz.href) AS navaidbroadcast,
    jsonb_build_object('id', airspace_airspace_pt_cxugll.id,
    'title', coalesce(cast(airspace_airspace_pt_cxugll.title AS varchar), '(' || airspace_airspace_pt_cxugll.nilreason[1] || ')'),
    'href', airspace_airspace_pt_cxugll.href) AS clientairspace,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_ahldzm.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_ahldzm.title AS varchar), '(' || airport_heliport_airportheliport_pt_ahldzm.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_ahldzm.href) AS clientairport,
    jsonb_agg(routes_routeportion_view_wtdhpg.id) AS clientroute,
    jsonb_build_object('id', holding_holdingpattern_pt_bbkaxy.id,
    'title', coalesce(cast(holding_holdingpattern_pt_bbkaxy.title AS varchar), '(' || holding_holdingpattern_pt_bbkaxy.nilreason[1] || ')'),
    'href', holding_holdingpattern_pt_bbkaxy.href) AS clientholding,
    jsonb_build_object('id', aerial_refuelling_aerialrefuelling_pt_fmktyf.id,
    'title', coalesce(cast(aerial_refuelling_aerialrefuelling_pt_fmktyf.title AS varchar), '(' || aerial_refuelling_aerialrefuelling_pt_fmktyf.nilreason[1] || ')'),
    'href', aerial_refuelling_aerialrefuelling_pt_fmktyf.href) AS clientaerialrefuelling
from service.informationservice 
inner join master_join mj2 on service.informationservice.id = mj2.source_id
inner join service.informationservice_tsp on mj2.target_id = service.informationservice_tsp.id
inner join service.informationservice_ts on service.informationservice_tsp.informationservicetimeslice_id = service.informationservice_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_mlrlpf on service.informationservice_ts.location_id = geometry_elevatedpoint_view_mlrlpf.id
left join organisation.unit_pt organisation_unit_pt_rqarls on service.informationservice_ts.serviceprovider_id = organisation_unit_pt_rqarls.id
left join master_join master_join_tddvlo on service.informationservice_ts.id = master_join_tddvlo.source_id
left join service.callsigndetail_view service_callsigndetail_view_zgklej on master_join_tddvlo.target_id = service_callsigndetail_view_zgklej.id
left join master_join master_join_ybiaph on service.informationservice_ts.id = master_join_ybiaph.source_id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_nzvwzh on master_join_ybiaph.target_id = service_radiocommunicationchannel_pt_nzvwzh.id
left join master_join master_join_rhelgi on service.informationservice_ts.id = master_join_rhelgi.source_id
left join shared.contactinformation_view shared_contactinformation_view_spffoc on master_join_rhelgi.target_id = shared_contactinformation_view_spffoc.id
left join master_join master_join_rxksfe on service.informationservice_ts.id = master_join_rxksfe.source_id
left join service.serviceoperationalstatus_view service_serviceoperationalstatus_view_sqzzas on master_join_rxksfe.target_id = service_serviceoperationalstatus_view_sqzzas.id
left join master_join master_join_pgsrzd on service.informationservice_ts.id = master_join_pgsrzd.source_id
left join notes.note_view notes_note_view_uduxeu on master_join_pgsrzd.target_id = notes_note_view_uduxeu.id
left join master_join master_join_kkephj on service.informationservice_ts.id = master_join_kkephj.source_id
left join navaids_points.vor_pt navaids_points_vor_pt_gbeipz on master_join_kkephj.target_id = navaids_points_vor_pt_gbeipz.id
left join master_join master_join_jodema on service.informationservice_ts.id = master_join_jodema.source_id
left join airspace.airspace_pt airspace_airspace_pt_cxugll on master_join_jodema.target_id = airspace_airspace_pt_cxugll.id
left join master_join master_join_wwydjb on service.informationservice_ts.id = master_join_wwydjb.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_ahldzm on master_join_wwydjb.target_id = airport_heliport_airportheliport_pt_ahldzm.id
left join master_join master_join_ouwzqh on service.informationservice_ts.id = master_join_ouwzqh.source_id
left join routes.routeportion_view routes_routeportion_view_wtdhpg on master_join_ouwzqh.target_id = routes_routeportion_view_wtdhpg.id
left join master_join master_join_dkzzma on service.informationservice_ts.id = master_join_dkzzma.source_id
left join holding.holdingpattern_pt holding_holdingpattern_pt_bbkaxy on master_join_dkzzma.target_id = holding_holdingpattern_pt_bbkaxy.id
left join master_join master_join_fanbht on service.informationservice_ts.id = master_join_fanbht.source_id
left join aerial_refuelling.aerialrefuelling_pt aerial_refuelling_aerialrefuelling_pt_fmktyf on master_join_fanbht.target_id = aerial_refuelling_aerialrefuelling_pt_fmktyf.id
where service.informationservice.feature_status = 'APPROVED'
  and service.informationservice_ts.feature_status = 'APPROVED'
group by
    service.informationservice.id,
    service.informationservice_ts.id,
    service.informationservice_tsp.id,
    service.informationservice.identifier,
    service.informationservice_ts.interpretation,
    service.informationservice_ts.sequence_number,
    service.informationservice_ts.correction_number,
    service.informationservice_ts.valid_time_begin,
    service.informationservice_ts.valid_time_end,
    service.informationservice_ts.feature_lifetime_begin,
    service.informationservice_ts.feature_lifetime_end,
    service.informationservice_ts.flightoperations_value,
    service.informationservice_ts.flightoperations_nilreason,
    service.informationservice_ts.rank_value,
    service.informationservice_ts.rank_nilreason,
    service.informationservice_ts.complianticao_value,
    service.informationservice_ts.complianticao_nilreason,
    service.informationservice_ts.name_value,
    service.informationservice_ts.name_nilreason,
    service.informationservice_ts.type_value,
    service.informationservice_ts.type_nilreason,
    service.informationservice_ts.voice_value,
    service.informationservice_ts.voice_nilreason,
    service.informationservice_ts.datalink_value,
    service.informationservice_ts.datalink_nilreason,
    service.informationservice_ts.recorded_value,
    service.informationservice_ts.recorded_nilreason,
    geometry_elevatedpoint_view_mlrlpf.geom,
    geometry_elevatedpoint_view_mlrlpf.elevation,
    geometry_elevatedpoint_view_mlrlpf.geoidUndulation,
    geometry_elevatedpoint_view_mlrlpf.verticalDatum,
    geometry_elevatedpoint_view_mlrlpf.verticalAccuracy,
    geometry_elevatedpoint_view_mlrlpf.horizontalAccuracy,
    organisation_unit_pt_rqarls.title,
    organisation_unit_pt_rqarls.nilreason[1],
    organisation_unit_pt_rqarls.href
order by informationservice.identifier, informationservice_ts.sequence_number, informationservice_ts.correction_number DESC;
-- InitialLegTimeSliceType
-- ['shared.obstacleassessmentarea_view', 'notes.note_view', 'geometry.curve_view', 'shared.aircraftcharacteristic_view']
create or replace view procedure.initialleg_view as
select distinct on (initialleg.identifier,initialleg_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.initialleg.id,
    procedure.initialleg_ts.id as ts_id,
    procedure.initialleg_tsp.id as tsp_id,
    procedure.initialleg.identifier,
    procedure.initialleg_ts.interpretation,
    procedure.initialleg_ts.sequence_number,
    procedure.initialleg_ts.correction_number,
    procedure.initialleg_ts.valid_time_begin,
    procedure.initialleg_ts.valid_time_end,
    procedure.initialleg_ts.feature_lifetime_begin,
    procedure.initialleg_ts.feature_lifetime_end,
    coalesce(cast(procedure.initialleg_ts.endconditiondesignator_value as varchar), '(' || procedure.initialleg_ts.endconditiondesignator_nilreason || ')') as endconditiondesignator,
    coalesce(cast(procedure.initialleg_ts.legpath_value as varchar), '(' || procedure.initialleg_ts.legpath_nilreason || ')') as legpath,
    coalesce(cast(procedure.initialleg_ts.legtypearinc_value as varchar), '(' || procedure.initialleg_ts.legtypearinc_nilreason || ')') as legtypearinc,
    coalesce(cast(procedure.initialleg_ts.course_value as varchar), '(' || procedure.initialleg_ts.course_nilreason || ')') as course,
    coalesce(cast(procedure.initialleg_ts.coursetype_value as varchar), '(' || procedure.initialleg_ts.coursetype_nilreason || ')') as coursetype,
    coalesce(cast(procedure.initialleg_ts.coursedirection_value as varchar), '(' || procedure.initialleg_ts.coursedirection_nilreason || ')') as coursedirection,
    coalesce(cast(procedure.initialleg_ts.turndirection_value as varchar), '(' || procedure.initialleg_ts.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(procedure.initialleg_ts.speedreference_value as varchar), '(' || procedure.initialleg_ts.speedreference_nilreason || ')') as speedreference,
    coalesce(cast(procedure.initialleg_ts.speedinterpretation_value as varchar), '(' || procedure.initialleg_ts.speedinterpretation_nilreason || ')') as speedinterpretation,
    coalesce(cast(procedure.initialleg_ts.bankangle_value as varchar), '(' || procedure.initialleg_ts.bankangle_nilreason || ')') as bankangle,
    coalesce(cast(procedure.initialleg_ts.procedureturnrequired_value as varchar), '(' || procedure.initialleg_ts.procedureturnrequired_nilreason || ')') as procedureturnrequired,
    coalesce(cast(procedure.initialleg_ts.upperlimitreference_value as varchar), '(' || procedure.initialleg_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(procedure.initialleg_ts.lowerlimitreference_value as varchar), '(' || procedure.initialleg_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(procedure.initialleg_ts.altitudeinterpretation_value as varchar), '(' || procedure.initialleg_ts.altitudeinterpretation_nilreason || ')') as altitudeinterpretation,
    coalesce(cast(procedure.initialleg_ts.altitudeoverridereference_value as varchar), '(' || procedure.initialleg_ts.altitudeoverridereference_nilreason || ')') as altitudeoverridereference,
    coalesce(cast(procedure.initialleg_ts.verticalangle_value as varchar), '(' || procedure.initialleg_ts.verticalangle_nilreason || ')') as verticalangle,
    coalesce(cast(procedure.initialleg_ts.requirednavigationperformance_value as varchar), '(' || procedure.initialleg_ts.requirednavigationperformance_nilreason || ')') as requirednavigationperformance,
    coalesce(cast(procedure.initialleg_ts.speedlimit_value as varchar) || ' ' || procedure.initialleg_ts.speedlimit_uom, '(' || procedure.initialleg_ts.speedlimit_nilreason || ')') as speedlimit,
    coalesce(cast(procedure.initialleg_ts.length_value as varchar) || ' ' || procedure.initialleg_ts.length_uom, '(' || procedure.initialleg_ts.length_nilreason || ')') as length,
    coalesce(cast(procedure.initialleg_ts.duration_value as varchar) || ' ' || procedure.initialleg_ts.duration_uom, '(' || procedure.initialleg_ts.duration_nilreason || ')') as duration,
    coalesce(cast(procedure.initialleg_ts.upperlimitaltitude_value as varchar) || ' ' || procedure.initialleg_ts.upperlimitaltitude_uom, '(' || procedure.initialleg_ts.upperlimitaltitude_nilreason || ')') as upperlimitaltitude,
    coalesce(cast(procedure.initialleg_ts.lowerlimitaltitude_value as varchar) || ' ' || procedure.initialleg_ts.lowerlimitaltitude_uom, '(' || procedure.initialleg_ts.lowerlimitaltitude_nilreason || ')') as lowerlimitaltitude,
    coalesce(cast(procedure.initialleg_ts.altitudeoverrideatc_value as varchar) || ' ' || procedure.initialleg_ts.altitudeoverrideatc_uom, '(' || procedure.initialleg_ts.altitudeoverrideatc_nilreason || ')') as altitudeoverrideatc,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_zdoqcq.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_zdoqcq.nilreason[1] || ')') AS startpoint,
    navaids_points_terminalsegmentpoint_pt_zdoqcq.href AS startpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_xhikbh.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_xhikbh.nilreason[1] || ')') AS endpoint,
    navaids_points_terminalsegmentpoint_pt_xhikbh.href AS endpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_hmsmld.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_hmsmld.nilreason[1] || ')') AS arccentre,
    navaids_points_terminalsegmentpoint_pt_hmsmld.href AS arccentre_href,
    geometry_curve_view_ckkitq.geom AS geom,
    coalesce(cast(navaids_points_angleindication_pt_rmtwhf.title as varchar), '(' || navaids_points_angleindication_pt_rmtwhf.nilreason[1] || ')') AS angle,
    navaids_points_angleindication_pt_rmtwhf.href AS angle_href,
    coalesce(cast(navaids_points_distanceindication_pt_oozntf.title as varchar), '(' || navaids_points_distanceindication_pt_oozntf.nilreason[1] || ')') AS distance,
    navaids_points_distanceindication_pt_oozntf.href AS distance_href,
    coalesce(cast(procedure_holdinguse_pt_ijhcdk.title as varchar), '(' || procedure_holdinguse_pt_ijhcdk.nilreason[1] || ')') AS holding,
    procedure_holdinguse_pt_ijhcdk.href AS holding_href,
    coalesce(cast(procedure_instrumentapproachprocedure_pt_ctmuze.title as varchar), '(' || procedure_instrumentapproachprocedure_pt_ctmuze.nilreason[1] || ')') AS approach,
    procedure_instrumentapproachprocedure_pt_ctmuze.href AS approach_href,
    jsonb_agg(shared_aircraftcharacteristic_view_mxawnu.id) AS aircraftcategory,
    jsonb_agg(shared_obstacleassessmentarea_view_xcydju.id) AS designsurface,
    jsonb_agg(notes_note_view_nsflqe.*) AS initialleg_annotation
from procedure.initialleg 
inner join master_join mj2 on procedure.initialleg.id = mj2.source_id
inner join procedure.initialleg_tsp on mj2.target_id = procedure.initialleg_tsp.id
inner join procedure.initialleg_ts on procedure.initialleg_tsp.initiallegtimeslice_id = procedure.initialleg_ts.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_zdoqcq on procedure.initialleg_ts.startpoint_id = navaids_points_terminalsegmentpoint_pt_zdoqcq.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_xhikbh on procedure.initialleg_ts.endpoint_id = navaids_points_terminalsegmentpoint_pt_xhikbh.id
left join geometry.curve_view geometry_curve_view_ckkitq on procedure.initialleg_ts.trajectory_id = geometry_curve_view_ckkitq.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_hmsmld on procedure.initialleg_ts.arccentre_id = navaids_points_terminalsegmentpoint_pt_hmsmld.id
left join navaids_points.angleindication_pt navaids_points_angleindication_pt_rmtwhf on procedure.initialleg_ts.angle_id = navaids_points_angleindication_pt_rmtwhf.id
left join navaids_points.distanceindication_pt navaids_points_distanceindication_pt_oozntf on procedure.initialleg_ts.distance_id = navaids_points_distanceindication_pt_oozntf.id
left join procedure.holdinguse_pt procedure_holdinguse_pt_ijhcdk on procedure.initialleg_ts.holding_id = procedure_holdinguse_pt_ijhcdk.id
left join procedure.instrumentapproachprocedure_pt procedure_instrumentapproachprocedure_pt_ctmuze on procedure.initialleg_ts.approach_id = procedure_instrumentapproachprocedure_pt_ctmuze.id
left join master_join master_join_eicexz on procedure.initialleg_ts.id = master_join_eicexz.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_mxawnu on master_join_eicexz.target_id = shared_aircraftcharacteristic_view_mxawnu.id
left join master_join master_join_yczwes on procedure.initialleg_ts.id = master_join_yczwes.source_id
left join shared.obstacleassessmentarea_view shared_obstacleassessmentarea_view_xcydju on master_join_yczwes.target_id = shared_obstacleassessmentarea_view_xcydju.id
left join master_join master_join_dudkmo on procedure.initialleg_ts.id = master_join_dudkmo.source_id
left join notes.note_view notes_note_view_nsflqe on master_join_dudkmo.target_id = notes_note_view_nsflqe.id
where procedure.initialleg.feature_status = 'APPROVED'
  and procedure.initialleg_ts.feature_status = 'APPROVED'
group by
    procedure.initialleg.id,
    procedure.initialleg_ts.id,
    procedure.initialleg_tsp.id,
    procedure.initialleg.identifier,
    procedure.initialleg_ts.interpretation,
    procedure.initialleg_ts.sequence_number,
    procedure.initialleg_ts.correction_number,
    procedure.initialleg_ts.valid_time_begin,
    procedure.initialleg_ts.valid_time_end,
    procedure.initialleg_ts.feature_lifetime_begin,
    procedure.initialleg_ts.feature_lifetime_end,
    procedure.initialleg_ts.endconditiondesignator_value,
    procedure.initialleg_ts.endconditiondesignator_nilreason,
    procedure.initialleg_ts.legpath_value,
    procedure.initialleg_ts.legpath_nilreason,
    procedure.initialleg_ts.legtypearinc_value,
    procedure.initialleg_ts.legtypearinc_nilreason,
    procedure.initialleg_ts.course_value,
    procedure.initialleg_ts.course_nilreason,
    procedure.initialleg_ts.coursetype_value,
    procedure.initialleg_ts.coursetype_nilreason,
    procedure.initialleg_ts.coursedirection_value,
    procedure.initialleg_ts.coursedirection_nilreason,
    procedure.initialleg_ts.turndirection_value,
    procedure.initialleg_ts.turndirection_nilreason,
    procedure.initialleg_ts.speedreference_value,
    procedure.initialleg_ts.speedreference_nilreason,
    procedure.initialleg_ts.speedinterpretation_value,
    procedure.initialleg_ts.speedinterpretation_nilreason,
    procedure.initialleg_ts.bankangle_value,
    procedure.initialleg_ts.bankangle_nilreason,
    procedure.initialleg_ts.procedureturnrequired_value,
    procedure.initialleg_ts.procedureturnrequired_nilreason,
    procedure.initialleg_ts.upperlimitreference_value,
    procedure.initialleg_ts.upperlimitreference_nilreason,
    procedure.initialleg_ts.lowerlimitreference_value,
    procedure.initialleg_ts.lowerlimitreference_nilreason,
    procedure.initialleg_ts.altitudeinterpretation_value,
    procedure.initialleg_ts.altitudeinterpretation_nilreason,
    procedure.initialleg_ts.altitudeoverridereference_value,
    procedure.initialleg_ts.altitudeoverridereference_nilreason,
    procedure.initialleg_ts.verticalangle_value,
    procedure.initialleg_ts.verticalangle_nilreason,
    procedure.initialleg_ts.requirednavigationperformance_value,
    procedure.initialleg_ts.requirednavigationperformance_nilreason,
    procedure.initialleg_ts.speedlimit_value,
    procedure.initialleg_ts.speedlimit_uom,
    procedure.initialleg_ts.speedlimit_nilreason,
    procedure.initialleg_ts.length_value,
    procedure.initialleg_ts.length_uom,
    procedure.initialleg_ts.length_nilreason,
    procedure.initialleg_ts.duration_value,
    procedure.initialleg_ts.duration_uom,
    procedure.initialleg_ts.duration_nilreason,
    procedure.initialleg_ts.upperlimitaltitude_value,
    procedure.initialleg_ts.upperlimitaltitude_uom,
    procedure.initialleg_ts.upperlimitaltitude_nilreason,
    procedure.initialleg_ts.lowerlimitaltitude_value,
    procedure.initialleg_ts.lowerlimitaltitude_uom,
    procedure.initialleg_ts.lowerlimitaltitude_nilreason,
    procedure.initialleg_ts.altitudeoverrideatc_value,
    procedure.initialleg_ts.altitudeoverrideatc_uom,
    procedure.initialleg_ts.altitudeoverrideatc_nilreason,
    navaids_points_terminalsegmentpoint_pt_zdoqcq.title,
    navaids_points_terminalsegmentpoint_pt_zdoqcq.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_zdoqcq.href,
    navaids_points_terminalsegmentpoint_pt_xhikbh.title,
    navaids_points_terminalsegmentpoint_pt_xhikbh.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_xhikbh.href,
    geometry_curve_view_ckkitq.geom,
    navaids_points_terminalsegmentpoint_pt_hmsmld.title,
    navaids_points_terminalsegmentpoint_pt_hmsmld.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_hmsmld.href,
    navaids_points_angleindication_pt_rmtwhf.title,
    navaids_points_angleindication_pt_rmtwhf.nilreason[1],
    navaids_points_angleindication_pt_rmtwhf.href,
    navaids_points_distanceindication_pt_oozntf.title,
    navaids_points_distanceindication_pt_oozntf.nilreason[1],
    navaids_points_distanceindication_pt_oozntf.href,
    procedure_holdinguse_pt_ijhcdk.title,
    procedure_holdinguse_pt_ijhcdk.nilreason[1],
    procedure_holdinguse_pt_ijhcdk.href,
    procedure_instrumentapproachprocedure_pt_ctmuze.title,
    procedure_instrumentapproachprocedure_pt_ctmuze.nilreason[1],
    procedure_instrumentapproachprocedure_pt_ctmuze.href
order by initialleg.identifier, initialleg_ts.sequence_number, initialleg_ts.correction_number DESC;
-- InstrumentApproachProcedureTimeSliceType
-- ['procedure.proceduretransition_view', 'procedure.procedureavailability_view', 'notes.note_view', 'shared.aircraftcharacteristic_view', 'procedure.missedapproachgroup_view']
create or replace view procedure.instrumentapproachprocedure_view as
select distinct on (instrumentapproachprocedure.identifier,instrumentapproachprocedure_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.instrumentapproachprocedure.id,
    procedure.instrumentapproachprocedure_ts.id as ts_id,
    procedure.instrumentapproachprocedure_tsp.id as tsp_id,
    procedure.instrumentapproachprocedure.identifier,
    procedure.instrumentapproachprocedure_ts.interpretation,
    procedure.instrumentapproachprocedure_ts.sequence_number,
    procedure.instrumentapproachprocedure_ts.correction_number,
    procedure.instrumentapproachprocedure_ts.valid_time_begin,
    procedure.instrumentapproachprocedure_ts.valid_time_end,
    procedure.instrumentapproachprocedure_ts.feature_lifetime_begin,
    procedure.instrumentapproachprocedure_ts.feature_lifetime_end,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.communicationfailureinstruction_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.communicationfailureinstruction_nilreason || ')') as communicationfailureinstruction,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.instruction_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.instruction_nilreason || ')') as instruction,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.designcriteria_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.designcriteria_nilreason || ')') as designcriteria,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.codingstandard_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.codingstandard_nilreason || ')') as codingstandard,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.flightchecked_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.name_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.name_nilreason || ')') as name,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.rnav_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.rnav_nilreason || ')') as rnav,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.approachprefix_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.approachprefix_nilreason || ')') as approachprefix,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.approachtype_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.approachtype_nilreason || ')') as approachtype,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.multipleidentification_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.multipleidentification_nilreason || ')') as multipleidentification,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.coptertrack_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.coptertrack_nilreason || ')') as coptertrack,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.circlingidentification_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.circlingidentification_nilreason || ')') as circlingidentification,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.coursereversalinstruction_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.coursereversalinstruction_nilreason || ')') as coursereversalinstruction,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.additionalequipment_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.additionalequipment_nilreason || ')') as additionalequipment,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.channelgnss_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.channelgnss_nilreason || ')') as channelgnss,
    coalesce(cast(procedure.instrumentapproachprocedure_ts.waasreliable_value as varchar), '(' || procedure.instrumentapproachprocedure_ts.waasreliable_nilreason || ')') as waasreliable,
    coalesce(cast(navaids_points_navaid_pt_ivkqsn.title as varchar), '(' || navaids_points_navaid_pt_ivkqsn.nilreason[1] || ')') AS guidancefacilitynavaid,
    navaids_points_navaid_pt_ivkqsn.href AS guidancefacilitynavaid_href,
    coalesce(cast(navaids_points_specialnavigationsystem_pt_gzensi.title as varchar), '(' || navaids_points_specialnavigationsystem_pt_gzensi.nilreason[1] || ')') AS guidancefacilityspecialnavigationsystem,
    navaids_points_specialnavigationsystem_pt_gzensi.href AS guidancefacilityspecialnavigationsystem_href,
    coalesce(cast(surveillance_radarsystem_pt_chysmn.title as varchar), '(' || surveillance_radarsystem_pt_chysmn.nilreason[1] || ')') AS guidancefacilityradar,
    surveillance_radarsystem_pt_chysmn.href AS guidancefacilityradar_href,
    coalesce(cast(procedure_safealtitudearea_pt_buhryb.title as varchar), '(' || procedure_safealtitudearea_pt_buhryb.nilreason[1] || ')') AS safealtitude,
    procedure_safealtitudearea_pt_buhryb.href AS safealtitude_href,
    coalesce(cast(procedure_landingtakeoffareacollection_pt_qbrpyn.title as varchar), '(' || procedure_landingtakeoffareacollection_pt_qbrpyn.nilreason[1] || ')') AS landing,
    procedure_landingtakeoffareacollection_pt_qbrpyn.href AS landing_href,
    coalesce(cast(procedure_finalprofile_pt_xpmqbw.title as varchar), '(' || procedure_finalprofile_pt_xpmqbw.nilreason[1] || ')') AS finalprofile,
    procedure_finalprofile_pt_xpmqbw.href AS finalprofile_href,
    jsonb_agg(procedure_procedureavailability_view_ybxvbk.id) AS availability,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_dhpjuh.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_dhpjuh.title AS varchar), '(' || airport_heliport_airportheliport_pt_dhpjuh.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_dhpjuh.href) AS airportheliport,
    jsonb_agg(shared_aircraftcharacteristic_view_hfgwbo.id) AS aircraftcharacteristic,
    jsonb_agg(procedure_proceduretransition_view_ldgvhs.id) AS flighttransition,
    jsonb_agg(notes_note_view_qiywib.*) AS instrumentapproachprocedure_annotation,
    jsonb_agg(procedure_missedapproachgroup_view_dhclhs.id) AS missedinstruction
from procedure.instrumentapproachprocedure 
inner join master_join mj2 on procedure.instrumentapproachprocedure.id = mj2.source_id
inner join procedure.instrumentapproachprocedure_tsp on mj2.target_id = procedure.instrumentapproachprocedure_tsp.id
inner join procedure.instrumentapproachprocedure_ts on procedure.instrumentapproachprocedure_tsp.instrumentapproachproceduretimeslice_id = procedure.instrumentapproachprocedure_ts.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_ivkqsn on procedure.instrumentapproachprocedure_ts.guidancefacility_navaid_id = navaids_points_navaid_pt_ivkqsn.id
left join navaids_points.specialnavigationsystem_pt navaids_points_specialnavigationsystem_pt_gzensi on procedure.instrumentapproachprocedure_ts.guidancefacility_specialnavigationsystem_id = navaids_points_specialnavigationsystem_pt_gzensi.id
left join surveillance.radarsystem_pt surveillance_radarsystem_pt_chysmn on procedure.instrumentapproachprocedure_ts.guidancefacility_radar_id = surveillance_radarsystem_pt_chysmn.id
left join procedure.safealtitudearea_pt procedure_safealtitudearea_pt_buhryb on procedure.instrumentapproachprocedure_ts.safealtitude_id = procedure_safealtitudearea_pt_buhryb.id
left join procedure.landingtakeoffareacollection_pt procedure_landingtakeoffareacollection_pt_qbrpyn on procedure.instrumentapproachprocedure_ts.landing_id = procedure_landingtakeoffareacollection_pt_qbrpyn.id
left join procedure.finalprofile_pt procedure_finalprofile_pt_xpmqbw on procedure.instrumentapproachprocedure_ts.finalprofile_id = procedure_finalprofile_pt_xpmqbw.id
left join master_join master_join_zhqrvy on procedure.instrumentapproachprocedure_ts.id = master_join_zhqrvy.source_id
left join procedure.procedureavailability_view procedure_procedureavailability_view_ybxvbk on master_join_zhqrvy.target_id = procedure_procedureavailability_view_ybxvbk.id
left join master_join master_join_fczxzv on procedure.instrumentapproachprocedure_ts.id = master_join_fczxzv.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_dhpjuh on master_join_fczxzv.target_id = airport_heliport_airportheliport_pt_dhpjuh.id
left join master_join master_join_vcxyve on procedure.instrumentapproachprocedure_ts.id = master_join_vcxyve.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_hfgwbo on master_join_vcxyve.target_id = shared_aircraftcharacteristic_view_hfgwbo.id
left join master_join master_join_rigown on procedure.instrumentapproachprocedure_ts.id = master_join_rigown.source_id
left join procedure.proceduretransition_view procedure_proceduretransition_view_ldgvhs on master_join_rigown.target_id = procedure_proceduretransition_view_ldgvhs.id
left join master_join master_join_cjtodt on procedure.instrumentapproachprocedure_ts.id = master_join_cjtodt.source_id
left join notes.note_view notes_note_view_qiywib on master_join_cjtodt.target_id = notes_note_view_qiywib.id
left join master_join master_join_xgfvgg on procedure.instrumentapproachprocedure_ts.id = master_join_xgfvgg.source_id
left join procedure.missedapproachgroup_view procedure_missedapproachgroup_view_dhclhs on master_join_xgfvgg.target_id = procedure_missedapproachgroup_view_dhclhs.id
where procedure.instrumentapproachprocedure.feature_status = 'APPROVED'
  and procedure.instrumentapproachprocedure_ts.feature_status = 'APPROVED'
group by
    procedure.instrumentapproachprocedure.id,
    procedure.instrumentapproachprocedure_ts.id,
    procedure.instrumentapproachprocedure_tsp.id,
    procedure.instrumentapproachprocedure.identifier,
    procedure.instrumentapproachprocedure_ts.interpretation,
    procedure.instrumentapproachprocedure_ts.sequence_number,
    procedure.instrumentapproachprocedure_ts.correction_number,
    procedure.instrumentapproachprocedure_ts.valid_time_begin,
    procedure.instrumentapproachprocedure_ts.valid_time_end,
    procedure.instrumentapproachprocedure_ts.feature_lifetime_begin,
    procedure.instrumentapproachprocedure_ts.feature_lifetime_end,
    procedure.instrumentapproachprocedure_ts.communicationfailureinstruction_value,
    procedure.instrumentapproachprocedure_ts.communicationfailureinstruction_nilreason,
    procedure.instrumentapproachprocedure_ts.instruction_value,
    procedure.instrumentapproachprocedure_ts.instruction_nilreason,
    procedure.instrumentapproachprocedure_ts.designcriteria_value,
    procedure.instrumentapproachprocedure_ts.designcriteria_nilreason,
    procedure.instrumentapproachprocedure_ts.codingstandard_value,
    procedure.instrumentapproachprocedure_ts.codingstandard_nilreason,
    procedure.instrumentapproachprocedure_ts.flightchecked_value,
    procedure.instrumentapproachprocedure_ts.flightchecked_nilreason,
    procedure.instrumentapproachprocedure_ts.name_value,
    procedure.instrumentapproachprocedure_ts.name_nilreason,
    procedure.instrumentapproachprocedure_ts.rnav_value,
    procedure.instrumentapproachprocedure_ts.rnav_nilreason,
    procedure.instrumentapproachprocedure_ts.approachprefix_value,
    procedure.instrumentapproachprocedure_ts.approachprefix_nilreason,
    procedure.instrumentapproachprocedure_ts.approachtype_value,
    procedure.instrumentapproachprocedure_ts.approachtype_nilreason,
    procedure.instrumentapproachprocedure_ts.multipleidentification_value,
    procedure.instrumentapproachprocedure_ts.multipleidentification_nilreason,
    procedure.instrumentapproachprocedure_ts.coptertrack_value,
    procedure.instrumentapproachprocedure_ts.coptertrack_nilreason,
    procedure.instrumentapproachprocedure_ts.circlingidentification_value,
    procedure.instrumentapproachprocedure_ts.circlingidentification_nilreason,
    procedure.instrumentapproachprocedure_ts.coursereversalinstruction_value,
    procedure.instrumentapproachprocedure_ts.coursereversalinstruction_nilreason,
    procedure.instrumentapproachprocedure_ts.additionalequipment_value,
    procedure.instrumentapproachprocedure_ts.additionalequipment_nilreason,
    procedure.instrumentapproachprocedure_ts.channelgnss_value,
    procedure.instrumentapproachprocedure_ts.channelgnss_nilreason,
    procedure.instrumentapproachprocedure_ts.waasreliable_value,
    procedure.instrumentapproachprocedure_ts.waasreliable_nilreason,
    navaids_points_navaid_pt_ivkqsn.title,
    navaids_points_navaid_pt_ivkqsn.nilreason[1],
    navaids_points_navaid_pt_ivkqsn.href,
    navaids_points_specialnavigationsystem_pt_gzensi.title,
    navaids_points_specialnavigationsystem_pt_gzensi.nilreason[1],
    navaids_points_specialnavigationsystem_pt_gzensi.href,
    surveillance_radarsystem_pt_chysmn.title,
    surveillance_radarsystem_pt_chysmn.nilreason[1],
    surveillance_radarsystem_pt_chysmn.href,
    procedure_safealtitudearea_pt_buhryb.title,
    procedure_safealtitudearea_pt_buhryb.nilreason[1],
    procedure_safealtitudearea_pt_buhryb.href,
    procedure_landingtakeoffareacollection_pt_qbrpyn.title,
    procedure_landingtakeoffareacollection_pt_qbrpyn.nilreason[1],
    procedure_landingtakeoffareacollection_pt_qbrpyn.href,
    procedure_finalprofile_pt_xpmqbw.title,
    procedure_finalprofile_pt_xpmqbw.nilreason[1],
    procedure_finalprofile_pt_xpmqbw.href
order by instrumentapproachprocedure.identifier, instrumentapproachprocedure_ts.sequence_number, instrumentapproachprocedure_ts.correction_number DESC;
-- IntermediateLegTimeSliceType
-- ['shared.obstacleassessmentarea_view', 'notes.note_view', 'geometry.curve_view', 'shared.aircraftcharacteristic_view']
create or replace view procedure.intermediateleg_view as
select distinct on (intermediateleg.identifier,intermediateleg_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.intermediateleg.id,
    procedure.intermediateleg_ts.id as ts_id,
    procedure.intermediateleg_tsp.id as tsp_id,
    procedure.intermediateleg.identifier,
    procedure.intermediateleg_ts.interpretation,
    procedure.intermediateleg_ts.sequence_number,
    procedure.intermediateleg_ts.correction_number,
    procedure.intermediateleg_ts.valid_time_begin,
    procedure.intermediateleg_ts.valid_time_end,
    procedure.intermediateleg_ts.feature_lifetime_begin,
    procedure.intermediateleg_ts.feature_lifetime_end,
    coalesce(cast(procedure.intermediateleg_ts.endconditiondesignator_value as varchar), '(' || procedure.intermediateleg_ts.endconditiondesignator_nilreason || ')') as endconditiondesignator,
    coalesce(cast(procedure.intermediateleg_ts.legpath_value as varchar), '(' || procedure.intermediateleg_ts.legpath_nilreason || ')') as legpath,
    coalesce(cast(procedure.intermediateleg_ts.legtypearinc_value as varchar), '(' || procedure.intermediateleg_ts.legtypearinc_nilreason || ')') as legtypearinc,
    coalesce(cast(procedure.intermediateleg_ts.course_value as varchar), '(' || procedure.intermediateleg_ts.course_nilreason || ')') as course,
    coalesce(cast(procedure.intermediateleg_ts.coursetype_value as varchar), '(' || procedure.intermediateleg_ts.coursetype_nilreason || ')') as coursetype,
    coalesce(cast(procedure.intermediateleg_ts.coursedirection_value as varchar), '(' || procedure.intermediateleg_ts.coursedirection_nilreason || ')') as coursedirection,
    coalesce(cast(procedure.intermediateleg_ts.turndirection_value as varchar), '(' || procedure.intermediateleg_ts.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(procedure.intermediateleg_ts.speedreference_value as varchar), '(' || procedure.intermediateleg_ts.speedreference_nilreason || ')') as speedreference,
    coalesce(cast(procedure.intermediateleg_ts.speedinterpretation_value as varchar), '(' || procedure.intermediateleg_ts.speedinterpretation_nilreason || ')') as speedinterpretation,
    coalesce(cast(procedure.intermediateleg_ts.bankangle_value as varchar), '(' || procedure.intermediateleg_ts.bankangle_nilreason || ')') as bankangle,
    coalesce(cast(procedure.intermediateleg_ts.procedureturnrequired_value as varchar), '(' || procedure.intermediateleg_ts.procedureturnrequired_nilreason || ')') as procedureturnrequired,
    coalesce(cast(procedure.intermediateleg_ts.upperlimitreference_value as varchar), '(' || procedure.intermediateleg_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(procedure.intermediateleg_ts.lowerlimitreference_value as varchar), '(' || procedure.intermediateleg_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(procedure.intermediateleg_ts.altitudeinterpretation_value as varchar), '(' || procedure.intermediateleg_ts.altitudeinterpretation_nilreason || ')') as altitudeinterpretation,
    coalesce(cast(procedure.intermediateleg_ts.altitudeoverridereference_value as varchar), '(' || procedure.intermediateleg_ts.altitudeoverridereference_nilreason || ')') as altitudeoverridereference,
    coalesce(cast(procedure.intermediateleg_ts.verticalangle_value as varchar), '(' || procedure.intermediateleg_ts.verticalangle_nilreason || ')') as verticalangle,
    coalesce(cast(procedure.intermediateleg_ts.requirednavigationperformance_value as varchar), '(' || procedure.intermediateleg_ts.requirednavigationperformance_nilreason || ')') as requirednavigationperformance,
    coalesce(cast(procedure.intermediateleg_ts.speedlimit_value as varchar) || ' ' || procedure.intermediateleg_ts.speedlimit_uom, '(' || procedure.intermediateleg_ts.speedlimit_nilreason || ')') as speedlimit,
    coalesce(cast(procedure.intermediateleg_ts.length_value as varchar) || ' ' || procedure.intermediateleg_ts.length_uom, '(' || procedure.intermediateleg_ts.length_nilreason || ')') as length,
    coalesce(cast(procedure.intermediateleg_ts.duration_value as varchar) || ' ' || procedure.intermediateleg_ts.duration_uom, '(' || procedure.intermediateleg_ts.duration_nilreason || ')') as duration,
    coalesce(cast(procedure.intermediateleg_ts.upperlimitaltitude_value as varchar) || ' ' || procedure.intermediateleg_ts.upperlimitaltitude_uom, '(' || procedure.intermediateleg_ts.upperlimitaltitude_nilreason || ')') as upperlimitaltitude,
    coalesce(cast(procedure.intermediateleg_ts.lowerlimitaltitude_value as varchar) || ' ' || procedure.intermediateleg_ts.lowerlimitaltitude_uom, '(' || procedure.intermediateleg_ts.lowerlimitaltitude_nilreason || ')') as lowerlimitaltitude,
    coalesce(cast(procedure.intermediateleg_ts.altitudeoverrideatc_value as varchar) || ' ' || procedure.intermediateleg_ts.altitudeoverrideatc_uom, '(' || procedure.intermediateleg_ts.altitudeoverrideatc_nilreason || ')') as altitudeoverrideatc,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_vdjkub.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_vdjkub.nilreason[1] || ')') AS startpoint,
    navaids_points_terminalsegmentpoint_pt_vdjkub.href AS startpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_mjjbpa.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_mjjbpa.nilreason[1] || ')') AS endpoint,
    navaids_points_terminalsegmentpoint_pt_mjjbpa.href AS endpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_tssjgc.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_tssjgc.nilreason[1] || ')') AS arccentre,
    navaids_points_terminalsegmentpoint_pt_tssjgc.href AS arccentre_href,
    geometry_curve_view_gjoalz.geom AS geom,
    coalesce(cast(navaids_points_angleindication_pt_sqhwnu.title as varchar), '(' || navaids_points_angleindication_pt_sqhwnu.nilreason[1] || ')') AS angle,
    navaids_points_angleindication_pt_sqhwnu.href AS angle_href,
    coalesce(cast(navaids_points_distanceindication_pt_nstokr.title as varchar), '(' || navaids_points_distanceindication_pt_nstokr.nilreason[1] || ')') AS distance,
    navaids_points_distanceindication_pt_nstokr.href AS distance_href,
    coalesce(cast(procedure_holdinguse_pt_jcajrg.title as varchar), '(' || procedure_holdinguse_pt_jcajrg.nilreason[1] || ')') AS holding,
    procedure_holdinguse_pt_jcajrg.href AS holding_href,
    coalesce(cast(procedure_instrumentapproachprocedure_pt_tuyrvi.title as varchar), '(' || procedure_instrumentapproachprocedure_pt_tuyrvi.nilreason[1] || ')') AS approach,
    procedure_instrumentapproachprocedure_pt_tuyrvi.href AS approach_href,
    jsonb_agg(shared_aircraftcharacteristic_view_rzyvum.id) AS aircraftcategory,
    jsonb_agg(shared_obstacleassessmentarea_view_fswqzr.id) AS designsurface,
    jsonb_agg(notes_note_view_kbneqc.*) AS intermediateleg_annotation
from procedure.intermediateleg 
inner join master_join mj2 on procedure.intermediateleg.id = mj2.source_id
inner join procedure.intermediateleg_tsp on mj2.target_id = procedure.intermediateleg_tsp.id
inner join procedure.intermediateleg_ts on procedure.intermediateleg_tsp.intermediatelegtimeslice_id = procedure.intermediateleg_ts.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_vdjkub on procedure.intermediateleg_ts.startpoint_id = navaids_points_terminalsegmentpoint_pt_vdjkub.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_mjjbpa on procedure.intermediateleg_ts.endpoint_id = navaids_points_terminalsegmentpoint_pt_mjjbpa.id
left join geometry.curve_view geometry_curve_view_gjoalz on procedure.intermediateleg_ts.trajectory_id = geometry_curve_view_gjoalz.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_tssjgc on procedure.intermediateleg_ts.arccentre_id = navaids_points_terminalsegmentpoint_pt_tssjgc.id
left join navaids_points.angleindication_pt navaids_points_angleindication_pt_sqhwnu on procedure.intermediateleg_ts.angle_id = navaids_points_angleindication_pt_sqhwnu.id
left join navaids_points.distanceindication_pt navaids_points_distanceindication_pt_nstokr on procedure.intermediateleg_ts.distance_id = navaids_points_distanceindication_pt_nstokr.id
left join procedure.holdinguse_pt procedure_holdinguse_pt_jcajrg on procedure.intermediateleg_ts.holding_id = procedure_holdinguse_pt_jcajrg.id
left join procedure.instrumentapproachprocedure_pt procedure_instrumentapproachprocedure_pt_tuyrvi on procedure.intermediateleg_ts.approach_id = procedure_instrumentapproachprocedure_pt_tuyrvi.id
left join master_join master_join_zjcdnr on procedure.intermediateleg_ts.id = master_join_zjcdnr.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_rzyvum on master_join_zjcdnr.target_id = shared_aircraftcharacteristic_view_rzyvum.id
left join master_join master_join_ncqlod on procedure.intermediateleg_ts.id = master_join_ncqlod.source_id
left join shared.obstacleassessmentarea_view shared_obstacleassessmentarea_view_fswqzr on master_join_ncqlod.target_id = shared_obstacleassessmentarea_view_fswqzr.id
left join master_join master_join_zdsxvm on procedure.intermediateleg_ts.id = master_join_zdsxvm.source_id
left join notes.note_view notes_note_view_kbneqc on master_join_zdsxvm.target_id = notes_note_view_kbneqc.id
where procedure.intermediateleg.feature_status = 'APPROVED'
  and procedure.intermediateleg_ts.feature_status = 'APPROVED'
group by
    procedure.intermediateleg.id,
    procedure.intermediateleg_ts.id,
    procedure.intermediateleg_tsp.id,
    procedure.intermediateleg.identifier,
    procedure.intermediateleg_ts.interpretation,
    procedure.intermediateleg_ts.sequence_number,
    procedure.intermediateleg_ts.correction_number,
    procedure.intermediateleg_ts.valid_time_begin,
    procedure.intermediateleg_ts.valid_time_end,
    procedure.intermediateleg_ts.feature_lifetime_begin,
    procedure.intermediateleg_ts.feature_lifetime_end,
    procedure.intermediateleg_ts.endconditiondesignator_value,
    procedure.intermediateleg_ts.endconditiondesignator_nilreason,
    procedure.intermediateleg_ts.legpath_value,
    procedure.intermediateleg_ts.legpath_nilreason,
    procedure.intermediateleg_ts.legtypearinc_value,
    procedure.intermediateleg_ts.legtypearinc_nilreason,
    procedure.intermediateleg_ts.course_value,
    procedure.intermediateleg_ts.course_nilreason,
    procedure.intermediateleg_ts.coursetype_value,
    procedure.intermediateleg_ts.coursetype_nilreason,
    procedure.intermediateleg_ts.coursedirection_value,
    procedure.intermediateleg_ts.coursedirection_nilreason,
    procedure.intermediateleg_ts.turndirection_value,
    procedure.intermediateleg_ts.turndirection_nilreason,
    procedure.intermediateleg_ts.speedreference_value,
    procedure.intermediateleg_ts.speedreference_nilreason,
    procedure.intermediateleg_ts.speedinterpretation_value,
    procedure.intermediateleg_ts.speedinterpretation_nilreason,
    procedure.intermediateleg_ts.bankangle_value,
    procedure.intermediateleg_ts.bankangle_nilreason,
    procedure.intermediateleg_ts.procedureturnrequired_value,
    procedure.intermediateleg_ts.procedureturnrequired_nilreason,
    procedure.intermediateleg_ts.upperlimitreference_value,
    procedure.intermediateleg_ts.upperlimitreference_nilreason,
    procedure.intermediateleg_ts.lowerlimitreference_value,
    procedure.intermediateleg_ts.lowerlimitreference_nilreason,
    procedure.intermediateleg_ts.altitudeinterpretation_value,
    procedure.intermediateleg_ts.altitudeinterpretation_nilreason,
    procedure.intermediateleg_ts.altitudeoverridereference_value,
    procedure.intermediateleg_ts.altitudeoverridereference_nilreason,
    procedure.intermediateleg_ts.verticalangle_value,
    procedure.intermediateleg_ts.verticalangle_nilreason,
    procedure.intermediateleg_ts.requirednavigationperformance_value,
    procedure.intermediateleg_ts.requirednavigationperformance_nilreason,
    procedure.intermediateleg_ts.speedlimit_value,
    procedure.intermediateleg_ts.speedlimit_uom,
    procedure.intermediateleg_ts.speedlimit_nilreason,
    procedure.intermediateleg_ts.length_value,
    procedure.intermediateleg_ts.length_uom,
    procedure.intermediateleg_ts.length_nilreason,
    procedure.intermediateleg_ts.duration_value,
    procedure.intermediateleg_ts.duration_uom,
    procedure.intermediateleg_ts.duration_nilreason,
    procedure.intermediateleg_ts.upperlimitaltitude_value,
    procedure.intermediateleg_ts.upperlimitaltitude_uom,
    procedure.intermediateleg_ts.upperlimitaltitude_nilreason,
    procedure.intermediateleg_ts.lowerlimitaltitude_value,
    procedure.intermediateleg_ts.lowerlimitaltitude_uom,
    procedure.intermediateleg_ts.lowerlimitaltitude_nilreason,
    procedure.intermediateleg_ts.altitudeoverrideatc_value,
    procedure.intermediateleg_ts.altitudeoverrideatc_uom,
    procedure.intermediateleg_ts.altitudeoverrideatc_nilreason,
    navaids_points_terminalsegmentpoint_pt_vdjkub.title,
    navaids_points_terminalsegmentpoint_pt_vdjkub.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_vdjkub.href,
    navaids_points_terminalsegmentpoint_pt_mjjbpa.title,
    navaids_points_terminalsegmentpoint_pt_mjjbpa.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_mjjbpa.href,
    geometry_curve_view_gjoalz.geom,
    navaids_points_terminalsegmentpoint_pt_tssjgc.title,
    navaids_points_terminalsegmentpoint_pt_tssjgc.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_tssjgc.href,
    navaids_points_angleindication_pt_sqhwnu.title,
    navaids_points_angleindication_pt_sqhwnu.nilreason[1],
    navaids_points_angleindication_pt_sqhwnu.href,
    navaids_points_distanceindication_pt_nstokr.title,
    navaids_points_distanceindication_pt_nstokr.nilreason[1],
    navaids_points_distanceindication_pt_nstokr.href,
    procedure_holdinguse_pt_jcajrg.title,
    procedure_holdinguse_pt_jcajrg.nilreason[1],
    procedure_holdinguse_pt_jcajrg.href,
    procedure_instrumentapproachprocedure_pt_tuyrvi.title,
    procedure_instrumentapproachprocedure_pt_tuyrvi.nilreason[1],
    procedure_instrumentapproachprocedure_pt_tuyrvi.href
order by intermediateleg.identifier, intermediateleg_ts.sequence_number, intermediateleg_ts.correction_number DESC;
-- LocalizerTimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.localizer_view as
select distinct on (localizer.identifier,localizer_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.localizer.id,
    navaids_points.localizer_ts.id as ts_id,
    navaids_points.localizer_tsp.id as tsp_id,
    navaids_points.localizer.identifier,
    navaids_points.localizer_ts.interpretation,
    navaids_points.localizer_ts.sequence_number,
    navaids_points.localizer_ts.correction_number,
    navaids_points.localizer_ts.valid_time_begin,
    navaids_points.localizer_ts.valid_time_end,
    navaids_points.localizer_ts.feature_lifetime_begin,
    navaids_points.localizer_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.localizer_ts.designator_value as varchar), '(' || navaids_points.localizer_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.localizer_ts.name_value as varchar), '(' || navaids_points.localizer_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.localizer_ts.emissionclass_value as varchar), '(' || navaids_points.localizer_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.localizer_ts.mobile_value as varchar), '(' || navaids_points.localizer_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.localizer_ts.magneticvariation_value as varchar), '(' || navaids_points.localizer_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.localizer_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.localizer_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.localizer_ts.datemagneticvariation_value as varchar), '(' || navaids_points.localizer_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.localizer_ts.flightchecked_value as varchar), '(' || navaids_points.localizer_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.localizer_ts.magneticbearing_value as varchar), '(' || navaids_points.localizer_ts.magneticbearing_nilreason || ')') as magneticbearing,
    coalesce(cast(navaids_points.localizer_ts.magneticbearingaccuracy_value as varchar), '(' || navaids_points.localizer_ts.magneticbearingaccuracy_nilreason || ')') as magneticbearingaccuracy,
    coalesce(cast(navaids_points.localizer_ts.truebearing_value as varchar), '(' || navaids_points.localizer_ts.truebearing_nilreason || ')') as truebearing,
    coalesce(cast(navaids_points.localizer_ts.truebearingaccuracy_value as varchar), '(' || navaids_points.localizer_ts.truebearingaccuracy_nilreason || ')') as truebearingaccuracy,
    coalesce(cast(navaids_points.localizer_ts.declination_value as varchar), '(' || navaids_points.localizer_ts.declination_nilreason || ')') as declination,
    coalesce(cast(navaids_points.localizer_ts.widthcourse_value as varchar), '(' || navaids_points.localizer_ts.widthcourse_nilreason || ')') as widthcourse,
    coalesce(cast(navaids_points.localizer_ts.widthcourseaccuracy_value as varchar), '(' || navaids_points.localizer_ts.widthcourseaccuracy_nilreason || ')') as widthcourseaccuracy,
    coalesce(cast(navaids_points.localizer_ts.backcourseusable_value as varchar), '(' || navaids_points.localizer_ts.backcourseusable_nilreason || ')') as backcourseusable,
    coalesce(cast(navaids_points.localizer_ts.frequency_value as varchar) || ' ' || navaids_points.localizer_ts.frequency_uom, '(' || navaids_points.localizer_ts.frequency_nilreason || ')') as frequency,
    geometry_elevatedpoint_view_tmxnum.geom AS geom,
    ST_X(geometry_elevatedpoint_view_tmxnum.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_tmxnum.geom) AS latitude,
    geometry_elevatedpoint_view_tmxnum.elevation,
    geometry_elevatedpoint_view_tmxnum.geoidUndulation,
    geometry_elevatedpoint_view_tmxnum.verticalDatum,
    geometry_elevatedpoint_view_tmxnum.verticalAccuracy,
    geometry_elevatedpoint_view_tmxnum.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_fkrlwd.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_vzvopv.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_tuxkyj.id) AS availability,
    jsonb_agg(notes_note_view_ksfkjo.*) AS localizer_annotation
from navaids_points.localizer 
inner join master_join mj2 on navaids_points.localizer.id = mj2.source_id
inner join navaids_points.localizer_tsp on mj2.target_id = navaids_points.localizer_tsp.id
inner join navaids_points.localizer_ts on navaids_points.localizer_tsp.localizertimeslice_id = navaids_points.localizer_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_tmxnum on navaids_points.localizer_ts.location_id = geometry_elevatedpoint_view_tmxnum.id
left join master_join master_join_fccpxs on navaids_points.localizer_ts.id = master_join_fccpxs.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_fkrlwd on master_join_fccpxs.target_id = navaids_points_authorityfornavaidequipment_view_fkrlwd.id
left join master_join master_join_wnuxer on navaids_points.localizer_ts.id = master_join_wnuxer.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_vzvopv on master_join_wnuxer.target_id = navaids_points_navaidequipmentmonitoring_view_vzvopv.id
left join master_join master_join_czvqtd on navaids_points.localizer_ts.id = master_join_czvqtd.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_tuxkyj on master_join_czvqtd.target_id = navaids_points_navaidoperationalstatus_view_tuxkyj.id
left join master_join master_join_yrrjlk on navaids_points.localizer_ts.id = master_join_yrrjlk.source_id
left join notes.note_view notes_note_view_ksfkjo on master_join_yrrjlk.target_id = notes_note_view_ksfkjo.id
where navaids_points.localizer.feature_status = 'APPROVED'
  and navaids_points.localizer_ts.feature_status = 'APPROVED'
group by
    navaids_points.localizer.id,
    navaids_points.localizer_ts.id,
    navaids_points.localizer_tsp.id,
    navaids_points.localizer.identifier,
    navaids_points.localizer_ts.interpretation,
    navaids_points.localizer_ts.sequence_number,
    navaids_points.localizer_ts.correction_number,
    navaids_points.localizer_ts.valid_time_begin,
    navaids_points.localizer_ts.valid_time_end,
    navaids_points.localizer_ts.feature_lifetime_begin,
    navaids_points.localizer_ts.feature_lifetime_end,
    navaids_points.localizer_ts.designator_value,
    navaids_points.localizer_ts.designator_nilreason,
    navaids_points.localizer_ts.name_value,
    navaids_points.localizer_ts.name_nilreason,
    navaids_points.localizer_ts.emissionclass_value,
    navaids_points.localizer_ts.emissionclass_nilreason,
    navaids_points.localizer_ts.mobile_value,
    navaids_points.localizer_ts.mobile_nilreason,
    navaids_points.localizer_ts.magneticvariation_value,
    navaids_points.localizer_ts.magneticvariation_nilreason,
    navaids_points.localizer_ts.magneticvariationaccuracy_value,
    navaids_points.localizer_ts.magneticvariationaccuracy_nilreason,
    navaids_points.localizer_ts.datemagneticvariation_value,
    navaids_points.localizer_ts.datemagneticvariation_nilreason,
    navaids_points.localizer_ts.flightchecked_value,
    navaids_points.localizer_ts.flightchecked_nilreason,
    navaids_points.localizer_ts.magneticbearing_value,
    navaids_points.localizer_ts.magneticbearing_nilreason,
    navaids_points.localizer_ts.magneticbearingaccuracy_value,
    navaids_points.localizer_ts.magneticbearingaccuracy_nilreason,
    navaids_points.localizer_ts.truebearing_value,
    navaids_points.localizer_ts.truebearing_nilreason,
    navaids_points.localizer_ts.truebearingaccuracy_value,
    navaids_points.localizer_ts.truebearingaccuracy_nilreason,
    navaids_points.localizer_ts.declination_value,
    navaids_points.localizer_ts.declination_nilreason,
    navaids_points.localizer_ts.widthcourse_value,
    navaids_points.localizer_ts.widthcourse_nilreason,
    navaids_points.localizer_ts.widthcourseaccuracy_value,
    navaids_points.localizer_ts.widthcourseaccuracy_nilreason,
    navaids_points.localizer_ts.backcourseusable_value,
    navaids_points.localizer_ts.backcourseusable_nilreason,
    navaids_points.localizer_ts.frequency_value,
    navaids_points.localizer_ts.frequency_uom,
    navaids_points.localizer_ts.frequency_nilreason,
    geometry_elevatedpoint_view_tmxnum.geom,
    geometry_elevatedpoint_view_tmxnum.elevation,
    geometry_elevatedpoint_view_tmxnum.geoidUndulation,
    geometry_elevatedpoint_view_tmxnum.verticalDatum,
    geometry_elevatedpoint_view_tmxnum.verticalAccuracy,
    geometry_elevatedpoint_view_tmxnum.horizontalAccuracy
order by localizer.identifier, localizer_ts.sequence_number, localizer_ts.correction_number DESC;
-- MarkerBeaconTimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.markerbeacon_view as
select distinct on (markerbeacon.identifier,markerbeacon_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.markerbeacon.id,
    navaids_points.markerbeacon_ts.id as ts_id,
    navaids_points.markerbeacon_tsp.id as tsp_id,
    navaids_points.markerbeacon.identifier,
    navaids_points.markerbeacon_ts.interpretation,
    navaids_points.markerbeacon_ts.sequence_number,
    navaids_points.markerbeacon_ts.correction_number,
    navaids_points.markerbeacon_ts.valid_time_begin,
    navaids_points.markerbeacon_ts.valid_time_end,
    navaids_points.markerbeacon_ts.feature_lifetime_begin,
    navaids_points.markerbeacon_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.markerbeacon_ts.designator_value as varchar), '(' || navaids_points.markerbeacon_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.markerbeacon_ts.name_value as varchar), '(' || navaids_points.markerbeacon_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.markerbeacon_ts.emissionclass_value as varchar), '(' || navaids_points.markerbeacon_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.markerbeacon_ts.mobile_value as varchar), '(' || navaids_points.markerbeacon_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.markerbeacon_ts.magneticvariation_value as varchar), '(' || navaids_points.markerbeacon_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.markerbeacon_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.markerbeacon_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.markerbeacon_ts.datemagneticvariation_value as varchar), '(' || navaids_points.markerbeacon_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.markerbeacon_ts.flightchecked_value as varchar), '(' || navaids_points.markerbeacon_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.markerbeacon_ts.class_value as varchar), '(' || navaids_points.markerbeacon_ts.class_nilreason || ')') as class,
    coalesce(cast(navaids_points.markerbeacon_ts.axisbearing_value as varchar), '(' || navaids_points.markerbeacon_ts.axisbearing_nilreason || ')') as axisbearing,
    coalesce(cast(navaids_points.markerbeacon_ts.auralmorsecode_value as varchar), '(' || navaids_points.markerbeacon_ts.auralmorsecode_nilreason || ')') as auralmorsecode,
    coalesce(cast(navaids_points.markerbeacon_ts.frequency_value as varchar) || ' ' || navaids_points.markerbeacon_ts.frequency_uom, '(' || navaids_points.markerbeacon_ts.frequency_nilreason || ')') as frequency,
    geometry_elevatedpoint_view_lcmine.geom AS geom,
    ST_X(geometry_elevatedpoint_view_lcmine.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_lcmine.geom) AS latitude,
    geometry_elevatedpoint_view_lcmine.elevation,
    geometry_elevatedpoint_view_lcmine.geoidUndulation,
    geometry_elevatedpoint_view_lcmine.verticalDatum,
    geometry_elevatedpoint_view_lcmine.verticalAccuracy,
    geometry_elevatedpoint_view_lcmine.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_pbjzpp.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_kipshv.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_rsacev.id) AS availability,
    jsonb_agg(notes_note_view_syxufg.*) AS markerbeacon_annotation
from navaids_points.markerbeacon 
inner join master_join mj2 on navaids_points.markerbeacon.id = mj2.source_id
inner join navaids_points.markerbeacon_tsp on mj2.target_id = navaids_points.markerbeacon_tsp.id
inner join navaids_points.markerbeacon_ts on navaids_points.markerbeacon_tsp.markerbeacontimeslice_id = navaids_points.markerbeacon_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_lcmine on navaids_points.markerbeacon_ts.location_id = geometry_elevatedpoint_view_lcmine.id
left join master_join master_join_knfrwq on navaids_points.markerbeacon_ts.id = master_join_knfrwq.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_pbjzpp on master_join_knfrwq.target_id = navaids_points_authorityfornavaidequipment_view_pbjzpp.id
left join master_join master_join_ymimct on navaids_points.markerbeacon_ts.id = master_join_ymimct.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_kipshv on master_join_ymimct.target_id = navaids_points_navaidequipmentmonitoring_view_kipshv.id
left join master_join master_join_pqzsxq on navaids_points.markerbeacon_ts.id = master_join_pqzsxq.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_rsacev on master_join_pqzsxq.target_id = navaids_points_navaidoperationalstatus_view_rsacev.id
left join master_join master_join_ibreyt on navaids_points.markerbeacon_ts.id = master_join_ibreyt.source_id
left join notes.note_view notes_note_view_syxufg on master_join_ibreyt.target_id = notes_note_view_syxufg.id
where navaids_points.markerbeacon.feature_status = 'APPROVED'
  and navaids_points.markerbeacon_ts.feature_status = 'APPROVED'
group by
    navaids_points.markerbeacon.id,
    navaids_points.markerbeacon_ts.id,
    navaids_points.markerbeacon_tsp.id,
    navaids_points.markerbeacon.identifier,
    navaids_points.markerbeacon_ts.interpretation,
    navaids_points.markerbeacon_ts.sequence_number,
    navaids_points.markerbeacon_ts.correction_number,
    navaids_points.markerbeacon_ts.valid_time_begin,
    navaids_points.markerbeacon_ts.valid_time_end,
    navaids_points.markerbeacon_ts.feature_lifetime_begin,
    navaids_points.markerbeacon_ts.feature_lifetime_end,
    navaids_points.markerbeacon_ts.designator_value,
    navaids_points.markerbeacon_ts.designator_nilreason,
    navaids_points.markerbeacon_ts.name_value,
    navaids_points.markerbeacon_ts.name_nilreason,
    navaids_points.markerbeacon_ts.emissionclass_value,
    navaids_points.markerbeacon_ts.emissionclass_nilreason,
    navaids_points.markerbeacon_ts.mobile_value,
    navaids_points.markerbeacon_ts.mobile_nilreason,
    navaids_points.markerbeacon_ts.magneticvariation_value,
    navaids_points.markerbeacon_ts.magneticvariation_nilreason,
    navaids_points.markerbeacon_ts.magneticvariationaccuracy_value,
    navaids_points.markerbeacon_ts.magneticvariationaccuracy_nilreason,
    navaids_points.markerbeacon_ts.datemagneticvariation_value,
    navaids_points.markerbeacon_ts.datemagneticvariation_nilreason,
    navaids_points.markerbeacon_ts.flightchecked_value,
    navaids_points.markerbeacon_ts.flightchecked_nilreason,
    navaids_points.markerbeacon_ts.class_value,
    navaids_points.markerbeacon_ts.class_nilreason,
    navaids_points.markerbeacon_ts.axisbearing_value,
    navaids_points.markerbeacon_ts.axisbearing_nilreason,
    navaids_points.markerbeacon_ts.auralmorsecode_value,
    navaids_points.markerbeacon_ts.auralmorsecode_nilreason,
    navaids_points.markerbeacon_ts.frequency_value,
    navaids_points.markerbeacon_ts.frequency_uom,
    navaids_points.markerbeacon_ts.frequency_nilreason,
    geometry_elevatedpoint_view_lcmine.geom,
    geometry_elevatedpoint_view_lcmine.elevation,
    geometry_elevatedpoint_view_lcmine.geoidUndulation,
    geometry_elevatedpoint_view_lcmine.verticalDatum,
    geometry_elevatedpoint_view_lcmine.verticalAccuracy,
    geometry_elevatedpoint_view_lcmine.horizontalAccuracy
order by markerbeacon.identifier, markerbeacon_ts.sequence_number, markerbeacon_ts.correction_number DESC;
-- MarkingBuoyTimeSliceType
-- ['notes.note_view', 'geometry.elevatedpoint_view']
create or replace view airport_heliport.markingbuoy_view as
select distinct on (markingbuoy.identifier,markingbuoy_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.markingbuoy.id,
    airport_heliport.markingbuoy_ts.id as ts_id,
    airport_heliport.markingbuoy_tsp.id as tsp_id,
    airport_heliport.markingbuoy.identifier,
    airport_heliport.markingbuoy_ts.interpretation,
    airport_heliport.markingbuoy_ts.sequence_number,
    airport_heliport.markingbuoy_ts.correction_number,
    airport_heliport.markingbuoy_ts.valid_time_begin,
    airport_heliport.markingbuoy_ts.valid_time_end,
    airport_heliport.markingbuoy_ts.feature_lifetime_begin,
    airport_heliport.markingbuoy_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.markingbuoy_ts.type_value as varchar), '(' || airport_heliport.markingbuoy_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.markingbuoy_ts.colour_value as varchar), '(' || airport_heliport.markingbuoy_ts.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport_seaplanelandingarea_pt_fwdwbn.title as varchar), '(' || airport_heliport_seaplanelandingarea_pt_fwdwbn.nilreason[1] || ')') AS theseaplanelandingarea,
    airport_heliport_seaplanelandingarea_pt_fwdwbn.href AS theseaplanelandingarea_href,
    geometry_elevatedpoint_view_nenwdh.geom AS geom,
    ST_X(geometry_elevatedpoint_view_nenwdh.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_nenwdh.geom) AS latitude,
    geometry_elevatedpoint_view_nenwdh.elevation,
    geometry_elevatedpoint_view_nenwdh.geoidUndulation,
    geometry_elevatedpoint_view_nenwdh.verticalDatum,
    geometry_elevatedpoint_view_nenwdh.verticalAccuracy,
    geometry_elevatedpoint_view_nenwdh.horizontalAccuracy,
    jsonb_agg(notes_note_view_bwolmr.*) AS markingbuoy_annotation
from airport_heliport.markingbuoy 
inner join master_join mj2 on airport_heliport.markingbuoy.id = mj2.source_id
inner join airport_heliport.markingbuoy_tsp on mj2.target_id = airport_heliport.markingbuoy_tsp.id
inner join airport_heliport.markingbuoy_ts on airport_heliport.markingbuoy_tsp.markingbuoytimeslice_id = airport_heliport.markingbuoy_ts.id
left join airport_heliport.seaplanelandingarea_pt airport_heliport_seaplanelandingarea_pt_fwdwbn on airport_heliport.markingbuoy_ts.theseaplanelandingarea_id = airport_heliport_seaplanelandingarea_pt_fwdwbn.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_nenwdh on airport_heliport.markingbuoy_ts.location_id = geometry_elevatedpoint_view_nenwdh.id
left join master_join master_join_yiqjwb on airport_heliport.markingbuoy_ts.id = master_join_yiqjwb.source_id
left join notes.note_view notes_note_view_bwolmr on master_join_yiqjwb.target_id = notes_note_view_bwolmr.id
where airport_heliport.markingbuoy.feature_status = 'APPROVED'
  and airport_heliport.markingbuoy_ts.feature_status = 'APPROVED'
group by
    airport_heliport.markingbuoy.id,
    airport_heliport.markingbuoy_ts.id,
    airport_heliport.markingbuoy_tsp.id,
    airport_heliport.markingbuoy.identifier,
    airport_heliport.markingbuoy_ts.interpretation,
    airport_heliport.markingbuoy_ts.sequence_number,
    airport_heliport.markingbuoy_ts.correction_number,
    airport_heliport.markingbuoy_ts.valid_time_begin,
    airport_heliport.markingbuoy_ts.valid_time_end,
    airport_heliport.markingbuoy_ts.feature_lifetime_begin,
    airport_heliport.markingbuoy_ts.feature_lifetime_end,
    airport_heliport.markingbuoy_ts.type_value,
    airport_heliport.markingbuoy_ts.type_nilreason,
    airport_heliport.markingbuoy_ts.colour_value,
    airport_heliport.markingbuoy_ts.colour_nilreason,
    airport_heliport_seaplanelandingarea_pt_fwdwbn.title,
    airport_heliport_seaplanelandingarea_pt_fwdwbn.nilreason[1],
    airport_heliport_seaplanelandingarea_pt_fwdwbn.href,
    geometry_elevatedpoint_view_nenwdh.geom,
    geometry_elevatedpoint_view_nenwdh.elevation,
    geometry_elevatedpoint_view_nenwdh.geoidUndulation,
    geometry_elevatedpoint_view_nenwdh.verticalDatum,
    geometry_elevatedpoint_view_nenwdh.verticalAccuracy,
    geometry_elevatedpoint_view_nenwdh.horizontalAccuracy
order by markingbuoy.identifier, markingbuoy_ts.sequence_number, markingbuoy_ts.correction_number DESC;
-- MissedApproachLegTimeSliceType
-- ['procedure.approachcondition_view', 'notes.note_view', 'shared.aircraftcharacteristic_view', 'shared.obstacleassessmentarea_view', 'geometry.curve_view']
create or replace view procedure.missedapproachleg_view as
select distinct on (missedapproachleg.identifier,missedapproachleg_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.missedapproachleg.id,
    procedure.missedapproachleg_ts.id as ts_id,
    procedure.missedapproachleg_tsp.id as tsp_id,
    procedure.missedapproachleg.identifier,
    procedure.missedapproachleg_ts.interpretation,
    procedure.missedapproachleg_ts.sequence_number,
    procedure.missedapproachleg_ts.correction_number,
    procedure.missedapproachleg_ts.valid_time_begin,
    procedure.missedapproachleg_ts.valid_time_end,
    procedure.missedapproachleg_ts.feature_lifetime_begin,
    procedure.missedapproachleg_ts.feature_lifetime_end,
    coalesce(cast(procedure.missedapproachleg_ts.endconditiondesignator_value as varchar), '(' || procedure.missedapproachleg_ts.endconditiondesignator_nilreason || ')') as endconditiondesignator,
    coalesce(cast(procedure.missedapproachleg_ts.legpath_value as varchar), '(' || procedure.missedapproachleg_ts.legpath_nilreason || ')') as legpath,
    coalesce(cast(procedure.missedapproachleg_ts.legtypearinc_value as varchar), '(' || procedure.missedapproachleg_ts.legtypearinc_nilreason || ')') as legtypearinc,
    coalesce(cast(procedure.missedapproachleg_ts.course_value as varchar), '(' || procedure.missedapproachleg_ts.course_nilreason || ')') as course,
    coalesce(cast(procedure.missedapproachleg_ts.coursetype_value as varchar), '(' || procedure.missedapproachleg_ts.coursetype_nilreason || ')') as coursetype,
    coalesce(cast(procedure.missedapproachleg_ts.coursedirection_value as varchar), '(' || procedure.missedapproachleg_ts.coursedirection_nilreason || ')') as coursedirection,
    coalesce(cast(procedure.missedapproachleg_ts.turndirection_value as varchar), '(' || procedure.missedapproachleg_ts.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(procedure.missedapproachleg_ts.speedreference_value as varchar), '(' || procedure.missedapproachleg_ts.speedreference_nilreason || ')') as speedreference,
    coalesce(cast(procedure.missedapproachleg_ts.speedinterpretation_value as varchar), '(' || procedure.missedapproachleg_ts.speedinterpretation_nilreason || ')') as speedinterpretation,
    coalesce(cast(procedure.missedapproachleg_ts.bankangle_value as varchar), '(' || procedure.missedapproachleg_ts.bankangle_nilreason || ')') as bankangle,
    coalesce(cast(procedure.missedapproachleg_ts.procedureturnrequired_value as varchar), '(' || procedure.missedapproachleg_ts.procedureturnrequired_nilreason || ')') as procedureturnrequired,
    coalesce(cast(procedure.missedapproachleg_ts.upperlimitreference_value as varchar), '(' || procedure.missedapproachleg_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(procedure.missedapproachleg_ts.lowerlimitreference_value as varchar), '(' || procedure.missedapproachleg_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(procedure.missedapproachleg_ts.altitudeinterpretation_value as varchar), '(' || procedure.missedapproachleg_ts.altitudeinterpretation_nilreason || ')') as altitudeinterpretation,
    coalesce(cast(procedure.missedapproachleg_ts.altitudeoverridereference_value as varchar), '(' || procedure.missedapproachleg_ts.altitudeoverridereference_nilreason || ')') as altitudeoverridereference,
    coalesce(cast(procedure.missedapproachleg_ts.verticalangle_value as varchar), '(' || procedure.missedapproachleg_ts.verticalangle_nilreason || ')') as verticalangle,
    coalesce(cast(procedure.missedapproachleg_ts.type_value as varchar), '(' || procedure.missedapproachleg_ts.type_nilreason || ')') as type,
    coalesce(cast(procedure.missedapproachleg_ts.thresholdaftermapt_value as varchar), '(' || procedure.missedapproachleg_ts.thresholdaftermapt_nilreason || ')') as thresholdaftermapt,
    coalesce(cast(procedure.missedapproachleg_ts.requirednavigationperformance_value as varchar), '(' || procedure.missedapproachleg_ts.requirednavigationperformance_nilreason || ')') as requirednavigationperformance,
    coalesce(cast(procedure.missedapproachleg_ts.speedlimit_value as varchar) || ' ' || procedure.missedapproachleg_ts.speedlimit_uom, '(' || procedure.missedapproachleg_ts.speedlimit_nilreason || ')') as speedlimit,
    coalesce(cast(procedure.missedapproachleg_ts.length_value as varchar) || ' ' || procedure.missedapproachleg_ts.length_uom, '(' || procedure.missedapproachleg_ts.length_nilreason || ')') as length,
    coalesce(cast(procedure.missedapproachleg_ts.duration_value as varchar) || ' ' || procedure.missedapproachleg_ts.duration_uom, '(' || procedure.missedapproachleg_ts.duration_nilreason || ')') as duration,
    coalesce(cast(procedure.missedapproachleg_ts.upperlimitaltitude_value as varchar) || ' ' || procedure.missedapproachleg_ts.upperlimitaltitude_uom, '(' || procedure.missedapproachleg_ts.upperlimitaltitude_nilreason || ')') as upperlimitaltitude,
    coalesce(cast(procedure.missedapproachleg_ts.lowerlimitaltitude_value as varchar) || ' ' || procedure.missedapproachleg_ts.lowerlimitaltitude_uom, '(' || procedure.missedapproachleg_ts.lowerlimitaltitude_nilreason || ')') as lowerlimitaltitude,
    coalesce(cast(procedure.missedapproachleg_ts.altitudeoverrideatc_value as varchar) || ' ' || procedure.missedapproachleg_ts.altitudeoverrideatc_uom, '(' || procedure.missedapproachleg_ts.altitudeoverrideatc_nilreason || ')') as altitudeoverrideatc,
    coalesce(cast(procedure.missedapproachleg_ts.heightmapt_value as varchar) || ' ' || procedure.missedapproachleg_ts.heightmapt_uom, '(' || procedure.missedapproachleg_ts.heightmapt_nilreason || ')') as heightmapt,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_bzixbc.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_bzixbc.nilreason[1] || ')') AS startpoint,
    navaids_points_terminalsegmentpoint_pt_bzixbc.href AS startpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_xtgiqa.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_xtgiqa.nilreason[1] || ')') AS endpoint,
    navaids_points_terminalsegmentpoint_pt_xtgiqa.href AS endpoint_href,
    coalesce(cast(navaids_points_terminalsegmentpoint_pt_naujbk.title as varchar), '(' || navaids_points_terminalsegmentpoint_pt_naujbk.nilreason[1] || ')') AS arccentre,
    navaids_points_terminalsegmentpoint_pt_naujbk.href AS arccentre_href,
    geometry_curve_view_orceap.geom AS geom,
    coalesce(cast(navaids_points_angleindication_pt_ccvxzo.title as varchar), '(' || navaids_points_angleindication_pt_ccvxzo.nilreason[1] || ')') AS angle,
    navaids_points_angleindication_pt_ccvxzo.href AS angle_href,
    coalesce(cast(navaids_points_distanceindication_pt_hhytvh.title as varchar), '(' || navaids_points_distanceindication_pt_hhytvh.nilreason[1] || ')') AS distance,
    navaids_points_distanceindication_pt_hhytvh.href AS distance_href,
    coalesce(cast(procedure_holdinguse_pt_zhtgcl.title as varchar), '(' || procedure_holdinguse_pt_zhtgcl.nilreason[1] || ')') AS holding,
    procedure_holdinguse_pt_zhtgcl.href AS holding_href,
    coalesce(cast(procedure_instrumentapproachprocedure_pt_fxpqsk.title as varchar), '(' || procedure_instrumentapproachprocedure_pt_fxpqsk.nilreason[1] || ')') AS approach,
    procedure_instrumentapproachprocedure_pt_fxpqsk.href AS approach_href,
    jsonb_agg(shared_aircraftcharacteristic_view_ouuhpn.id) AS aircraftcategory,
    jsonb_agg(shared_obstacleassessmentarea_view_qvzlda.id) AS designsurface,
    jsonb_agg(notes_note_view_vdpzcn.*) AS missedapproachleg_annotation,
    jsonb_agg(procedure_approachcondition_view_kemols.id) AS condition
from procedure.missedapproachleg 
inner join master_join mj2 on procedure.missedapproachleg.id = mj2.source_id
inner join procedure.missedapproachleg_tsp on mj2.target_id = procedure.missedapproachleg_tsp.id
inner join procedure.missedapproachleg_ts on procedure.missedapproachleg_tsp.missedapproachlegtimeslice_id = procedure.missedapproachleg_ts.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_bzixbc on procedure.missedapproachleg_ts.startpoint_id = navaids_points_terminalsegmentpoint_pt_bzixbc.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_xtgiqa on procedure.missedapproachleg_ts.endpoint_id = navaids_points_terminalsegmentpoint_pt_xtgiqa.id
left join geometry.curve_view geometry_curve_view_orceap on procedure.missedapproachleg_ts.trajectory_id = geometry_curve_view_orceap.id
left join navaids_points.terminalsegmentpoint_pt navaids_points_terminalsegmentpoint_pt_naujbk on procedure.missedapproachleg_ts.arccentre_id = navaids_points_terminalsegmentpoint_pt_naujbk.id
left join navaids_points.angleindication_pt navaids_points_angleindication_pt_ccvxzo on procedure.missedapproachleg_ts.angle_id = navaids_points_angleindication_pt_ccvxzo.id
left join navaids_points.distanceindication_pt navaids_points_distanceindication_pt_hhytvh on procedure.missedapproachleg_ts.distance_id = navaids_points_distanceindication_pt_hhytvh.id
left join procedure.holdinguse_pt procedure_holdinguse_pt_zhtgcl on procedure.missedapproachleg_ts.holding_id = procedure_holdinguse_pt_zhtgcl.id
left join procedure.instrumentapproachprocedure_pt procedure_instrumentapproachprocedure_pt_fxpqsk on procedure.missedapproachleg_ts.approach_id = procedure_instrumentapproachprocedure_pt_fxpqsk.id
left join master_join master_join_hebgfk on procedure.missedapproachleg_ts.id = master_join_hebgfk.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_ouuhpn on master_join_hebgfk.target_id = shared_aircraftcharacteristic_view_ouuhpn.id
left join master_join master_join_nzpefb on procedure.missedapproachleg_ts.id = master_join_nzpefb.source_id
left join shared.obstacleassessmentarea_view shared_obstacleassessmentarea_view_qvzlda on master_join_nzpefb.target_id = shared_obstacleassessmentarea_view_qvzlda.id
left join master_join master_join_jkpgls on procedure.missedapproachleg_ts.id = master_join_jkpgls.source_id
left join notes.note_view notes_note_view_vdpzcn on master_join_jkpgls.target_id = notes_note_view_vdpzcn.id
left join master_join master_join_cchrgw on procedure.missedapproachleg_ts.id = master_join_cchrgw.source_id
left join procedure.approachcondition_view procedure_approachcondition_view_kemols on master_join_cchrgw.target_id = procedure_approachcondition_view_kemols.id
where procedure.missedapproachleg.feature_status = 'APPROVED'
  and procedure.missedapproachleg_ts.feature_status = 'APPROVED'
group by
    procedure.missedapproachleg.id,
    procedure.missedapproachleg_ts.id,
    procedure.missedapproachleg_tsp.id,
    procedure.missedapproachleg.identifier,
    procedure.missedapproachleg_ts.interpretation,
    procedure.missedapproachleg_ts.sequence_number,
    procedure.missedapproachleg_ts.correction_number,
    procedure.missedapproachleg_ts.valid_time_begin,
    procedure.missedapproachleg_ts.valid_time_end,
    procedure.missedapproachleg_ts.feature_lifetime_begin,
    procedure.missedapproachleg_ts.feature_lifetime_end,
    procedure.missedapproachleg_ts.endconditiondesignator_value,
    procedure.missedapproachleg_ts.endconditiondesignator_nilreason,
    procedure.missedapproachleg_ts.legpath_value,
    procedure.missedapproachleg_ts.legpath_nilreason,
    procedure.missedapproachleg_ts.legtypearinc_value,
    procedure.missedapproachleg_ts.legtypearinc_nilreason,
    procedure.missedapproachleg_ts.course_value,
    procedure.missedapproachleg_ts.course_nilreason,
    procedure.missedapproachleg_ts.coursetype_value,
    procedure.missedapproachleg_ts.coursetype_nilreason,
    procedure.missedapproachleg_ts.coursedirection_value,
    procedure.missedapproachleg_ts.coursedirection_nilreason,
    procedure.missedapproachleg_ts.turndirection_value,
    procedure.missedapproachleg_ts.turndirection_nilreason,
    procedure.missedapproachleg_ts.speedreference_value,
    procedure.missedapproachleg_ts.speedreference_nilreason,
    procedure.missedapproachleg_ts.speedinterpretation_value,
    procedure.missedapproachleg_ts.speedinterpretation_nilreason,
    procedure.missedapproachleg_ts.bankangle_value,
    procedure.missedapproachleg_ts.bankangle_nilreason,
    procedure.missedapproachleg_ts.procedureturnrequired_value,
    procedure.missedapproachleg_ts.procedureturnrequired_nilreason,
    procedure.missedapproachleg_ts.upperlimitreference_value,
    procedure.missedapproachleg_ts.upperlimitreference_nilreason,
    procedure.missedapproachleg_ts.lowerlimitreference_value,
    procedure.missedapproachleg_ts.lowerlimitreference_nilreason,
    procedure.missedapproachleg_ts.altitudeinterpretation_value,
    procedure.missedapproachleg_ts.altitudeinterpretation_nilreason,
    procedure.missedapproachleg_ts.altitudeoverridereference_value,
    procedure.missedapproachleg_ts.altitudeoverridereference_nilreason,
    procedure.missedapproachleg_ts.verticalangle_value,
    procedure.missedapproachleg_ts.verticalangle_nilreason,
    procedure.missedapproachleg_ts.type_value,
    procedure.missedapproachleg_ts.type_nilreason,
    procedure.missedapproachleg_ts.thresholdaftermapt_value,
    procedure.missedapproachleg_ts.thresholdaftermapt_nilreason,
    procedure.missedapproachleg_ts.requirednavigationperformance_value,
    procedure.missedapproachleg_ts.requirednavigationperformance_nilreason,
    procedure.missedapproachleg_ts.speedlimit_value,
    procedure.missedapproachleg_ts.speedlimit_uom,
    procedure.missedapproachleg_ts.speedlimit_nilreason,
    procedure.missedapproachleg_ts.length_value,
    procedure.missedapproachleg_ts.length_uom,
    procedure.missedapproachleg_ts.length_nilreason,
    procedure.missedapproachleg_ts.duration_value,
    procedure.missedapproachleg_ts.duration_uom,
    procedure.missedapproachleg_ts.duration_nilreason,
    procedure.missedapproachleg_ts.upperlimitaltitude_value,
    procedure.missedapproachleg_ts.upperlimitaltitude_uom,
    procedure.missedapproachleg_ts.upperlimitaltitude_nilreason,
    procedure.missedapproachleg_ts.lowerlimitaltitude_value,
    procedure.missedapproachleg_ts.lowerlimitaltitude_uom,
    procedure.missedapproachleg_ts.lowerlimitaltitude_nilreason,
    procedure.missedapproachleg_ts.altitudeoverrideatc_value,
    procedure.missedapproachleg_ts.altitudeoverrideatc_uom,
    procedure.missedapproachleg_ts.altitudeoverrideatc_nilreason,
    procedure.missedapproachleg_ts.heightmapt_value,
    procedure.missedapproachleg_ts.heightmapt_uom,
    procedure.missedapproachleg_ts.heightmapt_nilreason,
    navaids_points_terminalsegmentpoint_pt_bzixbc.title,
    navaids_points_terminalsegmentpoint_pt_bzixbc.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_bzixbc.href,
    navaids_points_terminalsegmentpoint_pt_xtgiqa.title,
    navaids_points_terminalsegmentpoint_pt_xtgiqa.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_xtgiqa.href,
    geometry_curve_view_orceap.geom,
    navaids_points_terminalsegmentpoint_pt_naujbk.title,
    navaids_points_terminalsegmentpoint_pt_naujbk.nilreason[1],
    navaids_points_terminalsegmentpoint_pt_naujbk.href,
    navaids_points_angleindication_pt_ccvxzo.title,
    navaids_points_angleindication_pt_ccvxzo.nilreason[1],
    navaids_points_angleindication_pt_ccvxzo.href,
    navaids_points_distanceindication_pt_hhytvh.title,
    navaids_points_distanceindication_pt_hhytvh.nilreason[1],
    navaids_points_distanceindication_pt_hhytvh.href,
    procedure_holdinguse_pt_zhtgcl.title,
    procedure_holdinguse_pt_zhtgcl.nilreason[1],
    procedure_holdinguse_pt_zhtgcl.href,
    procedure_instrumentapproachprocedure_pt_fxpqsk.title,
    procedure_instrumentapproachprocedure_pt_fxpqsk.nilreason[1],
    procedure_instrumentapproachprocedure_pt_fxpqsk.href
order by missedapproachleg.identifier, missedapproachleg_ts.sequence_number, missedapproachleg_ts.correction_number DESC;
-- NavaidTimeSliceType
-- ['navaids_points.navaidcomponent_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidoperationalstatus_view']
create or replace view navaids_points.navaid_view as
select distinct on (navaid.identifier,navaid_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.navaid.id,
    navaids_points.navaid_ts.id as ts_id,
    navaids_points.navaid_tsp.id as tsp_id,
    navaids_points.navaid.identifier,
    navaids_points.navaid_ts.interpretation,
    navaids_points.navaid_ts.sequence_number,
    navaids_points.navaid_ts.correction_number,
    navaids_points.navaid_ts.valid_time_begin,
    navaids_points.navaid_ts.valid_time_end,
    navaids_points.navaid_ts.feature_lifetime_begin,
    navaids_points.navaid_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.navaid_ts.type_value as varchar), '(' || navaids_points.navaid_ts.type_nilreason || ')') as type,
    coalesce(cast(navaids_points.navaid_ts.designator_value as varchar), '(' || navaids_points.navaid_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.navaid_ts.name_value as varchar), '(' || navaids_points.navaid_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.navaid_ts.flightchecked_value as varchar), '(' || navaids_points.navaid_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.navaid_ts.purpose_value as varchar), '(' || navaids_points.navaid_ts.purpose_nilreason || ')') as purpose,
    coalesce(cast(navaids_points.navaid_ts.signalperformance_value as varchar), '(' || navaids_points.navaid_ts.signalperformance_nilreason || ')') as signalperformance,
    coalesce(cast(navaids_points.navaid_ts.coursequality_value as varchar), '(' || navaids_points.navaid_ts.coursequality_nilreason || ')') as coursequality,
    coalesce(cast(navaids_points.navaid_ts.integritylevel_value as varchar), '(' || navaids_points.navaid_ts.integritylevel_nilreason || ')') as integritylevel,
    geometry_elevatedpoint_view_ctzjil.geom AS geom,
    ST_X(geometry_elevatedpoint_view_ctzjil.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_ctzjil.geom) AS latitude,
    geometry_elevatedpoint_view_ctzjil.elevation,
    geometry_elevatedpoint_view_ctzjil.geoidUndulation,
    geometry_elevatedpoint_view_ctzjil.verticalDatum,
    geometry_elevatedpoint_view_ctzjil.verticalAccuracy,
    geometry_elevatedpoint_view_ctzjil.horizontalAccuracy,
    jsonb_build_object('id', airport_heliport_touchdownliftoff_pt_tnuvfe.id,
    'title', coalesce(cast(airport_heliport_touchdownliftoff_pt_tnuvfe.title AS varchar), '(' || airport_heliport_touchdownliftoff_pt_tnuvfe.nilreason[1] || ')'),
    'href', airport_heliport_touchdownliftoff_pt_tnuvfe.href) AS touchdownliftoff,
    jsonb_agg(navaids_points_navaidcomponent_view_irtmlq.id) AS navaidequipment,
    jsonb_build_object('id', airport_heliport_runwaydirection_pt_bhponn.id,
    'title', coalesce(cast(airport_heliport_runwaydirection_pt_bhponn.title AS varchar), '(' || airport_heliport_runwaydirection_pt_bhponn.nilreason[1] || ')'),
    'href', airport_heliport_runwaydirection_pt_bhponn.href) AS runwaydirection,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_fbezen.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_fbezen.title AS varchar), '(' || airport_heliport_airportheliport_pt_fbezen.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_fbezen.href) AS servedairport,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_khsoek.id) AS availability,
    jsonb_agg(notes_note_view_oyylml.*) AS navaid_annotation
from navaids_points.navaid 
inner join master_join mj2 on navaids_points.navaid.id = mj2.source_id
inner join navaids_points.navaid_tsp on mj2.target_id = navaids_points.navaid_tsp.id
inner join navaids_points.navaid_ts on navaids_points.navaid_tsp.navaidtimeslice_id = navaids_points.navaid_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_ctzjil on navaids_points.navaid_ts.location_id = geometry_elevatedpoint_view_ctzjil.id
left join master_join master_join_nkhzed on navaids_points.navaid_ts.id = master_join_nkhzed.source_id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_tnuvfe on master_join_nkhzed.target_id = airport_heliport_touchdownliftoff_pt_tnuvfe.id
left join master_join master_join_othipl on navaids_points.navaid_ts.id = master_join_othipl.source_id
left join navaids_points.navaidcomponent_view navaids_points_navaidcomponent_view_irtmlq on master_join_othipl.target_id = navaids_points_navaidcomponent_view_irtmlq.id
left join master_join master_join_xkxehv on navaids_points.navaid_ts.id = master_join_xkxehv.source_id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_bhponn on master_join_xkxehv.target_id = airport_heliport_runwaydirection_pt_bhponn.id
left join master_join master_join_gedujs on navaids_points.navaid_ts.id = master_join_gedujs.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_fbezen on master_join_gedujs.target_id = airport_heliport_airportheliport_pt_fbezen.id
left join master_join master_join_ezisex on navaids_points.navaid_ts.id = master_join_ezisex.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_khsoek on master_join_ezisex.target_id = navaids_points_navaidoperationalstatus_view_khsoek.id
left join master_join master_join_tiprof on navaids_points.navaid_ts.id = master_join_tiprof.source_id
left join notes.note_view notes_note_view_oyylml on master_join_tiprof.target_id = notes_note_view_oyylml.id
where navaids_points.navaid.feature_status = 'APPROVED'
  and navaids_points.navaid_ts.feature_status = 'APPROVED'
group by
    navaids_points.navaid.id,
    navaids_points.navaid_ts.id,
    navaids_points.navaid_tsp.id,
    navaids_points.navaid.identifier,
    navaids_points.navaid_ts.interpretation,
    navaids_points.navaid_ts.sequence_number,
    navaids_points.navaid_ts.correction_number,
    navaids_points.navaid_ts.valid_time_begin,
    navaids_points.navaid_ts.valid_time_end,
    navaids_points.navaid_ts.feature_lifetime_begin,
    navaids_points.navaid_ts.feature_lifetime_end,
    navaids_points.navaid_ts.type_value,
    navaids_points.navaid_ts.type_nilreason,
    navaids_points.navaid_ts.designator_value,
    navaids_points.navaid_ts.designator_nilreason,
    navaids_points.navaid_ts.name_value,
    navaids_points.navaid_ts.name_nilreason,
    navaids_points.navaid_ts.flightchecked_value,
    navaids_points.navaid_ts.flightchecked_nilreason,
    navaids_points.navaid_ts.purpose_value,
    navaids_points.navaid_ts.purpose_nilreason,
    navaids_points.navaid_ts.signalperformance_value,
    navaids_points.navaid_ts.signalperformance_nilreason,
    navaids_points.navaid_ts.coursequality_value,
    navaids_points.navaid_ts.coursequality_nilreason,
    navaids_points.navaid_ts.integritylevel_value,
    navaids_points.navaid_ts.integritylevel_nilreason,
    geometry_elevatedpoint_view_ctzjil.geom,
    geometry_elevatedpoint_view_ctzjil.elevation,
    geometry_elevatedpoint_view_ctzjil.geoidUndulation,
    geometry_elevatedpoint_view_ctzjil.verticalDatum,
    geometry_elevatedpoint_view_ctzjil.verticalAccuracy,
    geometry_elevatedpoint_view_ctzjil.horizontalAccuracy
order by navaid.identifier, navaid_ts.sequence_number, navaid_ts.correction_number DESC;
-- NavigationAreaRestrictionTimeSliceType
-- ['notes.note_view']
create or replace view procedure.navigationarearestriction_view as
select distinct on (navigationarearestriction.identifier,navigationarearestriction_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.navigationarearestriction.id,
    procedure.navigationarearestriction_ts.id as ts_id,
    procedure.navigationarearestriction_tsp.id as tsp_id,
    procedure.navigationarearestriction.identifier,
    procedure.navigationarearestriction_ts.interpretation,
    procedure.navigationarearestriction_ts.sequence_number,
    procedure.navigationarearestriction_ts.correction_number,
    procedure.navigationarearestriction_ts.valid_time_begin,
    procedure.navigationarearestriction_ts.valid_time_end,
    procedure.navigationarearestriction_ts.feature_lifetime_begin,
    procedure.navigationarearestriction_ts.feature_lifetime_end,
    coalesce(cast(procedure.navigationarearestriction_ts.type_value as varchar), '(' || procedure.navigationarearestriction_ts.type_nilreason || ')') as type,
    coalesce(cast(shared_obstacleassessmentarea_pt_lqljqv.title as varchar), '(' || shared_obstacleassessmentarea_pt_lqljqv.nilreason[1] || ')') AS designsurface,
    shared_obstacleassessmentarea_pt_lqljqv.href AS designsurface_href,
    coalesce(cast(shared_circlesector_pt_kwdosf.title as varchar), '(' || shared_circlesector_pt_kwdosf.nilreason[1] || ')') AS sectordefinition,
    shared_circlesector_pt_kwdosf.href AS sectordefinition_href,
    jsonb_agg(notes_note_view_lguzst.*) AS navigationarearestriction_annotation
from procedure.navigationarearestriction 
inner join master_join mj2 on procedure.navigationarearestriction.id = mj2.source_id
inner join procedure.navigationarearestriction_tsp on mj2.target_id = procedure.navigationarearestriction_tsp.id
inner join procedure.navigationarearestriction_ts on procedure.navigationarearestriction_tsp.navigationarearestrictiontimeslice_id = procedure.navigationarearestriction_ts.id
left join shared.obstacleassessmentarea_pt shared_obstacleassessmentarea_pt_lqljqv on procedure.navigationarearestriction_ts.designsurface_id = shared_obstacleassessmentarea_pt_lqljqv.id
left join shared.circlesector_pt shared_circlesector_pt_kwdosf on procedure.navigationarearestriction_ts.sectordefinition_id = shared_circlesector_pt_kwdosf.id
left join master_join master_join_zxmets on procedure.navigationarearestriction_ts.id = master_join_zxmets.source_id
left join notes.note_view notes_note_view_lguzst on master_join_zxmets.target_id = notes_note_view_lguzst.id
where procedure.navigationarearestriction.feature_status = 'APPROVED'
  and procedure.navigationarearestriction_ts.feature_status = 'APPROVED'
group by
    procedure.navigationarearestriction.id,
    procedure.navigationarearestriction_ts.id,
    procedure.navigationarearestriction_tsp.id,
    procedure.navigationarearestriction.identifier,
    procedure.navigationarearestriction_ts.interpretation,
    procedure.navigationarearestriction_ts.sequence_number,
    procedure.navigationarearestriction_ts.correction_number,
    procedure.navigationarearestriction_ts.valid_time_begin,
    procedure.navigationarearestriction_ts.valid_time_end,
    procedure.navigationarearestriction_ts.feature_lifetime_begin,
    procedure.navigationarearestriction_ts.feature_lifetime_end,
    procedure.navigationarearestriction_ts.type_value,
    procedure.navigationarearestriction_ts.type_nilreason,
    shared_obstacleassessmentarea_pt_lqljqv.title,
    shared_obstacleassessmentarea_pt_lqljqv.nilreason[1],
    shared_obstacleassessmentarea_pt_lqljqv.href,
    shared_circlesector_pt_kwdosf.title,
    shared_circlesector_pt_kwdosf.nilreason[1],
    shared_circlesector_pt_kwdosf.href
order by navigationarearestriction.identifier, navigationarearestriction_ts.sequence_number, navigationarearestriction_ts.correction_number DESC;
-- NavigationAreaTimeSliceType
-- ['notes.note_view', 'geometry.point_view', 'procedure.navigationareasector_view']
create or replace view procedure.navigationarea_view as
select distinct on (navigationarea.identifier,navigationarea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.navigationarea.id,
    procedure.navigationarea_ts.id as ts_id,
    procedure.navigationarea_tsp.id as tsp_id,
    procedure.navigationarea.identifier,
    procedure.navigationarea_ts.interpretation,
    procedure.navigationarea_ts.sequence_number,
    procedure.navigationarea_ts.correction_number,
    procedure.navigationarea_ts.valid_time_begin,
    procedure.navigationarea_ts.valid_time_end,
    procedure.navigationarea_ts.feature_lifetime_begin,
    procedure.navigationarea_ts.feature_lifetime_end,
    coalesce(cast(procedure.navigationarea_ts.navigationareatype_value as varchar), '(' || procedure.navigationarea_ts.navigationareatype_nilreason || ')') as navigationareatype,
    coalesce(cast(procedure.navigationarea_ts.minimumceiling_value as varchar) || ' ' || procedure.navigationarea_ts.minimumceiling_uom, '(' || procedure.navigationarea_ts.minimumceiling_nilreason || ')') as minimumceiling,
    coalesce(cast(procedure.navigationarea_ts.minimumvisibility_value as varchar) || ' ' || procedure.navigationarea_ts.minimumvisibility_uom, '(' || procedure.navigationarea_ts.minimumvisibility_nilreason || ')') as minimumvisibility,
    coalesce(cast(procedure_standardinstrumentdeparture_pt_exitxz.title as varchar), '(' || procedure_standardinstrumentdeparture_pt_exitxz.nilreason[1] || ')') AS departure,
    procedure_standardinstrumentdeparture_pt_exitxz.href AS departure_href,
    coalesce(cast(navaids_points_designatedpoint_pt_uiezce.title as varchar), '(' || navaids_points_designatedpoint_pt_uiezce.nilreason[1] || ')') AS centrepointfixdesignatedpoint,
    navaids_points_designatedpoint_pt_uiezce.href AS centrepointfixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_jkzrtn.title as varchar), '(' || navaids_points_navaid_pt_jkzrtn.nilreason[1] || ')') AS centrepointnavaidsystem,
    navaids_points_navaid_pt_jkzrtn.href AS centrepointnavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_uyidok.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_uyidok.nilreason[1] || ')') AS centrepointaimingpoint,
    airport_heliport_touchdownliftoff_pt_uyidok.href AS centrepointaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_ccrbuw.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_ccrbuw.nilreason[1] || ')') AS centrepointrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_ccrbuw.href AS centrepointrunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_yejspt.title as varchar), '(' || airport_heliport_airportheliport_pt_yejspt.nilreason[1] || ')') AS centrepointairportreferencepoint,
    airport_heliport_airportheliport_pt_yejspt.href AS centrepointairportreferencepoint_href,
    geometry_point_view_mqghlf.geom AS geom,
    ST_X(geometry_point_view_mqghlf.geom) AS longitude,
    ST_Y(geometry_point_view_mqghlf.geom) AS latitude,
    geometry_point_view_mqghlf.horizontalAccuracy,
    jsonb_agg(procedure_navigationareasector_view_qpbvbn.id) AS sector,
    jsonb_agg(notes_note_view_adceaa.*) AS navigationarea_annotation
from procedure.navigationarea 
inner join master_join mj2 on procedure.navigationarea.id = mj2.source_id
inner join procedure.navigationarea_tsp on mj2.target_id = procedure.navigationarea_tsp.id
inner join procedure.navigationarea_ts on procedure.navigationarea_tsp.navigationareatimeslice_id = procedure.navigationarea_ts.id
left join procedure.standardinstrumentdeparture_pt procedure_standardinstrumentdeparture_pt_exitxz on procedure.navigationarea_ts.departure_id = procedure_standardinstrumentdeparture_pt_exitxz.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_uiezce on procedure.navigationarea_ts.centrepoint_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_uiezce.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_jkzrtn on procedure.navigationarea_ts.centrepoint_navaidsystem_id = navaids_points_navaid_pt_jkzrtn.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_uyidok on procedure.navigationarea_ts.centrepoint_aimingpoint_id = airport_heliport_touchdownliftoff_pt_uyidok.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_ccrbuw on procedure.navigationarea_ts.centrepoint_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_ccrbuw.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_yejspt on procedure.navigationarea_ts.centrepoint_airportreferencepoint_id = airport_heliport_airportheliport_pt_yejspt.id
left join geometry.point_view geometry_point_view_mqghlf on procedure.navigationarea_ts.centrepoint_position_id = geometry_point_view_mqghlf.id
left join master_join master_join_nojlpa on procedure.navigationarea_ts.id = master_join_nojlpa.source_id
left join procedure.navigationareasector_view procedure_navigationareasector_view_qpbvbn on master_join_nojlpa.target_id = procedure_navigationareasector_view_qpbvbn.id
left join master_join master_join_gxzvcq on procedure.navigationarea_ts.id = master_join_gxzvcq.source_id
left join notes.note_view notes_note_view_adceaa on master_join_gxzvcq.target_id = notes_note_view_adceaa.id
where procedure.navigationarea.feature_status = 'APPROVED'
  and procedure.navigationarea_ts.feature_status = 'APPROVED'
group by
    procedure.navigationarea.id,
    procedure.navigationarea_ts.id,
    procedure.navigationarea_tsp.id,
    procedure.navigationarea.identifier,
    procedure.navigationarea_ts.interpretation,
    procedure.navigationarea_ts.sequence_number,
    procedure.navigationarea_ts.correction_number,
    procedure.navigationarea_ts.valid_time_begin,
    procedure.navigationarea_ts.valid_time_end,
    procedure.navigationarea_ts.feature_lifetime_begin,
    procedure.navigationarea_ts.feature_lifetime_end,
    procedure.navigationarea_ts.navigationareatype_value,
    procedure.navigationarea_ts.navigationareatype_nilreason,
    procedure.navigationarea_ts.minimumceiling_value,
    procedure.navigationarea_ts.minimumceiling_uom,
    procedure.navigationarea_ts.minimumceiling_nilreason,
    procedure.navigationarea_ts.minimumvisibility_value,
    procedure.navigationarea_ts.minimumvisibility_uom,
    procedure.navigationarea_ts.minimumvisibility_nilreason,
    procedure_standardinstrumentdeparture_pt_exitxz.title,
    procedure_standardinstrumentdeparture_pt_exitxz.nilreason[1],
    procedure_standardinstrumentdeparture_pt_exitxz.href,
    navaids_points_designatedpoint_pt_uiezce.title,
    navaids_points_designatedpoint_pt_uiezce.nilreason[1],
    navaids_points_designatedpoint_pt_uiezce.href,
    navaids_points_navaid_pt_jkzrtn.title,
    navaids_points_navaid_pt_jkzrtn.nilreason[1],
    navaids_points_navaid_pt_jkzrtn.href,
    airport_heliport_touchdownliftoff_pt_uyidok.title,
    airport_heliport_touchdownliftoff_pt_uyidok.nilreason[1],
    airport_heliport_touchdownliftoff_pt_uyidok.href,
    airport_heliport_runwaycentrelinepoint_pt_ccrbuw.title,
    airport_heliport_runwaycentrelinepoint_pt_ccrbuw.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_ccrbuw.href,
    airport_heliport_airportheliport_pt_yejspt.title,
    airport_heliport_airportheliport_pt_yejspt.nilreason[1],
    airport_heliport_airportheliport_pt_yejspt.href,
    geometry_point_view_mqghlf.geom,
    geometry_point_view_mqghlf.horizontalAccuracy
order by navigationarea.identifier, navigationarea_ts.sequence_number, navigationarea_ts.correction_number DESC;
-- NDBTimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.ndb_view as
select distinct on (ndb.identifier,ndb_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.ndb.id,
    navaids_points.ndb_ts.id as ts_id,
    navaids_points.ndb_tsp.id as tsp_id,
    navaids_points.ndb.identifier,
    navaids_points.ndb_ts.interpretation,
    navaids_points.ndb_ts.sequence_number,
    navaids_points.ndb_ts.correction_number,
    navaids_points.ndb_ts.valid_time_begin,
    navaids_points.ndb_ts.valid_time_end,
    navaids_points.ndb_ts.feature_lifetime_begin,
    navaids_points.ndb_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.ndb_ts.designator_value as varchar), '(' || navaids_points.ndb_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.ndb_ts.name_value as varchar), '(' || navaids_points.ndb_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.ndb_ts.emissionclass_value as varchar), '(' || navaids_points.ndb_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.ndb_ts.mobile_value as varchar), '(' || navaids_points.ndb_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.ndb_ts.magneticvariation_value as varchar), '(' || navaids_points.ndb_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.ndb_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.ndb_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.ndb_ts.datemagneticvariation_value as varchar), '(' || navaids_points.ndb_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.ndb_ts.flightchecked_value as varchar), '(' || navaids_points.ndb_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.ndb_ts.class_value as varchar), '(' || navaids_points.ndb_ts.class_nilreason || ')') as class,
    coalesce(cast(navaids_points.ndb_ts.emissionband_value as varchar), '(' || navaids_points.ndb_ts.emissionband_nilreason || ')') as emissionband,
    coalesce(cast(navaids_points.ndb_ts.frequency_value as varchar) || ' ' || navaids_points.ndb_ts.frequency_uom, '(' || navaids_points.ndb_ts.frequency_nilreason || ')') as frequency,
    geometry_elevatedpoint_view_aharzj.geom AS geom,
    ST_X(geometry_elevatedpoint_view_aharzj.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_aharzj.geom) AS latitude,
    geometry_elevatedpoint_view_aharzj.elevation,
    geometry_elevatedpoint_view_aharzj.geoidUndulation,
    geometry_elevatedpoint_view_aharzj.verticalDatum,
    geometry_elevatedpoint_view_aharzj.verticalAccuracy,
    geometry_elevatedpoint_view_aharzj.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_agaztt.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_ufhsgq.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_xwvqre.id) AS availability,
    jsonb_agg(notes_note_view_utynqf.*) AS ndb_annotation
from navaids_points.ndb 
inner join master_join mj2 on navaids_points.ndb.id = mj2.source_id
inner join navaids_points.ndb_tsp on mj2.target_id = navaids_points.ndb_tsp.id
inner join navaids_points.ndb_ts on navaids_points.ndb_tsp.ndbtimeslice_id = navaids_points.ndb_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_aharzj on navaids_points.ndb_ts.location_id = geometry_elevatedpoint_view_aharzj.id
left join master_join master_join_pgdxiy on navaids_points.ndb_ts.id = master_join_pgdxiy.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_agaztt on master_join_pgdxiy.target_id = navaids_points_authorityfornavaidequipment_view_agaztt.id
left join master_join master_join_rfzlgu on navaids_points.ndb_ts.id = master_join_rfzlgu.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_ufhsgq on master_join_rfzlgu.target_id = navaids_points_navaidequipmentmonitoring_view_ufhsgq.id
left join master_join master_join_pwwplq on navaids_points.ndb_ts.id = master_join_pwwplq.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_xwvqre on master_join_pwwplq.target_id = navaids_points_navaidoperationalstatus_view_xwvqre.id
left join master_join master_join_gcxmmf on navaids_points.ndb_ts.id = master_join_gcxmmf.source_id
left join notes.note_view notes_note_view_utynqf on master_join_gcxmmf.target_id = notes_note_view_utynqf.id
where navaids_points.ndb.feature_status = 'APPROVED'
  and navaids_points.ndb_ts.feature_status = 'APPROVED'
group by
    navaids_points.ndb.id,
    navaids_points.ndb_ts.id,
    navaids_points.ndb_tsp.id,
    navaids_points.ndb.identifier,
    navaids_points.ndb_ts.interpretation,
    navaids_points.ndb_ts.sequence_number,
    navaids_points.ndb_ts.correction_number,
    navaids_points.ndb_ts.valid_time_begin,
    navaids_points.ndb_ts.valid_time_end,
    navaids_points.ndb_ts.feature_lifetime_begin,
    navaids_points.ndb_ts.feature_lifetime_end,
    navaids_points.ndb_ts.designator_value,
    navaids_points.ndb_ts.designator_nilreason,
    navaids_points.ndb_ts.name_value,
    navaids_points.ndb_ts.name_nilreason,
    navaids_points.ndb_ts.emissionclass_value,
    navaids_points.ndb_ts.emissionclass_nilreason,
    navaids_points.ndb_ts.mobile_value,
    navaids_points.ndb_ts.mobile_nilreason,
    navaids_points.ndb_ts.magneticvariation_value,
    navaids_points.ndb_ts.magneticvariation_nilreason,
    navaids_points.ndb_ts.magneticvariationaccuracy_value,
    navaids_points.ndb_ts.magneticvariationaccuracy_nilreason,
    navaids_points.ndb_ts.datemagneticvariation_value,
    navaids_points.ndb_ts.datemagneticvariation_nilreason,
    navaids_points.ndb_ts.flightchecked_value,
    navaids_points.ndb_ts.flightchecked_nilreason,
    navaids_points.ndb_ts.class_value,
    navaids_points.ndb_ts.class_nilreason,
    navaids_points.ndb_ts.emissionband_value,
    navaids_points.ndb_ts.emissionband_nilreason,
    navaids_points.ndb_ts.frequency_value,
    navaids_points.ndb_ts.frequency_uom,
    navaids_points.ndb_ts.frequency_nilreason,
    geometry_elevatedpoint_view_aharzj.geom,
    geometry_elevatedpoint_view_aharzj.elevation,
    geometry_elevatedpoint_view_aharzj.geoidUndulation,
    geometry_elevatedpoint_view_aharzj.verticalDatum,
    geometry_elevatedpoint_view_aharzj.verticalAccuracy,
    geometry_elevatedpoint_view_aharzj.horizontalAccuracy
order by ndb.identifier, ndb_ts.sequence_number, ndb_ts.correction_number DESC;
-- NonMovementAreaTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view']
create or replace view airport_heliport.nonmovementarea_view as
select distinct on (nonmovementarea.identifier,nonmovementarea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.nonmovementarea.id,
    airport_heliport.nonmovementarea_ts.id as ts_id,
    airport_heliport.nonmovementarea_tsp.id as tsp_id,
    airport_heliport.nonmovementarea.identifier,
    airport_heliport.nonmovementarea_ts.interpretation,
    airport_heliport.nonmovementarea_ts.sequence_number,
    airport_heliport.nonmovementarea_ts.correction_number,
    airport_heliport.nonmovementarea_ts.valid_time_begin,
    airport_heliport.nonmovementarea_ts.valid_time_end,
    airport_heliport.nonmovementarea_ts.feature_lifetime_begin,
    airport_heliport.nonmovementarea_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport_airportheliport_pt_bbtjeu.title as varchar), '(' || airport_heliport_airportheliport_pt_bbtjeu.nilreason[1] || ')') AS associatedairportheliport,
    airport_heliport_airportheliport_pt_bbtjeu.href AS associatedairportheliport_href,
    geometry_elevatedsurface_view_mzpnuq.geom AS geom,
    geometry_elevatedsurface_view_mzpnuq.elevation,
    geometry_elevatedsurface_view_mzpnuq.geoidUndulation,
    geometry_elevatedsurface_view_mzpnuq.verticalDatum,
    geometry_elevatedsurface_view_mzpnuq.verticalAccuracy,
    geometry_elevatedsurface_view_mzpnuq.horizontalAccuracy,
    jsonb_agg(notes_note_view_ojzsgd.*) AS nonmovementarea_annotation
from airport_heliport.nonmovementarea 
inner join master_join mj2 on airport_heliport.nonmovementarea.id = mj2.source_id
inner join airport_heliport.nonmovementarea_tsp on mj2.target_id = airport_heliport.nonmovementarea_tsp.id
inner join airport_heliport.nonmovementarea_ts on airport_heliport.nonmovementarea_tsp.nonmovementareatimeslice_id = airport_heliport.nonmovementarea_ts.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_bbtjeu on airport_heliport.nonmovementarea_ts.associatedairportheliport_id = airport_heliport_airportheliport_pt_bbtjeu.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_mzpnuq on airport_heliport.nonmovementarea_ts.extent_id = geometry_elevatedsurface_view_mzpnuq.id
left join master_join master_join_tkxlpt on airport_heliport.nonmovementarea_ts.id = master_join_tkxlpt.source_id
left join notes.note_view notes_note_view_ojzsgd on master_join_tkxlpt.target_id = notes_note_view_ojzsgd.id
where airport_heliport.nonmovementarea.feature_status = 'APPROVED'
  and airport_heliport.nonmovementarea_ts.feature_status = 'APPROVED'
group by
    airport_heliport.nonmovementarea.id,
    airport_heliport.nonmovementarea_ts.id,
    airport_heliport.nonmovementarea_tsp.id,
    airport_heliport.nonmovementarea.identifier,
    airport_heliport.nonmovementarea_ts.interpretation,
    airport_heliport.nonmovementarea_ts.sequence_number,
    airport_heliport.nonmovementarea_ts.correction_number,
    airport_heliport.nonmovementarea_ts.valid_time_begin,
    airport_heliport.nonmovementarea_ts.valid_time_end,
    airport_heliport.nonmovementarea_ts.feature_lifetime_begin,
    airport_heliport.nonmovementarea_ts.feature_lifetime_end,
    airport_heliport_airportheliport_pt_bbtjeu.title,
    airport_heliport_airportheliport_pt_bbtjeu.nilreason[1],
    airport_heliport_airportheliport_pt_bbtjeu.href,
    geometry_elevatedsurface_view_mzpnuq.geom,
    geometry_elevatedsurface_view_mzpnuq.elevation,
    geometry_elevatedsurface_view_mzpnuq.geoidUndulation,
    geometry_elevatedsurface_view_mzpnuq.verticalDatum,
    geometry_elevatedsurface_view_mzpnuq.verticalAccuracy,
    geometry_elevatedsurface_view_mzpnuq.horizontalAccuracy
order by nonmovementarea.identifier, nonmovementarea_ts.sequence_number, nonmovementarea_ts.correction_number DESC;
-- ObstacleAreaTimeSliceType
-- ['geometry.surface_view', 'notes.note_view']
create or replace view obstacles.obstaclearea_view as
select distinct on (obstaclearea.identifier,obstaclearea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    obstacles.obstaclearea.id,
    obstacles.obstaclearea_ts.id as ts_id,
    obstacles.obstaclearea_tsp.id as tsp_id,
    obstacles.obstaclearea.identifier,
    obstacles.obstaclearea_ts.interpretation,
    obstacles.obstaclearea_ts.sequence_number,
    obstacles.obstaclearea_ts.correction_number,
    obstacles.obstaclearea_ts.valid_time_begin,
    obstacles.obstaclearea_ts.valid_time_end,
    obstacles.obstaclearea_ts.feature_lifetime_begin,
    obstacles.obstaclearea_ts.feature_lifetime_end,
    coalesce(cast(obstacles.obstaclearea_ts.type_value as varchar), '(' || obstacles.obstaclearea_ts.type_nilreason || ')') as type,
    coalesce(cast(obstacles.obstaclearea_ts.obstructionidsurfacecondition_value as varchar), '(' || obstacles.obstaclearea_ts.obstructionidsurfacecondition_nilreason || ')') as obstructionidsurfacecondition,
    coalesce(cast(airport_heliport_airportheliport_pt_jwpkwb.title as varchar), '(' || airport_heliport_airportheliport_pt_jwpkwb.nilreason[1] || ')') AS referenceownerairport,
    airport_heliport_airportheliport_pt_jwpkwb.href AS referenceownerairport_href,
    coalesce(cast(airport_heliport_runwaydirection_pt_lmvznj.title as varchar), '(' || airport_heliport_runwaydirection_pt_lmvznj.nilreason[1] || ')') AS referenceownerrunway,
    airport_heliport_runwaydirection_pt_lmvznj.href AS referenceownerrunway_href,
    coalesce(cast(organisation_organisationauthority_pt_wqszvd.title as varchar), '(' || organisation_organisationauthority_pt_wqszvd.nilreason[1] || ')') AS referenceownerorganisation,
    organisation_organisationauthority_pt_wqszvd.href AS referenceownerorganisation_href,
    geometry_surface_view_pzklwl.geom AS geom,
    jsonb_build_object('id', obstacles_verticalstructure_pt_wnhlkz.id,
    'title', coalesce(cast(obstacles_verticalstructure_pt_wnhlkz.title AS varchar), '(' || obstacles_verticalstructure_pt_wnhlkz.nilreason[1] || ')'),
    'href', obstacles_verticalstructure_pt_wnhlkz.href) AS obstacle,
    jsonb_agg(notes_note_view_zpzksl.*) AS obstaclearea_annotation
from obstacles.obstaclearea 
inner join master_join mj2 on obstacles.obstaclearea.id = mj2.source_id
inner join obstacles.obstaclearea_tsp on mj2.target_id = obstacles.obstaclearea_tsp.id
inner join obstacles.obstaclearea_ts on obstacles.obstaclearea_tsp.obstacleareatimeslice_id = obstacles.obstaclearea_ts.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_jwpkwb on obstacles.obstaclearea_ts.reference_ownerairport_id = airport_heliport_airportheliport_pt_jwpkwb.id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_lmvznj on obstacles.obstaclearea_ts.reference_ownerrunway_id = airport_heliport_runwaydirection_pt_lmvznj.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_wqszvd on obstacles.obstaclearea_ts.reference_ownerorganisation_id = organisation_organisationauthority_pt_wqszvd.id
left join geometry.surface_view geometry_surface_view_pzklwl on obstacles.obstaclearea_ts.surfaceextent_id = geometry_surface_view_pzklwl.id
left join master_join master_join_xqejau on obstacles.obstaclearea_ts.id = master_join_xqejau.source_id
left join obstacles.verticalstructure_pt obstacles_verticalstructure_pt_wnhlkz on master_join_xqejau.target_id = obstacles_verticalstructure_pt_wnhlkz.id
left join master_join master_join_jikmvh on obstacles.obstaclearea_ts.id = master_join_jikmvh.source_id
left join notes.note_view notes_note_view_zpzksl on master_join_jikmvh.target_id = notes_note_view_zpzksl.id
where obstacles.obstaclearea.feature_status = 'APPROVED'
  and obstacles.obstaclearea_ts.feature_status = 'APPROVED'
group by
    obstacles.obstaclearea.id,
    obstacles.obstaclearea_ts.id,
    obstacles.obstaclearea_tsp.id,
    obstacles.obstaclearea.identifier,
    obstacles.obstaclearea_ts.interpretation,
    obstacles.obstaclearea_ts.sequence_number,
    obstacles.obstaclearea_ts.correction_number,
    obstacles.obstaclearea_ts.valid_time_begin,
    obstacles.obstaclearea_ts.valid_time_end,
    obstacles.obstaclearea_ts.feature_lifetime_begin,
    obstacles.obstaclearea_ts.feature_lifetime_end,
    obstacles.obstaclearea_ts.type_value,
    obstacles.obstaclearea_ts.type_nilreason,
    obstacles.obstaclearea_ts.obstructionidsurfacecondition_value,
    obstacles.obstaclearea_ts.obstructionidsurfacecondition_nilreason,
    airport_heliport_airportheliport_pt_jwpkwb.title,
    airport_heliport_airportheliport_pt_jwpkwb.nilreason[1],
    airport_heliport_airportheliport_pt_jwpkwb.href,
    airport_heliport_runwaydirection_pt_lmvznj.title,
    airport_heliport_runwaydirection_pt_lmvznj.nilreason[1],
    airport_heliport_runwaydirection_pt_lmvznj.href,
    organisation_organisationauthority_pt_wqszvd.title,
    organisation_organisationauthority_pt_wqszvd.nilreason[1],
    organisation_organisationauthority_pt_wqszvd.href,
    geometry_surface_view_pzklwl.geom
order by obstaclearea.identifier, obstaclearea_ts.sequence_number, obstaclearea_ts.correction_number DESC;
-- OrganisationAuthorityTimeSliceType
-- ['organisation.organisationauthorityassociation_view', 'notes.note_view', 'shared.contactinformation_view']
create or replace view organisation.organisationauthority_view as
select distinct on (organisationauthority.identifier,organisationauthority_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    organisation.organisationauthority.id,
    organisation.organisationauthority_ts.id as ts_id,
    organisation.organisationauthority_tsp.id as tsp_id,
    organisation.organisationauthority.identifier,
    organisation.organisationauthority_ts.interpretation,
    organisation.organisationauthority_ts.sequence_number,
    organisation.organisationauthority_ts.correction_number,
    organisation.organisationauthority_ts.valid_time_begin,
    organisation.organisationauthority_ts.valid_time_end,
    organisation.organisationauthority_ts.feature_lifetime_begin,
    organisation.organisationauthority_ts.feature_lifetime_end,
    coalesce(cast(organisation.organisationauthority_ts.name_value as varchar), '(' || organisation.organisationauthority_ts.name_nilreason || ')') as name,
    coalesce(cast(organisation.organisationauthority_ts.designator_value as varchar), '(' || organisation.organisationauthority_ts.designator_nilreason || ')') as designator,
    coalesce(cast(organisation.organisationauthority_ts.type_value as varchar), '(' || organisation.organisationauthority_ts.type_nilreason || ')') as type,
    coalesce(cast(organisation.organisationauthority_ts.military_value as varchar), '(' || organisation.organisationauthority_ts.military_nilreason || ')') as military,
    jsonb_agg(organisation_organisationauthorityassociation_view_lxurlj.id) AS relatedorganisationauthority,
    jsonb_agg(notes_note_view_aeevqq.*) AS organisationauthority_annotation
from organisation.organisationauthority 
inner join master_join mj2 on organisation.organisationauthority.id = mj2.source_id
inner join organisation.organisationauthority_tsp on mj2.target_id = organisation.organisationauthority_tsp.id
inner join organisation.organisationauthority_ts on organisation.organisationauthority_tsp.organisationauthoritytimeslice_id = organisation.organisationauthority_ts.id
left join master_join master_join_uuhcja on organisation.organisationauthority_ts.id = master_join_uuhcja.source_id
left join shared.contactinformation_view shared_contactinformation_view_cnbuyj on master_join_uuhcja.target_id = shared_contactinformation_view_cnbuyj.id
left join master_join master_join_wgizva on organisation.organisationauthority_ts.id = master_join_wgizva.source_id
left join organisation.organisationauthorityassociation_view organisation_organisationauthorityassociation_view_lxurlj on master_join_wgizva.target_id = organisation_organisationauthorityassociation_view_lxurlj.id
left join master_join master_join_rzaqge on organisation.organisationauthority_ts.id = master_join_rzaqge.source_id
left join notes.note_view notes_note_view_aeevqq on master_join_rzaqge.target_id = notes_note_view_aeevqq.id
where organisation.organisationauthority.feature_status = 'APPROVED'
  and organisation.organisationauthority_ts.feature_status = 'APPROVED'
group by
    organisation.organisationauthority.id,
    organisation.organisationauthority_ts.id,
    organisation.organisationauthority_tsp.id,
    organisation.organisationauthority.identifier,
    organisation.organisationauthority_ts.interpretation,
    organisation.organisationauthority_ts.sequence_number,
    organisation.organisationauthority_ts.correction_number,
    organisation.organisationauthority_ts.valid_time_begin,
    organisation.organisationauthority_ts.valid_time_end,
    organisation.organisationauthority_ts.feature_lifetime_begin,
    organisation.organisationauthority_ts.feature_lifetime_end,
    organisation.organisationauthority_ts.name_value,
    organisation.organisationauthority_ts.name_nilreason,
    organisation.organisationauthority_ts.designator_value,
    organisation.organisationauthority_ts.designator_nilreason,
    organisation.organisationauthority_ts.type_value,
    organisation.organisationauthority_ts.type_nilreason,
    organisation.organisationauthority_ts.military_value,
    organisation.organisationauthority_ts.military_nilreason
order by organisationauthority.identifier, organisationauthority_ts.sequence_number, organisationauthority_ts.correction_number DESC;
-- PassengerLoadingBridgeTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view']
create or replace view airport_heliport.passengerloadingbridge_view as
select distinct on (passengerloadingbridge.identifier,passengerloadingbridge_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.passengerloadingbridge.id,
    airport_heliport.passengerloadingbridge_ts.id as ts_id,
    airport_heliport.passengerloadingbridge_tsp.id as tsp_id,
    airport_heliport.passengerloadingbridge.identifier,
    airport_heliport.passengerloadingbridge_ts.interpretation,
    airport_heliport.passengerloadingbridge_ts.sequence_number,
    airport_heliport.passengerloadingbridge_ts.correction_number,
    airport_heliport.passengerloadingbridge_ts.valid_time_begin,
    airport_heliport.passengerloadingbridge_ts.valid_time_end,
    airport_heliport.passengerloadingbridge_ts.feature_lifetime_begin,
    airport_heliport.passengerloadingbridge_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.passengerloadingbridge_ts.type_value as varchar), '(' || airport_heliport.passengerloadingbridge_ts.type_nilreason || ')') as type,
    geometry_elevatedsurface_view_igqhxt.geom AS geom,
    geometry_elevatedsurface_view_igqhxt.elevation,
    geometry_elevatedsurface_view_igqhxt.geoidUndulation,
    geometry_elevatedsurface_view_igqhxt.verticalDatum,
    geometry_elevatedsurface_view_igqhxt.verticalAccuracy,
    geometry_elevatedsurface_view_igqhxt.horizontalAccuracy,
    jsonb_build_object('id', airport_heliport_aircraftstand_pt_hxxofo.id,
    'title', coalesce(cast(airport_heliport_aircraftstand_pt_hxxofo.title AS varchar), '(' || airport_heliport_aircraftstand_pt_hxxofo.nilreason[1] || ')'),
    'href', airport_heliport_aircraftstand_pt_hxxofo.href) AS associatedstand,
    jsonb_agg(notes_note_view_hcngam.*) AS passengerloadingbridge_annotation
from airport_heliport.passengerloadingbridge 
inner join master_join mj2 on airport_heliport.passengerloadingbridge.id = mj2.source_id
inner join airport_heliport.passengerloadingbridge_tsp on mj2.target_id = airport_heliport.passengerloadingbridge_tsp.id
inner join airport_heliport.passengerloadingbridge_ts on airport_heliport.passengerloadingbridge_tsp.passengerloadingbridgetimeslice_id = airport_heliport.passengerloadingbridge_ts.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_igqhxt on airport_heliport.passengerloadingbridge_ts.extent_id = geometry_elevatedsurface_view_igqhxt.id
left join master_join master_join_zoamkm on airport_heliport.passengerloadingbridge_ts.id = master_join_zoamkm.source_id
left join airport_heliport.aircraftstand_pt airport_heliport_aircraftstand_pt_hxxofo on master_join_zoamkm.target_id = airport_heliport_aircraftstand_pt_hxxofo.id
left join master_join master_join_wibauc on airport_heliport.passengerloadingbridge_ts.id = master_join_wibauc.source_id
left join notes.note_view notes_note_view_hcngam on master_join_wibauc.target_id = notes_note_view_hcngam.id
where airport_heliport.passengerloadingbridge.feature_status = 'APPROVED'
  and airport_heliport.passengerloadingbridge_ts.feature_status = 'APPROVED'
group by
    airport_heliport.passengerloadingbridge.id,
    airport_heliport.passengerloadingbridge_ts.id,
    airport_heliport.passengerloadingbridge_tsp.id,
    airport_heliport.passengerloadingbridge.identifier,
    airport_heliport.passengerloadingbridge_ts.interpretation,
    airport_heliport.passengerloadingbridge_ts.sequence_number,
    airport_heliport.passengerloadingbridge_ts.correction_number,
    airport_heliport.passengerloadingbridge_ts.valid_time_begin,
    airport_heliport.passengerloadingbridge_ts.valid_time_end,
    airport_heliport.passengerloadingbridge_ts.feature_lifetime_begin,
    airport_heliport.passengerloadingbridge_ts.feature_lifetime_end,
    airport_heliport.passengerloadingbridge_ts.type_value,
    airport_heliport.passengerloadingbridge_ts.type_nilreason,
    geometry_elevatedsurface_view_igqhxt.geom,
    geometry_elevatedsurface_view_igqhxt.elevation,
    geometry_elevatedsurface_view_igqhxt.geoidUndulation,
    geometry_elevatedsurface_view_igqhxt.verticalDatum,
    geometry_elevatedsurface_view_igqhxt.verticalAccuracy,
    geometry_elevatedsurface_view_igqhxt.horizontalAccuracy
order by passengerloadingbridge.identifier, passengerloadingbridge_ts.sequence_number, passengerloadingbridge_ts.correction_number DESC;
-- PassengerServiceTimeSliceType
-- ['service.serviceoperationalstatus_view', 'notes.note_view', 'shared.contactinformation_view', 'geometry.elevatedpoint_view', 'service.callsigndetail_view']
create or replace view service.passengerservice_view as
select distinct on (passengerservice.identifier,passengerservice_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.passengerservice.id,
    service.passengerservice_ts.id as ts_id,
    service.passengerservice_tsp.id as tsp_id,
    service.passengerservice.identifier,
    service.passengerservice_ts.interpretation,
    service.passengerservice_ts.sequence_number,
    service.passengerservice_ts.correction_number,
    service.passengerservice_ts.valid_time_begin,
    service.passengerservice_ts.valid_time_end,
    service.passengerservice_ts.feature_lifetime_begin,
    service.passengerservice_ts.feature_lifetime_end,
    coalesce(cast(service.passengerservice_ts.flightoperations_value as varchar), '(' || service.passengerservice_ts.flightoperations_nilreason || ')') as flightoperations,
    coalesce(cast(service.passengerservice_ts.rank_value as varchar), '(' || service.passengerservice_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.passengerservice_ts.complianticao_value as varchar), '(' || service.passengerservice_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(service.passengerservice_ts.name_value as varchar), '(' || service.passengerservice_ts.name_nilreason || ')') as name,
    coalesce(cast(service.passengerservice_ts.type_value as varchar), '(' || service.passengerservice_ts.type_nilreason || ')') as type,
    geometry_elevatedpoint_view_sjrqdk.geom AS geom,
    ST_X(geometry_elevatedpoint_view_sjrqdk.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_sjrqdk.geom) AS latitude,
    geometry_elevatedpoint_view_sjrqdk.elevation,
    geometry_elevatedpoint_view_sjrqdk.geoidUndulation,
    geometry_elevatedpoint_view_sjrqdk.verticalDatum,
    geometry_elevatedpoint_view_sjrqdk.verticalAccuracy,
    geometry_elevatedpoint_view_sjrqdk.horizontalAccuracy,
    coalesce(cast(organisation_unit_pt_dalewe.title as varchar), '(' || organisation_unit_pt_dalewe.nilreason[1] || ')') AS serviceprovider,
    organisation_unit_pt_dalewe.href AS serviceprovider_href,
    jsonb_agg(service_callsigndetail_view_vrrwwf.id) AS callsign,
    jsonb_build_object('id', service_radiocommunicationchannel_pt_eohszr.id,
    'title', coalesce(cast(service_radiocommunicationchannel_pt_eohszr.title AS varchar), '(' || service_radiocommunicationchannel_pt_eohszr.nilreason[1] || ')'),
    'href', service_radiocommunicationchannel_pt_eohszr.href) AS radiocommunication,
    jsonb_agg(service_serviceoperationalstatus_view_ejtxtp.id) AS availability,
    jsonb_agg(notes_note_view_dpuzey.*) AS passengerservice_annotation,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_zqrmyn.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_zqrmyn.title AS varchar), '(' || airport_heliport_airportheliport_pt_zqrmyn.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_zqrmyn.href) AS airportheliport
from service.passengerservice 
inner join master_join mj2 on service.passengerservice.id = mj2.source_id
inner join service.passengerservice_tsp on mj2.target_id = service.passengerservice_tsp.id
inner join service.passengerservice_ts on service.passengerservice_tsp.passengerservicetimeslice_id = service.passengerservice_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_sjrqdk on service.passengerservice_ts.location_id = geometry_elevatedpoint_view_sjrqdk.id
left join organisation.unit_pt organisation_unit_pt_dalewe on service.passengerservice_ts.serviceprovider_id = organisation_unit_pt_dalewe.id
left join master_join master_join_rwkupo on service.passengerservice_ts.id = master_join_rwkupo.source_id
left join service.callsigndetail_view service_callsigndetail_view_vrrwwf on master_join_rwkupo.target_id = service_callsigndetail_view_vrrwwf.id
left join master_join master_join_qrcrqd on service.passengerservice_ts.id = master_join_qrcrqd.source_id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_eohszr on master_join_qrcrqd.target_id = service_radiocommunicationchannel_pt_eohszr.id
left join master_join master_join_pqevxr on service.passengerservice_ts.id = master_join_pqevxr.source_id
left join shared.contactinformation_view shared_contactinformation_view_xqdbty on master_join_pqevxr.target_id = shared_contactinformation_view_xqdbty.id
left join master_join master_join_bwuyqa on service.passengerservice_ts.id = master_join_bwuyqa.source_id
left join service.serviceoperationalstatus_view service_serviceoperationalstatus_view_ejtxtp on master_join_bwuyqa.target_id = service_serviceoperationalstatus_view_ejtxtp.id
left join master_join master_join_lfhjzw on service.passengerservice_ts.id = master_join_lfhjzw.source_id
left join notes.note_view notes_note_view_dpuzey on master_join_lfhjzw.target_id = notes_note_view_dpuzey.id
left join master_join master_join_tsstem on service.passengerservice_ts.id = master_join_tsstem.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_zqrmyn on master_join_tsstem.target_id = airport_heliport_airportheliport_pt_zqrmyn.id
where service.passengerservice.feature_status = 'APPROVED'
  and service.passengerservice_ts.feature_status = 'APPROVED'
group by
    service.passengerservice.id,
    service.passengerservice_ts.id,
    service.passengerservice_tsp.id,
    service.passengerservice.identifier,
    service.passengerservice_ts.interpretation,
    service.passengerservice_ts.sequence_number,
    service.passengerservice_ts.correction_number,
    service.passengerservice_ts.valid_time_begin,
    service.passengerservice_ts.valid_time_end,
    service.passengerservice_ts.feature_lifetime_begin,
    service.passengerservice_ts.feature_lifetime_end,
    service.passengerservice_ts.flightoperations_value,
    service.passengerservice_ts.flightoperations_nilreason,
    service.passengerservice_ts.rank_value,
    service.passengerservice_ts.rank_nilreason,
    service.passengerservice_ts.complianticao_value,
    service.passengerservice_ts.complianticao_nilreason,
    service.passengerservice_ts.name_value,
    service.passengerservice_ts.name_nilreason,
    service.passengerservice_ts.type_value,
    service.passengerservice_ts.type_nilreason,
    geometry_elevatedpoint_view_sjrqdk.geom,
    geometry_elevatedpoint_view_sjrqdk.elevation,
    geometry_elevatedpoint_view_sjrqdk.geoidUndulation,
    geometry_elevatedpoint_view_sjrqdk.verticalDatum,
    geometry_elevatedpoint_view_sjrqdk.verticalAccuracy,
    geometry_elevatedpoint_view_sjrqdk.horizontalAccuracy,
    organisation_unit_pt_dalewe.title,
    organisation_unit_pt_dalewe.nilreason[1],
    organisation_unit_pt_dalewe.href
order by passengerservice.identifier, passengerservice_ts.sequence_number, passengerservice_ts.correction_number DESC;
-- PilotControlledLightingTimeSliceType
-- ['airport_heliport.lightactivation_view', 'notes.note_view']
create or replace view service.pilotcontrolledlighting_view as
select distinct on (pilotcontrolledlighting.identifier,pilotcontrolledlighting_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.pilotcontrolledlighting.id,
    service.pilotcontrolledlighting_ts.id as ts_id,
    service.pilotcontrolledlighting_tsp.id as tsp_id,
    service.pilotcontrolledlighting.identifier,
    service.pilotcontrolledlighting_ts.interpretation,
    service.pilotcontrolledlighting_ts.sequence_number,
    service.pilotcontrolledlighting_ts.correction_number,
    service.pilotcontrolledlighting_ts.valid_time_begin,
    service.pilotcontrolledlighting_ts.valid_time_end,
    service.pilotcontrolledlighting_ts.feature_lifetime_begin,
    service.pilotcontrolledlighting_ts.feature_lifetime_end,
    coalesce(cast(service.pilotcontrolledlighting_ts.type_value as varchar), '(' || service.pilotcontrolledlighting_ts.type_nilreason || ')') as type,
    coalesce(cast(service.pilotcontrolledlighting_ts.intensitysteps_value as varchar), '(' || service.pilotcontrolledlighting_ts.intensitysteps_nilreason || ')') as intensitysteps,
    coalesce(cast(service.pilotcontrolledlighting_ts.standbyintensity_value as varchar), '(' || service.pilotcontrolledlighting_ts.standbyintensity_nilreason || ')') as standbyintensity,
    coalesce(cast(service.pilotcontrolledlighting_ts.activationinstruction_value as varchar), '(' || service.pilotcontrolledlighting_ts.activationinstruction_nilreason || ')') as activationinstruction,
    coalesce(cast(service.pilotcontrolledlighting_ts.duration_value as varchar) || ' ' || service.pilotcontrolledlighting_ts.duration_uom, '(' || service.pilotcontrolledlighting_ts.duration_nilreason || ')') as duration,
    coalesce(cast(service.pilotcontrolledlighting_ts.radiofrequency_value as varchar) || ' ' || service.pilotcontrolledlighting_ts.radiofrequency_uom, '(' || service.pilotcontrolledlighting_ts.radiofrequency_nilreason || ')') as radiofrequency,
    jsonb_agg(airport_heliport_lightactivation_view_neekao.id) AS controlledlightintensity,
    jsonb_agg(notes_note_view_tulnnd.*) AS pilotcontrolledlighting_annotation
from service.pilotcontrolledlighting 
inner join master_join mj2 on service.pilotcontrolledlighting.id = mj2.source_id
inner join service.pilotcontrolledlighting_tsp on mj2.target_id = service.pilotcontrolledlighting_tsp.id
inner join service.pilotcontrolledlighting_ts on service.pilotcontrolledlighting_tsp.pilotcontrolledlightingtimeslice_id = service.pilotcontrolledlighting_ts.id
left join master_join master_join_tlujbb on service.pilotcontrolledlighting_ts.id = master_join_tlujbb.source_id
left join airport_heliport.lightactivation_view airport_heliport_lightactivation_view_neekao on master_join_tlujbb.target_id = airport_heliport_lightactivation_view_neekao.id
left join master_join master_join_ozmpmk on service.pilotcontrolledlighting_ts.id = master_join_ozmpmk.source_id
left join notes.note_view notes_note_view_tulnnd on master_join_ozmpmk.target_id = notes_note_view_tulnnd.id
where service.pilotcontrolledlighting.feature_status = 'APPROVED'
  and service.pilotcontrolledlighting_ts.feature_status = 'APPROVED'
group by
    service.pilotcontrolledlighting.id,
    service.pilotcontrolledlighting_ts.id,
    service.pilotcontrolledlighting_tsp.id,
    service.pilotcontrolledlighting.identifier,
    service.pilotcontrolledlighting_ts.interpretation,
    service.pilotcontrolledlighting_ts.sequence_number,
    service.pilotcontrolledlighting_ts.correction_number,
    service.pilotcontrolledlighting_ts.valid_time_begin,
    service.pilotcontrolledlighting_ts.valid_time_end,
    service.pilotcontrolledlighting_ts.feature_lifetime_begin,
    service.pilotcontrolledlighting_ts.feature_lifetime_end,
    service.pilotcontrolledlighting_ts.type_value,
    service.pilotcontrolledlighting_ts.type_nilreason,
    service.pilotcontrolledlighting_ts.intensitysteps_value,
    service.pilotcontrolledlighting_ts.intensitysteps_nilreason,
    service.pilotcontrolledlighting_ts.standbyintensity_value,
    service.pilotcontrolledlighting_ts.standbyintensity_nilreason,
    service.pilotcontrolledlighting_ts.activationinstruction_value,
    service.pilotcontrolledlighting_ts.activationinstruction_nilreason,
    service.pilotcontrolledlighting_ts.duration_value,
    service.pilotcontrolledlighting_ts.duration_uom,
    service.pilotcontrolledlighting_ts.duration_nilreason,
    service.pilotcontrolledlighting_ts.radiofrequency_value,
    service.pilotcontrolledlighting_ts.radiofrequency_uom,
    service.pilotcontrolledlighting_ts.radiofrequency_nilreason
order by pilotcontrolledlighting.identifier, pilotcontrolledlighting_ts.sequence_number, pilotcontrolledlighting_ts.correction_number DESC;
-- PrecisionApproachRadarTimeSliceType
-- ['surveillance.reflector_view', 'notes.note_view', 'shared.contactinformation_view', 'geometry.elevatedpoint_view']
create or replace view surveillance.precisionapproachradar_view as
select distinct on (precisionapproachradar.identifier,precisionapproachradar_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    surveillance.precisionapproachradar.id,
    surveillance.precisionapproachradar_ts.id as ts_id,
    surveillance.precisionapproachradar_tsp.id as tsp_id,
    surveillance.precisionapproachradar.identifier,
    surveillance.precisionapproachradar_ts.interpretation,
    surveillance.precisionapproachradar_ts.sequence_number,
    surveillance.precisionapproachradar_ts.correction_number,
    surveillance.precisionapproachradar_ts.valid_time_begin,
    surveillance.precisionapproachradar_ts.valid_time_end,
    surveillance.precisionapproachradar_ts.feature_lifetime_begin,
    surveillance.precisionapproachradar_ts.feature_lifetime_end,
    coalesce(cast(surveillance.precisionapproachradar_ts.name_value as varchar), '(' || surveillance.precisionapproachradar_ts.name_nilreason || ')') as name,
    coalesce(cast(surveillance.precisionapproachradar_ts.serialnumber_value as varchar), '(' || surveillance.precisionapproachradar_ts.serialnumber_nilreason || ')') as serialnumber,
    coalesce(cast(surveillance.precisionapproachradar_ts.dualchannel_value as varchar), '(' || surveillance.precisionapproachradar_ts.dualchannel_nilreason || ')') as dualchannel,
    coalesce(cast(surveillance.precisionapproachradar_ts.movingtargetindicator_value as varchar), '(' || surveillance.precisionapproachradar_ts.movingtargetindicator_nilreason || ')') as movingtargetindicator,
    coalesce(cast(surveillance.precisionapproachradar_ts.standbypower_value as varchar), '(' || surveillance.precisionapproachradar_ts.standbypower_nilreason || ')') as standbypower,
    coalesce(cast(surveillance.precisionapproachradar_ts.digital_value as varchar), '(' || surveillance.precisionapproachradar_ts.digital_nilreason || ')') as digital,
    coalesce(cast(surveillance.precisionapproachradar_ts.militaryuseonly_value as varchar), '(' || surveillance.precisionapproachradar_ts.militaryuseonly_nilreason || ')') as militaryuseonly,
    coalesce(cast(surveillance.precisionapproachradar_ts.specialuseonly_value as varchar), '(' || surveillance.precisionapproachradar_ts.specialuseonly_nilreason || ')') as specialuseonly,
    coalesce(cast(surveillance.precisionapproachradar_ts.specialaircraftonly_value as varchar), '(' || surveillance.precisionapproachradar_ts.specialaircraftonly_nilreason || ')') as specialaircraftonly,
    coalesce(cast(surveillance.precisionapproachradar_ts.magneticvariation_value as varchar), '(' || surveillance.precisionapproachradar_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(surveillance.precisionapproachradar_ts.magneticvariationaccuracy_value as varchar), '(' || surveillance.precisionapproachradar_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(surveillance.precisionapproachradar_ts.datemagneticvariation_value as varchar), '(' || surveillance.precisionapproachradar_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(surveillance.precisionapproachradar_ts.precisionapproachradartype_value as varchar), '(' || surveillance.precisionapproachradar_ts.precisionapproachradartype_nilreason || ')') as precisionapproachradartype,
    coalesce(cast(surveillance.precisionapproachradar_ts.slope_value as varchar), '(' || surveillance.precisionapproachradar_ts.slope_nilreason || ')') as slope,
    coalesce(cast(surveillance.precisionapproachradar_ts.slopeaccuracy_value as varchar), '(' || surveillance.precisionapproachradar_ts.slopeaccuracy_nilreason || ')') as slopeaccuracy,
    coalesce(cast(surveillance.precisionapproachradar_ts.range_value as varchar) || ' ' || surveillance.precisionapproachradar_ts.range_uom, '(' || surveillance.precisionapproachradar_ts.range_nilreason || ')') as range,
    coalesce(cast(surveillance.precisionapproachradar_ts.rangeaccuracy_value as varchar) || ' ' || surveillance.precisionapproachradar_ts.rangeaccuracy_uom, '(' || surveillance.precisionapproachradar_ts.rangeaccuracy_nilreason || ')') as rangeaccuracy,
    geometry_elevatedpoint_view_vnaekh.geom AS geom,
    ST_X(geometry_elevatedpoint_view_vnaekh.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_vnaekh.geom) AS latitude,
    geometry_elevatedpoint_view_vnaekh.elevation,
    geometry_elevatedpoint_view_vnaekh.geoidUndulation,
    geometry_elevatedpoint_view_vnaekh.verticalDatum,
    geometry_elevatedpoint_view_vnaekh.verticalAccuracy,
    geometry_elevatedpoint_view_vnaekh.horizontalAccuracy,
    jsonb_agg(notes_note_view_advjaa.*) AS precisionapproachradar_annotation,
    jsonb_agg(surveillance_reflector_view_rnlchj.id) AS reflector
from surveillance.precisionapproachradar 
inner join master_join mj2 on surveillance.precisionapproachradar.id = mj2.source_id
inner join surveillance.precisionapproachradar_tsp on mj2.target_id = surveillance.precisionapproachradar_tsp.id
inner join surveillance.precisionapproachradar_ts on surveillance.precisionapproachradar_tsp.precisionapproachradartimeslice_id = surveillance.precisionapproachradar_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_vnaekh on surveillance.precisionapproachradar_ts.location_id = geometry_elevatedpoint_view_vnaekh.id
left join master_join master_join_klerao on surveillance.precisionapproachradar_ts.id = master_join_klerao.source_id
left join shared.contactinformation_view shared_contactinformation_view_booxze on master_join_klerao.target_id = shared_contactinformation_view_booxze.id
left join master_join master_join_zzqncy on surveillance.precisionapproachradar_ts.id = master_join_zzqncy.source_id
left join notes.note_view notes_note_view_advjaa on master_join_zzqncy.target_id = notes_note_view_advjaa.id
left join master_join master_join_jxrnex on surveillance.precisionapproachradar_ts.id = master_join_jxrnex.source_id
left join surveillance.reflector_view surveillance_reflector_view_rnlchj on master_join_jxrnex.target_id = surveillance_reflector_view_rnlchj.id
where surveillance.precisionapproachradar.feature_status = 'APPROVED'
  and surveillance.precisionapproachradar_ts.feature_status = 'APPROVED'
group by
    surveillance.precisionapproachradar.id,
    surveillance.precisionapproachradar_ts.id,
    surveillance.precisionapproachradar_tsp.id,
    surveillance.precisionapproachradar.identifier,
    surveillance.precisionapproachradar_ts.interpretation,
    surveillance.precisionapproachradar_ts.sequence_number,
    surveillance.precisionapproachradar_ts.correction_number,
    surveillance.precisionapproachradar_ts.valid_time_begin,
    surveillance.precisionapproachradar_ts.valid_time_end,
    surveillance.precisionapproachradar_ts.feature_lifetime_begin,
    surveillance.precisionapproachradar_ts.feature_lifetime_end,
    surveillance.precisionapproachradar_ts.name_value,
    surveillance.precisionapproachradar_ts.name_nilreason,
    surveillance.precisionapproachradar_ts.serialnumber_value,
    surveillance.precisionapproachradar_ts.serialnumber_nilreason,
    surveillance.precisionapproachradar_ts.dualchannel_value,
    surveillance.precisionapproachradar_ts.dualchannel_nilreason,
    surveillance.precisionapproachradar_ts.movingtargetindicator_value,
    surveillance.precisionapproachradar_ts.movingtargetindicator_nilreason,
    surveillance.precisionapproachradar_ts.standbypower_value,
    surveillance.precisionapproachradar_ts.standbypower_nilreason,
    surveillance.precisionapproachradar_ts.digital_value,
    surveillance.precisionapproachradar_ts.digital_nilreason,
    surveillance.precisionapproachradar_ts.militaryuseonly_value,
    surveillance.precisionapproachradar_ts.militaryuseonly_nilreason,
    surveillance.precisionapproachradar_ts.specialuseonly_value,
    surveillance.precisionapproachradar_ts.specialuseonly_nilreason,
    surveillance.precisionapproachradar_ts.specialaircraftonly_value,
    surveillance.precisionapproachradar_ts.specialaircraftonly_nilreason,
    surveillance.precisionapproachradar_ts.magneticvariation_value,
    surveillance.precisionapproachradar_ts.magneticvariation_nilreason,
    surveillance.precisionapproachradar_ts.magneticvariationaccuracy_value,
    surveillance.precisionapproachradar_ts.magneticvariationaccuracy_nilreason,
    surveillance.precisionapproachradar_ts.datemagneticvariation_value,
    surveillance.precisionapproachradar_ts.datemagneticvariation_nilreason,
    surveillance.precisionapproachradar_ts.precisionapproachradartype_value,
    surveillance.precisionapproachradar_ts.precisionapproachradartype_nilreason,
    surveillance.precisionapproachradar_ts.slope_value,
    surveillance.precisionapproachradar_ts.slope_nilreason,
    surveillance.precisionapproachradar_ts.slopeaccuracy_value,
    surveillance.precisionapproachradar_ts.slopeaccuracy_nilreason,
    surveillance.precisionapproachradar_ts.range_value,
    surveillance.precisionapproachradar_ts.range_uom,
    surveillance.precisionapproachradar_ts.range_nilreason,
    surveillance.precisionapproachradar_ts.rangeaccuracy_value,
    surveillance.precisionapproachradar_ts.rangeaccuracy_uom,
    surveillance.precisionapproachradar_ts.rangeaccuracy_nilreason,
    geometry_elevatedpoint_view_vnaekh.geom,
    geometry_elevatedpoint_view_vnaekh.elevation,
    geometry_elevatedpoint_view_vnaekh.geoidUndulation,
    geometry_elevatedpoint_view_vnaekh.verticalDatum,
    geometry_elevatedpoint_view_vnaekh.verticalAccuracy,
    geometry_elevatedpoint_view_vnaekh.horizontalAccuracy
order by precisionapproachradar.identifier, precisionapproachradar_ts.sequence_number, precisionapproachradar_ts.correction_number DESC;
-- PrimarySurveillanceRadarTimeSliceType
-- ['notes.note_view', 'surveillance.surveillancegroundstation_view', 'shared.contactinformation_view', 'geometry.elevatedpoint_view']
create or replace view surveillance.primarysurveillanceradar_view as
select distinct on (primarysurveillanceradar.identifier,primarysurveillanceradar_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    surveillance.primarysurveillanceradar.id,
    surveillance.primarysurveillanceradar_ts.id as ts_id,
    surveillance.primarysurveillanceradar_tsp.id as tsp_id,
    surveillance.primarysurveillanceradar.identifier,
    surveillance.primarysurveillanceradar_ts.interpretation,
    surveillance.primarysurveillanceradar_ts.sequence_number,
    surveillance.primarysurveillanceradar_ts.correction_number,
    surveillance.primarysurveillanceradar_ts.valid_time_begin,
    surveillance.primarysurveillanceradar_ts.valid_time_end,
    surveillance.primarysurveillanceradar_ts.feature_lifetime_begin,
    surveillance.primarysurveillanceradar_ts.feature_lifetime_end,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.name_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.name_nilreason || ')') as name,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.serialnumber_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.serialnumber_nilreason || ')') as serialnumber,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.dualchannel_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.dualchannel_nilreason || ')') as dualchannel,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.movingtargetindicator_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.movingtargetindicator_nilreason || ')') as movingtargetindicator,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.standbypower_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.standbypower_nilreason || ')') as standbypower,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.digital_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.digital_nilreason || ')') as digital,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.militaryuseonly_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.militaryuseonly_nilreason || ')') as militaryuseonly,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.specialuseonly_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.specialuseonly_nilreason || ')') as specialuseonly,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.specialaircraftonly_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.specialaircraftonly_nilreason || ')') as specialaircraftonly,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.magneticvariation_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.magneticvariationaccuracy_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.datemagneticvariation_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.verticalcoverageazimuth_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.verticalcoverageazimuth_nilreason || ')') as verticalcoverageazimuth,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.antennatiltfixed_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.antennatiltfixed_nilreason || ')') as antennatiltfixed,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.tiltangle_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.tiltangle_nilreason || ')') as tiltangle,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.automatedradarterminalsystem_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.automatedradarterminalsystem_nilreason || ')') as automatedradarterminalsystem,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.type_value as varchar), '(' || surveillance.primarysurveillanceradar_ts.type_nilreason || ')') as type,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.range_value as varchar) || ' ' || surveillance.primarysurveillanceradar_ts.range_uom, '(' || surveillance.primarysurveillanceradar_ts.range_nilreason || ')') as range,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.rangeaccuracy_value as varchar) || ' ' || surveillance.primarysurveillanceradar_ts.rangeaccuracy_uom, '(' || surveillance.primarysurveillanceradar_ts.rangeaccuracy_nilreason || ')') as rangeaccuracy,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.verticalcoveragealtitude_value as varchar) || ' ' || surveillance.primarysurveillanceradar_ts.verticalcoveragealtitude_uom, '(' || surveillance.primarysurveillanceradar_ts.verticalcoveragealtitude_nilreason || ')') as verticalcoveragealtitude,
    coalesce(cast(surveillance.primarysurveillanceradar_ts.verticalcoveragedistance_value as varchar) || ' ' || surveillance.primarysurveillanceradar_ts.verticalcoveragedistance_uom, '(' || surveillance.primarysurveillanceradar_ts.verticalcoveragedistance_nilreason || ')') as verticalcoveragedistance,
    geometry_elevatedpoint_view_gabmqs.geom AS geom,
    ST_X(geometry_elevatedpoint_view_gabmqs.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_gabmqs.geom) AS latitude,
    geometry_elevatedpoint_view_gabmqs.elevation,
    geometry_elevatedpoint_view_gabmqs.geoidUndulation,
    geometry_elevatedpoint_view_gabmqs.verticalDatum,
    geometry_elevatedpoint_view_gabmqs.verticalAccuracy,
    geometry_elevatedpoint_view_gabmqs.horizontalAccuracy,
    jsonb_agg(notes_note_view_sqqorz.*) AS primarysurveillanceradar_annotation,
    jsonb_agg(surveillance_surveillancegroundstation_view_xsngii.id) AS groundstation
from surveillance.primarysurveillanceradar 
inner join master_join mj2 on surveillance.primarysurveillanceradar.id = mj2.source_id
inner join surveillance.primarysurveillanceradar_tsp on mj2.target_id = surveillance.primarysurveillanceradar_tsp.id
inner join surveillance.primarysurveillanceradar_ts on surveillance.primarysurveillanceradar_tsp.primarysurveillanceradartimeslice_id = surveillance.primarysurveillanceradar_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_gabmqs on surveillance.primarysurveillanceradar_ts.location_id = geometry_elevatedpoint_view_gabmqs.id
left join master_join master_join_sqpzuv on surveillance.primarysurveillanceradar_ts.id = master_join_sqpzuv.source_id
left join shared.contactinformation_view shared_contactinformation_view_unrjve on master_join_sqpzuv.target_id = shared_contactinformation_view_unrjve.id
left join master_join master_join_cholsk on surveillance.primarysurveillanceradar_ts.id = master_join_cholsk.source_id
left join notes.note_view notes_note_view_sqqorz on master_join_cholsk.target_id = notes_note_view_sqqorz.id
left join master_join master_join_onicvx on surveillance.primarysurveillanceradar_ts.id = master_join_onicvx.source_id
left join surveillance.surveillancegroundstation_view surveillance_surveillancegroundstation_view_xsngii on master_join_onicvx.target_id = surveillance_surveillancegroundstation_view_xsngii.id
where surveillance.primarysurveillanceradar.feature_status = 'APPROVED'
  and surveillance.primarysurveillanceradar_ts.feature_status = 'APPROVED'
group by
    surveillance.primarysurveillanceradar.id,
    surveillance.primarysurveillanceradar_ts.id,
    surveillance.primarysurveillanceradar_tsp.id,
    surveillance.primarysurveillanceradar.identifier,
    surveillance.primarysurveillanceradar_ts.interpretation,
    surveillance.primarysurveillanceradar_ts.sequence_number,
    surveillance.primarysurveillanceradar_ts.correction_number,
    surveillance.primarysurveillanceradar_ts.valid_time_begin,
    surveillance.primarysurveillanceradar_ts.valid_time_end,
    surveillance.primarysurveillanceradar_ts.feature_lifetime_begin,
    surveillance.primarysurveillanceradar_ts.feature_lifetime_end,
    surveillance.primarysurveillanceradar_ts.name_value,
    surveillance.primarysurveillanceradar_ts.name_nilreason,
    surveillance.primarysurveillanceradar_ts.serialnumber_value,
    surveillance.primarysurveillanceradar_ts.serialnumber_nilreason,
    surveillance.primarysurveillanceradar_ts.dualchannel_value,
    surveillance.primarysurveillanceradar_ts.dualchannel_nilreason,
    surveillance.primarysurveillanceradar_ts.movingtargetindicator_value,
    surveillance.primarysurveillanceradar_ts.movingtargetindicator_nilreason,
    surveillance.primarysurveillanceradar_ts.standbypower_value,
    surveillance.primarysurveillanceradar_ts.standbypower_nilreason,
    surveillance.primarysurveillanceradar_ts.digital_value,
    surveillance.primarysurveillanceradar_ts.digital_nilreason,
    surveillance.primarysurveillanceradar_ts.militaryuseonly_value,
    surveillance.primarysurveillanceradar_ts.militaryuseonly_nilreason,
    surveillance.primarysurveillanceradar_ts.specialuseonly_value,
    surveillance.primarysurveillanceradar_ts.specialuseonly_nilreason,
    surveillance.primarysurveillanceradar_ts.specialaircraftonly_value,
    surveillance.primarysurveillanceradar_ts.specialaircraftonly_nilreason,
    surveillance.primarysurveillanceradar_ts.magneticvariation_value,
    surveillance.primarysurveillanceradar_ts.magneticvariation_nilreason,
    surveillance.primarysurveillanceradar_ts.magneticvariationaccuracy_value,
    surveillance.primarysurveillanceradar_ts.magneticvariationaccuracy_nilreason,
    surveillance.primarysurveillanceradar_ts.datemagneticvariation_value,
    surveillance.primarysurveillanceradar_ts.datemagneticvariation_nilreason,
    surveillance.primarysurveillanceradar_ts.verticalcoverageazimuth_value,
    surveillance.primarysurveillanceradar_ts.verticalcoverageazimuth_nilreason,
    surveillance.primarysurveillanceradar_ts.antennatiltfixed_value,
    surveillance.primarysurveillanceradar_ts.antennatiltfixed_nilreason,
    surveillance.primarysurveillanceradar_ts.tiltangle_value,
    surveillance.primarysurveillanceradar_ts.tiltangle_nilreason,
    surveillance.primarysurveillanceradar_ts.automatedradarterminalsystem_value,
    surveillance.primarysurveillanceradar_ts.automatedradarterminalsystem_nilreason,
    surveillance.primarysurveillanceradar_ts.type_value,
    surveillance.primarysurveillanceradar_ts.type_nilreason,
    surveillance.primarysurveillanceradar_ts.range_value,
    surveillance.primarysurveillanceradar_ts.range_uom,
    surveillance.primarysurveillanceradar_ts.range_nilreason,
    surveillance.primarysurveillanceradar_ts.rangeaccuracy_value,
    surveillance.primarysurveillanceradar_ts.rangeaccuracy_uom,
    surveillance.primarysurveillanceradar_ts.rangeaccuracy_nilreason,
    surveillance.primarysurveillanceradar_ts.verticalcoveragealtitude_value,
    surveillance.primarysurveillanceradar_ts.verticalcoveragealtitude_uom,
    surveillance.primarysurveillanceradar_ts.verticalcoveragealtitude_nilreason,
    surveillance.primarysurveillanceradar_ts.verticalcoveragedistance_value,
    surveillance.primarysurveillanceradar_ts.verticalcoveragedistance_uom,
    surveillance.primarysurveillanceradar_ts.verticalcoveragedistance_nilreason,
    geometry_elevatedpoint_view_gabmqs.geom,
    geometry_elevatedpoint_view_gabmqs.elevation,
    geometry_elevatedpoint_view_gabmqs.geoidUndulation,
    geometry_elevatedpoint_view_gabmqs.verticalDatum,
    geometry_elevatedpoint_view_gabmqs.verticalAccuracy,
    geometry_elevatedpoint_view_gabmqs.horizontalAccuracy
order by primarysurveillanceradar.identifier, primarysurveillanceradar_ts.sequence_number, primarysurveillanceradar_ts.correction_number DESC;
-- ProcedureDMETimeSliceType
-- ['notes.note_view']
create or replace view procedure.proceduredme_view as
select distinct on (proceduredme.identifier,proceduredme_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.proceduredme.id,
    procedure.proceduredme_ts.id as ts_id,
    procedure.proceduredme_tsp.id as tsp_id,
    procedure.proceduredme.identifier,
    procedure.proceduredme_ts.interpretation,
    procedure.proceduredme_ts.sequence_number,
    procedure.proceduredme_ts.correction_number,
    procedure.proceduredme_ts.valid_time_begin,
    procedure.proceduredme_ts.valid_time_end,
    procedure.proceduredme_ts.feature_lifetime_begin,
    procedure.proceduredme_ts.feature_lifetime_end,
    coalesce(cast(procedure.proceduredme_ts.criticaldme_value as varchar), '(' || procedure.proceduredme_ts.criticaldme_nilreason || ')') as criticaldme,
    coalesce(cast(procedure.proceduredme_ts.satisfactory_value as varchar), '(' || procedure.proceduredme_ts.satisfactory_nilreason || ')') as satisfactory,
    coalesce(cast(navaids_points_dme_pt_odvrxo.title as varchar), '(' || navaids_points_dme_pt_odvrxo.nilreason[1] || ')') AS dme,
    navaids_points_dme_pt_odvrxo.href AS dme_href,
    jsonb_agg(notes_note_view_pgfjsj.*) AS proceduredme_annotation
from procedure.proceduredme 
inner join master_join mj2 on procedure.proceduredme.id = mj2.source_id
inner join procedure.proceduredme_tsp on mj2.target_id = procedure.proceduredme_tsp.id
inner join procedure.proceduredme_ts on procedure.proceduredme_tsp.proceduredmetimeslice_id = procedure.proceduredme_ts.id
left join navaids_points.dme_pt navaids_points_dme_pt_odvrxo on procedure.proceduredme_ts.dme_id = navaids_points_dme_pt_odvrxo.id
left join master_join master_join_ftsvsd on procedure.proceduredme_ts.id = master_join_ftsvsd.source_id
left join notes.note_view notes_note_view_pgfjsj on master_join_ftsvsd.target_id = notes_note_view_pgfjsj.id
where procedure.proceduredme.feature_status = 'APPROVED'
  and procedure.proceduredme_ts.feature_status = 'APPROVED'
group by
    procedure.proceduredme.id,
    procedure.proceduredme_ts.id,
    procedure.proceduredme_tsp.id,
    procedure.proceduredme.identifier,
    procedure.proceduredme_ts.interpretation,
    procedure.proceduredme_ts.sequence_number,
    procedure.proceduredme_ts.correction_number,
    procedure.proceduredme_ts.valid_time_begin,
    procedure.proceduredme_ts.valid_time_end,
    procedure.proceduredme_ts.feature_lifetime_begin,
    procedure.proceduredme_ts.feature_lifetime_end,
    procedure.proceduredme_ts.criticaldme_value,
    procedure.proceduredme_ts.criticaldme_nilreason,
    procedure.proceduredme_ts.satisfactory_value,
    procedure.proceduredme_ts.satisfactory_nilreason,
    navaids_points_dme_pt_odvrxo.title,
    navaids_points_dme_pt_odvrxo.nilreason[1],
    navaids_points_dme_pt_odvrxo.href
order by proceduredme.identifier, proceduredme_ts.sequence_number, proceduredme_ts.correction_number DESC;
-- RadarSystemTimeSliceType
-- ['surveillance.radarcomponent_view', 'notes.note_view', 'geometry.elevatedpoint_view']
create or replace view surveillance.radarsystem_view as
select distinct on (radarsystem.identifier,radarsystem_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    surveillance.radarsystem.id,
    surveillance.radarsystem_ts.id as ts_id,
    surveillance.radarsystem_tsp.id as tsp_id,
    surveillance.radarsystem.identifier,
    surveillance.radarsystem_ts.interpretation,
    surveillance.radarsystem_ts.sequence_number,
    surveillance.radarsystem_ts.correction_number,
    surveillance.radarsystem_ts.valid_time_begin,
    surveillance.radarsystem_ts.valid_time_end,
    surveillance.radarsystem_ts.feature_lifetime_begin,
    surveillance.radarsystem_ts.feature_lifetime_end,
    coalesce(cast(surveillance.radarsystem_ts.type_value as varchar), '(' || surveillance.radarsystem_ts.type_nilreason || ')') as type,
    coalesce(cast(surveillance.radarsystem_ts.model_value as varchar), '(' || surveillance.radarsystem_ts.model_nilreason || ')') as model,
    coalesce(cast(surveillance.radarsystem_ts.generalterrainmonitor_value as varchar), '(' || surveillance.radarsystem_ts.generalterrainmonitor_nilreason || ')') as generalterrainmonitor,
    coalesce(cast(surveillance.radarsystem_ts.broadcastidentifier_value as varchar), '(' || surveillance.radarsystem_ts.broadcastidentifier_nilreason || ')') as broadcastidentifier,
    coalesce(cast(airport_heliport_airportheliport_pt_ihhdqf.title as varchar), '(' || airport_heliport_airportheliport_pt_ihhdqf.nilreason[1] || ')') AS airportheliport,
    airport_heliport_airportheliport_pt_ihhdqf.href AS airportheliport_href,
    geometry_elevatedpoint_view_mvfwnq.geom AS geom,
    ST_X(geometry_elevatedpoint_view_mvfwnq.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_mvfwnq.geom) AS latitude,
    geometry_elevatedpoint_view_mvfwnq.elevation,
    geometry_elevatedpoint_view_mvfwnq.geoidUndulation,
    geometry_elevatedpoint_view_mvfwnq.verticalDatum,
    geometry_elevatedpoint_view_mvfwnq.verticalAccuracy,
    geometry_elevatedpoint_view_mvfwnq.horizontalAccuracy,
    jsonb_agg(surveillance_radarcomponent_view_xwzcno.id) AS radarequipment,
    jsonb_build_object('id', organisation_organisationauthority_pt_cuuxaj.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_cuuxaj.title AS varchar), '(' || organisation_organisationauthority_pt_cuuxaj.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_cuuxaj.href) AS office,
    jsonb_build_object('id', airport_heliport_runway_pt_ntqfba.id,
    'title', coalesce(cast(airport_heliport_runway_pt_ntqfba.title AS varchar), '(' || airport_heliport_runway_pt_ntqfba.nilreason[1] || ')'),
    'href', airport_heliport_runway_pt_ntqfba.href) AS parrunway,
    jsonb_agg(notes_note_view_bepwhb.*) AS radarsystem_annotation
from surveillance.radarsystem 
inner join master_join mj2 on surveillance.radarsystem.id = mj2.source_id
inner join surveillance.radarsystem_tsp on mj2.target_id = surveillance.radarsystem_tsp.id
inner join surveillance.radarsystem_ts on surveillance.radarsystem_tsp.radarsystemtimeslice_id = surveillance.radarsystem_ts.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_ihhdqf on surveillance.radarsystem_ts.airportheliport_id = airport_heliport_airportheliport_pt_ihhdqf.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_mvfwnq on surveillance.radarsystem_ts.location_id = geometry_elevatedpoint_view_mvfwnq.id
left join master_join master_join_ehbehe on surveillance.radarsystem_ts.id = master_join_ehbehe.source_id
left join surveillance.radarcomponent_view surveillance_radarcomponent_view_xwzcno on master_join_ehbehe.target_id = surveillance_radarcomponent_view_xwzcno.id
left join master_join master_join_tntjdp on surveillance.radarsystem_ts.id = master_join_tntjdp.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_cuuxaj on master_join_tntjdp.target_id = organisation_organisationauthority_pt_cuuxaj.id
left join master_join master_join_zgvzwv on surveillance.radarsystem_ts.id = master_join_zgvzwv.source_id
left join airport_heliport.runway_pt airport_heliport_runway_pt_ntqfba on master_join_zgvzwv.target_id = airport_heliport_runway_pt_ntqfba.id
left join master_join master_join_zxbmck on surveillance.radarsystem_ts.id = master_join_zxbmck.source_id
left join notes.note_view notes_note_view_bepwhb on master_join_zxbmck.target_id = notes_note_view_bepwhb.id
where surveillance.radarsystem.feature_status = 'APPROVED'
  and surveillance.radarsystem_ts.feature_status = 'APPROVED'
group by
    surveillance.radarsystem.id,
    surveillance.radarsystem_ts.id,
    surveillance.radarsystem_tsp.id,
    surveillance.radarsystem.identifier,
    surveillance.radarsystem_ts.interpretation,
    surveillance.radarsystem_ts.sequence_number,
    surveillance.radarsystem_ts.correction_number,
    surveillance.radarsystem_ts.valid_time_begin,
    surveillance.radarsystem_ts.valid_time_end,
    surveillance.radarsystem_ts.feature_lifetime_begin,
    surveillance.radarsystem_ts.feature_lifetime_end,
    surveillance.radarsystem_ts.type_value,
    surveillance.radarsystem_ts.type_nilreason,
    surveillance.radarsystem_ts.model_value,
    surveillance.radarsystem_ts.model_nilreason,
    surveillance.radarsystem_ts.generalterrainmonitor_value,
    surveillance.radarsystem_ts.generalterrainmonitor_nilreason,
    surveillance.radarsystem_ts.broadcastidentifier_value,
    surveillance.radarsystem_ts.broadcastidentifier_nilreason,
    airport_heliport_airportheliport_pt_ihhdqf.title,
    airport_heliport_airportheliport_pt_ihhdqf.nilreason[1],
    airport_heliport_airportheliport_pt_ihhdqf.href,
    geometry_elevatedpoint_view_mvfwnq.geom,
    geometry_elevatedpoint_view_mvfwnq.elevation,
    geometry_elevatedpoint_view_mvfwnq.geoidUndulation,
    geometry_elevatedpoint_view_mvfwnq.verticalDatum,
    geometry_elevatedpoint_view_mvfwnq.verticalAccuracy,
    geometry_elevatedpoint_view_mvfwnq.horizontalAccuracy
order by radarsystem.identifier, radarsystem_ts.sequence_number, radarsystem_ts.correction_number DESC;
-- RadioCommunicationChannelTimeSliceType
-- ['service.radiocommunicationoperationalstatus_view', 'notes.note_view', 'geometry.elevatedpoint_view']
create or replace view service.radiocommunicationchannel_view as
select distinct on (radiocommunicationchannel.identifier,radiocommunicationchannel_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.radiocommunicationchannel.id,
    service.radiocommunicationchannel_ts.id as ts_id,
    service.radiocommunicationchannel_tsp.id as tsp_id,
    service.radiocommunicationchannel.identifier,
    service.radiocommunicationchannel_ts.interpretation,
    service.radiocommunicationchannel_ts.sequence_number,
    service.radiocommunicationchannel_ts.correction_number,
    service.radiocommunicationchannel_ts.valid_time_begin,
    service.radiocommunicationchannel_ts.valid_time_end,
    service.radiocommunicationchannel_ts.feature_lifetime_begin,
    service.radiocommunicationchannel_ts.feature_lifetime_end,
    coalesce(cast(service.radiocommunicationchannel_ts.mode_value as varchar), '(' || service.radiocommunicationchannel_ts.mode_nilreason || ')') as mode,
    coalesce(cast(service.radiocommunicationchannel_ts.rank_value as varchar), '(' || service.radiocommunicationchannel_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.radiocommunicationchannel_ts.channel_value as varchar), '(' || service.radiocommunicationchannel_ts.channel_nilreason || ')') as channel,
    coalesce(cast(service.radiocommunicationchannel_ts.logon_value as varchar), '(' || service.radiocommunicationchannel_ts.logon_nilreason || ')') as logon,
    coalesce(cast(service.radiocommunicationchannel_ts.emissiontype_value as varchar), '(' || service.radiocommunicationchannel_ts.emissiontype_nilreason || ')') as emissiontype,
    coalesce(cast(service.radiocommunicationchannel_ts.selectivecall_value as varchar), '(' || service.radiocommunicationchannel_ts.selectivecall_nilreason || ')') as selectivecall,
    coalesce(cast(service.radiocommunicationchannel_ts.flightchecked_value as varchar), '(' || service.radiocommunicationchannel_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(service.radiocommunicationchannel_ts.trafficdirection_value as varchar), '(' || service.radiocommunicationchannel_ts.trafficdirection_nilreason || ')') as trafficdirection,
    coalesce(cast(service.radiocommunicationchannel_ts.frequencytransmission_value as varchar) || ' ' || service.radiocommunicationchannel_ts.frequencytransmission_uom, '(' || service.radiocommunicationchannel_ts.frequencytransmission_nilreason || ')') as frequencytransmission,
    coalesce(cast(service.radiocommunicationchannel_ts.frequencyreception_value as varchar) || ' ' || service.radiocommunicationchannel_ts.frequencyreception_uom, '(' || service.radiocommunicationchannel_ts.frequencyreception_nilreason || ')') as frequencyreception,
    geometry_elevatedpoint_view_bxuhqo.geom AS geom,
    jsonb_agg(service_radiocommunicationoperationalstatus_view_lsohzi.id) AS availability,
    jsonb_agg(notes_note_view_vxyomz.*) AS radiocommunicationchannel_annotation
from service.radiocommunicationchannel 
inner join master_join mj2 on service.radiocommunicationchannel.id = mj2.source_id
inner join service.radiocommunicationchannel_tsp on mj2.target_id = service.radiocommunicationchannel_tsp.id
inner join service.radiocommunicationchannel_ts on service.radiocommunicationchannel_tsp.radiocommunicationchanneltimeslice_id = service.radiocommunicationchannel_ts.id
left join master_join master_join_zuiwlo on service.radiocommunicationchannel_ts.id = master_join_zuiwlo.source_id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_bxuhqo on master_join_zuiwlo.target_id = geometry_elevatedpoint_view_bxuhqo.id
left join master_join master_join_qyzpgg on service.radiocommunicationchannel_ts.id = master_join_qyzpgg.source_id
left join service.radiocommunicationoperationalstatus_view service_radiocommunicationoperationalstatus_view_lsohzi on master_join_qyzpgg.target_id = service_radiocommunicationoperationalstatus_view_lsohzi.id
left join master_join master_join_tnjftc on service.radiocommunicationchannel_ts.id = master_join_tnjftc.source_id
left join notes.note_view notes_note_view_vxyomz on master_join_tnjftc.target_id = notes_note_view_vxyomz.id
where service.radiocommunicationchannel.feature_status = 'APPROVED'
  and service.radiocommunicationchannel_ts.feature_status = 'APPROVED'
group by
    service.radiocommunicationchannel.id,
    service.radiocommunicationchannel_ts.id,
    service.radiocommunicationchannel_tsp.id,
    service.radiocommunicationchannel.identifier,
    service.radiocommunicationchannel_ts.interpretation,
    service.radiocommunicationchannel_ts.sequence_number,
    service.radiocommunicationchannel_ts.correction_number,
    service.radiocommunicationchannel_ts.valid_time_begin,
    service.radiocommunicationchannel_ts.valid_time_end,
    service.radiocommunicationchannel_ts.feature_lifetime_begin,
    service.radiocommunicationchannel_ts.feature_lifetime_end,
    service.radiocommunicationchannel_ts.mode_value,
    service.radiocommunicationchannel_ts.mode_nilreason,
    service.radiocommunicationchannel_ts.rank_value,
    service.radiocommunicationchannel_ts.rank_nilreason,
    service.radiocommunicationchannel_ts.channel_value,
    service.radiocommunicationchannel_ts.channel_nilreason,
    service.radiocommunicationchannel_ts.logon_value,
    service.radiocommunicationchannel_ts.logon_nilreason,
    service.radiocommunicationchannel_ts.emissiontype_value,
    service.radiocommunicationchannel_ts.emissiontype_nilreason,
    service.radiocommunicationchannel_ts.selectivecall_value,
    service.radiocommunicationchannel_ts.selectivecall_nilreason,
    service.radiocommunicationchannel_ts.flightchecked_value,
    service.radiocommunicationchannel_ts.flightchecked_nilreason,
    service.radiocommunicationchannel_ts.trafficdirection_value,
    service.radiocommunicationchannel_ts.trafficdirection_nilreason,
    service.radiocommunicationchannel_ts.frequencytransmission_value,
    service.radiocommunicationchannel_ts.frequencytransmission_uom,
    service.radiocommunicationchannel_ts.frequencytransmission_nilreason,
    service.radiocommunicationchannel_ts.frequencyreception_value,
    service.radiocommunicationchannel_ts.frequencyreception_uom,
    service.radiocommunicationchannel_ts.frequencyreception_nilreason
order by radiocommunicationchannel.identifier, radiocommunicationchannel_ts.sequence_number, radiocommunicationchannel_ts.correction_number DESC;
-- RadioFrequencyAreaTimeSliceType
-- ['geometry.surface_view', 'notes.note_view', 'shared.circlesector_view']
create or replace view shared.radiofrequencyarea_view as
select distinct on (radiofrequencyarea.identifier,radiofrequencyarea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    shared.radiofrequencyarea.id,
    shared.radiofrequencyarea_ts.id as ts_id,
    shared.radiofrequencyarea_tsp.id as tsp_id,
    shared.radiofrequencyarea.identifier,
    shared.radiofrequencyarea_ts.interpretation,
    shared.radiofrequencyarea_ts.sequence_number,
    shared.radiofrequencyarea_ts.correction_number,
    shared.radiofrequencyarea_ts.valid_time_begin,
    shared.radiofrequencyarea_ts.valid_time_end,
    shared.radiofrequencyarea_ts.feature_lifetime_begin,
    shared.radiofrequencyarea_ts.feature_lifetime_end,
    coalesce(cast(shared.radiofrequencyarea_ts.type_value as varchar), '(' || shared.radiofrequencyarea_ts.type_nilreason || ')') as type,
    coalesce(cast(shared.radiofrequencyarea_ts.anglescallop_value as varchar), '(' || shared.radiofrequencyarea_ts.anglescallop_nilreason || ')') as anglescallop,
    coalesce(cast(shared.radiofrequencyarea_ts.signaltype_value as varchar), '(' || shared.radiofrequencyarea_ts.signaltype_nilreason || ')') as signaltype,
    coalesce(cast(service_radiocommunicationchannel_pt_axpzst.title as varchar), '(' || service_radiocommunicationchannel_pt_axpzst.nilreason[1] || ')') AS equipmentfrequency,
    service_radiocommunicationchannel_pt_axpzst.href AS equipmentfrequency_href,
    coalesce(cast(navaids_points_specialnavigationstation_pt_zmbtja.title as varchar), '(' || navaids_points_specialnavigationstation_pt_zmbtja.nilreason[1] || ')') AS equipmentspecialnavigationstation,
    navaids_points_specialnavigationstation_pt_zmbtja.href AS equipmentspecialnavigationstation_href,
    coalesce(cast(surveillance_precisionapproachradar_pt_zpuevu.title as varchar), '(' || surveillance_precisionapproachradar_pt_zpuevu.nilreason[1] || ')') AS equipmentprecisionapproachradar,
    surveillance_precisionapproachradar_pt_zpuevu.href AS equipmentprecisionapproachradar_href,
    coalesce(cast(surveillance_secondarysurveillanceradar_pt_sdxxnx.title as varchar), '(' || surveillance_secondarysurveillanceradar_pt_sdxxnx.nilreason[1] || ')') AS equipmentradar,
    surveillance_secondarysurveillanceradar_pt_sdxxnx.href AS equipmentradar_href,
    jsonb_agg(shared_circlesector_view_drnncw.id) AS sector,
    geometry_surface_view_fiprxn.geom AS geom,
    jsonb_agg(notes_note_view_ovxboh.*) AS radiofrequencyarea_annotation
from shared.radiofrequencyarea 
inner join master_join mj2 on shared.radiofrequencyarea.id = mj2.source_id
inner join shared.radiofrequencyarea_tsp on mj2.target_id = shared.radiofrequencyarea_tsp.id
inner join shared.radiofrequencyarea_ts on shared.radiofrequencyarea_tsp.radiofrequencyareatimeslice_id = shared.radiofrequencyarea_ts.id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_axpzst on shared.radiofrequencyarea_ts.equipment_frequency_id = service_radiocommunicationchannel_pt_axpzst.id
left join navaids_points.specialnavigationstation_pt navaids_points_specialnavigationstation_pt_zmbtja on shared.radiofrequencyarea_ts.equipment_specialnavigationstation_id = navaids_points_specialnavigationstation_pt_zmbtja.id
left join surveillance.precisionapproachradar_pt surveillance_precisionapproachradar_pt_zpuevu on shared.radiofrequencyarea_ts.equipment_precisionapproachradar_id = surveillance_precisionapproachradar_pt_zpuevu.id
left join surveillance.secondarysurveillanceradar_pt surveillance_secondarysurveillanceradar_pt_sdxxnx on shared.radiofrequencyarea_ts.equipment_radar_id = surveillance_secondarysurveillanceradar_pt_sdxxnx.id
left join master_join master_join_kjnhld on shared.radiofrequencyarea_ts.id = master_join_kjnhld.source_id
left join shared.circlesector_view shared_circlesector_view_drnncw on master_join_kjnhld.target_id = shared_circlesector_view_drnncw.id
left join master_join master_join_beyqhe on shared.radiofrequencyarea_ts.id = master_join_beyqhe.source_id
left join geometry.surface_view geometry_surface_view_fiprxn on master_join_beyqhe.target_id = geometry_surface_view_fiprxn.id
left join master_join master_join_pvgbai on shared.radiofrequencyarea_ts.id = master_join_pvgbai.source_id
left join notes.note_view notes_note_view_ovxboh on master_join_pvgbai.target_id = notes_note_view_ovxboh.id
where shared.radiofrequencyarea.feature_status = 'APPROVED'
  and shared.radiofrequencyarea_ts.feature_status = 'APPROVED'
group by
    shared.radiofrequencyarea.id,
    shared.radiofrequencyarea_ts.id,
    shared.radiofrequencyarea_tsp.id,
    shared.radiofrequencyarea.identifier,
    shared.radiofrequencyarea_ts.interpretation,
    shared.radiofrequencyarea_ts.sequence_number,
    shared.radiofrequencyarea_ts.correction_number,
    shared.radiofrequencyarea_ts.valid_time_begin,
    shared.radiofrequencyarea_ts.valid_time_end,
    shared.radiofrequencyarea_ts.feature_lifetime_begin,
    shared.radiofrequencyarea_ts.feature_lifetime_end,
    shared.radiofrequencyarea_ts.type_value,
    shared.radiofrequencyarea_ts.type_nilreason,
    shared.radiofrequencyarea_ts.anglescallop_value,
    shared.radiofrequencyarea_ts.anglescallop_nilreason,
    shared.radiofrequencyarea_ts.signaltype_value,
    shared.radiofrequencyarea_ts.signaltype_nilreason,
    service_radiocommunicationchannel_pt_axpzst.title,
    service_radiocommunicationchannel_pt_axpzst.nilreason[1],
    service_radiocommunicationchannel_pt_axpzst.href,
    navaids_points_specialnavigationstation_pt_zmbtja.title,
    navaids_points_specialnavigationstation_pt_zmbtja.nilreason[1],
    navaids_points_specialnavigationstation_pt_zmbtja.href,
    surveillance_precisionapproachradar_pt_zpuevu.title,
    surveillance_precisionapproachradar_pt_zpuevu.nilreason[1],
    surveillance_precisionapproachradar_pt_zpuevu.href,
    surveillance_secondarysurveillanceradar_pt_sdxxnx.title,
    surveillance_secondarysurveillanceradar_pt_sdxxnx.nilreason[1],
    surveillance_secondarysurveillanceradar_pt_sdxxnx.href
order by radiofrequencyarea.identifier, radiofrequencyarea_ts.sequence_number, radiofrequencyarea_ts.correction_number DESC;
-- RoadTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view']
create or replace view airport_heliport.road_view as
select distinct on (road.identifier,road_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.road.id,
    airport_heliport.road_ts.id as ts_id,
    airport_heliport.road_tsp.id as tsp_id,
    airport_heliport.road.identifier,
    airport_heliport.road_ts.interpretation,
    airport_heliport.road_ts.sequence_number,
    airport_heliport.road_ts.correction_number,
    airport_heliport.road_ts.valid_time_begin,
    airport_heliport.road_ts.valid_time_end,
    airport_heliport.road_ts.feature_lifetime_begin,
    airport_heliport.road_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.road_ts.designator_value as varchar), '(' || airport_heliport.road_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airport_heliport.road_ts.status_value as varchar), '(' || airport_heliport.road_ts.status_nilreason || ')') as status,
    coalesce(cast(airport_heliport.road_ts.type_value as varchar), '(' || airport_heliport.road_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.road_ts.abandoned_value as varchar), '(' || airport_heliport.road_ts.abandoned_nilreason || ')') as abandoned,
    coalesce(cast(airport_heliport_airportheliport_pt_oelpup.title as varchar), '(' || airport_heliport_airportheliport_pt_oelpup.nilreason[1] || ')') AS associatedairport,
    airport_heliport_airportheliport_pt_oelpup.href AS associatedairport_href,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_oubwde.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_oubwde.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_oubwde.href AS surfaceproperties_href,
    geometry_elevatedsurface_view_ctvska.geom AS geom,
    geometry_elevatedsurface_view_ctvska.elevation,
    geometry_elevatedsurface_view_ctvska.geoidUndulation,
    geometry_elevatedsurface_view_ctvska.verticalDatum,
    geometry_elevatedsurface_view_ctvska.verticalAccuracy,
    geometry_elevatedsurface_view_ctvska.horizontalAccuracy,
    jsonb_build_object('id', airport_heliport_aircraftstand_pt_rppgst.id,
    'title', coalesce(cast(airport_heliport_aircraftstand_pt_rppgst.title AS varchar), '(' || airport_heliport_aircraftstand_pt_rppgst.nilreason[1] || ')'),
    'href', airport_heliport_aircraftstand_pt_rppgst.href) AS accessiblestand,
    jsonb_agg(notes_note_view_oooyxa.*) AS road_annotation
from airport_heliport.road 
inner join master_join mj2 on airport_heliport.road.id = mj2.source_id
inner join airport_heliport.road_tsp on mj2.target_id = airport_heliport.road_tsp.id
inner join airport_heliport.road_ts on airport_heliport.road_tsp.roadtimeslice_id = airport_heliport.road_ts.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_oelpup on airport_heliport.road_ts.associatedairport_id = airport_heliport_airportheliport_pt_oelpup.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_oubwde on airport_heliport.road_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_oubwde.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_ctvska on airport_heliport.road_ts.surfaceextent_id = geometry_elevatedsurface_view_ctvska.id
left join master_join master_join_irjfbp on airport_heliport.road_ts.id = master_join_irjfbp.source_id
left join airport_heliport.aircraftstand_pt airport_heliport_aircraftstand_pt_rppgst on master_join_irjfbp.target_id = airport_heliport_aircraftstand_pt_rppgst.id
left join master_join master_join_dyueyw on airport_heliport.road_ts.id = master_join_dyueyw.source_id
left join notes.note_view notes_note_view_oooyxa on master_join_dyueyw.target_id = notes_note_view_oooyxa.id
where airport_heliport.road.feature_status = 'APPROVED'
  and airport_heliport.road_ts.feature_status = 'APPROVED'
group by
    airport_heliport.road.id,
    airport_heliport.road_ts.id,
    airport_heliport.road_tsp.id,
    airport_heliport.road.identifier,
    airport_heliport.road_ts.interpretation,
    airport_heliport.road_ts.sequence_number,
    airport_heliport.road_ts.correction_number,
    airport_heliport.road_ts.valid_time_begin,
    airport_heliport.road_ts.valid_time_end,
    airport_heliport.road_ts.feature_lifetime_begin,
    airport_heliport.road_ts.feature_lifetime_end,
    airport_heliport.road_ts.designator_value,
    airport_heliport.road_ts.designator_nilreason,
    airport_heliport.road_ts.status_value,
    airport_heliport.road_ts.status_nilreason,
    airport_heliport.road_ts.type_value,
    airport_heliport.road_ts.type_nilreason,
    airport_heliport.road_ts.abandoned_value,
    airport_heliport.road_ts.abandoned_nilreason,
    airport_heliport_airportheliport_pt_oelpup.title,
    airport_heliport_airportheliport_pt_oelpup.nilreason[1],
    airport_heliport_airportheliport_pt_oelpup.href,
    airport_heliport_surfacecharacteristics_pt_oubwde.title,
    airport_heliport_surfacecharacteristics_pt_oubwde.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_oubwde.href,
    geometry_elevatedsurface_view_ctvska.geom,
    geometry_elevatedsurface_view_ctvska.elevation,
    geometry_elevatedsurface_view_ctvska.geoidUndulation,
    geometry_elevatedsurface_view_ctvska.verticalDatum,
    geometry_elevatedsurface_view_ctvska.verticalAccuracy,
    geometry_elevatedsurface_view_ctvska.horizontalAccuracy
order by road.identifier, road_ts.sequence_number, road_ts.correction_number DESC;
-- RouteDMETimeSliceType
-- ['notes.note_view']
create or replace view routes.routedme_view as
select distinct on (routedme.identifier,routedme_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    routes.routedme.id,
    routes.routedme_ts.id as ts_id,
    routes.routedme_tsp.id as tsp_id,
    routes.routedme.identifier,
    routes.routedme_ts.interpretation,
    routes.routedme_ts.sequence_number,
    routes.routedme_ts.correction_number,
    routes.routedme_ts.valid_time_begin,
    routes.routedme_ts.valid_time_end,
    routes.routedme_ts.feature_lifetime_begin,
    routes.routedme_ts.feature_lifetime_end,
    coalesce(cast(routes.routedme_ts.criticaldme_value as varchar), '(' || routes.routedme_ts.criticaldme_nilreason || ')') as criticaldme,
    coalesce(cast(routes.routedme_ts.satisfactory_value as varchar), '(' || routes.routedme_ts.satisfactory_nilreason || ')') as satisfactory,
    coalesce(cast(navaids_points_dme_pt_bnvwyn.title as varchar), '(' || navaids_points_dme_pt_bnvwyn.nilreason[1] || ')') AS referenceddme,
    navaids_points_dme_pt_bnvwyn.href AS referenceddme_href,
    coalesce(cast(routes_routeportion_pt_wiszuz.title as varchar), '(' || routes_routeportion_pt_wiszuz.nilreason[1] || ')') AS applicablerouteportion,
    routes_routeportion_pt_wiszuz.href AS applicablerouteportion_href,
    jsonb_agg(notes_note_view_tykpvl.*) AS routedme_annotation
from routes.routedme 
inner join master_join mj2 on routes.routedme.id = mj2.source_id
inner join routes.routedme_tsp on mj2.target_id = routes.routedme_tsp.id
inner join routes.routedme_ts on routes.routedme_tsp.routedmetimeslice_id = routes.routedme_ts.id
left join navaids_points.dme_pt navaids_points_dme_pt_bnvwyn on routes.routedme_ts.referenceddme_id = navaids_points_dme_pt_bnvwyn.id
left join routes.routeportion_pt routes_routeportion_pt_wiszuz on routes.routedme_ts.applicablerouteportion_id = routes_routeportion_pt_wiszuz.id
left join master_join master_join_qqyfey on routes.routedme_ts.id = master_join_qqyfey.source_id
left join notes.note_view notes_note_view_tykpvl on master_join_qqyfey.target_id = notes_note_view_tykpvl.id
where routes.routedme.feature_status = 'APPROVED'
  and routes.routedme_ts.feature_status = 'APPROVED'
group by
    routes.routedme.id,
    routes.routedme_ts.id,
    routes.routedme_tsp.id,
    routes.routedme.identifier,
    routes.routedme_ts.interpretation,
    routes.routedme_ts.sequence_number,
    routes.routedme_ts.correction_number,
    routes.routedme_ts.valid_time_begin,
    routes.routedme_ts.valid_time_end,
    routes.routedme_ts.feature_lifetime_begin,
    routes.routedme_ts.feature_lifetime_end,
    routes.routedme_ts.criticaldme_value,
    routes.routedme_ts.criticaldme_nilreason,
    routes.routedme_ts.satisfactory_value,
    routes.routedme_ts.satisfactory_nilreason,
    navaids_points_dme_pt_bnvwyn.title,
    navaids_points_dme_pt_bnvwyn.nilreason[1],
    navaids_points_dme_pt_bnvwyn.href,
    routes_routeportion_pt_wiszuz.title,
    routes_routeportion_pt_wiszuz.nilreason[1],
    routes_routeportion_pt_wiszuz.href
order by routedme.identifier, routedme_ts.sequence_number, routedme_ts.correction_number DESC;
-- RouteSegmentTimeSliceType
-- ['routes.routeavailability_view', 'geometry.curve_view', 'notes.note_view']
create or replace view routes.routesegment_view as
select distinct on (routesegment.identifier,routesegment_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    routes.routesegment.id,
    routes.routesegment_ts.id as ts_id,
    routes.routesegment_tsp.id as tsp_id,
    routes.routesegment.identifier,
    routes.routesegment_ts.interpretation,
    routes.routesegment_ts.sequence_number,
    routes.routesegment_ts.correction_number,
    routes.routesegment_ts.valid_time_begin,
    routes.routesegment_ts.valid_time_end,
    routes.routesegment_ts.feature_lifetime_begin,
    routes.routesegment_ts.feature_lifetime_end,
    coalesce(cast(routes.routesegment_ts.level_value as varchar), '(' || routes.routesegment_ts.level_nilreason || ')') as level,
    coalesce(cast(routes.routesegment_ts.upperlimitreference_value as varchar), '(' || routes.routesegment_ts.upperlimitreference_nilreason || ')') as upperlimitreference,
    coalesce(cast(routes.routesegment_ts.lowerlimitreference_value as varchar), '(' || routes.routesegment_ts.lowerlimitreference_nilreason || ')') as lowerlimitreference,
    coalesce(cast(routes.routesegment_ts.pathtype_value as varchar), '(' || routes.routesegment_ts.pathtype_nilreason || ')') as pathtype,
    coalesce(cast(routes.routesegment_ts.truetrack_value as varchar), '(' || routes.routesegment_ts.truetrack_nilreason || ')') as truetrack,
    coalesce(cast(routes.routesegment_ts.magnetictrack_value as varchar), '(' || routes.routesegment_ts.magnetictrack_nilreason || ')') as magnetictrack,
    coalesce(cast(routes.routesegment_ts.reversetruetrack_value as varchar), '(' || routes.routesegment_ts.reversetruetrack_nilreason || ')') as reversetruetrack,
    coalesce(cast(routes.routesegment_ts.reversemagnetictrack_value as varchar), '(' || routes.routesegment_ts.reversemagnetictrack_nilreason || ')') as reversemagnetictrack,
    coalesce(cast(routes.routesegment_ts.turndirection_value as varchar), '(' || routes.routesegment_ts.turndirection_nilreason || ')') as turndirection,
    coalesce(cast(routes.routesegment_ts.signalgap_value as varchar), '(' || routes.routesegment_ts.signalgap_nilreason || ')') as signalgap,
    coalesce(cast(routes.routesegment_ts.minimumcrossingatendreference_value as varchar), '(' || routes.routesegment_ts.minimumcrossingatendreference_nilreason || ')') as minimumcrossingatendreference,
    coalesce(cast(routes.routesegment_ts.maximumcrossingatendreference_value as varchar), '(' || routes.routesegment_ts.maximumcrossingatendreference_nilreason || ')') as maximumcrossingatendreference,
    coalesce(cast(routes.routesegment_ts.navigationtype_value as varchar), '(' || routes.routesegment_ts.navigationtype_nilreason || ')') as navigationtype,
    coalesce(cast(routes.routesegment_ts.requirednavigationperformance_value as varchar), '(' || routes.routesegment_ts.requirednavigationperformance_nilreason || ')') as requirednavigationperformance,
    coalesce(cast(routes.routesegment_ts.designatorsuffix_value as varchar), '(' || routes.routesegment_ts.designatorsuffix_nilreason || ')') as designatorsuffix,
    coalesce(cast(routes.routesegment_ts.upperlimit_value as varchar) || ' ' || routes.routesegment_ts.upperlimit_uom, '(' || routes.routesegment_ts.upperlimit_nilreason || ')') as upperlimit,
    coalesce(cast(routes.routesegment_ts.lowerlimit_value as varchar) || ' ' || routes.routesegment_ts.lowerlimit_uom, '(' || routes.routesegment_ts.lowerlimit_nilreason || ')') as lowerlimit,
    coalesce(cast(routes.routesegment_ts.minimumobstacleclearancealtitude_value as varchar) || ' ' || routes.routesegment_ts.minimumobstacleclearancealtitude_uom, '(' || routes.routesegment_ts.minimumobstacleclearancealtitude_nilreason || ')') as minimumobstacleclearancealtitude,
    coalesce(cast(routes.routesegment_ts.length_value as varchar) || ' ' || routes.routesegment_ts.length_uom, '(' || routes.routesegment_ts.length_nilreason || ')') as length,
    coalesce(cast(routes.routesegment_ts.widthleft_value as varchar) || ' ' || routes.routesegment_ts.widthleft_uom, '(' || routes.routesegment_ts.widthleft_nilreason || ')') as widthleft,
    coalesce(cast(routes.routesegment_ts.widthright_value as varchar) || ' ' || routes.routesegment_ts.widthright_uom, '(' || routes.routesegment_ts.widthright_nilreason || ')') as widthright,
    coalesce(cast(routes.routesegment_ts.minimumenroutealtitude_value as varchar) || ' ' || routes.routesegment_ts.minimumenroutealtitude_uom, '(' || routes.routesegment_ts.minimumenroutealtitude_nilreason || ')') as minimumenroutealtitude,
    coalesce(cast(routes.routesegment_ts.minimumcrossingatend_value as varchar) || ' ' || routes.routesegment_ts.minimumcrossingatend_uom, '(' || routes.routesegment_ts.minimumcrossingatend_nilreason || ')') as minimumcrossingatend,
    coalesce(cast(routes.routesegment_ts.maximumcrossingatend_value as varchar) || ' ' || routes.routesegment_ts.maximumcrossingatend_uom, '(' || routes.routesegment_ts.maximumcrossingatend_nilreason || ')') as maximumcrossingatend,
    coalesce(cast(navaids_points_enroutesegmentpoint_pt_tjtmol.title as varchar), '(' || navaids_points_enroutesegmentpoint_pt_tjtmol.nilreason[1] || ')') AS start,
    navaids_points_enroutesegmentpoint_pt_tjtmol.href AS start_href,
    coalesce(cast(navaids_points_enroutesegmentpoint_pt_zjjiet.title as varchar), '(' || navaids_points_enroutesegmentpoint_pt_zjjiet.nilreason[1] || ')') AS end,
    navaids_points_enroutesegmentpoint_pt_zjjiet.href AS end_href,
    coalesce(cast(routes_route_pt_cgfjwe.title as varchar), '(' || routes_route_pt_cgfjwe.nilreason[1] || ')') AS routeformed,
    routes_route_pt_cgfjwe.href AS routeformed_href,
    coalesce(cast(shared_obstacleassessmentarea_pt_imoghg.title as varchar), '(' || shared_obstacleassessmentarea_pt_imoghg.nilreason[1] || ')') AS evaluationarea,
    shared_obstacleassessmentarea_pt_imoghg.href AS evaluationarea_href,
    geometry_curve_view_zwcohs.geom AS geom,
    jsonb_agg(routes_routeavailability_view_xyddek.id) AS availability,
    jsonb_agg(notes_note_view_ytztav.*) AS routesegment_annotation
from routes.routesegment 
inner join master_join mj2 on routes.routesegment.id = mj2.source_id
inner join routes.routesegment_tsp on mj2.target_id = routes.routesegment_tsp.id
inner join routes.routesegment_ts on routes.routesegment_tsp.routesegmenttimeslice_id = routes.routesegment_ts.id
left join navaids_points.enroutesegmentpoint_pt navaids_points_enroutesegmentpoint_pt_tjtmol on routes.routesegment_ts.start_id = navaids_points_enroutesegmentpoint_pt_tjtmol.id
left join routes.route_pt routes_route_pt_cgfjwe on routes.routesegment_ts.routeformed_id = routes_route_pt_cgfjwe.id
left join shared.obstacleassessmentarea_pt shared_obstacleassessmentarea_pt_imoghg on routes.routesegment_ts.evaluationarea_id = shared_obstacleassessmentarea_pt_imoghg.id
left join geometry.curve_view geometry_curve_view_zwcohs on routes.routesegment_ts.curveextent_id = geometry_curve_view_zwcohs.id
left join navaids_points.enroutesegmentpoint_pt navaids_points_enroutesegmentpoint_pt_zjjiet on routes.routesegment_ts.end_id = navaids_points_enroutesegmentpoint_pt_zjjiet.id
left join master_join master_join_vrreos on routes.routesegment_ts.id = master_join_vrreos.source_id
left join routes.routeavailability_view routes_routeavailability_view_xyddek on master_join_vrreos.target_id = routes_routeavailability_view_xyddek.id
left join master_join master_join_bdjfgm on routes.routesegment_ts.id = master_join_bdjfgm.source_id
left join notes.note_view notes_note_view_ytztav on master_join_bdjfgm.target_id = notes_note_view_ytztav.id
where routes.routesegment.feature_status = 'APPROVED'
  and routes.routesegment_ts.feature_status = 'APPROVED'
group by
    routes.routesegment.id,
    routes.routesegment_ts.id,
    routes.routesegment_tsp.id,
    routes.routesegment.identifier,
    routes.routesegment_ts.interpretation,
    routes.routesegment_ts.sequence_number,
    routes.routesegment_ts.correction_number,
    routes.routesegment_ts.valid_time_begin,
    routes.routesegment_ts.valid_time_end,
    routes.routesegment_ts.feature_lifetime_begin,
    routes.routesegment_ts.feature_lifetime_end,
    routes.routesegment_ts.level_value,
    routes.routesegment_ts.level_nilreason,
    routes.routesegment_ts.upperlimitreference_value,
    routes.routesegment_ts.upperlimitreference_nilreason,
    routes.routesegment_ts.lowerlimitreference_value,
    routes.routesegment_ts.lowerlimitreference_nilreason,
    routes.routesegment_ts.pathtype_value,
    routes.routesegment_ts.pathtype_nilreason,
    routes.routesegment_ts.truetrack_value,
    routes.routesegment_ts.truetrack_nilreason,
    routes.routesegment_ts.magnetictrack_value,
    routes.routesegment_ts.magnetictrack_nilreason,
    routes.routesegment_ts.reversetruetrack_value,
    routes.routesegment_ts.reversetruetrack_nilreason,
    routes.routesegment_ts.reversemagnetictrack_value,
    routes.routesegment_ts.reversemagnetictrack_nilreason,
    routes.routesegment_ts.turndirection_value,
    routes.routesegment_ts.turndirection_nilreason,
    routes.routesegment_ts.signalgap_value,
    routes.routesegment_ts.signalgap_nilreason,
    routes.routesegment_ts.minimumcrossingatendreference_value,
    routes.routesegment_ts.minimumcrossingatendreference_nilreason,
    routes.routesegment_ts.maximumcrossingatendreference_value,
    routes.routesegment_ts.maximumcrossingatendreference_nilreason,
    routes.routesegment_ts.navigationtype_value,
    routes.routesegment_ts.navigationtype_nilreason,
    routes.routesegment_ts.requirednavigationperformance_value,
    routes.routesegment_ts.requirednavigationperformance_nilreason,
    routes.routesegment_ts.designatorsuffix_value,
    routes.routesegment_ts.designatorsuffix_nilreason,
    routes.routesegment_ts.upperlimit_value,
    routes.routesegment_ts.upperlimit_uom,
    routes.routesegment_ts.upperlimit_nilreason,
    routes.routesegment_ts.lowerlimit_value,
    routes.routesegment_ts.lowerlimit_uom,
    routes.routesegment_ts.lowerlimit_nilreason,
    routes.routesegment_ts.minimumobstacleclearancealtitude_value,
    routes.routesegment_ts.minimumobstacleclearancealtitude_uom,
    routes.routesegment_ts.minimumobstacleclearancealtitude_nilreason,
    routes.routesegment_ts.length_value,
    routes.routesegment_ts.length_uom,
    routes.routesegment_ts.length_nilreason,
    routes.routesegment_ts.widthleft_value,
    routes.routesegment_ts.widthleft_uom,
    routes.routesegment_ts.widthleft_nilreason,
    routes.routesegment_ts.widthright_value,
    routes.routesegment_ts.widthright_uom,
    routes.routesegment_ts.widthright_nilreason,
    routes.routesegment_ts.minimumenroutealtitude_value,
    routes.routesegment_ts.minimumenroutealtitude_uom,
    routes.routesegment_ts.minimumenroutealtitude_nilreason,
    routes.routesegment_ts.minimumcrossingatend_value,
    routes.routesegment_ts.minimumcrossingatend_uom,
    routes.routesegment_ts.minimumcrossingatend_nilreason,
    routes.routesegment_ts.maximumcrossingatend_value,
    routes.routesegment_ts.maximumcrossingatend_uom,
    routes.routesegment_ts.maximumcrossingatend_nilreason,
    navaids_points_enroutesegmentpoint_pt_tjtmol.title,
    navaids_points_enroutesegmentpoint_pt_tjtmol.nilreason[1],
    navaids_points_enroutesegmentpoint_pt_tjtmol.href,
    routes_route_pt_cgfjwe.title,
    routes_route_pt_cgfjwe.nilreason[1],
    routes_route_pt_cgfjwe.href,
    shared_obstacleassessmentarea_pt_imoghg.title,
    shared_obstacleassessmentarea_pt_imoghg.nilreason[1],
    shared_obstacleassessmentarea_pt_imoghg.href,
    geometry_curve_view_zwcohs.geom,
    navaids_points_enroutesegmentpoint_pt_zjjiet.title,
    navaids_points_enroutesegmentpoint_pt_zjjiet.nilreason[1],
    navaids_points_enroutesegmentpoint_pt_zjjiet.href
order by routesegment.identifier, routesegment_ts.sequence_number, routesegment_ts.correction_number DESC;
-- RouteTimeSliceType
-- ['notes.note_view']
create or replace view routes.route_view as
select distinct on (route.identifier,route_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    routes.route.id,
    routes.route_ts.id as ts_id,
    routes.route_tsp.id as tsp_id,
    routes.route.identifier,
    routes.route_ts.interpretation,
    routes.route_ts.sequence_number,
    routes.route_ts.correction_number,
    routes.route_ts.valid_time_begin,
    routes.route_ts.valid_time_end,
    routes.route_ts.feature_lifetime_begin,
    routes.route_ts.feature_lifetime_end,
    coalesce(cast(routes.route_ts.designatorprefix_value as varchar), '(' || routes.route_ts.designatorprefix_nilreason || ')') as designatorprefix,
    coalesce(cast(routes.route_ts.designatorsecondletter_value as varchar), '(' || routes.route_ts.designatorsecondletter_nilreason || ')') as designatorsecondletter,
    coalesce(cast(routes.route_ts.designatornumber_value as varchar), '(' || routes.route_ts.designatornumber_nilreason || ')') as designatornumber,
    coalesce(cast(routes.route_ts.multipleidentifier_value as varchar), '(' || routes.route_ts.multipleidentifier_nilreason || ')') as multipleidentifier,
    coalesce(cast(routes.route_ts.locationdesignator_value as varchar), '(' || routes.route_ts.locationdesignator_nilreason || ')') as locationdesignator,
    coalesce(cast(routes.route_ts.name_value as varchar), '(' || routes.route_ts.name_nilreason || ')') as name,
    coalesce(cast(routes.route_ts.type_value as varchar), '(' || routes.route_ts.type_nilreason || ')') as type,
    coalesce(cast(routes.route_ts.flightrule_value as varchar), '(' || routes.route_ts.flightrule_nilreason || ')') as flightrule,
    coalesce(cast(routes.route_ts.internationaluse_value as varchar), '(' || routes.route_ts.internationaluse_nilreason || ')') as internationaluse,
    coalesce(cast(routes.route_ts.militaryuse_value as varchar), '(' || routes.route_ts.militaryuse_nilreason || ')') as militaryuse,
    coalesce(cast(routes.route_ts.militarytrainingtype_value as varchar), '(' || routes.route_ts.militarytrainingtype_nilreason || ')') as militarytrainingtype,
    coalesce(cast(organisation_organisationauthority_pt_ypfgko.title as varchar), '(' || organisation_organisationauthority_pt_ypfgko.nilreason[1] || ')') AS userorganisation,
    organisation_organisationauthority_pt_ypfgko.href AS userorganisation_href,
    jsonb_agg(notes_note_view_tvdfka.*) AS route_annotation
from routes.route 
inner join master_join mj2 on routes.route.id = mj2.source_id
inner join routes.route_tsp on mj2.target_id = routes.route_tsp.id
inner join routes.route_ts on routes.route_tsp.routetimeslice_id = routes.route_ts.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_ypfgko on routes.route_ts.userorganisation_id = organisation_organisationauthority_pt_ypfgko.id
left join master_join master_join_ycqdej on routes.route_ts.id = master_join_ycqdej.source_id
left join notes.note_view notes_note_view_tvdfka on master_join_ycqdej.target_id = notes_note_view_tvdfka.id
where routes.route.feature_status = 'APPROVED'
  and routes.route_ts.feature_status = 'APPROVED'
group by
    routes.route.id,
    routes.route_ts.id,
    routes.route_tsp.id,
    routes.route.identifier,
    routes.route_ts.interpretation,
    routes.route_ts.sequence_number,
    routes.route_ts.correction_number,
    routes.route_ts.valid_time_begin,
    routes.route_ts.valid_time_end,
    routes.route_ts.feature_lifetime_begin,
    routes.route_ts.feature_lifetime_end,
    routes.route_ts.designatorprefix_value,
    routes.route_ts.designatorprefix_nilreason,
    routes.route_ts.designatorsecondletter_value,
    routes.route_ts.designatorsecondletter_nilreason,
    routes.route_ts.designatornumber_value,
    routes.route_ts.designatornumber_nilreason,
    routes.route_ts.multipleidentifier_value,
    routes.route_ts.multipleidentifier_nilreason,
    routes.route_ts.locationdesignator_value,
    routes.route_ts.locationdesignator_nilreason,
    routes.route_ts.name_value,
    routes.route_ts.name_nilreason,
    routes.route_ts.type_value,
    routes.route_ts.type_nilreason,
    routes.route_ts.flightrule_value,
    routes.route_ts.flightrule_nilreason,
    routes.route_ts.internationaluse_value,
    routes.route_ts.internationaluse_nilreason,
    routes.route_ts.militaryuse_value,
    routes.route_ts.militaryuse_nilreason,
    routes.route_ts.militarytrainingtype_value,
    routes.route_ts.militarytrainingtype_nilreason,
    organisation_organisationauthority_pt_ypfgko.title,
    organisation_organisationauthority_pt_ypfgko.nilreason[1],
    organisation_organisationauthority_pt_ypfgko.href
order by route.identifier, route_ts.sequence_number, route_ts.correction_number DESC;
-- RulesProceduresTimeSliceType
-- ['notes.note_view']
create or replace view rules_procedures.rulesprocedures_view as
select distinct on (rulesprocedures.identifier,rulesprocedures_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    rules_procedures.rulesprocedures.id,
    rules_procedures.rulesprocedures_ts.id as ts_id,
    rules_procedures.rulesprocedures_tsp.id as tsp_id,
    rules_procedures.rulesprocedures.identifier,
    rules_procedures.rulesprocedures_ts.interpretation,
    rules_procedures.rulesprocedures_ts.sequence_number,
    rules_procedures.rulesprocedures_ts.correction_number,
    rules_procedures.rulesprocedures_ts.valid_time_begin,
    rules_procedures.rulesprocedures_ts.valid_time_end,
    rules_procedures.rulesprocedures_ts.feature_lifetime_begin,
    rules_procedures.rulesprocedures_ts.feature_lifetime_end,
    coalesce(cast(rules_procedures.rulesprocedures_ts.category_value as varchar), '(' || rules_procedures.rulesprocedures_ts.category_nilreason || ')') as category,
    coalesce(cast(rules_procedures.rulesprocedures_ts.title_value as varchar), '(' || rules_procedures.rulesprocedures_ts.title_nilreason || ')') as title,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_uiihyg.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_uiihyg.title AS varchar), '(' || airport_heliport_airportheliport_pt_uiihyg.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_uiihyg.href) AS affectedlocation,
    jsonb_build_object('id', airspace_airspace_pt_iyplcf.id,
    'title', coalesce(cast(airspace_airspace_pt_iyplcf.title AS varchar), '(' || airspace_airspace_pt_iyplcf.nilreason[1] || ')'),
    'href', airspace_airspace_pt_iyplcf.href) AS affectedarea,
    jsonb_agg(notes_note_view_casrfo.*) AS rulesprocedures_annotation
from rules_procedures.rulesprocedures 
inner join master_join mj2 on rules_procedures.rulesprocedures.id = mj2.source_id
inner join rules_procedures.rulesprocedures_tsp on mj2.target_id = rules_procedures.rulesprocedures_tsp.id
inner join rules_procedures.rulesprocedures_ts on rules_procedures.rulesprocedures_tsp.rulesprocedurestimeslice_id = rules_procedures.rulesprocedures_ts.id
left join master_join master_join_hxcbhx on rules_procedures.rulesprocedures_ts.id = master_join_hxcbhx.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_uiihyg on master_join_hxcbhx.target_id = airport_heliport_airportheliport_pt_uiihyg.id
left join master_join master_join_jphkwu on rules_procedures.rulesprocedures_ts.id = master_join_jphkwu.source_id
left join airspace.airspace_pt airspace_airspace_pt_iyplcf on master_join_jphkwu.target_id = airspace_airspace_pt_iyplcf.id
left join master_join master_join_afsvvn on rules_procedures.rulesprocedures_ts.id = master_join_afsvvn.source_id
left join notes.note_view notes_note_view_casrfo on master_join_afsvvn.target_id = notes_note_view_casrfo.id
where rules_procedures.rulesprocedures.feature_status = 'APPROVED'
  and rules_procedures.rulesprocedures_ts.feature_status = 'APPROVED'
group by
    rules_procedures.rulesprocedures.id,
    rules_procedures.rulesprocedures_ts.id,
    rules_procedures.rulesprocedures_tsp.id,
    rules_procedures.rulesprocedures.identifier,
    rules_procedures.rulesprocedures_ts.interpretation,
    rules_procedures.rulesprocedures_ts.sequence_number,
    rules_procedures.rulesprocedures_ts.correction_number,
    rules_procedures.rulesprocedures_ts.valid_time_begin,
    rules_procedures.rulesprocedures_ts.valid_time_end,
    rules_procedures.rulesprocedures_ts.feature_lifetime_begin,
    rules_procedures.rulesprocedures_ts.feature_lifetime_end,
    rules_procedures.rulesprocedures_ts.category_value,
    rules_procedures.rulesprocedures_ts.category_nilreason,
    rules_procedures.rulesprocedures_ts.title_value,
    rules_procedures.rulesprocedures_ts.title_nilreason
order by rulesprocedures.identifier, rulesprocedures_ts.sequence_number, rulesprocedures_ts.correction_number DESC;
-- RunwayBlastPadTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view']
create or replace view airport_heliport.runwayblastpad_view as
select distinct on (runwayblastpad.identifier,runwayblastpad_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.runwayblastpad.id,
    airport_heliport.runwayblastpad_ts.id as ts_id,
    airport_heliport.runwayblastpad_tsp.id as tsp_id,
    airport_heliport.runwayblastpad.identifier,
    airport_heliport.runwayblastpad_ts.interpretation,
    airport_heliport.runwayblastpad_ts.sequence_number,
    airport_heliport.runwayblastpad_ts.correction_number,
    airport_heliport.runwayblastpad_ts.valid_time_begin,
    airport_heliport.runwayblastpad_ts.valid_time_end,
    airport_heliport.runwayblastpad_ts.feature_lifetime_begin,
    airport_heliport.runwayblastpad_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.runwayblastpad_ts.status_value as varchar), '(' || airport_heliport.runwayblastpad_ts.status_nilreason || ')') as status,
    coalesce(cast(airport_heliport.runwayblastpad_ts.length_value as varchar) || ' ' || airport_heliport.runwayblastpad_ts.length_uom, '(' || airport_heliport.runwayblastpad_ts.length_nilreason || ')') as length,
    coalesce(cast(airport_heliport_runwaydirection_pt_frefyp.title as varchar), '(' || airport_heliport_runwaydirection_pt_frefyp.nilreason[1] || ')') AS usedrunwaydirection,
    airport_heliport_runwaydirection_pt_frefyp.href AS usedrunwaydirection_href,
    geometry_elevatedsurface_view_amgtdk.geom AS geom,
    geometry_elevatedsurface_view_amgtdk.elevation,
    geometry_elevatedsurface_view_amgtdk.geoidUndulation,
    geometry_elevatedsurface_view_amgtdk.verticalDatum,
    geometry_elevatedsurface_view_amgtdk.verticalAccuracy,
    geometry_elevatedsurface_view_amgtdk.horizontalAccuracy,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_fzdwot.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_fzdwot.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_fzdwot.href AS surfaceproperties_href,
    jsonb_agg(notes_note_view_uvecnz.*) AS runwayblastpad_annotation
from airport_heliport.runwayblastpad 
inner join master_join mj2 on airport_heliport.runwayblastpad.id = mj2.source_id
inner join airport_heliport.runwayblastpad_tsp on mj2.target_id = airport_heliport.runwayblastpad_tsp.id
inner join airport_heliport.runwayblastpad_ts on airport_heliport.runwayblastpad_tsp.runwayblastpadtimeslice_id = airport_heliport.runwayblastpad_ts.id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_frefyp on airport_heliport.runwayblastpad_ts.usedrunwaydirection_id = airport_heliport_runwaydirection_pt_frefyp.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_amgtdk on airport_heliport.runwayblastpad_ts.extent_id = geometry_elevatedsurface_view_amgtdk.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_fzdwot on airport_heliport.runwayblastpad_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_fzdwot.id
left join master_join master_join_ibdlqj on airport_heliport.runwayblastpad_ts.id = master_join_ibdlqj.source_id
left join notes.note_view notes_note_view_uvecnz on master_join_ibdlqj.target_id = notes_note_view_uvecnz.id
where airport_heliport.runwayblastpad.feature_status = 'APPROVED'
  and airport_heliport.runwayblastpad_ts.feature_status = 'APPROVED'
group by
    airport_heliport.runwayblastpad.id,
    airport_heliport.runwayblastpad_ts.id,
    airport_heliport.runwayblastpad_tsp.id,
    airport_heliport.runwayblastpad.identifier,
    airport_heliport.runwayblastpad_ts.interpretation,
    airport_heliport.runwayblastpad_ts.sequence_number,
    airport_heliport.runwayblastpad_ts.correction_number,
    airport_heliport.runwayblastpad_ts.valid_time_begin,
    airport_heliport.runwayblastpad_ts.valid_time_end,
    airport_heliport.runwayblastpad_ts.feature_lifetime_begin,
    airport_heliport.runwayblastpad_ts.feature_lifetime_end,
    airport_heliport.runwayblastpad_ts.status_value,
    airport_heliport.runwayblastpad_ts.status_nilreason,
    airport_heliport.runwayblastpad_ts.length_value,
    airport_heliport.runwayblastpad_ts.length_uom,
    airport_heliport.runwayblastpad_ts.length_nilreason,
    airport_heliport_runwaydirection_pt_frefyp.title,
    airport_heliport_runwaydirection_pt_frefyp.nilreason[1],
    airport_heliport_runwaydirection_pt_frefyp.href,
    geometry_elevatedsurface_view_amgtdk.geom,
    geometry_elevatedsurface_view_amgtdk.elevation,
    geometry_elevatedsurface_view_amgtdk.geoidUndulation,
    geometry_elevatedsurface_view_amgtdk.verticalDatum,
    geometry_elevatedsurface_view_amgtdk.verticalAccuracy,
    geometry_elevatedsurface_view_amgtdk.horizontalAccuracy,
    airport_heliport_surfacecharacteristics_pt_fzdwot.title,
    airport_heliport_surfacecharacteristics_pt_fzdwot.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_fzdwot.href
order by runwayblastpad.identifier, runwayblastpad_ts.sequence_number, runwayblastpad_ts.correction_number DESC;
-- RunwayCentrelinePointTimeSliceType
-- ['airport_heliport.runwaydeclareddistance_view', 'airport_heliport.navaidequipmentdistance_view', 'notes.note_view', 'geometry.elevatedpoint_view']
create or replace view airport_heliport.runwaycentrelinepoint_view as
select distinct on (runwaycentrelinepoint.identifier,runwaycentrelinepoint_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.runwaycentrelinepoint.id,
    airport_heliport.runwaycentrelinepoint_ts.id as ts_id,
    airport_heliport.runwaycentrelinepoint_tsp.id as tsp_id,
    airport_heliport.runwaycentrelinepoint.identifier,
    airport_heliport.runwaycentrelinepoint_ts.interpretation,
    airport_heliport.runwaycentrelinepoint_ts.sequence_number,
    airport_heliport.runwaycentrelinepoint_ts.correction_number,
    airport_heliport.runwaycentrelinepoint_ts.valid_time_begin,
    airport_heliport.runwaycentrelinepoint_ts.valid_time_end,
    airport_heliport.runwaycentrelinepoint_ts.feature_lifetime_begin,
    airport_heliport.runwaycentrelinepoint_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.runwaycentrelinepoint_ts.role_value as varchar), '(' || airport_heliport.runwaycentrelinepoint_ts.role_nilreason || ')') as role,
    coalesce(cast(airport_heliport.runwaycentrelinepoint_ts.designator_value as varchar), '(' || airport_heliport.runwaycentrelinepoint_ts.designator_nilreason || ')') as designator,
    geometry_elevatedpoint_view_scosqh.geom AS geom,
    ST_X(geometry_elevatedpoint_view_scosqh.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_scosqh.geom) AS latitude,
    geometry_elevatedpoint_view_scosqh.elevation,
    geometry_elevatedpoint_view_scosqh.geoidUndulation,
    geometry_elevatedpoint_view_scosqh.verticalDatum,
    geometry_elevatedpoint_view_scosqh.verticalAccuracy,
    geometry_elevatedpoint_view_scosqh.horizontalAccuracy,
    coalesce(cast(airport_heliport_runwaydirection_pt_pvmata.title as varchar), '(' || airport_heliport_runwaydirection_pt_pvmata.nilreason[1] || ')') AS onrunway,
    airport_heliport_runwaydirection_pt_pvmata.href AS onrunway_href,
    jsonb_agg(airport_heliport_runwaydeclareddistance_view_mvracc.id) AS associateddeclareddistance,
    jsonb_agg(airport_heliport_navaidequipmentdistance_view_rtlwgc.id) AS navaidequipment,
    jsonb_agg(notes_note_view_hjcyek.*) AS runwaycentrelinepoint_annotation
from airport_heliport.runwaycentrelinepoint 
inner join master_join mj2 on airport_heliport.runwaycentrelinepoint.id = mj2.source_id
inner join airport_heliport.runwaycentrelinepoint_tsp on mj2.target_id = airport_heliport.runwaycentrelinepoint_tsp.id
inner join airport_heliport.runwaycentrelinepoint_ts on airport_heliport.runwaycentrelinepoint_tsp.runwaycentrelinepointtimeslice_id = airport_heliport.runwaycentrelinepoint_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_scosqh on airport_heliport.runwaycentrelinepoint_ts.location_id = geometry_elevatedpoint_view_scosqh.id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_pvmata on airport_heliport.runwaycentrelinepoint_ts.onrunway_id = airport_heliport_runwaydirection_pt_pvmata.id
left join master_join master_join_gfuzgy on airport_heliport.runwaycentrelinepoint_ts.id = master_join_gfuzgy.source_id
left join airport_heliport.runwaydeclareddistance_view airport_heliport_runwaydeclareddistance_view_mvracc on master_join_gfuzgy.target_id = airport_heliport_runwaydeclareddistance_view_mvracc.id
left join master_join master_join_lzijrb on airport_heliport.runwaycentrelinepoint_ts.id = master_join_lzijrb.source_id
left join airport_heliport.navaidequipmentdistance_view airport_heliport_navaidequipmentdistance_view_rtlwgc on master_join_lzijrb.target_id = airport_heliport_navaidequipmentdistance_view_rtlwgc.id
left join master_join master_join_hjejhf on airport_heliport.runwaycentrelinepoint_ts.id = master_join_hjejhf.source_id
left join notes.note_view notes_note_view_hjcyek on master_join_hjejhf.target_id = notes_note_view_hjcyek.id
where airport_heliport.runwaycentrelinepoint.feature_status = 'APPROVED'
  and airport_heliport.runwaycentrelinepoint_ts.feature_status = 'APPROVED'
group by
    airport_heliport.runwaycentrelinepoint.id,
    airport_heliport.runwaycentrelinepoint_ts.id,
    airport_heliport.runwaycentrelinepoint_tsp.id,
    airport_heliport.runwaycentrelinepoint.identifier,
    airport_heliport.runwaycentrelinepoint_ts.interpretation,
    airport_heliport.runwaycentrelinepoint_ts.sequence_number,
    airport_heliport.runwaycentrelinepoint_ts.correction_number,
    airport_heliport.runwaycentrelinepoint_ts.valid_time_begin,
    airport_heliport.runwaycentrelinepoint_ts.valid_time_end,
    airport_heliport.runwaycentrelinepoint_ts.feature_lifetime_begin,
    airport_heliport.runwaycentrelinepoint_ts.feature_lifetime_end,
    airport_heliport.runwaycentrelinepoint_ts.role_value,
    airport_heliport.runwaycentrelinepoint_ts.role_nilreason,
    airport_heliport.runwaycentrelinepoint_ts.designator_value,
    airport_heliport.runwaycentrelinepoint_ts.designator_nilreason,
    geometry_elevatedpoint_view_scosqh.geom,
    geometry_elevatedpoint_view_scosqh.elevation,
    geometry_elevatedpoint_view_scosqh.geoidUndulation,
    geometry_elevatedpoint_view_scosqh.verticalDatum,
    geometry_elevatedpoint_view_scosqh.verticalAccuracy,
    geometry_elevatedpoint_view_scosqh.horizontalAccuracy,
    airport_heliport_runwaydirection_pt_pvmata.title,
    airport_heliport_runwaydirection_pt_pvmata.nilreason[1],
    airport_heliport_runwaydirection_pt_pvmata.href
order by runwaycentrelinepoint.identifier, runwaycentrelinepoint_ts.sequence_number, runwaycentrelinepoint_ts.correction_number DESC;
-- RunwayDirectionLightSystemTimeSliceType
-- ['shared.lightelement_view', 'airport_heliport.groundlightingavailability_view', 'notes.note_view']
create or replace view airport_heliport.runwaydirectionlightsystem_view as
select distinct on (runwaydirectionlightsystem.identifier,runwaydirectionlightsystem_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.runwaydirectionlightsystem.id,
    airport_heliport.runwaydirectionlightsystem_ts.id as ts_id,
    airport_heliport.runwaydirectionlightsystem_tsp.id as tsp_id,
    airport_heliport.runwaydirectionlightsystem.identifier,
    airport_heliport.runwaydirectionlightsystem_ts.interpretation,
    airport_heliport.runwaydirectionlightsystem_ts.sequence_number,
    airport_heliport.runwaydirectionlightsystem_ts.correction_number,
    airport_heliport.runwaydirectionlightsystem_ts.valid_time_begin,
    airport_heliport.runwaydirectionlightsystem_ts.valid_time_end,
    airport_heliport.runwaydirectionlightsystem_ts.feature_lifetime_begin,
    airport_heliport.runwaydirectionlightsystem_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.runwaydirectionlightsystem_ts.emergencylighting_value as varchar), '(' || airport_heliport.runwaydirectionlightsystem_ts.emergencylighting_nilreason || ')') as emergencylighting,
    coalesce(cast(airport_heliport.runwaydirectionlightsystem_ts.intensitylevel_value as varchar), '(' || airport_heliport.runwaydirectionlightsystem_ts.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(airport_heliport.runwaydirectionlightsystem_ts.colour_value as varchar), '(' || airport_heliport.runwaydirectionlightsystem_ts.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport.runwaydirectionlightsystem_ts.position_value as varchar), '(' || airport_heliport.runwaydirectionlightsystem_ts.position_nilreason || ')') as position,
    coalesce(cast(airport_heliport_runwaydirection_pt_qdhlgb.title as varchar), '(' || airport_heliport_runwaydirection_pt_qdhlgb.nilreason[1] || ')') AS associatedrunwaydirection,
    airport_heliport_runwaydirection_pt_qdhlgb.href AS associatedrunwaydirection_href,
    jsonb_agg(shared_lightelement_view_ahwfhp.id) AS element,
    jsonb_agg(airport_heliport_groundlightingavailability_view_mikpvw.id) AS availability,
    jsonb_agg(notes_note_view_ttecks.*) AS runwaydirectionlightsystem_annotation
from airport_heliport.runwaydirectionlightsystem 
inner join master_join mj2 on airport_heliport.runwaydirectionlightsystem.id = mj2.source_id
inner join airport_heliport.runwaydirectionlightsystem_tsp on mj2.target_id = airport_heliport.runwaydirectionlightsystem_tsp.id
inner join airport_heliport.runwaydirectionlightsystem_ts on airport_heliport.runwaydirectionlightsystem_tsp.runwaydirectionlightsystemtimeslice_id = airport_heliport.runwaydirectionlightsystem_ts.id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_qdhlgb on airport_heliport.runwaydirectionlightsystem_ts.associatedrunwaydirection_id = airport_heliport_runwaydirection_pt_qdhlgb.id
left join master_join master_join_mqmmns on airport_heliport.runwaydirectionlightsystem_ts.id = master_join_mqmmns.source_id
left join shared.lightelement_view shared_lightelement_view_ahwfhp on master_join_mqmmns.target_id = shared_lightelement_view_ahwfhp.id
left join master_join master_join_vnkeia on airport_heliport.runwaydirectionlightsystem_ts.id = master_join_vnkeia.source_id
left join airport_heliport.groundlightingavailability_view airport_heliport_groundlightingavailability_view_mikpvw on master_join_vnkeia.target_id = airport_heliport_groundlightingavailability_view_mikpvw.id
left join master_join master_join_jexoab on airport_heliport.runwaydirectionlightsystem_ts.id = master_join_jexoab.source_id
left join notes.note_view notes_note_view_ttecks on master_join_jexoab.target_id = notes_note_view_ttecks.id
where airport_heliport.runwaydirectionlightsystem.feature_status = 'APPROVED'
  and airport_heliport.runwaydirectionlightsystem_ts.feature_status = 'APPROVED'
group by
    airport_heliport.runwaydirectionlightsystem.id,
    airport_heliport.runwaydirectionlightsystem_ts.id,
    airport_heliport.runwaydirectionlightsystem_tsp.id,
    airport_heliport.runwaydirectionlightsystem.identifier,
    airport_heliport.runwaydirectionlightsystem_ts.interpretation,
    airport_heliport.runwaydirectionlightsystem_ts.sequence_number,
    airport_heliport.runwaydirectionlightsystem_ts.correction_number,
    airport_heliport.runwaydirectionlightsystem_ts.valid_time_begin,
    airport_heliport.runwaydirectionlightsystem_ts.valid_time_end,
    airport_heliport.runwaydirectionlightsystem_ts.feature_lifetime_begin,
    airport_heliport.runwaydirectionlightsystem_ts.feature_lifetime_end,
    airport_heliport.runwaydirectionlightsystem_ts.emergencylighting_value,
    airport_heliport.runwaydirectionlightsystem_ts.emergencylighting_nilreason,
    airport_heliport.runwaydirectionlightsystem_ts.intensitylevel_value,
    airport_heliport.runwaydirectionlightsystem_ts.intensitylevel_nilreason,
    airport_heliport.runwaydirectionlightsystem_ts.colour_value,
    airport_heliport.runwaydirectionlightsystem_ts.colour_nilreason,
    airport_heliport.runwaydirectionlightsystem_ts.position_value,
    airport_heliport.runwaydirectionlightsystem_ts.position_nilreason,
    airport_heliport_runwaydirection_pt_qdhlgb.title,
    airport_heliport_runwaydirection_pt_qdhlgb.nilreason[1],
    airport_heliport_runwaydirection_pt_qdhlgb.href
order by runwaydirectionlightsystem.identifier, runwaydirectionlightsystem_ts.sequence_number, runwaydirectionlightsystem_ts.correction_number DESC;
-- RunwayDirectionTimeSliceType
-- ['airport_heliport.manoeuvringareaavailability_view', 'notes.note_view']
create or replace view airport_heliport.runwaydirection_view as
select distinct on (runwaydirection.identifier,runwaydirection_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.runwaydirection.id,
    airport_heliport.runwaydirection_ts.id as ts_id,
    airport_heliport.runwaydirection_tsp.id as tsp_id,
    airport_heliport.runwaydirection.identifier,
    airport_heliport.runwaydirection_ts.interpretation,
    airport_heliport.runwaydirection_ts.sequence_number,
    airport_heliport.runwaydirection_ts.correction_number,
    airport_heliport.runwaydirection_ts.valid_time_begin,
    airport_heliport.runwaydirection_ts.valid_time_end,
    airport_heliport.runwaydirection_ts.feature_lifetime_begin,
    airport_heliport.runwaydirection_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.runwaydirection_ts.designator_value as varchar), '(' || airport_heliport.runwaydirection_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airport_heliport.runwaydirection_ts.truebearing_value as varchar), '(' || airport_heliport.runwaydirection_ts.truebearing_nilreason || ')') as truebearing,
    coalesce(cast(airport_heliport.runwaydirection_ts.truebearingaccuracy_value as varchar), '(' || airport_heliport.runwaydirection_ts.truebearingaccuracy_nilreason || ')') as truebearingaccuracy,
    coalesce(cast(airport_heliport.runwaydirection_ts.magneticbearing_value as varchar), '(' || airport_heliport.runwaydirection_ts.magneticbearing_nilreason || ')') as magneticbearing,
    coalesce(cast(airport_heliport.runwaydirection_ts.patternvfr_value as varchar), '(' || airport_heliport.runwaydirection_ts.patternvfr_nilreason || ')') as patternvfr,
    coalesce(cast(airport_heliport.runwaydirection_ts.slopetdz_value as varchar), '(' || airport_heliport.runwaydirection_ts.slopetdz_nilreason || ')') as slopetdz,
    coalesce(cast(airport_heliport.runwaydirection_ts.approachmarkingtype_value as varchar), '(' || airport_heliport.runwaydirection_ts.approachmarkingtype_nilreason || ')') as approachmarkingtype,
    coalesce(cast(airport_heliport.runwaydirection_ts.approachmarkingcondition_value as varchar), '(' || airport_heliport.runwaydirection_ts.approachmarkingcondition_nilreason || ')') as approachmarkingcondition,
    coalesce(cast(airport_heliport.runwaydirection_ts.classlightingjar_value as varchar), '(' || airport_heliport.runwaydirection_ts.classlightingjar_nilreason || ')') as classlightingjar,
    coalesce(cast(airport_heliport.runwaydirection_ts.precisionapproachguidance_value as varchar), '(' || airport_heliport.runwaydirection_ts.precisionapproachguidance_nilreason || ')') as precisionapproachguidance,
    coalesce(cast(airport_heliport.runwaydirection_ts.elevationtdz_value as varchar) || ' ' || airport_heliport.runwaydirection_ts.elevationtdz_uom, '(' || airport_heliport.runwaydirection_ts.elevationtdz_nilreason || ')') as elevationtdz,
    coalesce(cast(airport_heliport.runwaydirection_ts.elevationtdzaccuracy_value as varchar) || ' ' || airport_heliport.runwaydirection_ts.elevationtdzaccuracy_uom, '(' || airport_heliport.runwaydirection_ts.elevationtdzaccuracy_nilreason || ')') as elevationtdzaccuracy,
    coalesce(cast(airport_heliport_runway_pt_alxsro.title as varchar), '(' || airport_heliport_runway_pt_alxsro.nilreason[1] || ')') AS usedrunway,
    airport_heliport_runway_pt_alxsro.href AS usedrunway_href,
    coalesce(cast(airport_heliport_runwayelement_pt_nliehu.title as varchar), '(' || airport_heliport_runwayelement_pt_nliehu.nilreason[1] || ')') AS startingelement,
    airport_heliport_runwayelement_pt_nliehu.href AS startingelement_href,
    jsonb_agg(notes_note_view_avswkh.*) AS runwaydirection_annotation,
    jsonb_agg(airport_heliport_manoeuvringareaavailability_view_bbgvsq.id) AS availability
from airport_heliport.runwaydirection 
inner join master_join mj2 on airport_heliport.runwaydirection.id = mj2.source_id
inner join airport_heliport.runwaydirection_tsp on mj2.target_id = airport_heliport.runwaydirection_tsp.id
inner join airport_heliport.runwaydirection_ts on airport_heliport.runwaydirection_tsp.runwaydirectiontimeslice_id = airport_heliport.runwaydirection_ts.id
left join airport_heliport.runway_pt airport_heliport_runway_pt_alxsro on airport_heliport.runwaydirection_ts.usedrunway_id = airport_heliport_runway_pt_alxsro.id
left join airport_heliport.runwayelement_pt airport_heliport_runwayelement_pt_nliehu on airport_heliport.runwaydirection_ts.startingelement_id = airport_heliport_runwayelement_pt_nliehu.id
left join master_join master_join_jiwebd on airport_heliport.runwaydirection_ts.id = master_join_jiwebd.source_id
left join notes.note_view notes_note_view_avswkh on master_join_jiwebd.target_id = notes_note_view_avswkh.id
left join master_join master_join_akdjlm on airport_heliport.runwaydirection_ts.id = master_join_akdjlm.source_id
left join airport_heliport.manoeuvringareaavailability_view airport_heliport_manoeuvringareaavailability_view_bbgvsq on master_join_akdjlm.target_id = airport_heliport_manoeuvringareaavailability_view_bbgvsq.id
where airport_heliport.runwaydirection.feature_status = 'APPROVED'
  and airport_heliport.runwaydirection_ts.feature_status = 'APPROVED'
group by
    airport_heliport.runwaydirection.id,
    airport_heliport.runwaydirection_ts.id,
    airport_heliport.runwaydirection_tsp.id,
    airport_heliport.runwaydirection.identifier,
    airport_heliport.runwaydirection_ts.interpretation,
    airport_heliport.runwaydirection_ts.sequence_number,
    airport_heliport.runwaydirection_ts.correction_number,
    airport_heliport.runwaydirection_ts.valid_time_begin,
    airport_heliport.runwaydirection_ts.valid_time_end,
    airport_heliport.runwaydirection_ts.feature_lifetime_begin,
    airport_heliport.runwaydirection_ts.feature_lifetime_end,
    airport_heliport.runwaydirection_ts.designator_value,
    airport_heliport.runwaydirection_ts.designator_nilreason,
    airport_heliport.runwaydirection_ts.truebearing_value,
    airport_heliport.runwaydirection_ts.truebearing_nilreason,
    airport_heliport.runwaydirection_ts.truebearingaccuracy_value,
    airport_heliport.runwaydirection_ts.truebearingaccuracy_nilreason,
    airport_heliport.runwaydirection_ts.magneticbearing_value,
    airport_heliport.runwaydirection_ts.magneticbearing_nilreason,
    airport_heliport.runwaydirection_ts.patternvfr_value,
    airport_heliport.runwaydirection_ts.patternvfr_nilreason,
    airport_heliport.runwaydirection_ts.slopetdz_value,
    airport_heliport.runwaydirection_ts.slopetdz_nilreason,
    airport_heliport.runwaydirection_ts.approachmarkingtype_value,
    airport_heliport.runwaydirection_ts.approachmarkingtype_nilreason,
    airport_heliport.runwaydirection_ts.approachmarkingcondition_value,
    airport_heliport.runwaydirection_ts.approachmarkingcondition_nilreason,
    airport_heliport.runwaydirection_ts.classlightingjar_value,
    airport_heliport.runwaydirection_ts.classlightingjar_nilreason,
    airport_heliport.runwaydirection_ts.precisionapproachguidance_value,
    airport_heliport.runwaydirection_ts.precisionapproachguidance_nilreason,
    airport_heliport.runwaydirection_ts.elevationtdz_value,
    airport_heliport.runwaydirection_ts.elevationtdz_uom,
    airport_heliport.runwaydirection_ts.elevationtdz_nilreason,
    airport_heliport.runwaydirection_ts.elevationtdzaccuracy_value,
    airport_heliport.runwaydirection_ts.elevationtdzaccuracy_uom,
    airport_heliport.runwaydirection_ts.elevationtdzaccuracy_nilreason,
    airport_heliport_runway_pt_alxsro.title,
    airport_heliport_runway_pt_alxsro.nilreason[1],
    airport_heliport_runway_pt_alxsro.href,
    airport_heliport_runwayelement_pt_nliehu.title,
    airport_heliport_runwayelement_pt_nliehu.nilreason[1],
    airport_heliport_runwayelement_pt_nliehu.href
order by runwaydirection.identifier, runwaydirection_ts.sequence_number, runwaydirection_ts.correction_number DESC;
-- RunwayElementTimeSliceType
-- ['geometry.elevatedsurface_view', 'airport_heliport.manoeuvringareaavailability_view', 'notes.note_view']
create or replace view airport_heliport.runwayelement_view as
select distinct on (runwayelement.identifier,runwayelement_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.runwayelement.id,
    airport_heliport.runwayelement_ts.id as ts_id,
    airport_heliport.runwayelement_tsp.id as tsp_id,
    airport_heliport.runwayelement.identifier,
    airport_heliport.runwayelement_ts.interpretation,
    airport_heliport.runwayelement_ts.sequence_number,
    airport_heliport.runwayelement_ts.correction_number,
    airport_heliport.runwayelement_ts.valid_time_begin,
    airport_heliport.runwayelement_ts.valid_time_end,
    airport_heliport.runwayelement_ts.feature_lifetime_begin,
    airport_heliport.runwayelement_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.runwayelement_ts.type_value as varchar), '(' || airport_heliport.runwayelement_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.runwayelement_ts.gradeseparation_value as varchar), '(' || airport_heliport.runwayelement_ts.gradeseparation_nilreason || ')') as gradeseparation,
    coalesce(cast(airport_heliport.runwayelement_ts.length_value as varchar) || ' ' || airport_heliport.runwayelement_ts.length_uom, '(' || airport_heliport.runwayelement_ts.length_nilreason || ')') as length,
    coalesce(cast(airport_heliport.runwayelement_ts.width_value as varchar) || ' ' || airport_heliport.runwayelement_ts.width_uom, '(' || airport_heliport.runwayelement_ts.width_nilreason || ')') as width,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_fcfbzg.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_fcfbzg.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_fcfbzg.href AS surfaceproperties_href,
    geometry_elevatedsurface_view_rzdszv.geom AS geom,
    geometry_elevatedsurface_view_rzdszv.elevation,
    geometry_elevatedsurface_view_rzdszv.geoidUndulation,
    geometry_elevatedsurface_view_rzdszv.verticalDatum,
    geometry_elevatedsurface_view_rzdszv.verticalAccuracy,
    geometry_elevatedsurface_view_rzdszv.horizontalAccuracy,
    jsonb_build_object('id', airport_heliport_runway_pt_umtjvl.id,
    'title', coalesce(cast(airport_heliport_runway_pt_umtjvl.title AS varchar), '(' || airport_heliport_runway_pt_umtjvl.nilreason[1] || ')'),
    'href', airport_heliport_runway_pt_umtjvl.href) AS associatedrunway,
    jsonb_agg(notes_note_view_mnemdp.*) AS runwayelement_annotation,
    jsonb_agg(airport_heliport_manoeuvringareaavailability_view_ybswqc.id) AS availability
from airport_heliport.runwayelement 
inner join master_join mj2 on airport_heliport.runwayelement.id = mj2.source_id
inner join airport_heliport.runwayelement_tsp on mj2.target_id = airport_heliport.runwayelement_tsp.id
inner join airport_heliport.runwayelement_ts on airport_heliport.runwayelement_tsp.runwayelementtimeslice_id = airport_heliport.runwayelement_ts.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_fcfbzg on airport_heliport.runwayelement_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_fcfbzg.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_rzdszv on airport_heliport.runwayelement_ts.extent_id = geometry_elevatedsurface_view_rzdszv.id
left join master_join master_join_kqnqdk on airport_heliport.runwayelement_ts.id = master_join_kqnqdk.source_id
left join airport_heliport.runway_pt airport_heliport_runway_pt_umtjvl on master_join_kqnqdk.target_id = airport_heliport_runway_pt_umtjvl.id
left join master_join master_join_xmhftg on airport_heliport.runwayelement_ts.id = master_join_xmhftg.source_id
left join notes.note_view notes_note_view_mnemdp on master_join_xmhftg.target_id = notes_note_view_mnemdp.id
left join master_join master_join_crqvzt on airport_heliport.runwayelement_ts.id = master_join_crqvzt.source_id
left join airport_heliport.manoeuvringareaavailability_view airport_heliport_manoeuvringareaavailability_view_ybswqc on master_join_crqvzt.target_id = airport_heliport_manoeuvringareaavailability_view_ybswqc.id
where airport_heliport.runwayelement.feature_status = 'APPROVED'
  and airport_heliport.runwayelement_ts.feature_status = 'APPROVED'
group by
    airport_heliport.runwayelement.id,
    airport_heliport.runwayelement_ts.id,
    airport_heliport.runwayelement_tsp.id,
    airport_heliport.runwayelement.identifier,
    airport_heliport.runwayelement_ts.interpretation,
    airport_heliport.runwayelement_ts.sequence_number,
    airport_heliport.runwayelement_ts.correction_number,
    airport_heliport.runwayelement_ts.valid_time_begin,
    airport_heliport.runwayelement_ts.valid_time_end,
    airport_heliport.runwayelement_ts.feature_lifetime_begin,
    airport_heliport.runwayelement_ts.feature_lifetime_end,
    airport_heliport.runwayelement_ts.type_value,
    airport_heliport.runwayelement_ts.type_nilreason,
    airport_heliport.runwayelement_ts.gradeseparation_value,
    airport_heliport.runwayelement_ts.gradeseparation_nilreason,
    airport_heliport.runwayelement_ts.length_value,
    airport_heliport.runwayelement_ts.length_uom,
    airport_heliport.runwayelement_ts.length_nilreason,
    airport_heliport.runwayelement_ts.width_value,
    airport_heliport.runwayelement_ts.width_uom,
    airport_heliport.runwayelement_ts.width_nilreason,
    airport_heliport_surfacecharacteristics_pt_fcfbzg.title,
    airport_heliport_surfacecharacteristics_pt_fcfbzg.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_fcfbzg.href,
    geometry_elevatedsurface_view_rzdszv.geom,
    geometry_elevatedsurface_view_rzdszv.elevation,
    geometry_elevatedsurface_view_rzdszv.geoidUndulation,
    geometry_elevatedsurface_view_rzdszv.verticalDatum,
    geometry_elevatedsurface_view_rzdszv.verticalAccuracy,
    geometry_elevatedsurface_view_rzdszv.horizontalAccuracy
order by runwayelement.identifier, runwayelement_ts.sequence_number, runwayelement_ts.correction_number DESC;
-- RunwayMarkingTimeSliceType
-- ['notes.note_view', 'airport_heliport.markingelement_view']
create or replace view airport_heliport.runwaymarking_view as
select distinct on (runwaymarking.identifier,runwaymarking_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.runwaymarking.id,
    airport_heliport.runwaymarking_ts.id as ts_id,
    airport_heliport.runwaymarking_tsp.id as tsp_id,
    airport_heliport.runwaymarking.identifier,
    airport_heliport.runwaymarking_ts.interpretation,
    airport_heliport.runwaymarking_ts.sequence_number,
    airport_heliport.runwaymarking_ts.correction_number,
    airport_heliport.runwaymarking_ts.valid_time_begin,
    airport_heliport.runwaymarking_ts.valid_time_end,
    airport_heliport.runwaymarking_ts.feature_lifetime_begin,
    airport_heliport.runwaymarking_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.runwaymarking_ts.markingicaostandard_value as varchar), '(' || airport_heliport.runwaymarking_ts.markingicaostandard_nilreason || ')') as markingicaostandard,
    coalesce(cast(airport_heliport.runwaymarking_ts.condition_value as varchar), '(' || airport_heliport.runwaymarking_ts.condition_nilreason || ')') as condition,
    coalesce(cast(airport_heliport.runwaymarking_ts.markinglocation_value as varchar), '(' || airport_heliport.runwaymarking_ts.markinglocation_nilreason || ')') as markinglocation,
    coalesce(cast(airport_heliport_runway_pt_pnkjmq.title as varchar), '(' || airport_heliport_runway_pt_pnkjmq.nilreason[1] || ')') AS markedrunway,
    airport_heliport_runway_pt_pnkjmq.href AS markedrunway_href,
    jsonb_agg(airport_heliport_markingelement_view_nepild.id) AS element,
    jsonb_agg(notes_note_view_bfwhtu.*) AS runwaymarking_annotation
from airport_heliport.runwaymarking 
inner join master_join mj2 on airport_heliport.runwaymarking.id = mj2.source_id
inner join airport_heliport.runwaymarking_tsp on mj2.target_id = airport_heliport.runwaymarking_tsp.id
inner join airport_heliport.runwaymarking_ts on airport_heliport.runwaymarking_tsp.runwaymarkingtimeslice_id = airport_heliport.runwaymarking_ts.id
left join airport_heliport.runway_pt airport_heliport_runway_pt_pnkjmq on airport_heliport.runwaymarking_ts.markedrunway_id = airport_heliport_runway_pt_pnkjmq.id
left join master_join master_join_vqyryc on airport_heliport.runwaymarking_ts.id = master_join_vqyryc.source_id
left join airport_heliport.markingelement_view airport_heliport_markingelement_view_nepild on master_join_vqyryc.target_id = airport_heliport_markingelement_view_nepild.id
left join master_join master_join_uigfdf on airport_heliport.runwaymarking_ts.id = master_join_uigfdf.source_id
left join notes.note_view notes_note_view_bfwhtu on master_join_uigfdf.target_id = notes_note_view_bfwhtu.id
where airport_heliport.runwaymarking.feature_status = 'APPROVED'
  and airport_heliport.runwaymarking_ts.feature_status = 'APPROVED'
group by
    airport_heliport.runwaymarking.id,
    airport_heliport.runwaymarking_ts.id,
    airport_heliport.runwaymarking_tsp.id,
    airport_heliport.runwaymarking.identifier,
    airport_heliport.runwaymarking_ts.interpretation,
    airport_heliport.runwaymarking_ts.sequence_number,
    airport_heliport.runwaymarking_ts.correction_number,
    airport_heliport.runwaymarking_ts.valid_time_begin,
    airport_heliport.runwaymarking_ts.valid_time_end,
    airport_heliport.runwaymarking_ts.feature_lifetime_begin,
    airport_heliport.runwaymarking_ts.feature_lifetime_end,
    airport_heliport.runwaymarking_ts.markingicaostandard_value,
    airport_heliport.runwaymarking_ts.markingicaostandard_nilreason,
    airport_heliport.runwaymarking_ts.condition_value,
    airport_heliport.runwaymarking_ts.condition_nilreason,
    airport_heliport.runwaymarking_ts.markinglocation_value,
    airport_heliport.runwaymarking_ts.markinglocation_nilreason,
    airport_heliport_runway_pt_pnkjmq.title,
    airport_heliport_runway_pt_pnkjmq.nilreason[1],
    airport_heliport_runway_pt_pnkjmq.href
order by runwaymarking.identifier, runwaymarking_ts.sequence_number, runwaymarking_ts.correction_number DESC;
-- RunwayProtectAreaLightSystemTimeSliceType
-- ['shared.lightelement_view', 'airport_heliport.groundlightingavailability_view', 'notes.note_view']
create or replace view airport_heliport.runwayprotectarealightsystem_view as
select distinct on (runwayprotectarealightsystem.identifier,runwayprotectarealightsystem_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.runwayprotectarealightsystem.id,
    airport_heliport.runwayprotectarealightsystem_ts.id as ts_id,
    airport_heliport.runwayprotectarealightsystem_tsp.id as tsp_id,
    airport_heliport.runwayprotectarealightsystem.identifier,
    airport_heliport.runwayprotectarealightsystem_ts.interpretation,
    airport_heliport.runwayprotectarealightsystem_ts.sequence_number,
    airport_heliport.runwayprotectarealightsystem_ts.correction_number,
    airport_heliport.runwayprotectarealightsystem_ts.valid_time_begin,
    airport_heliport.runwayprotectarealightsystem_ts.valid_time_end,
    airport_heliport.runwayprotectarealightsystem_ts.feature_lifetime_begin,
    airport_heliport.runwayprotectarealightsystem_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.runwayprotectarealightsystem_ts.emergencylighting_value as varchar), '(' || airport_heliport.runwayprotectarealightsystem_ts.emergencylighting_nilreason || ')') as emergencylighting,
    coalesce(cast(airport_heliport.runwayprotectarealightsystem_ts.intensitylevel_value as varchar), '(' || airport_heliport.runwayprotectarealightsystem_ts.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(airport_heliport.runwayprotectarealightsystem_ts.colour_value as varchar), '(' || airport_heliport.runwayprotectarealightsystem_ts.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport.runwayprotectarealightsystem_ts.position_value as varchar), '(' || airport_heliport.runwayprotectarealightsystem_ts.position_nilreason || ')') as position,
    coalesce(cast(airport_heliport_runwayprotectarea_pt_xurrry.title as varchar), '(' || airport_heliport_runwayprotectarea_pt_xurrry.nilreason[1] || ')') AS lightedarea,
    airport_heliport_runwayprotectarea_pt_xurrry.href AS lightedarea_href,
    jsonb_agg(shared_lightelement_view_arcwer.id) AS element,
    jsonb_agg(airport_heliport_groundlightingavailability_view_brtutb.id) AS availability,
    jsonb_agg(notes_note_view_fdvxiz.*) AS runwayprotectarealightsystem_annotation
from airport_heliport.runwayprotectarealightsystem 
inner join master_join mj2 on airport_heliport.runwayprotectarealightsystem.id = mj2.source_id
inner join airport_heliport.runwayprotectarealightsystem_tsp on mj2.target_id = airport_heliport.runwayprotectarealightsystem_tsp.id
inner join airport_heliport.runwayprotectarealightsystem_ts on airport_heliport.runwayprotectarealightsystem_tsp.runwayprotectarealightsystemtimeslice_id = airport_heliport.runwayprotectarealightsystem_ts.id
left join airport_heliport.runwayprotectarea_pt airport_heliport_runwayprotectarea_pt_xurrry on airport_heliport.runwayprotectarealightsystem_ts.lightedarea_id = airport_heliport_runwayprotectarea_pt_xurrry.id
left join master_join master_join_wferji on airport_heliport.runwayprotectarealightsystem_ts.id = master_join_wferji.source_id
left join shared.lightelement_view shared_lightelement_view_arcwer on master_join_wferji.target_id = shared_lightelement_view_arcwer.id
left join master_join master_join_aefwgx on airport_heliport.runwayprotectarealightsystem_ts.id = master_join_aefwgx.source_id
left join airport_heliport.groundlightingavailability_view airport_heliport_groundlightingavailability_view_brtutb on master_join_aefwgx.target_id = airport_heliport_groundlightingavailability_view_brtutb.id
left join master_join master_join_nsahbq on airport_heliport.runwayprotectarealightsystem_ts.id = master_join_nsahbq.source_id
left join notes.note_view notes_note_view_fdvxiz on master_join_nsahbq.target_id = notes_note_view_fdvxiz.id
where airport_heliport.runwayprotectarealightsystem.feature_status = 'APPROVED'
  and airport_heliport.runwayprotectarealightsystem_ts.feature_status = 'APPROVED'
group by
    airport_heliport.runwayprotectarealightsystem.id,
    airport_heliport.runwayprotectarealightsystem_ts.id,
    airport_heliport.runwayprotectarealightsystem_tsp.id,
    airport_heliport.runwayprotectarealightsystem.identifier,
    airport_heliport.runwayprotectarealightsystem_ts.interpretation,
    airport_heliport.runwayprotectarealightsystem_ts.sequence_number,
    airport_heliport.runwayprotectarealightsystem_ts.correction_number,
    airport_heliport.runwayprotectarealightsystem_ts.valid_time_begin,
    airport_heliport.runwayprotectarealightsystem_ts.valid_time_end,
    airport_heliport.runwayprotectarealightsystem_ts.feature_lifetime_begin,
    airport_heliport.runwayprotectarealightsystem_ts.feature_lifetime_end,
    airport_heliport.runwayprotectarealightsystem_ts.emergencylighting_value,
    airport_heliport.runwayprotectarealightsystem_ts.emergencylighting_nilreason,
    airport_heliport.runwayprotectarealightsystem_ts.intensitylevel_value,
    airport_heliport.runwayprotectarealightsystem_ts.intensitylevel_nilreason,
    airport_heliport.runwayprotectarealightsystem_ts.colour_value,
    airport_heliport.runwayprotectarealightsystem_ts.colour_nilreason,
    airport_heliport.runwayprotectarealightsystem_ts.position_value,
    airport_heliport.runwayprotectarealightsystem_ts.position_nilreason,
    airport_heliport_runwayprotectarea_pt_xurrry.title,
    airport_heliport_runwayprotectarea_pt_xurrry.nilreason[1],
    airport_heliport_runwayprotectarea_pt_xurrry.href
order by runwayprotectarealightsystem.identifier, runwayprotectarealightsystem_ts.sequence_number, runwayprotectarealightsystem_ts.correction_number DESC;
-- RunwayProtectAreaTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view']
create or replace view airport_heliport.runwayprotectarea_view as
select distinct on (runwayprotectarea.identifier,runwayprotectarea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.runwayprotectarea.id,
    airport_heliport.runwayprotectarea_ts.id as ts_id,
    airport_heliport.runwayprotectarea_tsp.id as tsp_id,
    airport_heliport.runwayprotectarea.identifier,
    airport_heliport.runwayprotectarea_ts.interpretation,
    airport_heliport.runwayprotectarea_ts.sequence_number,
    airport_heliport.runwayprotectarea_ts.correction_number,
    airport_heliport.runwayprotectarea_ts.valid_time_begin,
    airport_heliport.runwayprotectarea_ts.valid_time_end,
    airport_heliport.runwayprotectarea_ts.feature_lifetime_begin,
    airport_heliport.runwayprotectarea_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.runwayprotectarea_ts.lighting_value as varchar), '(' || airport_heliport.runwayprotectarea_ts.lighting_nilreason || ')') as lighting,
    coalesce(cast(airport_heliport.runwayprotectarea_ts.obstaclefree_value as varchar), '(' || airport_heliport.runwayprotectarea_ts.obstaclefree_nilreason || ')') as obstaclefree,
    coalesce(cast(airport_heliport.runwayprotectarea_ts.type_value as varchar), '(' || airport_heliport.runwayprotectarea_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.runwayprotectarea_ts.status_value as varchar), '(' || airport_heliport.runwayprotectarea_ts.status_nilreason || ')') as status,
    coalesce(cast(airport_heliport.runwayprotectarea_ts.width_value as varchar) || ' ' || airport_heliport.runwayprotectarea_ts.width_uom, '(' || airport_heliport.runwayprotectarea_ts.width_nilreason || ')') as width,
    coalesce(cast(airport_heliport.runwayprotectarea_ts.length_value as varchar) || ' ' || airport_heliport.runwayprotectarea_ts.length_uom, '(' || airport_heliport.runwayprotectarea_ts.length_nilreason || ')') as length,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_vgpmht.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_vgpmht.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_vgpmht.href AS surfaceproperties_href,
    geometry_elevatedsurface_view_nkxxtp.geom AS geom,
    geometry_elevatedsurface_view_nkxxtp.elevation,
    geometry_elevatedsurface_view_nkxxtp.geoidUndulation,
    geometry_elevatedsurface_view_nkxxtp.verticalDatum,
    geometry_elevatedsurface_view_nkxxtp.verticalAccuracy,
    geometry_elevatedsurface_view_nkxxtp.horizontalAccuracy,
    coalesce(cast(airport_heliport_runwaydirection_pt_mbqudf.title as varchar), '(' || airport_heliport_runwaydirection_pt_mbqudf.nilreason[1] || ')') AS protectedrunwaydirection,
    airport_heliport_runwaydirection_pt_mbqudf.href AS protectedrunwaydirection_href,
    jsonb_agg(notes_note_view_xrozql.*) AS runwayprotectarea_annotation
from airport_heliport.runwayprotectarea 
inner join master_join mj2 on airport_heliport.runwayprotectarea.id = mj2.source_id
inner join airport_heliport.runwayprotectarea_tsp on mj2.target_id = airport_heliport.runwayprotectarea_tsp.id
inner join airport_heliport.runwayprotectarea_ts on airport_heliport.runwayprotectarea_tsp.runwayprotectareatimeslice_id = airport_heliport.runwayprotectarea_ts.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_vgpmht on airport_heliport.runwayprotectarea_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_vgpmht.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_nkxxtp on airport_heliport.runwayprotectarea_ts.extent_id = geometry_elevatedsurface_view_nkxxtp.id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_mbqudf on airport_heliport.runwayprotectarea_ts.protectedrunwaydirection_id = airport_heliport_runwaydirection_pt_mbqudf.id
left join master_join master_join_fzhxhv on airport_heliport.runwayprotectarea_ts.id = master_join_fzhxhv.source_id
left join notes.note_view notes_note_view_xrozql on master_join_fzhxhv.target_id = notes_note_view_xrozql.id
where airport_heliport.runwayprotectarea.feature_status = 'APPROVED'
  and airport_heliport.runwayprotectarea_ts.feature_status = 'APPROVED'
group by
    airport_heliport.runwayprotectarea.id,
    airport_heliport.runwayprotectarea_ts.id,
    airport_heliport.runwayprotectarea_tsp.id,
    airport_heliport.runwayprotectarea.identifier,
    airport_heliport.runwayprotectarea_ts.interpretation,
    airport_heliport.runwayprotectarea_ts.sequence_number,
    airport_heliport.runwayprotectarea_ts.correction_number,
    airport_heliport.runwayprotectarea_ts.valid_time_begin,
    airport_heliport.runwayprotectarea_ts.valid_time_end,
    airport_heliport.runwayprotectarea_ts.feature_lifetime_begin,
    airport_heliport.runwayprotectarea_ts.feature_lifetime_end,
    airport_heliport.runwayprotectarea_ts.lighting_value,
    airport_heliport.runwayprotectarea_ts.lighting_nilreason,
    airport_heliport.runwayprotectarea_ts.obstaclefree_value,
    airport_heliport.runwayprotectarea_ts.obstaclefree_nilreason,
    airport_heliport.runwayprotectarea_ts.type_value,
    airport_heliport.runwayprotectarea_ts.type_nilreason,
    airport_heliport.runwayprotectarea_ts.status_value,
    airport_heliport.runwayprotectarea_ts.status_nilreason,
    airport_heliport.runwayprotectarea_ts.width_value,
    airport_heliport.runwayprotectarea_ts.width_uom,
    airport_heliport.runwayprotectarea_ts.width_nilreason,
    airport_heliport.runwayprotectarea_ts.length_value,
    airport_heliport.runwayprotectarea_ts.length_uom,
    airport_heliport.runwayprotectarea_ts.length_nilreason,
    airport_heliport_surfacecharacteristics_pt_vgpmht.title,
    airport_heliport_surfacecharacteristics_pt_vgpmht.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_vgpmht.href,
    geometry_elevatedsurface_view_nkxxtp.geom,
    geometry_elevatedsurface_view_nkxxtp.elevation,
    geometry_elevatedsurface_view_nkxxtp.geoidUndulation,
    geometry_elevatedsurface_view_nkxxtp.verticalDatum,
    geometry_elevatedsurface_view_nkxxtp.verticalAccuracy,
    geometry_elevatedsurface_view_nkxxtp.horizontalAccuracy,
    airport_heliport_runwaydirection_pt_mbqudf.title,
    airport_heliport_runwaydirection_pt_mbqudf.nilreason[1],
    airport_heliport_runwaydirection_pt_mbqudf.href
order by runwayprotectarea.identifier, runwayprotectarea_ts.sequence_number, runwayprotectarea_ts.correction_number DESC;
-- RunwayTimeSliceType
-- ['airport_heliport.runwaysectioncontamination_view', 'notes.note_view', 'airport_heliport.runwaycontamination_view']
create or replace view airport_heliport.runway_view as
select distinct on (runway.identifier,runway_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.runway.id,
    airport_heliport.runway_ts.id as ts_id,
    airport_heliport.runway_tsp.id as tsp_id,
    airport_heliport.runway.identifier,
    airport_heliport.runway_ts.interpretation,
    airport_heliport.runway_ts.sequence_number,
    airport_heliport.runway_ts.correction_number,
    airport_heliport.runway_ts.valid_time_begin,
    airport_heliport.runway_ts.valid_time_end,
    airport_heliport.runway_ts.feature_lifetime_begin,
    airport_heliport.runway_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.runway_ts.designator_value as varchar), '(' || airport_heliport.runway_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airport_heliport.runway_ts.type_value as varchar), '(' || airport_heliport.runway_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.runway_ts.abandoned_value as varchar), '(' || airport_heliport.runway_ts.abandoned_nilreason || ')') as abandoned,
    coalesce(cast(airport_heliport.runway_ts.nominallength_value as varchar) || ' ' || airport_heliport.runway_ts.nominallength_uom, '(' || airport_heliport.runway_ts.nominallength_nilreason || ')') as nominallength,
    coalesce(cast(airport_heliport.runway_ts.lengthaccuracy_value as varchar) || ' ' || airport_heliport.runway_ts.lengthaccuracy_uom, '(' || airport_heliport.runway_ts.lengthaccuracy_nilreason || ')') as lengthaccuracy,
    coalesce(cast(airport_heliport.runway_ts.nominalwidth_value as varchar) || ' ' || airport_heliport.runway_ts.nominalwidth_uom, '(' || airport_heliport.runway_ts.nominalwidth_nilreason || ')') as nominalwidth,
    coalesce(cast(airport_heliport.runway_ts.widthaccuracy_value as varchar) || ' ' || airport_heliport.runway_ts.widthaccuracy_uom, '(' || airport_heliport.runway_ts.widthaccuracy_nilreason || ')') as widthaccuracy,
    coalesce(cast(airport_heliport.runway_ts.widthshoulder_value as varchar) || ' ' || airport_heliport.runway_ts.widthshoulder_uom, '(' || airport_heliport.runway_ts.widthshoulder_nilreason || ')') as widthshoulder,
    coalesce(cast(airport_heliport.runway_ts.lengthstrip_value as varchar) || ' ' || airport_heliport.runway_ts.lengthstrip_uom, '(' || airport_heliport.runway_ts.lengthstrip_nilreason || ')') as lengthstrip,
    coalesce(cast(airport_heliport.runway_ts.widthstrip_value as varchar) || ' ' || airport_heliport.runway_ts.widthstrip_uom, '(' || airport_heliport.runway_ts.widthstrip_nilreason || ')') as widthstrip,
    coalesce(cast(airport_heliport.runway_ts.lengthoffset_value as varchar) || ' ' || airport_heliport.runway_ts.lengthoffset_uom, '(' || airport_heliport.runway_ts.lengthoffset_nilreason || ')') as lengthoffset,
    coalesce(cast(airport_heliport.runway_ts.widthoffset_value as varchar) || ' ' || airport_heliport.runway_ts.widthoffset_uom, '(' || airport_heliport.runway_ts.widthoffset_nilreason || ')') as widthoffset,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_jnqpro.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_jnqpro.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_jnqpro.href AS surfaceproperties_href,
    coalesce(cast(airport_heliport_airportheliport_pt_qitgpu.title as varchar), '(' || airport_heliport_airportheliport_pt_qitgpu.nilreason[1] || ')') AS associatedairportheliport,
    airport_heliport_airportheliport_pt_qitgpu.href AS associatedairportheliport_href,
    jsonb_agg(airport_heliport_runwaycontamination_view_onqljl.id) AS overallcontaminant,
    jsonb_agg(notes_note_view_bfkqni.*) AS runway_annotation,
    jsonb_agg(airport_heliport_runwaysectioncontamination_view_qmdnwl.id) AS areacontaminant
from airport_heliport.runway 
inner join master_join mj2 on airport_heliport.runway.id = mj2.source_id
inner join airport_heliport.runway_tsp on mj2.target_id = airport_heliport.runway_tsp.id
inner join airport_heliport.runway_ts on airport_heliport.runway_tsp.runwaytimeslice_id = airport_heliport.runway_ts.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_jnqpro on airport_heliport.runway_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_jnqpro.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_qitgpu on airport_heliport.runway_ts.associatedairportheliport_id = airport_heliport_airportheliport_pt_qitgpu.id
left join master_join master_join_vdptjs on airport_heliport.runway_ts.id = master_join_vdptjs.source_id
left join airport_heliport.runwaycontamination_view airport_heliport_runwaycontamination_view_onqljl on master_join_vdptjs.target_id = airport_heliport_runwaycontamination_view_onqljl.id
left join master_join master_join_xltgak on airport_heliport.runway_ts.id = master_join_xltgak.source_id
left join notes.note_view notes_note_view_bfkqni on master_join_xltgak.target_id = notes_note_view_bfkqni.id
left join master_join master_join_cagtsv on airport_heliport.runway_ts.id = master_join_cagtsv.source_id
left join airport_heliport.runwaysectioncontamination_view airport_heliport_runwaysectioncontamination_view_qmdnwl on master_join_cagtsv.target_id = airport_heliport_runwaysectioncontamination_view_qmdnwl.id
where airport_heliport.runway.feature_status = 'APPROVED'
  and airport_heliport.runway_ts.feature_status = 'APPROVED'
group by
    airport_heliport.runway.id,
    airport_heliport.runway_ts.id,
    airport_heliport.runway_tsp.id,
    airport_heliport.runway.identifier,
    airport_heliport.runway_ts.interpretation,
    airport_heliport.runway_ts.sequence_number,
    airport_heliport.runway_ts.correction_number,
    airport_heliport.runway_ts.valid_time_begin,
    airport_heliport.runway_ts.valid_time_end,
    airport_heliport.runway_ts.feature_lifetime_begin,
    airport_heliport.runway_ts.feature_lifetime_end,
    airport_heliport.runway_ts.designator_value,
    airport_heliport.runway_ts.designator_nilreason,
    airport_heliport.runway_ts.type_value,
    airport_heliport.runway_ts.type_nilreason,
    airport_heliport.runway_ts.abandoned_value,
    airport_heliport.runway_ts.abandoned_nilreason,
    airport_heliport.runway_ts.nominallength_value,
    airport_heliport.runway_ts.nominallength_uom,
    airport_heliport.runway_ts.nominallength_nilreason,
    airport_heliport.runway_ts.lengthaccuracy_value,
    airport_heliport.runway_ts.lengthaccuracy_uom,
    airport_heliport.runway_ts.lengthaccuracy_nilreason,
    airport_heliport.runway_ts.nominalwidth_value,
    airport_heliport.runway_ts.nominalwidth_uom,
    airport_heliport.runway_ts.nominalwidth_nilreason,
    airport_heliport.runway_ts.widthaccuracy_value,
    airport_heliport.runway_ts.widthaccuracy_uom,
    airport_heliport.runway_ts.widthaccuracy_nilreason,
    airport_heliport.runway_ts.widthshoulder_value,
    airport_heliport.runway_ts.widthshoulder_uom,
    airport_heliport.runway_ts.widthshoulder_nilreason,
    airport_heliport.runway_ts.lengthstrip_value,
    airport_heliport.runway_ts.lengthstrip_uom,
    airport_heliport.runway_ts.lengthstrip_nilreason,
    airport_heliport.runway_ts.widthstrip_value,
    airport_heliport.runway_ts.widthstrip_uom,
    airport_heliport.runway_ts.widthstrip_nilreason,
    airport_heliport.runway_ts.lengthoffset_value,
    airport_heliport.runway_ts.lengthoffset_uom,
    airport_heliport.runway_ts.lengthoffset_nilreason,
    airport_heliport.runway_ts.widthoffset_value,
    airport_heliport.runway_ts.widthoffset_uom,
    airport_heliport.runway_ts.widthoffset_nilreason,
    airport_heliport_surfacecharacteristics_pt_jnqpro.title,
    airport_heliport_surfacecharacteristics_pt_jnqpro.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_jnqpro.href,
    airport_heliport_airportheliport_pt_qitgpu.title,
    airport_heliport_airportheliport_pt_qitgpu.nilreason[1],
    airport_heliport_airportheliport_pt_qitgpu.href
order by runway.identifier, runway_ts.sequence_number, runway_ts.correction_number DESC;
-- RunwayVisualRangeTimeSliceType
-- ['notes.note_view', 'geometry.elevatedpoint_view']
create or replace view airport_heliport.runwayvisualrange_view as
select distinct on (runwayvisualrange.identifier,runwayvisualrange_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.runwayvisualrange.id,
    airport_heliport.runwayvisualrange_ts.id as ts_id,
    airport_heliport.runwayvisualrange_tsp.id as tsp_id,
    airport_heliport.runwayvisualrange.identifier,
    airport_heliport.runwayvisualrange_ts.interpretation,
    airport_heliport.runwayvisualrange_ts.sequence_number,
    airport_heliport.runwayvisualrange_ts.correction_number,
    airport_heliport.runwayvisualrange_ts.valid_time_begin,
    airport_heliport.runwayvisualrange_ts.valid_time_end,
    airport_heliport.runwayvisualrange_ts.feature_lifetime_begin,
    airport_heliport.runwayvisualrange_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.runwayvisualrange_ts.readingposition_value as varchar), '(' || airport_heliport.runwayvisualrange_ts.readingposition_nilreason || ')') as readingposition,
    geometry_elevatedpoint_view_rzeqzw.geom AS geom,
    ST_X(geometry_elevatedpoint_view_rzeqzw.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_rzeqzw.geom) AS latitude,
    geometry_elevatedpoint_view_rzeqzw.elevation,
    geometry_elevatedpoint_view_rzeqzw.geoidUndulation,
    geometry_elevatedpoint_view_rzeqzw.verticalDatum,
    geometry_elevatedpoint_view_rzeqzw.verticalAccuracy,
    geometry_elevatedpoint_view_rzeqzw.horizontalAccuracy,
    jsonb_build_object('id', airport_heliport_runwaydirection_pt_xtsacj.id,
    'title', coalesce(cast(airport_heliport_runwaydirection_pt_xtsacj.title AS varchar), '(' || airport_heliport_runwaydirection_pt_xtsacj.nilreason[1] || ')'),
    'href', airport_heliport_runwaydirection_pt_xtsacj.href) AS associatedrunwaydirection,
    jsonb_agg(notes_note_view_bglraj.*) AS runwayvisualrange_annotation
from airport_heliport.runwayvisualrange 
inner join master_join mj2 on airport_heliport.runwayvisualrange.id = mj2.source_id
inner join airport_heliport.runwayvisualrange_tsp on mj2.target_id = airport_heliport.runwayvisualrange_tsp.id
inner join airport_heliport.runwayvisualrange_ts on airport_heliport.runwayvisualrange_tsp.runwayvisualrangetimeslice_id = airport_heliport.runwayvisualrange_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_rzeqzw on airport_heliport.runwayvisualrange_ts.location_id = geometry_elevatedpoint_view_rzeqzw.id
left join master_join master_join_uzlhyb on airport_heliport.runwayvisualrange_ts.id = master_join_uzlhyb.source_id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_xtsacj on master_join_uzlhyb.target_id = airport_heliport_runwaydirection_pt_xtsacj.id
left join master_join master_join_ramwkg on airport_heliport.runwayvisualrange_ts.id = master_join_ramwkg.source_id
left join notes.note_view notes_note_view_bglraj on master_join_ramwkg.target_id = notes_note_view_bglraj.id
where airport_heliport.runwayvisualrange.feature_status = 'APPROVED'
  and airport_heliport.runwayvisualrange_ts.feature_status = 'APPROVED'
group by
    airport_heliport.runwayvisualrange.id,
    airport_heliport.runwayvisualrange_ts.id,
    airport_heliport.runwayvisualrange_tsp.id,
    airport_heliport.runwayvisualrange.identifier,
    airport_heliport.runwayvisualrange_ts.interpretation,
    airport_heliport.runwayvisualrange_ts.sequence_number,
    airport_heliport.runwayvisualrange_ts.correction_number,
    airport_heliport.runwayvisualrange_ts.valid_time_begin,
    airport_heliport.runwayvisualrange_ts.valid_time_end,
    airport_heliport.runwayvisualrange_ts.feature_lifetime_begin,
    airport_heliport.runwayvisualrange_ts.feature_lifetime_end,
    airport_heliport.runwayvisualrange_ts.readingposition_value,
    airport_heliport.runwayvisualrange_ts.readingposition_nilreason,
    geometry_elevatedpoint_view_rzeqzw.geom,
    geometry_elevatedpoint_view_rzeqzw.elevation,
    geometry_elevatedpoint_view_rzeqzw.geoidUndulation,
    geometry_elevatedpoint_view_rzeqzw.verticalDatum,
    geometry_elevatedpoint_view_rzeqzw.verticalAccuracy,
    geometry_elevatedpoint_view_rzeqzw.horizontalAccuracy
order by runwayvisualrange.identifier, runwayvisualrange_ts.sequence_number, runwayvisualrange_ts.correction_number DESC;
-- SafeAltitudeAreaTimeSliceType
-- ['geometry.point_view', 'notes.note_view', 'procedure.safealtitudeareasector_view']
create or replace view procedure.safealtitudearea_view as
select distinct on (safealtitudearea.identifier,safealtitudearea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.safealtitudearea.id,
    procedure.safealtitudearea_ts.id as ts_id,
    procedure.safealtitudearea_tsp.id as tsp_id,
    procedure.safealtitudearea.identifier,
    procedure.safealtitudearea_ts.interpretation,
    procedure.safealtitudearea_ts.sequence_number,
    procedure.safealtitudearea_ts.correction_number,
    procedure.safealtitudearea_ts.valid_time_begin,
    procedure.safealtitudearea_ts.valid_time_end,
    procedure.safealtitudearea_ts.feature_lifetime_begin,
    procedure.safealtitudearea_ts.feature_lifetime_end,
    coalesce(cast(procedure.safealtitudearea_ts.safeareatype_value as varchar), '(' || procedure.safealtitudearea_ts.safeareatype_nilreason || ')') as safeareatype,
    coalesce(cast(navaids_points_designatedpoint_pt_ydbnkn.title as varchar), '(' || navaids_points_designatedpoint_pt_ydbnkn.nilreason[1] || ')') AS centrepointfixdesignatedpoint,
    navaids_points_designatedpoint_pt_ydbnkn.href AS centrepointfixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_nfftel.title as varchar), '(' || navaids_points_navaid_pt_nfftel.nilreason[1] || ')') AS centrepointnavaidsystem,
    navaids_points_navaid_pt_nfftel.href AS centrepointnavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_kpcnqx.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_kpcnqx.nilreason[1] || ')') AS centrepointaimingpoint,
    airport_heliport_touchdownliftoff_pt_kpcnqx.href AS centrepointaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_pwytnp.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_pwytnp.nilreason[1] || ')') AS centrepointrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_pwytnp.href AS centrepointrunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_eomnwd.title as varchar), '(' || airport_heliport_airportheliport_pt_eomnwd.nilreason[1] || ')') AS centrepointairportreferencepoint,
    airport_heliport_airportheliport_pt_eomnwd.href AS centrepointairportreferencepoint_href,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_riombd.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_riombd.title AS varchar), '(' || airport_heliport_airportheliport_pt_riombd.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_riombd.href) AS location,
    geometry_point_view_gigpiy.geom AS geom,
    ST_X(geometry_point_view_gigpiy.geom) AS longitude,
    ST_Y(geometry_point_view_gigpiy.geom) AS latitude,
    geometry_point_view_gigpiy.horizontalAccuracy,
    jsonb_agg(procedure_safealtitudeareasector_view_lbuhnj.id) AS sector,
    jsonb_agg(notes_note_view_aggcse.*) AS safealtitudearea_annotation
from procedure.safealtitudearea 
inner join master_join mj2 on procedure.safealtitudearea.id = mj2.source_id
inner join procedure.safealtitudearea_tsp on mj2.target_id = procedure.safealtitudearea_tsp.id
inner join procedure.safealtitudearea_ts on procedure.safealtitudearea_tsp.safealtitudeareatimeslice_id = procedure.safealtitudearea_ts.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_ydbnkn on procedure.safealtitudearea_ts.centrepoint_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_ydbnkn.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_nfftel on procedure.safealtitudearea_ts.centrepoint_navaidsystem_id = navaids_points_navaid_pt_nfftel.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_kpcnqx on procedure.safealtitudearea_ts.centrepoint_aimingpoint_id = airport_heliport_touchdownliftoff_pt_kpcnqx.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_pwytnp on procedure.safealtitudearea_ts.centrepoint_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_pwytnp.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_eomnwd on procedure.safealtitudearea_ts.centrepoint_airportreferencepoint_id = airport_heliport_airportheliport_pt_eomnwd.id
left join geometry.point_view geometry_point_view_gigpiy on procedure.safealtitudearea_ts.centrepoint_position_id = geometry_point_view_gigpiy.id
left join master_join master_join_sysfsa on procedure.safealtitudearea_ts.id = master_join_sysfsa.source_id
left join procedure.safealtitudeareasector_view procedure_safealtitudeareasector_view_lbuhnj on master_join_sysfsa.target_id = procedure_safealtitudeareasector_view_lbuhnj.id
left join master_join master_join_esgbey on procedure.safealtitudearea_ts.id = master_join_esgbey.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_riombd on master_join_esgbey.target_id = airport_heliport_airportheliport_pt_riombd.id
left join master_join master_join_fwzebn on procedure.safealtitudearea_ts.id = master_join_fwzebn.source_id
left join notes.note_view notes_note_view_aggcse on master_join_fwzebn.target_id = notes_note_view_aggcse.id
where procedure.safealtitudearea.feature_status = 'APPROVED'
  and procedure.safealtitudearea_ts.feature_status = 'APPROVED'
group by
    procedure.safealtitudearea.id,
    procedure.safealtitudearea_ts.id,
    procedure.safealtitudearea_tsp.id,
    procedure.safealtitudearea.identifier,
    procedure.safealtitudearea_ts.interpretation,
    procedure.safealtitudearea_ts.sequence_number,
    procedure.safealtitudearea_ts.correction_number,
    procedure.safealtitudearea_ts.valid_time_begin,
    procedure.safealtitudearea_ts.valid_time_end,
    procedure.safealtitudearea_ts.feature_lifetime_begin,
    procedure.safealtitudearea_ts.feature_lifetime_end,
    procedure.safealtitudearea_ts.safeareatype_value,
    procedure.safealtitudearea_ts.safeareatype_nilreason,
    navaids_points_designatedpoint_pt_ydbnkn.title,
    navaids_points_designatedpoint_pt_ydbnkn.nilreason[1],
    navaids_points_designatedpoint_pt_ydbnkn.href,
    navaids_points_navaid_pt_nfftel.title,
    navaids_points_navaid_pt_nfftel.nilreason[1],
    navaids_points_navaid_pt_nfftel.href,
    airport_heliport_touchdownliftoff_pt_kpcnqx.title,
    airport_heliport_touchdownliftoff_pt_kpcnqx.nilreason[1],
    airport_heliport_touchdownliftoff_pt_kpcnqx.href,
    airport_heliport_runwaycentrelinepoint_pt_pwytnp.title,
    airport_heliport_runwaycentrelinepoint_pt_pwytnp.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_pwytnp.href,
    airport_heliport_airportheliport_pt_eomnwd.title,
    airport_heliport_airportheliport_pt_eomnwd.nilreason[1],
    airport_heliport_airportheliport_pt_eomnwd.href,
    geometry_point_view_gigpiy.geom,
    geometry_point_view_gigpiy.horizontalAccuracy
order by safealtitudearea.identifier, safealtitudearea_ts.sequence_number, safealtitudearea_ts.correction_number DESC;
-- SDFTimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.sdf_view as
select distinct on (sdf.identifier,sdf_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.sdf.id,
    navaids_points.sdf_ts.id as ts_id,
    navaids_points.sdf_tsp.id as tsp_id,
    navaids_points.sdf.identifier,
    navaids_points.sdf_ts.interpretation,
    navaids_points.sdf_ts.sequence_number,
    navaids_points.sdf_ts.correction_number,
    navaids_points.sdf_ts.valid_time_begin,
    navaids_points.sdf_ts.valid_time_end,
    navaids_points.sdf_ts.feature_lifetime_begin,
    navaids_points.sdf_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.sdf_ts.designator_value as varchar), '(' || navaids_points.sdf_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.sdf_ts.name_value as varchar), '(' || navaids_points.sdf_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.sdf_ts.emissionclass_value as varchar), '(' || navaids_points.sdf_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.sdf_ts.mobile_value as varchar), '(' || navaids_points.sdf_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.sdf_ts.magneticvariation_value as varchar), '(' || navaids_points.sdf_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.sdf_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.sdf_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.sdf_ts.datemagneticvariation_value as varchar), '(' || navaids_points.sdf_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.sdf_ts.flightchecked_value as varchar), '(' || navaids_points.sdf_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.sdf_ts.magneticbearing_value as varchar), '(' || navaids_points.sdf_ts.magneticbearing_nilreason || ')') as magneticbearing,
    coalesce(cast(navaids_points.sdf_ts.truebearing_value as varchar), '(' || navaids_points.sdf_ts.truebearing_nilreason || ')') as truebearing,
    coalesce(cast(navaids_points.sdf_ts.frequency_value as varchar) || ' ' || navaids_points.sdf_ts.frequency_uom, '(' || navaids_points.sdf_ts.frequency_nilreason || ')') as frequency,
    geometry_elevatedpoint_view_khohmi.geom AS geom,
    ST_X(geometry_elevatedpoint_view_khohmi.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_khohmi.geom) AS latitude,
    geometry_elevatedpoint_view_khohmi.elevation,
    geometry_elevatedpoint_view_khohmi.geoidUndulation,
    geometry_elevatedpoint_view_khohmi.verticalDatum,
    geometry_elevatedpoint_view_khohmi.verticalAccuracy,
    geometry_elevatedpoint_view_khohmi.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_zmkgix.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_vcsgab.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_dmcusp.id) AS availability,
    jsonb_agg(notes_note_view_ljvmzq.*) AS sdf_annotation
from navaids_points.sdf 
inner join master_join mj2 on navaids_points.sdf.id = mj2.source_id
inner join navaids_points.sdf_tsp on mj2.target_id = navaids_points.sdf_tsp.id
inner join navaids_points.sdf_ts on navaids_points.sdf_tsp.sdftimeslice_id = navaids_points.sdf_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_khohmi on navaids_points.sdf_ts.location_id = geometry_elevatedpoint_view_khohmi.id
left join master_join master_join_pgnwcc on navaids_points.sdf_ts.id = master_join_pgnwcc.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_zmkgix on master_join_pgnwcc.target_id = navaids_points_authorityfornavaidequipment_view_zmkgix.id
left join master_join master_join_tqvwcj on navaids_points.sdf_ts.id = master_join_tqvwcj.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_vcsgab on master_join_tqvwcj.target_id = navaids_points_navaidequipmentmonitoring_view_vcsgab.id
left join master_join master_join_puzqmo on navaids_points.sdf_ts.id = master_join_puzqmo.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_dmcusp on master_join_puzqmo.target_id = navaids_points_navaidoperationalstatus_view_dmcusp.id
left join master_join master_join_ilhflk on navaids_points.sdf_ts.id = master_join_ilhflk.source_id
left join notes.note_view notes_note_view_ljvmzq on master_join_ilhflk.target_id = notes_note_view_ljvmzq.id
where navaids_points.sdf.feature_status = 'APPROVED'
  and navaids_points.sdf_ts.feature_status = 'APPROVED'
group by
    navaids_points.sdf.id,
    navaids_points.sdf_ts.id,
    navaids_points.sdf_tsp.id,
    navaids_points.sdf.identifier,
    navaids_points.sdf_ts.interpretation,
    navaids_points.sdf_ts.sequence_number,
    navaids_points.sdf_ts.correction_number,
    navaids_points.sdf_ts.valid_time_begin,
    navaids_points.sdf_ts.valid_time_end,
    navaids_points.sdf_ts.feature_lifetime_begin,
    navaids_points.sdf_ts.feature_lifetime_end,
    navaids_points.sdf_ts.designator_value,
    navaids_points.sdf_ts.designator_nilreason,
    navaids_points.sdf_ts.name_value,
    navaids_points.sdf_ts.name_nilreason,
    navaids_points.sdf_ts.emissionclass_value,
    navaids_points.sdf_ts.emissionclass_nilreason,
    navaids_points.sdf_ts.mobile_value,
    navaids_points.sdf_ts.mobile_nilreason,
    navaids_points.sdf_ts.magneticvariation_value,
    navaids_points.sdf_ts.magneticvariation_nilreason,
    navaids_points.sdf_ts.magneticvariationaccuracy_value,
    navaids_points.sdf_ts.magneticvariationaccuracy_nilreason,
    navaids_points.sdf_ts.datemagneticvariation_value,
    navaids_points.sdf_ts.datemagneticvariation_nilreason,
    navaids_points.sdf_ts.flightchecked_value,
    navaids_points.sdf_ts.flightchecked_nilreason,
    navaids_points.sdf_ts.magneticbearing_value,
    navaids_points.sdf_ts.magneticbearing_nilreason,
    navaids_points.sdf_ts.truebearing_value,
    navaids_points.sdf_ts.truebearing_nilreason,
    navaids_points.sdf_ts.frequency_value,
    navaids_points.sdf_ts.frequency_uom,
    navaids_points.sdf_ts.frequency_nilreason,
    geometry_elevatedpoint_view_khohmi.geom,
    geometry_elevatedpoint_view_khohmi.elevation,
    geometry_elevatedpoint_view_khohmi.geoidUndulation,
    geometry_elevatedpoint_view_khohmi.verticalDatum,
    geometry_elevatedpoint_view_khohmi.verticalAccuracy,
    geometry_elevatedpoint_view_khohmi.horizontalAccuracy
order by sdf.identifier, sdf_ts.sequence_number, sdf_ts.correction_number DESC;
-- SeaplaneLandingAreaTimeSliceType
-- ['geometry.elevatedsurface_view', 'airport_heliport.manoeuvringareaavailability_view', 'notes.note_view']
create or replace view airport_heliport.seaplanelandingarea_view as
select distinct on (seaplanelandingarea.identifier,seaplanelandingarea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.seaplanelandingarea.id,
    airport_heliport.seaplanelandingarea_ts.id as ts_id,
    airport_heliport.seaplanelandingarea_tsp.id as tsp_id,
    airport_heliport.seaplanelandingarea.identifier,
    airport_heliport.seaplanelandingarea_ts.interpretation,
    airport_heliport.seaplanelandingarea_ts.sequence_number,
    airport_heliport.seaplanelandingarea_ts.correction_number,
    airport_heliport.seaplanelandingarea_ts.valid_time_begin,
    airport_heliport.seaplanelandingarea_ts.valid_time_end,
    airport_heliport.seaplanelandingarea_ts.feature_lifetime_begin,
    airport_heliport.seaplanelandingarea_ts.feature_lifetime_end,
    geometry_elevatedsurface_view_cxtklb.geom AS geom,
    geometry_elevatedsurface_view_cxtklb.elevation,
    geometry_elevatedsurface_view_cxtklb.geoidUndulation,
    geometry_elevatedsurface_view_cxtklb.verticalDatum,
    geometry_elevatedsurface_view_cxtklb.verticalAccuracy,
    geometry_elevatedsurface_view_cxtklb.horizontalAccuracy,
    jsonb_build_object('id', airport_heliport_seaplanerampsite_pt_fqjfbd.id,
    'title', coalesce(cast(airport_heliport_seaplanerampsite_pt_fqjfbd.title AS varchar), '(' || airport_heliport_seaplanerampsite_pt_fqjfbd.nilreason[1] || ')'),
    'href', airport_heliport_seaplanerampsite_pt_fqjfbd.href) AS rampsite,
    jsonb_build_object('id', airport_heliport_floatingdocksite_pt_cjrppj.id,
    'title', coalesce(cast(airport_heliport_floatingdocksite_pt_cjrppj.title AS varchar), '(' || airport_heliport_floatingdocksite_pt_cjrppj.nilreason[1] || ')'),
    'href', airport_heliport_floatingdocksite_pt_cjrppj.href) AS docksite,
    jsonb_agg(notes_note_view_fhfycp.*) AS seaplanelandingarea_annotation,
    jsonb_agg(airport_heliport_manoeuvringareaavailability_view_utqfeq.id) AS availability
from airport_heliport.seaplanelandingarea 
inner join master_join mj2 on airport_heliport.seaplanelandingarea.id = mj2.source_id
inner join airport_heliport.seaplanelandingarea_tsp on mj2.target_id = airport_heliport.seaplanelandingarea_tsp.id
inner join airport_heliport.seaplanelandingarea_ts on airport_heliport.seaplanelandingarea_tsp.seaplanelandingareatimeslice_id = airport_heliport.seaplanelandingarea_ts.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_cxtklb on airport_heliport.seaplanelandingarea_ts.extent_id = geometry_elevatedsurface_view_cxtklb.id
left join master_join master_join_znjosb on airport_heliport.seaplanelandingarea_ts.id = master_join_znjosb.source_id
left join airport_heliport.seaplanerampsite_pt airport_heliport_seaplanerampsite_pt_fqjfbd on master_join_znjosb.target_id = airport_heliport_seaplanerampsite_pt_fqjfbd.id
left join master_join master_join_cmhhds on airport_heliport.seaplanelandingarea_ts.id = master_join_cmhhds.source_id
left join airport_heliport.floatingdocksite_pt airport_heliport_floatingdocksite_pt_cjrppj on master_join_cmhhds.target_id = airport_heliport_floatingdocksite_pt_cjrppj.id
left join master_join master_join_qrntau on airport_heliport.seaplanelandingarea_ts.id = master_join_qrntau.source_id
left join notes.note_view notes_note_view_fhfycp on master_join_qrntau.target_id = notes_note_view_fhfycp.id
left join master_join master_join_szqrea on airport_heliport.seaplanelandingarea_ts.id = master_join_szqrea.source_id
left join airport_heliport.manoeuvringareaavailability_view airport_heliport_manoeuvringareaavailability_view_utqfeq on master_join_szqrea.target_id = airport_heliport_manoeuvringareaavailability_view_utqfeq.id
where airport_heliport.seaplanelandingarea.feature_status = 'APPROVED'
  and airport_heliport.seaplanelandingarea_ts.feature_status = 'APPROVED'
group by
    airport_heliport.seaplanelandingarea.id,
    airport_heliport.seaplanelandingarea_ts.id,
    airport_heliport.seaplanelandingarea_tsp.id,
    airport_heliport.seaplanelandingarea.identifier,
    airport_heliport.seaplanelandingarea_ts.interpretation,
    airport_heliport.seaplanelandingarea_ts.sequence_number,
    airport_heliport.seaplanelandingarea_ts.correction_number,
    airport_heliport.seaplanelandingarea_ts.valid_time_begin,
    airport_heliport.seaplanelandingarea_ts.valid_time_end,
    airport_heliport.seaplanelandingarea_ts.feature_lifetime_begin,
    airport_heliport.seaplanelandingarea_ts.feature_lifetime_end,
    geometry_elevatedsurface_view_cxtklb.geom,
    geometry_elevatedsurface_view_cxtklb.elevation,
    geometry_elevatedsurface_view_cxtklb.geoidUndulation,
    geometry_elevatedsurface_view_cxtklb.verticalDatum,
    geometry_elevatedsurface_view_cxtklb.verticalAccuracy,
    geometry_elevatedsurface_view_cxtklb.horizontalAccuracy
order by seaplanelandingarea.identifier, seaplanelandingarea_ts.sequence_number, seaplanelandingarea_ts.correction_number DESC;
-- SeaplaneRampSiteTimeSliceType
-- ['geometry.elevatedsurface_view', 'geometry.elevatedcurve_view', 'notes.note_view']
create or replace view airport_heliport.seaplanerampsite_view as
select distinct on (seaplanerampsite.identifier,seaplanerampsite_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.seaplanerampsite.id,
    airport_heliport.seaplanerampsite_ts.id as ts_id,
    airport_heliport.seaplanerampsite_tsp.id as tsp_id,
    airport_heliport.seaplanerampsite.identifier,
    airport_heliport.seaplanerampsite_ts.interpretation,
    airport_heliport.seaplanerampsite_ts.sequence_number,
    airport_heliport.seaplanerampsite_ts.correction_number,
    airport_heliport.seaplanerampsite_ts.valid_time_begin,
    airport_heliport.seaplanerampsite_ts.valid_time_end,
    airport_heliport.seaplanerampsite_ts.feature_lifetime_begin,
    airport_heliport.seaplanerampsite_ts.feature_lifetime_end,
    geometry_elevatedsurface_view_lomonu.geom AS geom,
    geometry_elevatedsurface_view_lomonu.elevation,
    geometry_elevatedsurface_view_lomonu.geoidUndulation,
    geometry_elevatedsurface_view_lomonu.verticalDatum,
    geometry_elevatedsurface_view_lomonu.verticalAccuracy,
    geometry_elevatedsurface_view_lomonu.horizontalAccuracy,
    geometry_elevatedcurve_view_nwkuot.geom AS geom,
    geometry_elevatedcurve_view_nwkuot.elevation,
    geometry_elevatedcurve_view_nwkuot.geoidUndulation,
    geometry_elevatedcurve_view_nwkuot.verticalDatum,
    geometry_elevatedcurve_view_nwkuot.verticalAccuracy,
    geometry_elevatedcurve_view_nwkuot.horizontalAccuracy,
    jsonb_agg(notes_note_view_pfvvxk.*) AS seaplanerampsite_annotation
from airport_heliport.seaplanerampsite 
inner join master_join mj2 on airport_heliport.seaplanerampsite.id = mj2.source_id
inner join airport_heliport.seaplanerampsite_tsp on mj2.target_id = airport_heliport.seaplanerampsite_tsp.id
inner join airport_heliport.seaplanerampsite_ts on airport_heliport.seaplanerampsite_tsp.seaplanerampsitetimeslice_id = airport_heliport.seaplanerampsite_ts.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_lomonu on airport_heliport.seaplanerampsite_ts.extent_id = geometry_elevatedsurface_view_lomonu.id
left join geometry.elevatedcurve_view geometry_elevatedcurve_view_nwkuot on airport_heliport.seaplanerampsite_ts.centreline_id = geometry_elevatedcurve_view_nwkuot.id
left join master_join master_join_izgxen on airport_heliport.seaplanerampsite_ts.id = master_join_izgxen.source_id
left join notes.note_view notes_note_view_pfvvxk on master_join_izgxen.target_id = notes_note_view_pfvvxk.id
where airport_heliport.seaplanerampsite.feature_status = 'APPROVED'
  and airport_heliport.seaplanerampsite_ts.feature_status = 'APPROVED'
group by
    airport_heliport.seaplanerampsite.id,
    airport_heliport.seaplanerampsite_ts.id,
    airport_heliport.seaplanerampsite_tsp.id,
    airport_heliport.seaplanerampsite.identifier,
    airport_heliport.seaplanerampsite_ts.interpretation,
    airport_heliport.seaplanerampsite_ts.sequence_number,
    airport_heliport.seaplanerampsite_ts.correction_number,
    airport_heliport.seaplanerampsite_ts.valid_time_begin,
    airport_heliport.seaplanerampsite_ts.valid_time_end,
    airport_heliport.seaplanerampsite_ts.feature_lifetime_begin,
    airport_heliport.seaplanerampsite_ts.feature_lifetime_end,
    geometry_elevatedsurface_view_lomonu.geom,
    geometry_elevatedsurface_view_lomonu.elevation,
    geometry_elevatedsurface_view_lomonu.geoidUndulation,
    geometry_elevatedsurface_view_lomonu.verticalDatum,
    geometry_elevatedsurface_view_lomonu.verticalAccuracy,
    geometry_elevatedsurface_view_lomonu.horizontalAccuracy,
    geometry_elevatedcurve_view_nwkuot.geom,
    geometry_elevatedcurve_view_nwkuot.elevation,
    geometry_elevatedcurve_view_nwkuot.geoidUndulation,
    geometry_elevatedcurve_view_nwkuot.verticalDatum,
    geometry_elevatedcurve_view_nwkuot.verticalAccuracy,
    geometry_elevatedcurve_view_nwkuot.horizontalAccuracy
order by seaplanerampsite.identifier, seaplanerampsite_ts.sequence_number, seaplanerampsite_ts.correction_number DESC;
-- SearchRescueServiceTimeSliceType
-- ['service.serviceoperationalstatus_view', 'notes.note_view', 'shared.contactinformation_view', 'routes.routeportion_view', 'geometry.elevatedpoint_view', 'service.callsigndetail_view']
create or replace view service.searchrescueservice_view as
select distinct on (searchrescueservice.identifier,searchrescueservice_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    service.searchrescueservice.id,
    service.searchrescueservice_ts.id as ts_id,
    service.searchrescueservice_tsp.id as tsp_id,
    service.searchrescueservice.identifier,
    service.searchrescueservice_ts.interpretation,
    service.searchrescueservice_ts.sequence_number,
    service.searchrescueservice_ts.correction_number,
    service.searchrescueservice_ts.valid_time_begin,
    service.searchrescueservice_ts.valid_time_end,
    service.searchrescueservice_ts.feature_lifetime_begin,
    service.searchrescueservice_ts.feature_lifetime_end,
    coalesce(cast(service.searchrescueservice_ts.flightoperations_value as varchar), '(' || service.searchrescueservice_ts.flightoperations_nilreason || ')') as flightoperations,
    coalesce(cast(service.searchrescueservice_ts.rank_value as varchar), '(' || service.searchrescueservice_ts.rank_nilreason || ')') as rank,
    coalesce(cast(service.searchrescueservice_ts.complianticao_value as varchar), '(' || service.searchrescueservice_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(service.searchrescueservice_ts.name_value as varchar), '(' || service.searchrescueservice_ts.name_nilreason || ')') as name,
    coalesce(cast(service.searchrescueservice_ts.type_value as varchar), '(' || service.searchrescueservice_ts.type_nilreason || ')') as type,
    geometry_elevatedpoint_view_qrlsgr.geom AS geom,
    ST_X(geometry_elevatedpoint_view_qrlsgr.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_qrlsgr.geom) AS latitude,
    geometry_elevatedpoint_view_qrlsgr.elevation,
    geometry_elevatedpoint_view_qrlsgr.geoidUndulation,
    geometry_elevatedpoint_view_qrlsgr.verticalDatum,
    geometry_elevatedpoint_view_qrlsgr.verticalAccuracy,
    geometry_elevatedpoint_view_qrlsgr.horizontalAccuracy,
    coalesce(cast(organisation_unit_pt_akecdp.title as varchar), '(' || organisation_unit_pt_akecdp.nilreason[1] || ')') AS serviceprovider,
    organisation_unit_pt_akecdp.href AS serviceprovider_href,
    jsonb_agg(service_callsigndetail_view_gqycos.id) AS callsign,
    jsonb_build_object('id', service_radiocommunicationchannel_pt_zyiykv.id,
    'title', coalesce(cast(service_radiocommunicationchannel_pt_zyiykv.title AS varchar), '(' || service_radiocommunicationchannel_pt_zyiykv.nilreason[1] || ')'),
    'href', service_radiocommunicationchannel_pt_zyiykv.href) AS radiocommunication,
    jsonb_agg(service_serviceoperationalstatus_view_qhlexb.id) AS availability,
    jsonb_agg(notes_note_view_sefxjs.*) AS searchrescueservice_annotation,
    jsonb_build_object('id', airspace_airspace_pt_dktknc.id,
    'title', coalesce(cast(airspace_airspace_pt_dktknc.title AS varchar), '(' || airspace_airspace_pt_dktknc.nilreason[1] || ')'),
    'href', airspace_airspace_pt_dktknc.href) AS clientairspace,
    jsonb_agg(routes_routeportion_view_csawsd.id) AS clientroute
from service.searchrescueservice 
inner join master_join mj2 on service.searchrescueservice.id = mj2.source_id
inner join service.searchrescueservice_tsp on mj2.target_id = service.searchrescueservice_tsp.id
inner join service.searchrescueservice_ts on service.searchrescueservice_tsp.searchrescueservicetimeslice_id = service.searchrescueservice_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_qrlsgr on service.searchrescueservice_ts.location_id = geometry_elevatedpoint_view_qrlsgr.id
left join organisation.unit_pt organisation_unit_pt_akecdp on service.searchrescueservice_ts.serviceprovider_id = organisation_unit_pt_akecdp.id
left join master_join master_join_szcumr on service.searchrescueservice_ts.id = master_join_szcumr.source_id
left join service.callsigndetail_view service_callsigndetail_view_gqycos on master_join_szcumr.target_id = service_callsigndetail_view_gqycos.id
left join master_join master_join_pbebcp on service.searchrescueservice_ts.id = master_join_pbebcp.source_id
left join service.radiocommunicationchannel_pt service_radiocommunicationchannel_pt_zyiykv on master_join_pbebcp.target_id = service_radiocommunicationchannel_pt_zyiykv.id
left join master_join master_join_lgkgkq on service.searchrescueservice_ts.id = master_join_lgkgkq.source_id
left join shared.contactinformation_view shared_contactinformation_view_rxsjbp on master_join_lgkgkq.target_id = shared_contactinformation_view_rxsjbp.id
left join master_join master_join_jrgzwy on service.searchrescueservice_ts.id = master_join_jrgzwy.source_id
left join service.serviceoperationalstatus_view service_serviceoperationalstatus_view_qhlexb on master_join_jrgzwy.target_id = service_serviceoperationalstatus_view_qhlexb.id
left join master_join master_join_zxbsjs on service.searchrescueservice_ts.id = master_join_zxbsjs.source_id
left join notes.note_view notes_note_view_sefxjs on master_join_zxbsjs.target_id = notes_note_view_sefxjs.id
left join master_join master_join_hbedwx on service.searchrescueservice_ts.id = master_join_hbedwx.source_id
left join airspace.airspace_pt airspace_airspace_pt_dktknc on master_join_hbedwx.target_id = airspace_airspace_pt_dktknc.id
left join master_join master_join_jmmzqj on service.searchrescueservice_ts.id = master_join_jmmzqj.source_id
left join routes.routeportion_view routes_routeportion_view_csawsd on master_join_jmmzqj.target_id = routes_routeportion_view_csawsd.id
where service.searchrescueservice.feature_status = 'APPROVED'
  and service.searchrescueservice_ts.feature_status = 'APPROVED'
group by
    service.searchrescueservice.id,
    service.searchrescueservice_ts.id,
    service.searchrescueservice_tsp.id,
    service.searchrescueservice.identifier,
    service.searchrescueservice_ts.interpretation,
    service.searchrescueservice_ts.sequence_number,
    service.searchrescueservice_ts.correction_number,
    service.searchrescueservice_ts.valid_time_begin,
    service.searchrescueservice_ts.valid_time_end,
    service.searchrescueservice_ts.feature_lifetime_begin,
    service.searchrescueservice_ts.feature_lifetime_end,
    service.searchrescueservice_ts.flightoperations_value,
    service.searchrescueservice_ts.flightoperations_nilreason,
    service.searchrescueservice_ts.rank_value,
    service.searchrescueservice_ts.rank_nilreason,
    service.searchrescueservice_ts.complianticao_value,
    service.searchrescueservice_ts.complianticao_nilreason,
    service.searchrescueservice_ts.name_value,
    service.searchrescueservice_ts.name_nilreason,
    service.searchrescueservice_ts.type_value,
    service.searchrescueservice_ts.type_nilreason,
    geometry_elevatedpoint_view_qrlsgr.geom,
    geometry_elevatedpoint_view_qrlsgr.elevation,
    geometry_elevatedpoint_view_qrlsgr.geoidUndulation,
    geometry_elevatedpoint_view_qrlsgr.verticalDatum,
    geometry_elevatedpoint_view_qrlsgr.verticalAccuracy,
    geometry_elevatedpoint_view_qrlsgr.horizontalAccuracy,
    organisation_unit_pt_akecdp.title,
    organisation_unit_pt_akecdp.nilreason[1],
    organisation_unit_pt_akecdp.href
order by searchrescueservice.identifier, searchrescueservice_ts.sequence_number, searchrescueservice_ts.correction_number DESC;
-- SecondarySurveillanceRadarTimeSliceType
-- ['notes.note_view', 'surveillance.surveillancegroundstation_view', 'shared.contactinformation_view', 'geometry.elevatedpoint_view']
create or replace view surveillance.secondarysurveillanceradar_view as
select distinct on (secondarysurveillanceradar.identifier,secondarysurveillanceradar_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    surveillance.secondarysurveillanceradar.id,
    surveillance.secondarysurveillanceradar_ts.id as ts_id,
    surveillance.secondarysurveillanceradar_tsp.id as tsp_id,
    surveillance.secondarysurveillanceradar.identifier,
    surveillance.secondarysurveillanceradar_ts.interpretation,
    surveillance.secondarysurveillanceradar_ts.sequence_number,
    surveillance.secondarysurveillanceradar_ts.correction_number,
    surveillance.secondarysurveillanceradar_ts.valid_time_begin,
    surveillance.secondarysurveillanceradar_ts.valid_time_end,
    surveillance.secondarysurveillanceradar_ts.feature_lifetime_begin,
    surveillance.secondarysurveillanceradar_ts.feature_lifetime_end,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.name_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.name_nilreason || ')') as name,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.serialnumber_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.serialnumber_nilreason || ')') as serialnumber,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.dualchannel_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.dualchannel_nilreason || ')') as dualchannel,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.movingtargetindicator_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.movingtargetindicator_nilreason || ')') as movingtargetindicator,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.standbypower_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.standbypower_nilreason || ')') as standbypower,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.digital_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.digital_nilreason || ')') as digital,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.militaryuseonly_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.militaryuseonly_nilreason || ')') as militaryuseonly,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.specialuseonly_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.specialuseonly_nilreason || ')') as specialuseonly,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.specialaircraftonly_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.specialaircraftonly_nilreason || ')') as specialaircraftonly,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.magneticvariation_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.magneticvariationaccuracy_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.datemagneticvariation_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.verticalcoverageazimuth_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.verticalcoverageazimuth_nilreason || ')') as verticalcoverageazimuth,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.antennatiltfixed_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.antennatiltfixed_nilreason || ')') as antennatiltfixed,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.tiltangle_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.tiltangle_nilreason || ')') as tiltangle,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.automatedradarterminalsystem_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.automatedradarterminalsystem_nilreason || ')') as automatedradarterminalsystem,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.transponder_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.transponder_nilreason || ')') as transponder,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.autonomous_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.autonomous_nilreason || ')') as autonomous,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.monopulse_value as varchar), '(' || surveillance.secondarysurveillanceradar_ts.monopulse_nilreason || ')') as monopulse,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.range_value as varchar) || ' ' || surveillance.secondarysurveillanceradar_ts.range_uom, '(' || surveillance.secondarysurveillanceradar_ts.range_nilreason || ')') as range,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.rangeaccuracy_value as varchar) || ' ' || surveillance.secondarysurveillanceradar_ts.rangeaccuracy_uom, '(' || surveillance.secondarysurveillanceradar_ts.rangeaccuracy_nilreason || ')') as rangeaccuracy,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.verticalcoveragealtitude_value as varchar) || ' ' || surveillance.secondarysurveillanceradar_ts.verticalcoveragealtitude_uom, '(' || surveillance.secondarysurveillanceradar_ts.verticalcoveragealtitude_nilreason || ')') as verticalcoveragealtitude,
    coalesce(cast(surveillance.secondarysurveillanceradar_ts.verticalcoveragedistance_value as varchar) || ' ' || surveillance.secondarysurveillanceradar_ts.verticalcoveragedistance_uom, '(' || surveillance.secondarysurveillanceradar_ts.verticalcoveragedistance_nilreason || ')') as verticalcoveragedistance,
    geometry_elevatedpoint_view_aqzgxf.geom AS geom,
    ST_X(geometry_elevatedpoint_view_aqzgxf.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_aqzgxf.geom) AS latitude,
    geometry_elevatedpoint_view_aqzgxf.elevation,
    geometry_elevatedpoint_view_aqzgxf.geoidUndulation,
    geometry_elevatedpoint_view_aqzgxf.verticalDatum,
    geometry_elevatedpoint_view_aqzgxf.verticalAccuracy,
    geometry_elevatedpoint_view_aqzgxf.horizontalAccuracy,
    jsonb_agg(notes_note_view_xrzzjc.*) AS secondarysurveillanceradar_annotation,
    jsonb_agg(surveillance_surveillancegroundstation_view_mdswpq.id) AS groundstation
from surveillance.secondarysurveillanceradar 
inner join master_join mj2 on surveillance.secondarysurveillanceradar.id = mj2.source_id
inner join surveillance.secondarysurveillanceradar_tsp on mj2.target_id = surveillance.secondarysurveillanceradar_tsp.id
inner join surveillance.secondarysurveillanceradar_ts on surveillance.secondarysurveillanceradar_tsp.secondarysurveillanceradartimeslice_id = surveillance.secondarysurveillanceradar_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_aqzgxf on surveillance.secondarysurveillanceradar_ts.location_id = geometry_elevatedpoint_view_aqzgxf.id
left join master_join master_join_zsthzu on surveillance.secondarysurveillanceradar_ts.id = master_join_zsthzu.source_id
left join shared.contactinformation_view shared_contactinformation_view_tbikrf on master_join_zsthzu.target_id = shared_contactinformation_view_tbikrf.id
left join master_join master_join_ivhfme on surveillance.secondarysurveillanceradar_ts.id = master_join_ivhfme.source_id
left join notes.note_view notes_note_view_xrzzjc on master_join_ivhfme.target_id = notes_note_view_xrzzjc.id
left join master_join master_join_zpgiyk on surveillance.secondarysurveillanceradar_ts.id = master_join_zpgiyk.source_id
left join surveillance.surveillancegroundstation_view surveillance_surveillancegroundstation_view_mdswpq on master_join_zpgiyk.target_id = surveillance_surveillancegroundstation_view_mdswpq.id
where surveillance.secondarysurveillanceradar.feature_status = 'APPROVED'
  and surveillance.secondarysurveillanceradar_ts.feature_status = 'APPROVED'
group by
    surveillance.secondarysurveillanceradar.id,
    surveillance.secondarysurveillanceradar_ts.id,
    surveillance.secondarysurveillanceradar_tsp.id,
    surveillance.secondarysurveillanceradar.identifier,
    surveillance.secondarysurveillanceradar_ts.interpretation,
    surveillance.secondarysurveillanceradar_ts.sequence_number,
    surveillance.secondarysurveillanceradar_ts.correction_number,
    surveillance.secondarysurveillanceradar_ts.valid_time_begin,
    surveillance.secondarysurveillanceradar_ts.valid_time_end,
    surveillance.secondarysurveillanceradar_ts.feature_lifetime_begin,
    surveillance.secondarysurveillanceradar_ts.feature_lifetime_end,
    surveillance.secondarysurveillanceradar_ts.name_value,
    surveillance.secondarysurveillanceradar_ts.name_nilreason,
    surveillance.secondarysurveillanceradar_ts.serialnumber_value,
    surveillance.secondarysurveillanceradar_ts.serialnumber_nilreason,
    surveillance.secondarysurveillanceradar_ts.dualchannel_value,
    surveillance.secondarysurveillanceradar_ts.dualchannel_nilreason,
    surveillance.secondarysurveillanceradar_ts.movingtargetindicator_value,
    surveillance.secondarysurveillanceradar_ts.movingtargetindicator_nilreason,
    surveillance.secondarysurveillanceradar_ts.standbypower_value,
    surveillance.secondarysurveillanceradar_ts.standbypower_nilreason,
    surveillance.secondarysurveillanceradar_ts.digital_value,
    surveillance.secondarysurveillanceradar_ts.digital_nilreason,
    surveillance.secondarysurveillanceradar_ts.militaryuseonly_value,
    surveillance.secondarysurveillanceradar_ts.militaryuseonly_nilreason,
    surveillance.secondarysurveillanceradar_ts.specialuseonly_value,
    surveillance.secondarysurveillanceradar_ts.specialuseonly_nilreason,
    surveillance.secondarysurveillanceradar_ts.specialaircraftonly_value,
    surveillance.secondarysurveillanceradar_ts.specialaircraftonly_nilreason,
    surveillance.secondarysurveillanceradar_ts.magneticvariation_value,
    surveillance.secondarysurveillanceradar_ts.magneticvariation_nilreason,
    surveillance.secondarysurveillanceradar_ts.magneticvariationaccuracy_value,
    surveillance.secondarysurveillanceradar_ts.magneticvariationaccuracy_nilreason,
    surveillance.secondarysurveillanceradar_ts.datemagneticvariation_value,
    surveillance.secondarysurveillanceradar_ts.datemagneticvariation_nilreason,
    surveillance.secondarysurveillanceradar_ts.verticalcoverageazimuth_value,
    surveillance.secondarysurveillanceradar_ts.verticalcoverageazimuth_nilreason,
    surveillance.secondarysurveillanceradar_ts.antennatiltfixed_value,
    surveillance.secondarysurveillanceradar_ts.antennatiltfixed_nilreason,
    surveillance.secondarysurveillanceradar_ts.tiltangle_value,
    surveillance.secondarysurveillanceradar_ts.tiltangle_nilreason,
    surveillance.secondarysurveillanceradar_ts.automatedradarterminalsystem_value,
    surveillance.secondarysurveillanceradar_ts.automatedradarterminalsystem_nilreason,
    surveillance.secondarysurveillanceradar_ts.transponder_value,
    surveillance.secondarysurveillanceradar_ts.transponder_nilreason,
    surveillance.secondarysurveillanceradar_ts.autonomous_value,
    surveillance.secondarysurveillanceradar_ts.autonomous_nilreason,
    surveillance.secondarysurveillanceradar_ts.monopulse_value,
    surveillance.secondarysurveillanceradar_ts.monopulse_nilreason,
    surveillance.secondarysurveillanceradar_ts.range_value,
    surveillance.secondarysurveillanceradar_ts.range_uom,
    surveillance.secondarysurveillanceradar_ts.range_nilreason,
    surveillance.secondarysurveillanceradar_ts.rangeaccuracy_value,
    surveillance.secondarysurveillanceradar_ts.rangeaccuracy_uom,
    surveillance.secondarysurveillanceradar_ts.rangeaccuracy_nilreason,
    surveillance.secondarysurveillanceradar_ts.verticalcoveragealtitude_value,
    surveillance.secondarysurveillanceradar_ts.verticalcoveragealtitude_uom,
    surveillance.secondarysurveillanceradar_ts.verticalcoveragealtitude_nilreason,
    surveillance.secondarysurveillanceradar_ts.verticalcoveragedistance_value,
    surveillance.secondarysurveillanceradar_ts.verticalcoveragedistance_uom,
    surveillance.secondarysurveillanceradar_ts.verticalcoveragedistance_nilreason,
    geometry_elevatedpoint_view_aqzgxf.geom,
    geometry_elevatedpoint_view_aqzgxf.elevation,
    geometry_elevatedpoint_view_aqzgxf.geoidUndulation,
    geometry_elevatedpoint_view_aqzgxf.verticalDatum,
    geometry_elevatedpoint_view_aqzgxf.verticalAccuracy,
    geometry_elevatedpoint_view_aqzgxf.horizontalAccuracy
order by secondarysurveillanceradar.identifier, secondarysurveillanceradar_ts.sequence_number, secondarysurveillanceradar_ts.correction_number DESC;
-- SignificantPointInAirspaceTimeSliceType
-- ['geometry.point_view', 'notes.note_view']
create or replace view navaids_points.significantpointinairspace_view as
select distinct on (significantpointinairspace.identifier,significantpointinairspace_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.significantpointinairspace.id,
    navaids_points.significantpointinairspace_ts.id as ts_id,
    navaids_points.significantpointinairspace_tsp.id as tsp_id,
    navaids_points.significantpointinairspace.identifier,
    navaids_points.significantpointinairspace_ts.interpretation,
    navaids_points.significantpointinairspace_ts.sequence_number,
    navaids_points.significantpointinairspace_ts.correction_number,
    navaids_points.significantpointinairspace_ts.valid_time_begin,
    navaids_points.significantpointinairspace_ts.valid_time_end,
    navaids_points.significantpointinairspace_ts.feature_lifetime_begin,
    navaids_points.significantpointinairspace_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.significantpointinairspace_ts.type_value as varchar), '(' || navaids_points.significantpointinairspace_ts.type_nilreason || ')') as type,
    coalesce(cast(navaids_points.significantpointinairspace_ts.relativelocation_value as varchar), '(' || navaids_points.significantpointinairspace_ts.relativelocation_nilreason || ')') as relativelocation,
    coalesce(cast(airspace_airspace_pt_dzwxkf.title as varchar), '(' || airspace_airspace_pt_dzwxkf.nilreason[1] || ')') AS containingairspace,
    airspace_airspace_pt_dzwxkf.href AS containingairspace_href,
    coalesce(cast(navaids_points_designatedpoint_pt_egyius.title as varchar), '(' || navaids_points_designatedpoint_pt_egyius.nilreason[1] || ')') AS locationfixdesignatedpoint,
    navaids_points_designatedpoint_pt_egyius.href AS locationfixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_hmtoem.title as varchar), '(' || navaids_points_navaid_pt_hmtoem.nilreason[1] || ')') AS locationnavaidsystem,
    navaids_points_navaid_pt_hmtoem.href AS locationnavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_lutdbq.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_lutdbq.nilreason[1] || ')') AS locationaimingpoint,
    airport_heliport_touchdownliftoff_pt_lutdbq.href AS locationaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_xwoajb.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_xwoajb.nilreason[1] || ')') AS locationrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_xwoajb.href AS locationrunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_fszedb.title as varchar), '(' || airport_heliport_airportheliport_pt_fszedb.nilreason[1] || ')') AS locationairportreferencepoint,
    airport_heliport_airportheliport_pt_fszedb.href AS locationairportreferencepoint_href,
    geometry_point_view_mdhjtm.geom AS geom,
    ST_X(geometry_point_view_mdhjtm.geom) AS longitude,
    ST_Y(geometry_point_view_mdhjtm.geom) AS latitude,
    geometry_point_view_mdhjtm.horizontalAccuracy,
    jsonb_agg(notes_note_view_lucrvx.*) AS significantpointinairspace_annotation
from navaids_points.significantpointinairspace 
inner join master_join mj2 on navaids_points.significantpointinairspace.id = mj2.source_id
inner join navaids_points.significantpointinairspace_tsp on mj2.target_id = navaids_points.significantpointinairspace_tsp.id
inner join navaids_points.significantpointinairspace_ts on navaids_points.significantpointinairspace_tsp.significantpointinairspacetimeslice_id = navaids_points.significantpointinairspace_ts.id
left join airspace.airspace_pt airspace_airspace_pt_dzwxkf on navaids_points.significantpointinairspace_ts.containingairspace_id = airspace_airspace_pt_dzwxkf.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_egyius on navaids_points.significantpointinairspace_ts.location_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_egyius.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_hmtoem on navaids_points.significantpointinairspace_ts.location_navaidsystem_id = navaids_points_navaid_pt_hmtoem.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_lutdbq on navaids_points.significantpointinairspace_ts.location_aimingpoint_id = airport_heliport_touchdownliftoff_pt_lutdbq.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_xwoajb on navaids_points.significantpointinairspace_ts.location_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_xwoajb.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_fszedb on navaids_points.significantpointinairspace_ts.location_airportreferencepoint_id = airport_heliport_airportheliport_pt_fszedb.id
left join geometry.point_view geometry_point_view_mdhjtm on navaids_points.significantpointinairspace_ts.location_position_id = geometry_point_view_mdhjtm.id
left join master_join master_join_nshuwx on navaids_points.significantpointinairspace_ts.id = master_join_nshuwx.source_id
left join notes.note_view notes_note_view_lucrvx on master_join_nshuwx.target_id = notes_note_view_lucrvx.id
where navaids_points.significantpointinairspace.feature_status = 'APPROVED'
  and navaids_points.significantpointinairspace_ts.feature_status = 'APPROVED'
group by
    navaids_points.significantpointinairspace.id,
    navaids_points.significantpointinairspace_ts.id,
    navaids_points.significantpointinairspace_tsp.id,
    navaids_points.significantpointinairspace.identifier,
    navaids_points.significantpointinairspace_ts.interpretation,
    navaids_points.significantpointinairspace_ts.sequence_number,
    navaids_points.significantpointinairspace_ts.correction_number,
    navaids_points.significantpointinairspace_ts.valid_time_begin,
    navaids_points.significantpointinairspace_ts.valid_time_end,
    navaids_points.significantpointinairspace_ts.feature_lifetime_begin,
    navaids_points.significantpointinairspace_ts.feature_lifetime_end,
    navaids_points.significantpointinairspace_ts.type_value,
    navaids_points.significantpointinairspace_ts.type_nilreason,
    navaids_points.significantpointinairspace_ts.relativelocation_value,
    navaids_points.significantpointinairspace_ts.relativelocation_nilreason,
    airspace_airspace_pt_dzwxkf.title,
    airspace_airspace_pt_dzwxkf.nilreason[1],
    airspace_airspace_pt_dzwxkf.href,
    navaids_points_designatedpoint_pt_egyius.title,
    navaids_points_designatedpoint_pt_egyius.nilreason[1],
    navaids_points_designatedpoint_pt_egyius.href,
    navaids_points_navaid_pt_hmtoem.title,
    navaids_points_navaid_pt_hmtoem.nilreason[1],
    navaids_points_navaid_pt_hmtoem.href,
    airport_heliport_touchdownliftoff_pt_lutdbq.title,
    airport_heliport_touchdownliftoff_pt_lutdbq.nilreason[1],
    airport_heliport_touchdownliftoff_pt_lutdbq.href,
    airport_heliport_runwaycentrelinepoint_pt_xwoajb.title,
    airport_heliport_runwaycentrelinepoint_pt_xwoajb.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_xwoajb.href,
    airport_heliport_airportheliport_pt_fszedb.title,
    airport_heliport_airportheliport_pt_fszedb.nilreason[1],
    airport_heliport_airportheliport_pt_fszedb.href,
    geometry_point_view_mdhjtm.geom,
    geometry_point_view_mdhjtm.horizontalAccuracy
order by significantpointinairspace.identifier, significantpointinairspace_ts.sequence_number, significantpointinairspace_ts.correction_number DESC;
-- SpecialDateTimeSliceType
-- ['notes.note_view']
create or replace view shared.specialdate_view as
select distinct on (specialdate.identifier,specialdate_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    shared.specialdate.id,
    shared.specialdate_ts.id as ts_id,
    shared.specialdate_tsp.id as tsp_id,
    shared.specialdate.identifier,
    shared.specialdate_ts.interpretation,
    shared.specialdate_ts.sequence_number,
    shared.specialdate_ts.correction_number,
    shared.specialdate_ts.valid_time_begin,
    shared.specialdate_ts.valid_time_end,
    shared.specialdate_ts.feature_lifetime_begin,
    shared.specialdate_ts.feature_lifetime_end,
    coalesce(cast(shared.specialdate_ts.type_value as varchar), '(' || shared.specialdate_ts.type_nilreason || ')') as type,
    coalesce(cast(shared.specialdate_ts.dateday_value as varchar), '(' || shared.specialdate_ts.dateday_nilreason || ')') as dateday,
    coalesce(cast(shared.specialdate_ts.dateyear_value as varchar), '(' || shared.specialdate_ts.dateyear_nilreason || ')') as dateyear,
    coalesce(cast(shared.specialdate_ts.name_value as varchar), '(' || shared.specialdate_ts.name_nilreason || ')') as name,
    coalesce(cast(organisation_organisationauthority_pt_hcswpu.title as varchar), '(' || organisation_organisationauthority_pt_hcswpu.nilreason[1] || ')') AS authority,
    organisation_organisationauthority_pt_hcswpu.href AS authority_href,
    jsonb_agg(notes_note_view_lbwxaa.*) AS specialdate_annotation
from shared.specialdate 
inner join master_join mj2 on shared.specialdate.id = mj2.source_id
inner join shared.specialdate_tsp on mj2.target_id = shared.specialdate_tsp.id
inner join shared.specialdate_ts on shared.specialdate_tsp.specialdatetimeslice_id = shared.specialdate_ts.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_hcswpu on shared.specialdate_ts.authority_id = organisation_organisationauthority_pt_hcswpu.id
left join master_join master_join_yeafyf on shared.specialdate_ts.id = master_join_yeafyf.source_id
left join notes.note_view notes_note_view_lbwxaa on master_join_yeafyf.target_id = notes_note_view_lbwxaa.id
where shared.specialdate.feature_status = 'APPROVED'
  and shared.specialdate_ts.feature_status = 'APPROVED'
group by
    shared.specialdate.id,
    shared.specialdate_ts.id,
    shared.specialdate_tsp.id,
    shared.specialdate.identifier,
    shared.specialdate_ts.interpretation,
    shared.specialdate_ts.sequence_number,
    shared.specialdate_ts.correction_number,
    shared.specialdate_ts.valid_time_begin,
    shared.specialdate_ts.valid_time_end,
    shared.specialdate_ts.feature_lifetime_begin,
    shared.specialdate_ts.feature_lifetime_end,
    shared.specialdate_ts.type_value,
    shared.specialdate_ts.type_nilreason,
    shared.specialdate_ts.dateday_value,
    shared.specialdate_ts.dateday_nilreason,
    shared.specialdate_ts.dateyear_value,
    shared.specialdate_ts.dateyear_nilreason,
    shared.specialdate_ts.name_value,
    shared.specialdate_ts.name_nilreason,
    organisation_organisationauthority_pt_hcswpu.title,
    organisation_organisationauthority_pt_hcswpu.nilreason[1],
    organisation_organisationauthority_pt_hcswpu.href
order by specialdate.identifier, specialdate_ts.sequence_number, specialdate_ts.correction_number DESC;
-- SpecialNavigationStationTimeSliceType
-- ['notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.specialnavigationstationstatus_view']
create or replace view navaids_points.specialnavigationstation_view as
select distinct on (specialnavigationstation.identifier,specialnavigationstation_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.specialnavigationstation.id,
    navaids_points.specialnavigationstation_ts.id as ts_id,
    navaids_points.specialnavigationstation_tsp.id as tsp_id,
    navaids_points.specialnavigationstation.identifier,
    navaids_points.specialnavigationstation_ts.interpretation,
    navaids_points.specialnavigationstation_ts.sequence_number,
    navaids_points.specialnavigationstation_ts.correction_number,
    navaids_points.specialnavigationstation_ts.valid_time_begin,
    navaids_points.specialnavigationstation_ts.valid_time_end,
    navaids_points.specialnavigationstation_ts.feature_lifetime_begin,
    navaids_points.specialnavigationstation_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.specialnavigationstation_ts.name_value as varchar), '(' || navaids_points.specialnavigationstation_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.specialnavigationstation_ts.type_value as varchar), '(' || navaids_points.specialnavigationstation_ts.type_nilreason || ')') as type,
    coalesce(cast(navaids_points.specialnavigationstation_ts.emission_value as varchar), '(' || navaids_points.specialnavigationstation_ts.emission_nilreason || ')') as emission,
    coalesce(cast(navaids_points.specialnavigationstation_ts.frequency_value as varchar) || ' ' || navaids_points.specialnavigationstation_ts.frequency_uom, '(' || navaids_points.specialnavigationstation_ts.frequency_nilreason || ')') as frequency,
    coalesce(cast(navaids_points_specialnavigationsystem_pt_akvrmc.title as varchar), '(' || navaids_points_specialnavigationsystem_pt_akvrmc.nilreason[1] || ')') AS systemchain,
    navaids_points_specialnavigationsystem_pt_akvrmc.href AS systemchain_href,
    coalesce(cast(navaids_points_authorityforspecialnavigationstation_pt_xbdewd.title as varchar), '(' || navaids_points_authorityforspecialnavigationstation_pt_xbdewd.nilreason[1] || ')') AS responsibleorganisation,
    navaids_points_authorityforspecialnavigationstation_pt_xbdewd.href AS responsibleorganisation_href,
    geometry_elevatedpoint_view_mkbxow.geom AS geom,
    ST_X(geometry_elevatedpoint_view_mkbxow.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_mkbxow.geom) AS latitude,
    geometry_elevatedpoint_view_mkbxow.elevation,
    geometry_elevatedpoint_view_mkbxow.geoidUndulation,
    geometry_elevatedpoint_view_mkbxow.verticalDatum,
    geometry_elevatedpoint_view_mkbxow.verticalAccuracy,
    geometry_elevatedpoint_view_mkbxow.horizontalAccuracy,
    jsonb_agg(navaids_points_specialnavigationstationstatus_view_nscnje.id) AS availability,
    jsonb_agg(notes_note_view_sjkflk.*) AS specialnavigationstation_annotation
from navaids_points.specialnavigationstation 
inner join master_join mj2 on navaids_points.specialnavigationstation.id = mj2.source_id
inner join navaids_points.specialnavigationstation_tsp on mj2.target_id = navaids_points.specialnavigationstation_tsp.id
inner join navaids_points.specialnavigationstation_ts on navaids_points.specialnavigationstation_tsp.specialnavigationstationtimeslice_id = navaids_points.specialnavigationstation_ts.id
left join navaids_points.specialnavigationsystem_pt navaids_points_specialnavigationsystem_pt_akvrmc on navaids_points.specialnavigationstation_ts.systemchain_id = navaids_points_specialnavigationsystem_pt_akvrmc.id
left join navaids_points.authorityforspecialnavigationstation_pt navaids_points_authorityforspecialnavigationstation_pt_xbdewd on navaids_points.specialnavigationstation_ts.responsibleorganisation_id = navaids_points_authorityforspecialnavigationstation_pt_xbdewd.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_mkbxow on navaids_points.specialnavigationstation_ts.position_id = geometry_elevatedpoint_view_mkbxow.id
left join master_join master_join_tqqkto on navaids_points.specialnavigationstation_ts.id = master_join_tqqkto.source_id
left join navaids_points.specialnavigationstationstatus_view navaids_points_specialnavigationstationstatus_view_nscnje on master_join_tqqkto.target_id = navaids_points_specialnavigationstationstatus_view_nscnje.id
left join master_join master_join_psatig on navaids_points.specialnavigationstation_ts.id = master_join_psatig.source_id
left join notes.note_view notes_note_view_sjkflk on master_join_psatig.target_id = notes_note_view_sjkflk.id
where navaids_points.specialnavigationstation.feature_status = 'APPROVED'
  and navaids_points.specialnavigationstation_ts.feature_status = 'APPROVED'
group by
    navaids_points.specialnavigationstation.id,
    navaids_points.specialnavigationstation_ts.id,
    navaids_points.specialnavigationstation_tsp.id,
    navaids_points.specialnavigationstation.identifier,
    navaids_points.specialnavigationstation_ts.interpretation,
    navaids_points.specialnavigationstation_ts.sequence_number,
    navaids_points.specialnavigationstation_ts.correction_number,
    navaids_points.specialnavigationstation_ts.valid_time_begin,
    navaids_points.specialnavigationstation_ts.valid_time_end,
    navaids_points.specialnavigationstation_ts.feature_lifetime_begin,
    navaids_points.specialnavigationstation_ts.feature_lifetime_end,
    navaids_points.specialnavigationstation_ts.name_value,
    navaids_points.specialnavigationstation_ts.name_nilreason,
    navaids_points.specialnavigationstation_ts.type_value,
    navaids_points.specialnavigationstation_ts.type_nilreason,
    navaids_points.specialnavigationstation_ts.emission_value,
    navaids_points.specialnavigationstation_ts.emission_nilreason,
    navaids_points.specialnavigationstation_ts.frequency_value,
    navaids_points.specialnavigationstation_ts.frequency_uom,
    navaids_points.specialnavigationstation_ts.frequency_nilreason,
    navaids_points_specialnavigationsystem_pt_akvrmc.title,
    navaids_points_specialnavigationsystem_pt_akvrmc.nilreason[1],
    navaids_points_specialnavigationsystem_pt_akvrmc.href,
    navaids_points_authorityforspecialnavigationstation_pt_xbdewd.title,
    navaids_points_authorityforspecialnavigationstation_pt_xbdewd.nilreason[1],
    navaids_points_authorityforspecialnavigationstation_pt_xbdewd.href,
    geometry_elevatedpoint_view_mkbxow.geom,
    geometry_elevatedpoint_view_mkbxow.elevation,
    geometry_elevatedpoint_view_mkbxow.geoidUndulation,
    geometry_elevatedpoint_view_mkbxow.verticalDatum,
    geometry_elevatedpoint_view_mkbxow.verticalAccuracy,
    geometry_elevatedpoint_view_mkbxow.horizontalAccuracy
order by specialnavigationstation.identifier, specialnavigationstation_ts.sequence_number, specialnavigationstation_ts.correction_number DESC;
-- SpecialNavigationSystemTimeSliceType
-- ['notes.note_view']
create or replace view navaids_points.specialnavigationsystem_view as
select distinct on (specialnavigationsystem.identifier,specialnavigationsystem_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.specialnavigationsystem.id,
    navaids_points.specialnavigationsystem_ts.id as ts_id,
    navaids_points.specialnavigationsystem_tsp.id as tsp_id,
    navaids_points.specialnavigationsystem.identifier,
    navaids_points.specialnavigationsystem_ts.interpretation,
    navaids_points.specialnavigationsystem_ts.sequence_number,
    navaids_points.specialnavigationsystem_ts.correction_number,
    navaids_points.specialnavigationsystem_ts.valid_time_begin,
    navaids_points.specialnavigationsystem_ts.valid_time_end,
    navaids_points.specialnavigationsystem_ts.feature_lifetime_begin,
    navaids_points.specialnavigationsystem_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.specialnavigationsystem_ts.type_value as varchar), '(' || navaids_points.specialnavigationsystem_ts.type_nilreason || ')') as type,
    coalesce(cast(navaids_points.specialnavigationsystem_ts.designator_value as varchar), '(' || navaids_points.specialnavigationsystem_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.specialnavigationsystem_ts.name_value as varchar), '(' || navaids_points.specialnavigationsystem_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points_authorityforspecialnavigationsystem_pt_nzueba.title as varchar), '(' || navaids_points_authorityforspecialnavigationsystem_pt_nzueba.nilreason[1] || ')') AS responsibleorganisation,
    navaids_points_authorityforspecialnavigationsystem_pt_nzueba.href AS responsibleorganisation_href,
    jsonb_agg(notes_note_view_ctgezo.*) AS specialnavigationsystem_annotation
from navaids_points.specialnavigationsystem 
inner join master_join mj2 on navaids_points.specialnavigationsystem.id = mj2.source_id
inner join navaids_points.specialnavigationsystem_tsp on mj2.target_id = navaids_points.specialnavigationsystem_tsp.id
inner join navaids_points.specialnavigationsystem_ts on navaids_points.specialnavigationsystem_tsp.specialnavigationsystemtimeslice_id = navaids_points.specialnavigationsystem_ts.id
left join navaids_points.authorityforspecialnavigationsystem_pt navaids_points_authorityforspecialnavigationsystem_pt_nzueba on navaids_points.specialnavigationsystem_ts.responsibleorganisation_id = navaids_points_authorityforspecialnavigationsystem_pt_nzueba.id
left join master_join master_join_myxphz on navaids_points.specialnavigationsystem_ts.id = master_join_myxphz.source_id
left join notes.note_view notes_note_view_ctgezo on master_join_myxphz.target_id = notes_note_view_ctgezo.id
where navaids_points.specialnavigationsystem.feature_status = 'APPROVED'
  and navaids_points.specialnavigationsystem_ts.feature_status = 'APPROVED'
group by
    navaids_points.specialnavigationsystem.id,
    navaids_points.specialnavigationsystem_ts.id,
    navaids_points.specialnavigationsystem_tsp.id,
    navaids_points.specialnavigationsystem.identifier,
    navaids_points.specialnavigationsystem_ts.interpretation,
    navaids_points.specialnavigationsystem_ts.sequence_number,
    navaids_points.specialnavigationsystem_ts.correction_number,
    navaids_points.specialnavigationsystem_ts.valid_time_begin,
    navaids_points.specialnavigationsystem_ts.valid_time_end,
    navaids_points.specialnavigationsystem_ts.feature_lifetime_begin,
    navaids_points.specialnavigationsystem_ts.feature_lifetime_end,
    navaids_points.specialnavigationsystem_ts.type_value,
    navaids_points.specialnavigationsystem_ts.type_nilreason,
    navaids_points.specialnavigationsystem_ts.designator_value,
    navaids_points.specialnavigationsystem_ts.designator_nilreason,
    navaids_points.specialnavigationsystem_ts.name_value,
    navaids_points.specialnavigationsystem_ts.name_nilreason,
    navaids_points_authorityforspecialnavigationsystem_pt_nzueba.title,
    navaids_points_authorityforspecialnavigationsystem_pt_nzueba.nilreason[1],
    navaids_points_authorityforspecialnavigationsystem_pt_nzueba.href
order by specialnavigationsystem.identifier, specialnavigationsystem_ts.sequence_number, specialnavigationsystem_ts.correction_number DESC;
-- StandardInstrumentArrivalTimeSliceType
-- ['procedure.proceduretransition_view', 'notes.note_view', 'procedure.procedureavailability_view', 'shared.aircraftcharacteristic_view']
create or replace view procedure.standardinstrumentarrival_view as
select distinct on (standardinstrumentarrival.identifier,standardinstrumentarrival_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.standardinstrumentarrival.id,
    procedure.standardinstrumentarrival_ts.id as ts_id,
    procedure.standardinstrumentarrival_tsp.id as tsp_id,
    procedure.standardinstrumentarrival.identifier,
    procedure.standardinstrumentarrival_ts.interpretation,
    procedure.standardinstrumentarrival_ts.sequence_number,
    procedure.standardinstrumentarrival_ts.correction_number,
    procedure.standardinstrumentarrival_ts.valid_time_begin,
    procedure.standardinstrumentarrival_ts.valid_time_end,
    procedure.standardinstrumentarrival_ts.feature_lifetime_begin,
    procedure.standardinstrumentarrival_ts.feature_lifetime_end,
    coalesce(cast(procedure.standardinstrumentarrival_ts.communicationfailureinstruction_value as varchar), '(' || procedure.standardinstrumentarrival_ts.communicationfailureinstruction_nilreason || ')') as communicationfailureinstruction,
    coalesce(cast(procedure.standardinstrumentarrival_ts.instruction_value as varchar), '(' || procedure.standardinstrumentarrival_ts.instruction_nilreason || ')') as instruction,
    coalesce(cast(procedure.standardinstrumentarrival_ts.designcriteria_value as varchar), '(' || procedure.standardinstrumentarrival_ts.designcriteria_nilreason || ')') as designcriteria,
    coalesce(cast(procedure.standardinstrumentarrival_ts.codingstandard_value as varchar), '(' || procedure.standardinstrumentarrival_ts.codingstandard_nilreason || ')') as codingstandard,
    coalesce(cast(procedure.standardinstrumentarrival_ts.flightchecked_value as varchar), '(' || procedure.standardinstrumentarrival_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(procedure.standardinstrumentarrival_ts.name_value as varchar), '(' || procedure.standardinstrumentarrival_ts.name_nilreason || ')') as name,
    coalesce(cast(procedure.standardinstrumentarrival_ts.rnav_value as varchar), '(' || procedure.standardinstrumentarrival_ts.rnav_nilreason || ')') as rnav,
    coalesce(cast(procedure.standardinstrumentarrival_ts.designator_value as varchar), '(' || procedure.standardinstrumentarrival_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points_navaid_pt_scdldu.title as varchar), '(' || navaids_points_navaid_pt_scdldu.nilreason[1] || ')') AS guidancefacilitynavaid,
    navaids_points_navaid_pt_scdldu.href AS guidancefacilitynavaid_href,
    coalesce(cast(navaids_points_specialnavigationsystem_pt_lulzoh.title as varchar), '(' || navaids_points_specialnavigationsystem_pt_lulzoh.nilreason[1] || ')') AS guidancefacilityspecialnavigationsystem,
    navaids_points_specialnavigationsystem_pt_lulzoh.href AS guidancefacilityspecialnavigationsystem_href,
    coalesce(cast(surveillance_radarsystem_pt_cjmddn.title as varchar), '(' || surveillance_radarsystem_pt_cjmddn.nilreason[1] || ')') AS guidancefacilityradar,
    surveillance_radarsystem_pt_cjmddn.href AS guidancefacilityradar_href,
    coalesce(cast(procedure_safealtitudearea_pt_pfaogi.title as varchar), '(' || procedure_safealtitudearea_pt_pfaogi.nilreason[1] || ')') AS safealtitude,
    procedure_safealtitudearea_pt_pfaogi.href AS safealtitude_href,
    coalesce(cast(procedure_landingtakeoffareacollection_pt_uvstzz.title as varchar), '(' || procedure_landingtakeoffareacollection_pt_uvstzz.nilreason[1] || ')') AS arrival,
    procedure_landingtakeoffareacollection_pt_uvstzz.href AS arrival_href,
    jsonb_agg(procedure_procedureavailability_view_wofyji.id) AS availability,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_qkdqal.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_qkdqal.title AS varchar), '(' || airport_heliport_airportheliport_pt_qkdqal.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_qkdqal.href) AS airportheliport,
    jsonb_agg(shared_aircraftcharacteristic_view_bjmdmw.id) AS aircraftcharacteristic,
    jsonb_agg(procedure_proceduretransition_view_vwjjai.id) AS flighttransition,
    jsonb_agg(notes_note_view_yjwslw.*) AS standardinstrumentarrival_annotation
from procedure.standardinstrumentarrival 
inner join master_join mj2 on procedure.standardinstrumentarrival.id = mj2.source_id
inner join procedure.standardinstrumentarrival_tsp on mj2.target_id = procedure.standardinstrumentarrival_tsp.id
inner join procedure.standardinstrumentarrival_ts on procedure.standardinstrumentarrival_tsp.standardinstrumentarrivaltimeslice_id = procedure.standardinstrumentarrival_ts.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_scdldu on procedure.standardinstrumentarrival_ts.guidancefacility_navaid_id = navaids_points_navaid_pt_scdldu.id
left join navaids_points.specialnavigationsystem_pt navaids_points_specialnavigationsystem_pt_lulzoh on procedure.standardinstrumentarrival_ts.guidancefacility_specialnavigationsystem_id = navaids_points_specialnavigationsystem_pt_lulzoh.id
left join surveillance.radarsystem_pt surveillance_radarsystem_pt_cjmddn on procedure.standardinstrumentarrival_ts.guidancefacility_radar_id = surveillance_radarsystem_pt_cjmddn.id
left join procedure.safealtitudearea_pt procedure_safealtitudearea_pt_pfaogi on procedure.standardinstrumentarrival_ts.safealtitude_id = procedure_safealtitudearea_pt_pfaogi.id
left join procedure.landingtakeoffareacollection_pt procedure_landingtakeoffareacollection_pt_uvstzz on procedure.standardinstrumentarrival_ts.arrival_id = procedure_landingtakeoffareacollection_pt_uvstzz.id
left join master_join master_join_eqngot on procedure.standardinstrumentarrival_ts.id = master_join_eqngot.source_id
left join procedure.procedureavailability_view procedure_procedureavailability_view_wofyji on master_join_eqngot.target_id = procedure_procedureavailability_view_wofyji.id
left join master_join master_join_lmznoe on procedure.standardinstrumentarrival_ts.id = master_join_lmznoe.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_qkdqal on master_join_lmznoe.target_id = airport_heliport_airportheliport_pt_qkdqal.id
left join master_join master_join_lflbui on procedure.standardinstrumentarrival_ts.id = master_join_lflbui.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_bjmdmw on master_join_lflbui.target_id = shared_aircraftcharacteristic_view_bjmdmw.id
left join master_join master_join_waptzw on procedure.standardinstrumentarrival_ts.id = master_join_waptzw.source_id
left join procedure.proceduretransition_view procedure_proceduretransition_view_vwjjai on master_join_waptzw.target_id = procedure_proceduretransition_view_vwjjai.id
left join master_join master_join_rbskkb on procedure.standardinstrumentarrival_ts.id = master_join_rbskkb.source_id
left join notes.note_view notes_note_view_yjwslw on master_join_rbskkb.target_id = notes_note_view_yjwslw.id
where procedure.standardinstrumentarrival.feature_status = 'APPROVED'
  and procedure.standardinstrumentarrival_ts.feature_status = 'APPROVED'
group by
    procedure.standardinstrumentarrival.id,
    procedure.standardinstrumentarrival_ts.id,
    procedure.standardinstrumentarrival_tsp.id,
    procedure.standardinstrumentarrival.identifier,
    procedure.standardinstrumentarrival_ts.interpretation,
    procedure.standardinstrumentarrival_ts.sequence_number,
    procedure.standardinstrumentarrival_ts.correction_number,
    procedure.standardinstrumentarrival_ts.valid_time_begin,
    procedure.standardinstrumentarrival_ts.valid_time_end,
    procedure.standardinstrumentarrival_ts.feature_lifetime_begin,
    procedure.standardinstrumentarrival_ts.feature_lifetime_end,
    procedure.standardinstrumentarrival_ts.communicationfailureinstruction_value,
    procedure.standardinstrumentarrival_ts.communicationfailureinstruction_nilreason,
    procedure.standardinstrumentarrival_ts.instruction_value,
    procedure.standardinstrumentarrival_ts.instruction_nilreason,
    procedure.standardinstrumentarrival_ts.designcriteria_value,
    procedure.standardinstrumentarrival_ts.designcriteria_nilreason,
    procedure.standardinstrumentarrival_ts.codingstandard_value,
    procedure.standardinstrumentarrival_ts.codingstandard_nilreason,
    procedure.standardinstrumentarrival_ts.flightchecked_value,
    procedure.standardinstrumentarrival_ts.flightchecked_nilreason,
    procedure.standardinstrumentarrival_ts.name_value,
    procedure.standardinstrumentarrival_ts.name_nilreason,
    procedure.standardinstrumentarrival_ts.rnav_value,
    procedure.standardinstrumentarrival_ts.rnav_nilreason,
    procedure.standardinstrumentarrival_ts.designator_value,
    procedure.standardinstrumentarrival_ts.designator_nilreason,
    navaids_points_navaid_pt_scdldu.title,
    navaids_points_navaid_pt_scdldu.nilreason[1],
    navaids_points_navaid_pt_scdldu.href,
    navaids_points_specialnavigationsystem_pt_lulzoh.title,
    navaids_points_specialnavigationsystem_pt_lulzoh.nilreason[1],
    navaids_points_specialnavigationsystem_pt_lulzoh.href,
    surveillance_radarsystem_pt_cjmddn.title,
    surveillance_radarsystem_pt_cjmddn.nilreason[1],
    surveillance_radarsystem_pt_cjmddn.href,
    procedure_safealtitudearea_pt_pfaogi.title,
    procedure_safealtitudearea_pt_pfaogi.nilreason[1],
    procedure_safealtitudearea_pt_pfaogi.href,
    procedure_landingtakeoffareacollection_pt_uvstzz.title,
    procedure_landingtakeoffareacollection_pt_uvstzz.nilreason[1],
    procedure_landingtakeoffareacollection_pt_uvstzz.href
order by standardinstrumentarrival.identifier, standardinstrumentarrival_ts.sequence_number, standardinstrumentarrival_ts.correction_number DESC;
-- StandardInstrumentDepartureTimeSliceType
-- ['procedure.proceduretransition_view', 'notes.note_view', 'procedure.procedureavailability_view', 'shared.aircraftcharacteristic_view']
create or replace view procedure.standardinstrumentdeparture_view as
select distinct on (standardinstrumentdeparture.identifier,standardinstrumentdeparture_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.standardinstrumentdeparture.id,
    procedure.standardinstrumentdeparture_ts.id as ts_id,
    procedure.standardinstrumentdeparture_tsp.id as tsp_id,
    procedure.standardinstrumentdeparture.identifier,
    procedure.standardinstrumentdeparture_ts.interpretation,
    procedure.standardinstrumentdeparture_ts.sequence_number,
    procedure.standardinstrumentdeparture_ts.correction_number,
    procedure.standardinstrumentdeparture_ts.valid_time_begin,
    procedure.standardinstrumentdeparture_ts.valid_time_end,
    procedure.standardinstrumentdeparture_ts.feature_lifetime_begin,
    procedure.standardinstrumentdeparture_ts.feature_lifetime_end,
    coalesce(cast(procedure.standardinstrumentdeparture_ts.communicationfailureinstruction_value as varchar), '(' || procedure.standardinstrumentdeparture_ts.communicationfailureinstruction_nilreason || ')') as communicationfailureinstruction,
    coalesce(cast(procedure.standardinstrumentdeparture_ts.instruction_value as varchar), '(' || procedure.standardinstrumentdeparture_ts.instruction_nilreason || ')') as instruction,
    coalesce(cast(procedure.standardinstrumentdeparture_ts.designcriteria_value as varchar), '(' || procedure.standardinstrumentdeparture_ts.designcriteria_nilreason || ')') as designcriteria,
    coalesce(cast(procedure.standardinstrumentdeparture_ts.codingstandard_value as varchar), '(' || procedure.standardinstrumentdeparture_ts.codingstandard_nilreason || ')') as codingstandard,
    coalesce(cast(procedure.standardinstrumentdeparture_ts.flightchecked_value as varchar), '(' || procedure.standardinstrumentdeparture_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(procedure.standardinstrumentdeparture_ts.name_value as varchar), '(' || procedure.standardinstrumentdeparture_ts.name_nilreason || ')') as name,
    coalesce(cast(procedure.standardinstrumentdeparture_ts.rnav_value as varchar), '(' || procedure.standardinstrumentdeparture_ts.rnav_nilreason || ')') as rnav,
    coalesce(cast(procedure.standardinstrumentdeparture_ts.designator_value as varchar), '(' || procedure.standardinstrumentdeparture_ts.designator_nilreason || ')') as designator,
    coalesce(cast(procedure.standardinstrumentdeparture_ts.contingencyroute_value as varchar), '(' || procedure.standardinstrumentdeparture_ts.contingencyroute_nilreason || ')') as contingencyroute,
    coalesce(cast(navaids_points_navaid_pt_zgjsxh.title as varchar), '(' || navaids_points_navaid_pt_zgjsxh.nilreason[1] || ')') AS guidancefacilitynavaid,
    navaids_points_navaid_pt_zgjsxh.href AS guidancefacilitynavaid_href,
    coalesce(cast(navaids_points_specialnavigationsystem_pt_aripio.title as varchar), '(' || navaids_points_specialnavigationsystem_pt_aripio.nilreason[1] || ')') AS guidancefacilityspecialnavigationsystem,
    navaids_points_specialnavigationsystem_pt_aripio.href AS guidancefacilityspecialnavigationsystem_href,
    coalesce(cast(surveillance_radarsystem_pt_rxsjeq.title as varchar), '(' || surveillance_radarsystem_pt_rxsjeq.nilreason[1] || ')') AS guidancefacilityradar,
    surveillance_radarsystem_pt_rxsjeq.href AS guidancefacilityradar_href,
    coalesce(cast(procedure_safealtitudearea_pt_pxbdca.title as varchar), '(' || procedure_safealtitudearea_pt_pxbdca.nilreason[1] || ')') AS safealtitude,
    procedure_safealtitudearea_pt_pxbdca.href AS safealtitude_href,
    coalesce(cast(procedure_landingtakeoffareacollection_pt_oyqdyr.title as varchar), '(' || procedure_landingtakeoffareacollection_pt_oyqdyr.nilreason[1] || ')') AS takeoff,
    procedure_landingtakeoffareacollection_pt_oyqdyr.href AS takeoff_href,
    jsonb_agg(procedure_procedureavailability_view_mornjw.id) AS availability,
    jsonb_build_object('id', airport_heliport_airportheliport_pt_ubbywr.id,
    'title', coalesce(cast(airport_heliport_airportheliport_pt_ubbywr.title AS varchar), '(' || airport_heliport_airportheliport_pt_ubbywr.nilreason[1] || ')'),
    'href', airport_heliport_airportheliport_pt_ubbywr.href) AS airportheliport,
    jsonb_agg(shared_aircraftcharacteristic_view_knhatz.id) AS aircraftcharacteristic,
    jsonb_agg(procedure_proceduretransition_view_tjglvf.id) AS flighttransition,
    jsonb_agg(notes_note_view_qshmnv.*) AS standardinstrumentdeparture_annotation
from procedure.standardinstrumentdeparture 
inner join master_join mj2 on procedure.standardinstrumentdeparture.id = mj2.source_id
inner join procedure.standardinstrumentdeparture_tsp on mj2.target_id = procedure.standardinstrumentdeparture_tsp.id
inner join procedure.standardinstrumentdeparture_ts on procedure.standardinstrumentdeparture_tsp.standardinstrumentdeparturetimeslice_id = procedure.standardinstrumentdeparture_ts.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_zgjsxh on procedure.standardinstrumentdeparture_ts.guidancefacility_navaid_id = navaids_points_navaid_pt_zgjsxh.id
left join navaids_points.specialnavigationsystem_pt navaids_points_specialnavigationsystem_pt_aripio on procedure.standardinstrumentdeparture_ts.guidancefacility_specialnavigationsystem_id = navaids_points_specialnavigationsystem_pt_aripio.id
left join surveillance.radarsystem_pt surveillance_radarsystem_pt_rxsjeq on procedure.standardinstrumentdeparture_ts.guidancefacility_radar_id = surveillance_radarsystem_pt_rxsjeq.id
left join procedure.safealtitudearea_pt procedure_safealtitudearea_pt_pxbdca on procedure.standardinstrumentdeparture_ts.safealtitude_id = procedure_safealtitudearea_pt_pxbdca.id
left join procedure.landingtakeoffareacollection_pt procedure_landingtakeoffareacollection_pt_oyqdyr on procedure.standardinstrumentdeparture_ts.takeoff_id = procedure_landingtakeoffareacollection_pt_oyqdyr.id
left join master_join master_join_fgtolx on procedure.standardinstrumentdeparture_ts.id = master_join_fgtolx.source_id
left join procedure.procedureavailability_view procedure_procedureavailability_view_mornjw on master_join_fgtolx.target_id = procedure_procedureavailability_view_mornjw.id
left join master_join master_join_ccchxc on procedure.standardinstrumentdeparture_ts.id = master_join_ccchxc.source_id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_ubbywr on master_join_ccchxc.target_id = airport_heliport_airportheliport_pt_ubbywr.id
left join master_join master_join_bobsdi on procedure.standardinstrumentdeparture_ts.id = master_join_bobsdi.source_id
left join shared.aircraftcharacteristic_view shared_aircraftcharacteristic_view_knhatz on master_join_bobsdi.target_id = shared_aircraftcharacteristic_view_knhatz.id
left join master_join master_join_spcygc on procedure.standardinstrumentdeparture_ts.id = master_join_spcygc.source_id
left join procedure.proceduretransition_view procedure_proceduretransition_view_tjglvf on master_join_spcygc.target_id = procedure_proceduretransition_view_tjglvf.id
left join master_join master_join_pozvuv on procedure.standardinstrumentdeparture_ts.id = master_join_pozvuv.source_id
left join notes.note_view notes_note_view_qshmnv on master_join_pozvuv.target_id = notes_note_view_qshmnv.id
where procedure.standardinstrumentdeparture.feature_status = 'APPROVED'
  and procedure.standardinstrumentdeparture_ts.feature_status = 'APPROVED'
group by
    procedure.standardinstrumentdeparture.id,
    procedure.standardinstrumentdeparture_ts.id,
    procedure.standardinstrumentdeparture_tsp.id,
    procedure.standardinstrumentdeparture.identifier,
    procedure.standardinstrumentdeparture_ts.interpretation,
    procedure.standardinstrumentdeparture_ts.sequence_number,
    procedure.standardinstrumentdeparture_ts.correction_number,
    procedure.standardinstrumentdeparture_ts.valid_time_begin,
    procedure.standardinstrumentdeparture_ts.valid_time_end,
    procedure.standardinstrumentdeparture_ts.feature_lifetime_begin,
    procedure.standardinstrumentdeparture_ts.feature_lifetime_end,
    procedure.standardinstrumentdeparture_ts.communicationfailureinstruction_value,
    procedure.standardinstrumentdeparture_ts.communicationfailureinstruction_nilreason,
    procedure.standardinstrumentdeparture_ts.instruction_value,
    procedure.standardinstrumentdeparture_ts.instruction_nilreason,
    procedure.standardinstrumentdeparture_ts.designcriteria_value,
    procedure.standardinstrumentdeparture_ts.designcriteria_nilreason,
    procedure.standardinstrumentdeparture_ts.codingstandard_value,
    procedure.standardinstrumentdeparture_ts.codingstandard_nilreason,
    procedure.standardinstrumentdeparture_ts.flightchecked_value,
    procedure.standardinstrumentdeparture_ts.flightchecked_nilreason,
    procedure.standardinstrumentdeparture_ts.name_value,
    procedure.standardinstrumentdeparture_ts.name_nilreason,
    procedure.standardinstrumentdeparture_ts.rnav_value,
    procedure.standardinstrumentdeparture_ts.rnav_nilreason,
    procedure.standardinstrumentdeparture_ts.designator_value,
    procedure.standardinstrumentdeparture_ts.designator_nilreason,
    procedure.standardinstrumentdeparture_ts.contingencyroute_value,
    procedure.standardinstrumentdeparture_ts.contingencyroute_nilreason,
    navaids_points_navaid_pt_zgjsxh.title,
    navaids_points_navaid_pt_zgjsxh.nilreason[1],
    navaids_points_navaid_pt_zgjsxh.href,
    navaids_points_specialnavigationsystem_pt_aripio.title,
    navaids_points_specialnavigationsystem_pt_aripio.nilreason[1],
    navaids_points_specialnavigationsystem_pt_aripio.href,
    surveillance_radarsystem_pt_rxsjeq.title,
    surveillance_radarsystem_pt_rxsjeq.nilreason[1],
    surveillance_radarsystem_pt_rxsjeq.href,
    procedure_safealtitudearea_pt_pxbdca.title,
    procedure_safealtitudearea_pt_pxbdca.nilreason[1],
    procedure_safealtitudearea_pt_pxbdca.href,
    procedure_landingtakeoffareacollection_pt_oyqdyr.title,
    procedure_landingtakeoffareacollection_pt_oyqdyr.nilreason[1],
    procedure_landingtakeoffareacollection_pt_oyqdyr.href
order by standardinstrumentdeparture.identifier, standardinstrumentdeparture_ts.sequence_number, standardinstrumentdeparture_ts.correction_number DESC;
-- StandardLevelColumnTimeSliceType
-- ['shared.standardlevel_view', 'notes.note_view']
create or replace view shared.standardlevelcolumn_view as
select distinct on (standardlevelcolumn.identifier,standardlevelcolumn_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    shared.standardlevelcolumn.id,
    shared.standardlevelcolumn_ts.id as ts_id,
    shared.standardlevelcolumn_tsp.id as tsp_id,
    shared.standardlevelcolumn.identifier,
    shared.standardlevelcolumn_ts.interpretation,
    shared.standardlevelcolumn_ts.sequence_number,
    shared.standardlevelcolumn_ts.correction_number,
    shared.standardlevelcolumn_ts.valid_time_begin,
    shared.standardlevelcolumn_ts.valid_time_end,
    shared.standardlevelcolumn_ts.feature_lifetime_begin,
    shared.standardlevelcolumn_ts.feature_lifetime_end,
    coalesce(cast(shared.standardlevelcolumn_ts.series_value as varchar), '(' || shared.standardlevelcolumn_ts.series_nilreason || ')') as series,
    coalesce(cast(shared.standardlevelcolumn_ts.separation_value as varchar), '(' || shared.standardlevelcolumn_ts.separation_nilreason || ')') as separation,
    coalesce(cast(shared_standardleveltable_pt_upimwq.title as varchar), '(' || shared_standardleveltable_pt_upimwq.nilreason[1] || ')') AS leveltable,
    shared_standardleveltable_pt_upimwq.href AS leveltable_href,
    jsonb_agg(shared_standardlevel_view_qvyohp.id) AS level,
    jsonb_agg(notes_note_view_pbcina.*) AS standardlevelcolumn_annotation
from shared.standardlevelcolumn 
inner join master_join mj2 on shared.standardlevelcolumn.id = mj2.source_id
inner join shared.standardlevelcolumn_tsp on mj2.target_id = shared.standardlevelcolumn_tsp.id
inner join shared.standardlevelcolumn_ts on shared.standardlevelcolumn_tsp.standardlevelcolumntimeslice_id = shared.standardlevelcolumn_ts.id
left join shared.standardleveltable_pt shared_standardleveltable_pt_upimwq on shared.standardlevelcolumn_ts.leveltable_id = shared_standardleveltable_pt_upimwq.id
left join master_join master_join_njutff on shared.standardlevelcolumn_ts.id = master_join_njutff.source_id
left join shared.standardlevel_view shared_standardlevel_view_qvyohp on master_join_njutff.target_id = shared_standardlevel_view_qvyohp.id
left join master_join master_join_kaafzv on shared.standardlevelcolumn_ts.id = master_join_kaafzv.source_id
left join notes.note_view notes_note_view_pbcina on master_join_kaafzv.target_id = notes_note_view_pbcina.id
where shared.standardlevelcolumn.feature_status = 'APPROVED'
  and shared.standardlevelcolumn_ts.feature_status = 'APPROVED'
group by
    shared.standardlevelcolumn.id,
    shared.standardlevelcolumn_ts.id,
    shared.standardlevelcolumn_tsp.id,
    shared.standardlevelcolumn.identifier,
    shared.standardlevelcolumn_ts.interpretation,
    shared.standardlevelcolumn_ts.sequence_number,
    shared.standardlevelcolumn_ts.correction_number,
    shared.standardlevelcolumn_ts.valid_time_begin,
    shared.standardlevelcolumn_ts.valid_time_end,
    shared.standardlevelcolumn_ts.feature_lifetime_begin,
    shared.standardlevelcolumn_ts.feature_lifetime_end,
    shared.standardlevelcolumn_ts.series_value,
    shared.standardlevelcolumn_ts.series_nilreason,
    shared.standardlevelcolumn_ts.separation_value,
    shared.standardlevelcolumn_ts.separation_nilreason,
    shared_standardleveltable_pt_upimwq.title,
    shared_standardleveltable_pt_upimwq.nilreason[1],
    shared_standardleveltable_pt_upimwq.href
order by standardlevelcolumn.identifier, standardlevelcolumn_ts.sequence_number, standardlevelcolumn_ts.correction_number DESC;
-- StandardLevelSectorTimeSliceType
-- ['notes.note_view']
create or replace view shared.standardlevelsector_view as
select distinct on (standardlevelsector.identifier,standardlevelsector_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    shared.standardlevelsector.id,
    shared.standardlevelsector_ts.id as ts_id,
    shared.standardlevelsector_tsp.id as tsp_id,
    shared.standardlevelsector.identifier,
    shared.standardlevelsector_ts.interpretation,
    shared.standardlevelsector_ts.sequence_number,
    shared.standardlevelsector_ts.correction_number,
    shared.standardlevelsector_ts.valid_time_begin,
    shared.standardlevelsector_ts.valid_time_end,
    shared.standardlevelsector_ts.feature_lifetime_begin,
    shared.standardlevelsector_ts.feature_lifetime_end,
    coalesce(cast(shared.standardlevelsector_ts.flightrule_value as varchar), '(' || shared.standardlevelsector_ts.flightrule_nilreason || ')') as flightrule,
    coalesce(cast(shared.standardlevelsector_ts.fromtrack_value as varchar), '(' || shared.standardlevelsector_ts.fromtrack_nilreason || ')') as fromtrack,
    coalesce(cast(shared.standardlevelsector_ts.totrack_value as varchar), '(' || shared.standardlevelsector_ts.totrack_nilreason || ')') as totrack,
    coalesce(cast(shared.standardlevelsector_ts.angletype_value as varchar), '(' || shared.standardlevelsector_ts.angletype_nilreason || ')') as angletype,
    coalesce(cast(shared_standardlevelcolumn_pt_vpdwuu.title as varchar), '(' || shared_standardlevelcolumn_pt_vpdwuu.nilreason[1] || ')') AS applicablelevelcolumn,
    shared_standardlevelcolumn_pt_vpdwuu.href AS applicablelevelcolumn_href,
    jsonb_build_object('id', airspace_airspace_pt_jkhuum.id,
    'title', coalesce(cast(airspace_airspace_pt_jkhuum.title AS varchar), '(' || airspace_airspace_pt_jkhuum.nilreason[1] || ')'),
    'href', airspace_airspace_pt_jkhuum.href) AS applicableairspace,
    jsonb_agg(notes_note_view_zvxofh.*) AS standardlevelsector_annotation
from shared.standardlevelsector 
inner join master_join mj2 on shared.standardlevelsector.id = mj2.source_id
inner join shared.standardlevelsector_tsp on mj2.target_id = shared.standardlevelsector_tsp.id
inner join shared.standardlevelsector_ts on shared.standardlevelsector_tsp.standardlevelsectortimeslice_id = shared.standardlevelsector_ts.id
left join shared.standardlevelcolumn_pt shared_standardlevelcolumn_pt_vpdwuu on shared.standardlevelsector_ts.applicablelevelcolumn_id = shared_standardlevelcolumn_pt_vpdwuu.id
left join master_join master_join_oqydcp on shared.standardlevelsector_ts.id = master_join_oqydcp.source_id
left join airspace.airspace_pt airspace_airspace_pt_jkhuum on master_join_oqydcp.target_id = airspace_airspace_pt_jkhuum.id
left join master_join master_join_cgkpsy on shared.standardlevelsector_ts.id = master_join_cgkpsy.source_id
left join notes.note_view notes_note_view_zvxofh on master_join_cgkpsy.target_id = notes_note_view_zvxofh.id
where shared.standardlevelsector.feature_status = 'APPROVED'
  and shared.standardlevelsector_ts.feature_status = 'APPROVED'
group by
    shared.standardlevelsector.id,
    shared.standardlevelsector_ts.id,
    shared.standardlevelsector_tsp.id,
    shared.standardlevelsector.identifier,
    shared.standardlevelsector_ts.interpretation,
    shared.standardlevelsector_ts.sequence_number,
    shared.standardlevelsector_ts.correction_number,
    shared.standardlevelsector_ts.valid_time_begin,
    shared.standardlevelsector_ts.valid_time_end,
    shared.standardlevelsector_ts.feature_lifetime_begin,
    shared.standardlevelsector_ts.feature_lifetime_end,
    shared.standardlevelsector_ts.flightrule_value,
    shared.standardlevelsector_ts.flightrule_nilreason,
    shared.standardlevelsector_ts.fromtrack_value,
    shared.standardlevelsector_ts.fromtrack_nilreason,
    shared.standardlevelsector_ts.totrack_value,
    shared.standardlevelsector_ts.totrack_nilreason,
    shared.standardlevelsector_ts.angletype_value,
    shared.standardlevelsector_ts.angletype_nilreason,
    shared_standardlevelcolumn_pt_vpdwuu.title,
    shared_standardlevelcolumn_pt_vpdwuu.nilreason[1],
    shared_standardlevelcolumn_pt_vpdwuu.href
order by standardlevelsector.identifier, standardlevelsector_ts.sequence_number, standardlevelsector_ts.correction_number DESC;
-- StandardLevelTableTimeSliceType
-- ['notes.note_view']
create or replace view shared.standardleveltable_view as
select distinct on (standardleveltable.identifier,standardleveltable_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    shared.standardleveltable.id,
    shared.standardleveltable_ts.id as ts_id,
    shared.standardleveltable_tsp.id as tsp_id,
    shared.standardleveltable.identifier,
    shared.standardleveltable_ts.interpretation,
    shared.standardleveltable_ts.sequence_number,
    shared.standardleveltable_ts.correction_number,
    shared.standardleveltable_ts.valid_time_begin,
    shared.standardleveltable_ts.valid_time_end,
    shared.standardleveltable_ts.feature_lifetime_begin,
    shared.standardleveltable_ts.feature_lifetime_end,
    coalesce(cast(shared.standardleveltable_ts.name_value as varchar), '(' || shared.standardleveltable_ts.name_nilreason || ')') as name,
    coalesce(cast(shared.standardleveltable_ts.standardicao_value as varchar), '(' || shared.standardleveltable_ts.standardicao_nilreason || ')') as standardicao,
    jsonb_agg(notes_note_view_zsebwb.*) AS standardleveltable_annotation
from shared.standardleveltable 
inner join master_join mj2 on shared.standardleveltable.id = mj2.source_id
inner join shared.standardleveltable_tsp on mj2.target_id = shared.standardleveltable_tsp.id
inner join shared.standardleveltable_ts on shared.standardleveltable_tsp.standardleveltabletimeslice_id = shared.standardleveltable_ts.id
left join master_join master_join_qpuhsa on shared.standardleveltable_ts.id = master_join_qpuhsa.source_id
left join notes.note_view notes_note_view_zsebwb on master_join_qpuhsa.target_id = notes_note_view_zsebwb.id
where shared.standardleveltable.feature_status = 'APPROVED'
  and shared.standardleveltable_ts.feature_status = 'APPROVED'
group by
    shared.standardleveltable.id,
    shared.standardleveltable_ts.id,
    shared.standardleveltable_tsp.id,
    shared.standardleveltable.identifier,
    shared.standardleveltable_ts.interpretation,
    shared.standardleveltable_ts.sequence_number,
    shared.standardleveltable_ts.correction_number,
    shared.standardleveltable_ts.valid_time_begin,
    shared.standardleveltable_ts.valid_time_end,
    shared.standardleveltable_ts.feature_lifetime_begin,
    shared.standardleveltable_ts.feature_lifetime_end,
    shared.standardleveltable_ts.name_value,
    shared.standardleveltable_ts.name_nilreason,
    shared.standardleveltable_ts.standardicao_value,
    shared.standardleveltable_ts.standardicao_nilreason
order by standardleveltable.identifier, standardleveltable_ts.sequence_number, standardleveltable_ts.correction_number DESC;
-- StandMarkingTimeSliceType
-- ['notes.note_view', 'airport_heliport.markingelement_view']
create or replace view airport_heliport.standmarking_view as
select distinct on (standmarking.identifier,standmarking_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.standmarking.id,
    airport_heliport.standmarking_ts.id as ts_id,
    airport_heliport.standmarking_tsp.id as tsp_id,
    airport_heliport.standmarking.identifier,
    airport_heliport.standmarking_ts.interpretation,
    airport_heliport.standmarking_ts.sequence_number,
    airport_heliport.standmarking_ts.correction_number,
    airport_heliport.standmarking_ts.valid_time_begin,
    airport_heliport.standmarking_ts.valid_time_end,
    airport_heliport.standmarking_ts.feature_lifetime_begin,
    airport_heliport.standmarking_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.standmarking_ts.markingicaostandard_value as varchar), '(' || airport_heliport.standmarking_ts.markingicaostandard_nilreason || ')') as markingicaostandard,
    coalesce(cast(airport_heliport.standmarking_ts.condition_value as varchar), '(' || airport_heliport.standmarking_ts.condition_nilreason || ')') as condition,
    coalesce(cast(airport_heliport_aircraftstand_pt_hvjhpw.title as varchar), '(' || airport_heliport_aircraftstand_pt_hvjhpw.nilreason[1] || ')') AS markedstand,
    airport_heliport_aircraftstand_pt_hvjhpw.href AS markedstand_href,
    jsonb_agg(airport_heliport_markingelement_view_oyguug.id) AS element,
    jsonb_agg(notes_note_view_bllmmv.*) AS standmarking_annotation
from airport_heliport.standmarking 
inner join master_join mj2 on airport_heliport.standmarking.id = mj2.source_id
inner join airport_heliport.standmarking_tsp on mj2.target_id = airport_heliport.standmarking_tsp.id
inner join airport_heliport.standmarking_ts on airport_heliport.standmarking_tsp.standmarkingtimeslice_id = airport_heliport.standmarking_ts.id
left join airport_heliport.aircraftstand_pt airport_heliport_aircraftstand_pt_hvjhpw on airport_heliport.standmarking_ts.markedstand_id = airport_heliport_aircraftstand_pt_hvjhpw.id
left join master_join master_join_wtvpsq on airport_heliport.standmarking_ts.id = master_join_wtvpsq.source_id
left join airport_heliport.markingelement_view airport_heliport_markingelement_view_oyguug on master_join_wtvpsq.target_id = airport_heliport_markingelement_view_oyguug.id
left join master_join master_join_krrdvj on airport_heliport.standmarking_ts.id = master_join_krrdvj.source_id
left join notes.note_view notes_note_view_bllmmv on master_join_krrdvj.target_id = notes_note_view_bllmmv.id
where airport_heliport.standmarking.feature_status = 'APPROVED'
  and airport_heliport.standmarking_ts.feature_status = 'APPROVED'
group by
    airport_heliport.standmarking.id,
    airport_heliport.standmarking_ts.id,
    airport_heliport.standmarking_tsp.id,
    airport_heliport.standmarking.identifier,
    airport_heliport.standmarking_ts.interpretation,
    airport_heliport.standmarking_ts.sequence_number,
    airport_heliport.standmarking_ts.correction_number,
    airport_heliport.standmarking_ts.valid_time_begin,
    airport_heliport.standmarking_ts.valid_time_end,
    airport_heliport.standmarking_ts.feature_lifetime_begin,
    airport_heliport.standmarking_ts.feature_lifetime_end,
    airport_heliport.standmarking_ts.markingicaostandard_value,
    airport_heliport.standmarking_ts.markingicaostandard_nilreason,
    airport_heliport.standmarking_ts.condition_value,
    airport_heliport.standmarking_ts.condition_nilreason,
    airport_heliport_aircraftstand_pt_hvjhpw.title,
    airport_heliport_aircraftstand_pt_hvjhpw.nilreason[1],
    airport_heliport_aircraftstand_pt_hvjhpw.href
order by standmarking.identifier, standmarking_ts.sequence_number, standmarking_ts.correction_number DESC;
-- SurveyControlPointTimeSliceType
-- ['notes.note_view', 'geometry.elevatedpoint_view']
create or replace view airport_heliport.surveycontrolpoint_view as
select distinct on (surveycontrolpoint.identifier,surveycontrolpoint_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.surveycontrolpoint.id,
    airport_heliport.surveycontrolpoint_ts.id as ts_id,
    airport_heliport.surveycontrolpoint_tsp.id as tsp_id,
    airport_heliport.surveycontrolpoint.identifier,
    airport_heliport.surveycontrolpoint_ts.interpretation,
    airport_heliport.surveycontrolpoint_ts.sequence_number,
    airport_heliport.surveycontrolpoint_ts.correction_number,
    airport_heliport.surveycontrolpoint_ts.valid_time_begin,
    airport_heliport.surveycontrolpoint_ts.valid_time_end,
    airport_heliport.surveycontrolpoint_ts.feature_lifetime_begin,
    airport_heliport.surveycontrolpoint_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.surveycontrolpoint_ts.designator_value as varchar), '(' || airport_heliport.surveycontrolpoint_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airport_heliport_airportheliport_pt_gfsyee.title as varchar), '(' || airport_heliport_airportheliport_pt_gfsyee.nilreason[1] || ')') AS associatedairportheliport,
    airport_heliport_airportheliport_pt_gfsyee.href AS associatedairportheliport_href,
    geometry_elevatedpoint_view_aqjvez.geom AS geom,
    ST_X(geometry_elevatedpoint_view_aqjvez.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_aqjvez.geom) AS latitude,
    geometry_elevatedpoint_view_aqjvez.elevation,
    geometry_elevatedpoint_view_aqjvez.geoidUndulation,
    geometry_elevatedpoint_view_aqjvez.verticalDatum,
    geometry_elevatedpoint_view_aqjvez.verticalAccuracy,
    geometry_elevatedpoint_view_aqjvez.horizontalAccuracy,
    jsonb_agg(notes_note_view_ikwsyc.*) AS surveycontrolpoint_annotation
from airport_heliport.surveycontrolpoint 
inner join master_join mj2 on airport_heliport.surveycontrolpoint.id = mj2.source_id
inner join airport_heliport.surveycontrolpoint_tsp on mj2.target_id = airport_heliport.surveycontrolpoint_tsp.id
inner join airport_heliport.surveycontrolpoint_ts on airport_heliport.surveycontrolpoint_tsp.surveycontrolpointtimeslice_id = airport_heliport.surveycontrolpoint_ts.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_gfsyee on airport_heliport.surveycontrolpoint_ts.associatedairportheliport_id = airport_heliport_airportheliport_pt_gfsyee.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_aqjvez on airport_heliport.surveycontrolpoint_ts.location_id = geometry_elevatedpoint_view_aqjvez.id
left join master_join master_join_cqlyid on airport_heliport.surveycontrolpoint_ts.id = master_join_cqlyid.source_id
left join notes.note_view notes_note_view_ikwsyc on master_join_cqlyid.target_id = notes_note_view_ikwsyc.id
where airport_heliport.surveycontrolpoint.feature_status = 'APPROVED'
  and airport_heliport.surveycontrolpoint_ts.feature_status = 'APPROVED'
group by
    airport_heliport.surveycontrolpoint.id,
    airport_heliport.surveycontrolpoint_ts.id,
    airport_heliport.surveycontrolpoint_tsp.id,
    airport_heliport.surveycontrolpoint.identifier,
    airport_heliport.surveycontrolpoint_ts.interpretation,
    airport_heliport.surveycontrolpoint_ts.sequence_number,
    airport_heliport.surveycontrolpoint_ts.correction_number,
    airport_heliport.surveycontrolpoint_ts.valid_time_begin,
    airport_heliport.surveycontrolpoint_ts.valid_time_end,
    airport_heliport.surveycontrolpoint_ts.feature_lifetime_begin,
    airport_heliport.surveycontrolpoint_ts.feature_lifetime_end,
    airport_heliport.surveycontrolpoint_ts.designator_value,
    airport_heliport.surveycontrolpoint_ts.designator_nilreason,
    airport_heliport_airportheliport_pt_gfsyee.title,
    airport_heliport_airportheliport_pt_gfsyee.nilreason[1],
    airport_heliport_airportheliport_pt_gfsyee.href,
    geometry_elevatedpoint_view_aqjvez.geom,
    geometry_elevatedpoint_view_aqjvez.elevation,
    geometry_elevatedpoint_view_aqjvez.geoidUndulation,
    geometry_elevatedpoint_view_aqjvez.verticalDatum,
    geometry_elevatedpoint_view_aqjvez.verticalAccuracy,
    geometry_elevatedpoint_view_aqjvez.horizontalAccuracy
order by surveycontrolpoint.identifier, surveycontrolpoint_ts.sequence_number, surveycontrolpoint_ts.correction_number DESC;
-- TACANTimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.tacan_view as
select distinct on (tacan.identifier,tacan_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.tacan.id,
    navaids_points.tacan_ts.id as ts_id,
    navaids_points.tacan_tsp.id as tsp_id,
    navaids_points.tacan.identifier,
    navaids_points.tacan_ts.interpretation,
    navaids_points.tacan_ts.sequence_number,
    navaids_points.tacan_ts.correction_number,
    navaids_points.tacan_ts.valid_time_begin,
    navaids_points.tacan_ts.valid_time_end,
    navaids_points.tacan_ts.feature_lifetime_begin,
    navaids_points.tacan_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.tacan_ts.designator_value as varchar), '(' || navaids_points.tacan_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.tacan_ts.name_value as varchar), '(' || navaids_points.tacan_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.tacan_ts.emissionclass_value as varchar), '(' || navaids_points.tacan_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.tacan_ts.mobile_value as varchar), '(' || navaids_points.tacan_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.tacan_ts.magneticvariation_value as varchar), '(' || navaids_points.tacan_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.tacan_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.tacan_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.tacan_ts.datemagneticvariation_value as varchar), '(' || navaids_points.tacan_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.tacan_ts.flightchecked_value as varchar), '(' || navaids_points.tacan_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.tacan_ts.channel_value as varchar), '(' || navaids_points.tacan_ts.channel_nilreason || ')') as channel,
    coalesce(cast(navaids_points.tacan_ts.declination_value as varchar), '(' || navaids_points.tacan_ts.declination_nilreason || ')') as declination,
    geometry_elevatedpoint_view_bmvwwb.geom AS geom,
    ST_X(geometry_elevatedpoint_view_bmvwwb.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_bmvwwb.geom) AS latitude,
    geometry_elevatedpoint_view_bmvwwb.elevation,
    geometry_elevatedpoint_view_bmvwwb.geoidUndulation,
    geometry_elevatedpoint_view_bmvwwb.verticalDatum,
    geometry_elevatedpoint_view_bmvwwb.verticalAccuracy,
    geometry_elevatedpoint_view_bmvwwb.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_jvljdu.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_ikajyb.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_lvblyp.id) AS availability,
    jsonb_agg(notes_note_view_svtaju.*) AS tacan_annotation
from navaids_points.tacan 
inner join master_join mj2 on navaids_points.tacan.id = mj2.source_id
inner join navaids_points.tacan_tsp on mj2.target_id = navaids_points.tacan_tsp.id
inner join navaids_points.tacan_ts on navaids_points.tacan_tsp.tacantimeslice_id = navaids_points.tacan_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_bmvwwb on navaids_points.tacan_ts.location_id = geometry_elevatedpoint_view_bmvwwb.id
left join master_join master_join_cqildi on navaids_points.tacan_ts.id = master_join_cqildi.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_jvljdu on master_join_cqildi.target_id = navaids_points_authorityfornavaidequipment_view_jvljdu.id
left join master_join master_join_caaxnx on navaids_points.tacan_ts.id = master_join_caaxnx.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_ikajyb on master_join_caaxnx.target_id = navaids_points_navaidequipmentmonitoring_view_ikajyb.id
left join master_join master_join_azuczo on navaids_points.tacan_ts.id = master_join_azuczo.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_lvblyp on master_join_azuczo.target_id = navaids_points_navaidoperationalstatus_view_lvblyp.id
left join master_join master_join_lvrgrr on navaids_points.tacan_ts.id = master_join_lvrgrr.source_id
left join notes.note_view notes_note_view_svtaju on master_join_lvrgrr.target_id = notes_note_view_svtaju.id
where navaids_points.tacan.feature_status = 'APPROVED'
  and navaids_points.tacan_ts.feature_status = 'APPROVED'
group by
    navaids_points.tacan.id,
    navaids_points.tacan_ts.id,
    navaids_points.tacan_tsp.id,
    navaids_points.tacan.identifier,
    navaids_points.tacan_ts.interpretation,
    navaids_points.tacan_ts.sequence_number,
    navaids_points.tacan_ts.correction_number,
    navaids_points.tacan_ts.valid_time_begin,
    navaids_points.tacan_ts.valid_time_end,
    navaids_points.tacan_ts.feature_lifetime_begin,
    navaids_points.tacan_ts.feature_lifetime_end,
    navaids_points.tacan_ts.designator_value,
    navaids_points.tacan_ts.designator_nilreason,
    navaids_points.tacan_ts.name_value,
    navaids_points.tacan_ts.name_nilreason,
    navaids_points.tacan_ts.emissionclass_value,
    navaids_points.tacan_ts.emissionclass_nilreason,
    navaids_points.tacan_ts.mobile_value,
    navaids_points.tacan_ts.mobile_nilreason,
    navaids_points.tacan_ts.magneticvariation_value,
    navaids_points.tacan_ts.magneticvariation_nilreason,
    navaids_points.tacan_ts.magneticvariationaccuracy_value,
    navaids_points.tacan_ts.magneticvariationaccuracy_nilreason,
    navaids_points.tacan_ts.datemagneticvariation_value,
    navaids_points.tacan_ts.datemagneticvariation_nilreason,
    navaids_points.tacan_ts.flightchecked_value,
    navaids_points.tacan_ts.flightchecked_nilreason,
    navaids_points.tacan_ts.channel_value,
    navaids_points.tacan_ts.channel_nilreason,
    navaids_points.tacan_ts.declination_value,
    navaids_points.tacan_ts.declination_nilreason,
    geometry_elevatedpoint_view_bmvwwb.geom,
    geometry_elevatedpoint_view_bmvwwb.elevation,
    geometry_elevatedpoint_view_bmvwwb.geoidUndulation,
    geometry_elevatedpoint_view_bmvwwb.verticalDatum,
    geometry_elevatedpoint_view_bmvwwb.verticalAccuracy,
    geometry_elevatedpoint_view_bmvwwb.horizontalAccuracy
order by tacan.identifier, tacan_ts.sequence_number, tacan_ts.correction_number DESC;
-- TaxiHoldingPositionLightSystemTimeSliceType
-- ['shared.lightelement_view', 'airport_heliport.groundlightingavailability_view', 'notes.note_view']
create or replace view airport_heliport.taxiholdingpositionlightsystem_view as
select distinct on (taxiholdingpositionlightsystem.identifier,taxiholdingpositionlightsystem_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.taxiholdingpositionlightsystem.id,
    airport_heliport.taxiholdingpositionlightsystem_ts.id as ts_id,
    airport_heliport.taxiholdingpositionlightsystem_tsp.id as tsp_id,
    airport_heliport.taxiholdingpositionlightsystem.identifier,
    airport_heliport.taxiholdingpositionlightsystem_ts.interpretation,
    airport_heliport.taxiholdingpositionlightsystem_ts.sequence_number,
    airport_heliport.taxiholdingpositionlightsystem_ts.correction_number,
    airport_heliport.taxiholdingpositionlightsystem_ts.valid_time_begin,
    airport_heliport.taxiholdingpositionlightsystem_ts.valid_time_end,
    airport_heliport.taxiholdingpositionlightsystem_ts.feature_lifetime_begin,
    airport_heliport.taxiholdingpositionlightsystem_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.taxiholdingpositionlightsystem_ts.emergencylighting_value as varchar), '(' || airport_heliport.taxiholdingpositionlightsystem_ts.emergencylighting_nilreason || ')') as emergencylighting,
    coalesce(cast(airport_heliport.taxiholdingpositionlightsystem_ts.intensitylevel_value as varchar), '(' || airport_heliport.taxiholdingpositionlightsystem_ts.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(airport_heliport.taxiholdingpositionlightsystem_ts.colour_value as varchar), '(' || airport_heliport.taxiholdingpositionlightsystem_ts.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport.taxiholdingpositionlightsystem_ts.type_value as varchar), '(' || airport_heliport.taxiholdingpositionlightsystem_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport_taxiholdingposition_pt_qzphcd.title as varchar), '(' || airport_heliport_taxiholdingposition_pt_qzphcd.nilreason[1] || ')') AS taxiholding,
    airport_heliport_taxiholdingposition_pt_qzphcd.href AS taxiholding_href,
    jsonb_agg(shared_lightelement_view_jnxeut.id) AS element,
    jsonb_agg(airport_heliport_groundlightingavailability_view_bnxhko.id) AS availability,
    jsonb_agg(notes_note_view_aluknv.*) AS taxiholdingpositionlightsystem_annotation
from airport_heliport.taxiholdingpositionlightsystem 
inner join master_join mj2 on airport_heliport.taxiholdingpositionlightsystem.id = mj2.source_id
inner join airport_heliport.taxiholdingpositionlightsystem_tsp on mj2.target_id = airport_heliport.taxiholdingpositionlightsystem_tsp.id
inner join airport_heliport.taxiholdingpositionlightsystem_ts on airport_heliport.taxiholdingpositionlightsystem_tsp.taxiholdingpositionlightsystemtimeslice_id = airport_heliport.taxiholdingpositionlightsystem_ts.id
left join airport_heliport.taxiholdingposition_pt airport_heliport_taxiholdingposition_pt_qzphcd on airport_heliport.taxiholdingpositionlightsystem_ts.taxiholding_id = airport_heliport_taxiholdingposition_pt_qzphcd.id
left join master_join master_join_shaaqw on airport_heliport.taxiholdingpositionlightsystem_ts.id = master_join_shaaqw.source_id
left join shared.lightelement_view shared_lightelement_view_jnxeut on master_join_shaaqw.target_id = shared_lightelement_view_jnxeut.id
left join master_join master_join_expsdk on airport_heliport.taxiholdingpositionlightsystem_ts.id = master_join_expsdk.source_id
left join airport_heliport.groundlightingavailability_view airport_heliport_groundlightingavailability_view_bnxhko on master_join_expsdk.target_id = airport_heliport_groundlightingavailability_view_bnxhko.id
left join master_join master_join_atfowm on airport_heliport.taxiholdingpositionlightsystem_ts.id = master_join_atfowm.source_id
left join notes.note_view notes_note_view_aluknv on master_join_atfowm.target_id = notes_note_view_aluknv.id
where airport_heliport.taxiholdingpositionlightsystem.feature_status = 'APPROVED'
  and airport_heliport.taxiholdingpositionlightsystem_ts.feature_status = 'APPROVED'
group by
    airport_heliport.taxiholdingpositionlightsystem.id,
    airport_heliport.taxiholdingpositionlightsystem_ts.id,
    airport_heliport.taxiholdingpositionlightsystem_tsp.id,
    airport_heliport.taxiholdingpositionlightsystem.identifier,
    airport_heliport.taxiholdingpositionlightsystem_ts.interpretation,
    airport_heliport.taxiholdingpositionlightsystem_ts.sequence_number,
    airport_heliport.taxiholdingpositionlightsystem_ts.correction_number,
    airport_heliport.taxiholdingpositionlightsystem_ts.valid_time_begin,
    airport_heliport.taxiholdingpositionlightsystem_ts.valid_time_end,
    airport_heliport.taxiholdingpositionlightsystem_ts.feature_lifetime_begin,
    airport_heliport.taxiholdingpositionlightsystem_ts.feature_lifetime_end,
    airport_heliport.taxiholdingpositionlightsystem_ts.emergencylighting_value,
    airport_heliport.taxiholdingpositionlightsystem_ts.emergencylighting_nilreason,
    airport_heliport.taxiholdingpositionlightsystem_ts.intensitylevel_value,
    airport_heliport.taxiholdingpositionlightsystem_ts.intensitylevel_nilreason,
    airport_heliport.taxiholdingpositionlightsystem_ts.colour_value,
    airport_heliport.taxiholdingpositionlightsystem_ts.colour_nilreason,
    airport_heliport.taxiholdingpositionlightsystem_ts.type_value,
    airport_heliport.taxiholdingpositionlightsystem_ts.type_nilreason,
    airport_heliport_taxiholdingposition_pt_qzphcd.title,
    airport_heliport_taxiholdingposition_pt_qzphcd.nilreason[1],
    airport_heliport_taxiholdingposition_pt_qzphcd.href
order by taxiholdingpositionlightsystem.identifier, taxiholdingpositionlightsystem_ts.sequence_number, taxiholdingpositionlightsystem_ts.correction_number DESC;
-- TaxiHoldingPositionMarkingTimeSliceType
-- ['notes.note_view', 'airport_heliport.markingelement_view']
create or replace view airport_heliport.taxiholdingpositionmarking_view as
select distinct on (taxiholdingpositionmarking.identifier,taxiholdingpositionmarking_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.taxiholdingpositionmarking.id,
    airport_heliport.taxiholdingpositionmarking_ts.id as ts_id,
    airport_heliport.taxiholdingpositionmarking_tsp.id as tsp_id,
    airport_heliport.taxiholdingpositionmarking.identifier,
    airport_heliport.taxiholdingpositionmarking_ts.interpretation,
    airport_heliport.taxiholdingpositionmarking_ts.sequence_number,
    airport_heliport.taxiholdingpositionmarking_ts.correction_number,
    airport_heliport.taxiholdingpositionmarking_ts.valid_time_begin,
    airport_heliport.taxiholdingpositionmarking_ts.valid_time_end,
    airport_heliport.taxiholdingpositionmarking_ts.feature_lifetime_begin,
    airport_heliport.taxiholdingpositionmarking_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.taxiholdingpositionmarking_ts.markingicaostandard_value as varchar), '(' || airport_heliport.taxiholdingpositionmarking_ts.markingicaostandard_nilreason || ')') as markingicaostandard,
    coalesce(cast(airport_heliport.taxiholdingpositionmarking_ts.condition_value as varchar), '(' || airport_heliport.taxiholdingpositionmarking_ts.condition_nilreason || ')') as condition,
    coalesce(cast(airport_heliport_taxiholdingposition_pt_jzkjch.title as varchar), '(' || airport_heliport_taxiholdingposition_pt_jzkjch.nilreason[1] || ')') AS markedtaxihold,
    airport_heliport_taxiholdingposition_pt_jzkjch.href AS markedtaxihold_href,
    jsonb_agg(airport_heliport_markingelement_view_xvziyn.id) AS element,
    jsonb_agg(notes_note_view_jdvesh.*) AS taxiholdingpositionmarking_annotation
from airport_heliport.taxiholdingpositionmarking 
inner join master_join mj2 on airport_heliport.taxiholdingpositionmarking.id = mj2.source_id
inner join airport_heliport.taxiholdingpositionmarking_tsp on mj2.target_id = airport_heliport.taxiholdingpositionmarking_tsp.id
inner join airport_heliport.taxiholdingpositionmarking_ts on airport_heliport.taxiholdingpositionmarking_tsp.taxiholdingpositionmarkingtimeslice_id = airport_heliport.taxiholdingpositionmarking_ts.id
left join airport_heliport.taxiholdingposition_pt airport_heliport_taxiholdingposition_pt_jzkjch on airport_heliport.taxiholdingpositionmarking_ts.markedtaxihold_id = airport_heliport_taxiholdingposition_pt_jzkjch.id
left join master_join master_join_nubvqw on airport_heliport.taxiholdingpositionmarking_ts.id = master_join_nubvqw.source_id
left join airport_heliport.markingelement_view airport_heliport_markingelement_view_xvziyn on master_join_nubvqw.target_id = airport_heliport_markingelement_view_xvziyn.id
left join master_join master_join_syrbak on airport_heliport.taxiholdingpositionmarking_ts.id = master_join_syrbak.source_id
left join notes.note_view notes_note_view_jdvesh on master_join_syrbak.target_id = notes_note_view_jdvesh.id
where airport_heliport.taxiholdingpositionmarking.feature_status = 'APPROVED'
  and airport_heliport.taxiholdingpositionmarking_ts.feature_status = 'APPROVED'
group by
    airport_heliport.taxiholdingpositionmarking.id,
    airport_heliport.taxiholdingpositionmarking_ts.id,
    airport_heliport.taxiholdingpositionmarking_tsp.id,
    airport_heliport.taxiholdingpositionmarking.identifier,
    airport_heliport.taxiholdingpositionmarking_ts.interpretation,
    airport_heliport.taxiholdingpositionmarking_ts.sequence_number,
    airport_heliport.taxiholdingpositionmarking_ts.correction_number,
    airport_heliport.taxiholdingpositionmarking_ts.valid_time_begin,
    airport_heliport.taxiholdingpositionmarking_ts.valid_time_end,
    airport_heliport.taxiholdingpositionmarking_ts.feature_lifetime_begin,
    airport_heliport.taxiholdingpositionmarking_ts.feature_lifetime_end,
    airport_heliport.taxiholdingpositionmarking_ts.markingicaostandard_value,
    airport_heliport.taxiholdingpositionmarking_ts.markingicaostandard_nilreason,
    airport_heliport.taxiholdingpositionmarking_ts.condition_value,
    airport_heliport.taxiholdingpositionmarking_ts.condition_nilreason,
    airport_heliport_taxiholdingposition_pt_jzkjch.title,
    airport_heliport_taxiholdingposition_pt_jzkjch.nilreason[1],
    airport_heliport_taxiholdingposition_pt_jzkjch.href
order by taxiholdingpositionmarking.identifier, taxiholdingpositionmarking_ts.sequence_number, taxiholdingpositionmarking_ts.correction_number DESC;
-- TaxiHoldingPositionTimeSliceType
-- ['notes.note_view', 'geometry.elevatedpoint_view']
create or replace view airport_heliport.taxiholdingposition_view as
select distinct on (taxiholdingposition.identifier,taxiholdingposition_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.taxiholdingposition.id,
    airport_heliport.taxiholdingposition_ts.id as ts_id,
    airport_heliport.taxiholdingposition_tsp.id as tsp_id,
    airport_heliport.taxiholdingposition.identifier,
    airport_heliport.taxiholdingposition_ts.interpretation,
    airport_heliport.taxiholdingposition_ts.sequence_number,
    airport_heliport.taxiholdingposition_ts.correction_number,
    airport_heliport.taxiholdingposition_ts.valid_time_begin,
    airport_heliport.taxiholdingposition_ts.valid_time_end,
    airport_heliport.taxiholdingposition_ts.feature_lifetime_begin,
    airport_heliport.taxiholdingposition_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.taxiholdingposition_ts.landingcategory_value as varchar), '(' || airport_heliport.taxiholdingposition_ts.landingcategory_nilreason || ')') as landingcategory,
    coalesce(cast(airport_heliport.taxiholdingposition_ts.status_value as varchar), '(' || airport_heliport.taxiholdingposition_ts.status_nilreason || ')') as status,
    coalesce(cast(airport_heliport_guidanceline_pt_itaabz.title as varchar), '(' || airport_heliport_guidanceline_pt_itaabz.nilreason[1] || ')') AS associatedguidanceline,
    airport_heliport_guidanceline_pt_itaabz.href AS associatedguidanceline_href,
    geometry_elevatedpoint_view_aplxiy.geom AS geom,
    ST_X(geometry_elevatedpoint_view_aplxiy.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_aplxiy.geom) AS latitude,
    geometry_elevatedpoint_view_aplxiy.elevation,
    geometry_elevatedpoint_view_aplxiy.geoidUndulation,
    geometry_elevatedpoint_view_aplxiy.verticalDatum,
    geometry_elevatedpoint_view_aplxiy.verticalAccuracy,
    geometry_elevatedpoint_view_aplxiy.horizontalAccuracy,
    jsonb_build_object('id', airport_heliport_runway_pt_yyvyhr.id,
    'title', coalesce(cast(airport_heliport_runway_pt_yyvyhr.title AS varchar), '(' || airport_heliport_runway_pt_yyvyhr.nilreason[1] || ')'),
    'href', airport_heliport_runway_pt_yyvyhr.href) AS protectedrunway,
    jsonb_agg(notes_note_view_bvofto.*) AS taxiholdingposition_annotation
from airport_heliport.taxiholdingposition 
inner join master_join mj2 on airport_heliport.taxiholdingposition.id = mj2.source_id
inner join airport_heliport.taxiholdingposition_tsp on mj2.target_id = airport_heliport.taxiholdingposition_tsp.id
inner join airport_heliport.taxiholdingposition_ts on airport_heliport.taxiholdingposition_tsp.taxiholdingpositiontimeslice_id = airport_heliport.taxiholdingposition_ts.id
left join airport_heliport.guidanceline_pt airport_heliport_guidanceline_pt_itaabz on airport_heliport.taxiholdingposition_ts.associatedguidanceline_id = airport_heliport_guidanceline_pt_itaabz.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_aplxiy on airport_heliport.taxiholdingposition_ts.location_id = geometry_elevatedpoint_view_aplxiy.id
left join master_join master_join_ldwbpg on airport_heliport.taxiholdingposition_ts.id = master_join_ldwbpg.source_id
left join airport_heliport.runway_pt airport_heliport_runway_pt_yyvyhr on master_join_ldwbpg.target_id = airport_heliport_runway_pt_yyvyhr.id
left join master_join master_join_arkymr on airport_heliport.taxiholdingposition_ts.id = master_join_arkymr.source_id
left join notes.note_view notes_note_view_bvofto on master_join_arkymr.target_id = notes_note_view_bvofto.id
where airport_heliport.taxiholdingposition.feature_status = 'APPROVED'
  and airport_heliport.taxiholdingposition_ts.feature_status = 'APPROVED'
group by
    airport_heliport.taxiholdingposition.id,
    airport_heliport.taxiholdingposition_ts.id,
    airport_heliport.taxiholdingposition_tsp.id,
    airport_heliport.taxiholdingposition.identifier,
    airport_heliport.taxiholdingposition_ts.interpretation,
    airport_heliport.taxiholdingposition_ts.sequence_number,
    airport_heliport.taxiholdingposition_ts.correction_number,
    airport_heliport.taxiholdingposition_ts.valid_time_begin,
    airport_heliport.taxiholdingposition_ts.valid_time_end,
    airport_heliport.taxiholdingposition_ts.feature_lifetime_begin,
    airport_heliport.taxiholdingposition_ts.feature_lifetime_end,
    airport_heliport.taxiholdingposition_ts.landingcategory_value,
    airport_heliport.taxiholdingposition_ts.landingcategory_nilreason,
    airport_heliport.taxiholdingposition_ts.status_value,
    airport_heliport.taxiholdingposition_ts.status_nilreason,
    airport_heliport_guidanceline_pt_itaabz.title,
    airport_heliport_guidanceline_pt_itaabz.nilreason[1],
    airport_heliport_guidanceline_pt_itaabz.href,
    geometry_elevatedpoint_view_aplxiy.geom,
    geometry_elevatedpoint_view_aplxiy.elevation,
    geometry_elevatedpoint_view_aplxiy.geoidUndulation,
    geometry_elevatedpoint_view_aplxiy.verticalDatum,
    geometry_elevatedpoint_view_aplxiy.verticalAccuracy,
    geometry_elevatedpoint_view_aplxiy.horizontalAccuracy
order by taxiholdingposition.identifier, taxiholdingposition_ts.sequence_number, taxiholdingposition_ts.correction_number DESC;
-- TaxiwayElementTimeSliceType
-- ['geometry.elevatedsurface_view', 'airport_heliport.manoeuvringareaavailability_view', 'notes.note_view']
create or replace view airport_heliport.taxiwayelement_view as
select distinct on (taxiwayelement.identifier,taxiwayelement_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.taxiwayelement.id,
    airport_heliport.taxiwayelement_ts.id as ts_id,
    airport_heliport.taxiwayelement_tsp.id as tsp_id,
    airport_heliport.taxiwayelement.identifier,
    airport_heliport.taxiwayelement_ts.interpretation,
    airport_heliport.taxiwayelement_ts.sequence_number,
    airport_heliport.taxiwayelement_ts.correction_number,
    airport_heliport.taxiwayelement_ts.valid_time_begin,
    airport_heliport.taxiwayelement_ts.valid_time_end,
    airport_heliport.taxiwayelement_ts.feature_lifetime_begin,
    airport_heliport.taxiwayelement_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.taxiwayelement_ts.type_value as varchar), '(' || airport_heliport.taxiwayelement_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.taxiwayelement_ts.gradeseparation_value as varchar), '(' || airport_heliport.taxiwayelement_ts.gradeseparation_nilreason || ')') as gradeseparation,
    coalesce(cast(airport_heliport.taxiwayelement_ts.length_value as varchar) || ' ' || airport_heliport.taxiwayelement_ts.length_uom, '(' || airport_heliport.taxiwayelement_ts.length_nilreason || ')') as length,
    coalesce(cast(airport_heliport.taxiwayelement_ts.width_value as varchar) || ' ' || airport_heliport.taxiwayelement_ts.width_uom, '(' || airport_heliport.taxiwayelement_ts.width_nilreason || ')') as width,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_btmszn.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_btmszn.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_btmszn.href AS surfaceproperties_href,
    coalesce(cast(airport_heliport_taxiway_pt_qmksry.title as varchar), '(' || airport_heliport_taxiway_pt_qmksry.nilreason[1] || ')') AS associatedtaxiway,
    airport_heliport_taxiway_pt_qmksry.href AS associatedtaxiway_href,
    geometry_elevatedsurface_view_gddsve.geom AS geom,
    geometry_elevatedsurface_view_gddsve.elevation,
    geometry_elevatedsurface_view_gddsve.geoidUndulation,
    geometry_elevatedsurface_view_gddsve.verticalDatum,
    geometry_elevatedsurface_view_gddsve.verticalAccuracy,
    geometry_elevatedsurface_view_gddsve.horizontalAccuracy,
    jsonb_agg(notes_note_view_asbztr.*) AS taxiwayelement_annotation,
    jsonb_agg(airport_heliport_manoeuvringareaavailability_view_yunsqe.id) AS availability
from airport_heliport.taxiwayelement 
inner join master_join mj2 on airport_heliport.taxiwayelement.id = mj2.source_id
inner join airport_heliport.taxiwayelement_tsp on mj2.target_id = airport_heliport.taxiwayelement_tsp.id
inner join airport_heliport.taxiwayelement_ts on airport_heliport.taxiwayelement_tsp.taxiwayelementtimeslice_id = airport_heliport.taxiwayelement_ts.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_btmszn on airport_heliport.taxiwayelement_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_btmszn.id
left join airport_heliport.taxiway_pt airport_heliport_taxiway_pt_qmksry on airport_heliport.taxiwayelement_ts.associatedtaxiway_id = airport_heliport_taxiway_pt_qmksry.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_gddsve on airport_heliport.taxiwayelement_ts.extent_id = geometry_elevatedsurface_view_gddsve.id
left join master_join master_join_agouou on airport_heliport.taxiwayelement_ts.id = master_join_agouou.source_id
left join notes.note_view notes_note_view_asbztr on master_join_agouou.target_id = notes_note_view_asbztr.id
left join master_join master_join_exuryp on airport_heliport.taxiwayelement_ts.id = master_join_exuryp.source_id
left join airport_heliport.manoeuvringareaavailability_view airport_heliport_manoeuvringareaavailability_view_yunsqe on master_join_exuryp.target_id = airport_heliport_manoeuvringareaavailability_view_yunsqe.id
where airport_heliport.taxiwayelement.feature_status = 'APPROVED'
  and airport_heliport.taxiwayelement_ts.feature_status = 'APPROVED'
group by
    airport_heliport.taxiwayelement.id,
    airport_heliport.taxiwayelement_ts.id,
    airport_heliport.taxiwayelement_tsp.id,
    airport_heliport.taxiwayelement.identifier,
    airport_heliport.taxiwayelement_ts.interpretation,
    airport_heliport.taxiwayelement_ts.sequence_number,
    airport_heliport.taxiwayelement_ts.correction_number,
    airport_heliport.taxiwayelement_ts.valid_time_begin,
    airport_heliport.taxiwayelement_ts.valid_time_end,
    airport_heliport.taxiwayelement_ts.feature_lifetime_begin,
    airport_heliport.taxiwayelement_ts.feature_lifetime_end,
    airport_heliport.taxiwayelement_ts.type_value,
    airport_heliport.taxiwayelement_ts.type_nilreason,
    airport_heliport.taxiwayelement_ts.gradeseparation_value,
    airport_heliport.taxiwayelement_ts.gradeseparation_nilreason,
    airport_heliport.taxiwayelement_ts.length_value,
    airport_heliport.taxiwayelement_ts.length_uom,
    airport_heliport.taxiwayelement_ts.length_nilreason,
    airport_heliport.taxiwayelement_ts.width_value,
    airport_heliport.taxiwayelement_ts.width_uom,
    airport_heliport.taxiwayelement_ts.width_nilreason,
    airport_heliport_surfacecharacteristics_pt_btmszn.title,
    airport_heliport_surfacecharacteristics_pt_btmszn.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_btmszn.href,
    airport_heliport_taxiway_pt_qmksry.title,
    airport_heliport_taxiway_pt_qmksry.nilreason[1],
    airport_heliport_taxiway_pt_qmksry.href,
    geometry_elevatedsurface_view_gddsve.geom,
    geometry_elevatedsurface_view_gddsve.elevation,
    geometry_elevatedsurface_view_gddsve.geoidUndulation,
    geometry_elevatedsurface_view_gddsve.verticalDatum,
    geometry_elevatedsurface_view_gddsve.verticalAccuracy,
    geometry_elevatedsurface_view_gddsve.horizontalAccuracy
order by taxiwayelement.identifier, taxiwayelement_ts.sequence_number, taxiwayelement_ts.correction_number DESC;
-- TaxiwayLightSystemTimeSliceType
-- ['shared.lightelement_view', 'airport_heliport.groundlightingavailability_view', 'notes.note_view']
create or replace view airport_heliport.taxiwaylightsystem_view as
select distinct on (taxiwaylightsystem.identifier,taxiwaylightsystem_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.taxiwaylightsystem.id,
    airport_heliport.taxiwaylightsystem_ts.id as ts_id,
    airport_heliport.taxiwaylightsystem_tsp.id as tsp_id,
    airport_heliport.taxiwaylightsystem.identifier,
    airport_heliport.taxiwaylightsystem_ts.interpretation,
    airport_heliport.taxiwaylightsystem_ts.sequence_number,
    airport_heliport.taxiwaylightsystem_ts.correction_number,
    airport_heliport.taxiwaylightsystem_ts.valid_time_begin,
    airport_heliport.taxiwaylightsystem_ts.valid_time_end,
    airport_heliport.taxiwaylightsystem_ts.feature_lifetime_begin,
    airport_heliport.taxiwaylightsystem_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.taxiwaylightsystem_ts.emergencylighting_value as varchar), '(' || airport_heliport.taxiwaylightsystem_ts.emergencylighting_nilreason || ')') as emergencylighting,
    coalesce(cast(airport_heliport.taxiwaylightsystem_ts.intensitylevel_value as varchar), '(' || airport_heliport.taxiwaylightsystem_ts.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(airport_heliport.taxiwaylightsystem_ts.colour_value as varchar), '(' || airport_heliport.taxiwaylightsystem_ts.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport.taxiwaylightsystem_ts.position_value as varchar), '(' || airport_heliport.taxiwaylightsystem_ts.position_nilreason || ')') as position,
    coalesce(cast(airport_heliport_taxiway_pt_cbltyl.title as varchar), '(' || airport_heliport_taxiway_pt_cbltyl.nilreason[1] || ')') AS lightedtaxiway,
    airport_heliport_taxiway_pt_cbltyl.href AS lightedtaxiway_href,
    jsonb_agg(shared_lightelement_view_xtpokj.id) AS element,
    jsonb_agg(airport_heliport_groundlightingavailability_view_qoarsd.id) AS availability,
    jsonb_agg(notes_note_view_alwbpk.*) AS taxiwaylightsystem_annotation
from airport_heliport.taxiwaylightsystem 
inner join master_join mj2 on airport_heliport.taxiwaylightsystem.id = mj2.source_id
inner join airport_heliport.taxiwaylightsystem_tsp on mj2.target_id = airport_heliport.taxiwaylightsystem_tsp.id
inner join airport_heliport.taxiwaylightsystem_ts on airport_heliport.taxiwaylightsystem_tsp.taxiwaylightsystemtimeslice_id = airport_heliport.taxiwaylightsystem_ts.id
left join airport_heliport.taxiway_pt airport_heliport_taxiway_pt_cbltyl on airport_heliport.taxiwaylightsystem_ts.lightedtaxiway_id = airport_heliport_taxiway_pt_cbltyl.id
left join master_join master_join_xwlvby on airport_heliport.taxiwaylightsystem_ts.id = master_join_xwlvby.source_id
left join shared.lightelement_view shared_lightelement_view_xtpokj on master_join_xwlvby.target_id = shared_lightelement_view_xtpokj.id
left join master_join master_join_wymxkp on airport_heliport.taxiwaylightsystem_ts.id = master_join_wymxkp.source_id
left join airport_heliport.groundlightingavailability_view airport_heliport_groundlightingavailability_view_qoarsd on master_join_wymxkp.target_id = airport_heliport_groundlightingavailability_view_qoarsd.id
left join master_join master_join_ewobqf on airport_heliport.taxiwaylightsystem_ts.id = master_join_ewobqf.source_id
left join notes.note_view notes_note_view_alwbpk on master_join_ewobqf.target_id = notes_note_view_alwbpk.id
where airport_heliport.taxiwaylightsystem.feature_status = 'APPROVED'
  and airport_heliport.taxiwaylightsystem_ts.feature_status = 'APPROVED'
group by
    airport_heliport.taxiwaylightsystem.id,
    airport_heliport.taxiwaylightsystem_ts.id,
    airport_heliport.taxiwaylightsystem_tsp.id,
    airport_heliport.taxiwaylightsystem.identifier,
    airport_heliport.taxiwaylightsystem_ts.interpretation,
    airport_heliport.taxiwaylightsystem_ts.sequence_number,
    airport_heliport.taxiwaylightsystem_ts.correction_number,
    airport_heliport.taxiwaylightsystem_ts.valid_time_begin,
    airport_heliport.taxiwaylightsystem_ts.valid_time_end,
    airport_heliport.taxiwaylightsystem_ts.feature_lifetime_begin,
    airport_heliport.taxiwaylightsystem_ts.feature_lifetime_end,
    airport_heliport.taxiwaylightsystem_ts.emergencylighting_value,
    airport_heliport.taxiwaylightsystem_ts.emergencylighting_nilreason,
    airport_heliport.taxiwaylightsystem_ts.intensitylevel_value,
    airport_heliport.taxiwaylightsystem_ts.intensitylevel_nilreason,
    airport_heliport.taxiwaylightsystem_ts.colour_value,
    airport_heliport.taxiwaylightsystem_ts.colour_nilreason,
    airport_heliport.taxiwaylightsystem_ts.position_value,
    airport_heliport.taxiwaylightsystem_ts.position_nilreason,
    airport_heliport_taxiway_pt_cbltyl.title,
    airport_heliport_taxiway_pt_cbltyl.nilreason[1],
    airport_heliport_taxiway_pt_cbltyl.href
order by taxiwaylightsystem.identifier, taxiwaylightsystem_ts.sequence_number, taxiwaylightsystem_ts.correction_number DESC;
-- TaxiwayMarkingTimeSliceType
-- ['notes.note_view', 'airport_heliport.markingelement_view']
create or replace view airport_heliport.taxiwaymarking_view as
select distinct on (taxiwaymarking.identifier,taxiwaymarking_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.taxiwaymarking.id,
    airport_heliport.taxiwaymarking_ts.id as ts_id,
    airport_heliport.taxiwaymarking_tsp.id as tsp_id,
    airport_heliport.taxiwaymarking.identifier,
    airport_heliport.taxiwaymarking_ts.interpretation,
    airport_heliport.taxiwaymarking_ts.sequence_number,
    airport_heliport.taxiwaymarking_ts.correction_number,
    airport_heliport.taxiwaymarking_ts.valid_time_begin,
    airport_heliport.taxiwaymarking_ts.valid_time_end,
    airport_heliport.taxiwaymarking_ts.feature_lifetime_begin,
    airport_heliport.taxiwaymarking_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.taxiwaymarking_ts.markingicaostandard_value as varchar), '(' || airport_heliport.taxiwaymarking_ts.markingicaostandard_nilreason || ')') as markingicaostandard,
    coalesce(cast(airport_heliport.taxiwaymarking_ts.condition_value as varchar), '(' || airport_heliport.taxiwaymarking_ts.condition_nilreason || ')') as condition,
    coalesce(cast(airport_heliport.taxiwaymarking_ts.markinglocation_value as varchar), '(' || airport_heliport.taxiwaymarking_ts.markinglocation_nilreason || ')') as markinglocation,
    coalesce(cast(airport_heliport_taxiway_pt_zmkqus.title as varchar), '(' || airport_heliport_taxiway_pt_zmkqus.nilreason[1] || ')') AS markedtaxiway,
    airport_heliport_taxiway_pt_zmkqus.href AS markedtaxiway_href,
    coalesce(cast(airport_heliport_taxiwayelement_pt_adhczt.title as varchar), '(' || airport_heliport_taxiwayelement_pt_adhczt.nilreason[1] || ')') AS markedelement,
    airport_heliport_taxiwayelement_pt_adhczt.href AS markedelement_href,
    jsonb_agg(airport_heliport_markingelement_view_whyrkv.id) AS element,
    jsonb_agg(notes_note_view_hthjom.*) AS taxiwaymarking_annotation
from airport_heliport.taxiwaymarking 
inner join master_join mj2 on airport_heliport.taxiwaymarking.id = mj2.source_id
inner join airport_heliport.taxiwaymarking_tsp on mj2.target_id = airport_heliport.taxiwaymarking_tsp.id
inner join airport_heliport.taxiwaymarking_ts on airport_heliport.taxiwaymarking_tsp.taxiwaymarkingtimeslice_id = airport_heliport.taxiwaymarking_ts.id
left join airport_heliport.taxiway_pt airport_heliport_taxiway_pt_zmkqus on airport_heliport.taxiwaymarking_ts.markedtaxiway_id = airport_heliport_taxiway_pt_zmkqus.id
left join airport_heliport.taxiwayelement_pt airport_heliport_taxiwayelement_pt_adhczt on airport_heliport.taxiwaymarking_ts.markedelement_id = airport_heliport_taxiwayelement_pt_adhczt.id
left join master_join master_join_mwlxjo on airport_heliport.taxiwaymarking_ts.id = master_join_mwlxjo.source_id
left join airport_heliport.markingelement_view airport_heliport_markingelement_view_whyrkv on master_join_mwlxjo.target_id = airport_heliport_markingelement_view_whyrkv.id
left join master_join master_join_izujji on airport_heliport.taxiwaymarking_ts.id = master_join_izujji.source_id
left join notes.note_view notes_note_view_hthjom on master_join_izujji.target_id = notes_note_view_hthjom.id
where airport_heliport.taxiwaymarking.feature_status = 'APPROVED'
  and airport_heliport.taxiwaymarking_ts.feature_status = 'APPROVED'
group by
    airport_heliport.taxiwaymarking.id,
    airport_heliport.taxiwaymarking_ts.id,
    airport_heliport.taxiwaymarking_tsp.id,
    airport_heliport.taxiwaymarking.identifier,
    airport_heliport.taxiwaymarking_ts.interpretation,
    airport_heliport.taxiwaymarking_ts.sequence_number,
    airport_heliport.taxiwaymarking_ts.correction_number,
    airport_heliport.taxiwaymarking_ts.valid_time_begin,
    airport_heliport.taxiwaymarking_ts.valid_time_end,
    airport_heliport.taxiwaymarking_ts.feature_lifetime_begin,
    airport_heliport.taxiwaymarking_ts.feature_lifetime_end,
    airport_heliport.taxiwaymarking_ts.markingicaostandard_value,
    airport_heliport.taxiwaymarking_ts.markingicaostandard_nilreason,
    airport_heliport.taxiwaymarking_ts.condition_value,
    airport_heliport.taxiwaymarking_ts.condition_nilreason,
    airport_heliport.taxiwaymarking_ts.markinglocation_value,
    airport_heliport.taxiwaymarking_ts.markinglocation_nilreason,
    airport_heliport_taxiway_pt_zmkqus.title,
    airport_heliport_taxiway_pt_zmkqus.nilreason[1],
    airport_heliport_taxiway_pt_zmkqus.href,
    airport_heliport_taxiwayelement_pt_adhczt.title,
    airport_heliport_taxiwayelement_pt_adhczt.nilreason[1],
    airport_heliport_taxiwayelement_pt_adhczt.href
order by taxiwaymarking.identifier, taxiwaymarking_ts.sequence_number, taxiwaymarking_ts.correction_number DESC;
-- TaxiwayTimeSliceType
-- ['airport_heliport.taxiwaycontamination_view', 'notes.note_view', 'airport_heliport.manoeuvringareaavailability_view']
create or replace view airport_heliport.taxiway_view as
select distinct on (taxiway.identifier,taxiway_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.taxiway.id,
    airport_heliport.taxiway_ts.id as ts_id,
    airport_heliport.taxiway_tsp.id as tsp_id,
    airport_heliport.taxiway.identifier,
    airport_heliport.taxiway_ts.interpretation,
    airport_heliport.taxiway_ts.sequence_number,
    airport_heliport.taxiway_ts.correction_number,
    airport_heliport.taxiway_ts.valid_time_begin,
    airport_heliport.taxiway_ts.valid_time_end,
    airport_heliport.taxiway_ts.feature_lifetime_begin,
    airport_heliport.taxiway_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.taxiway_ts.designator_value as varchar), '(' || airport_heliport.taxiway_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airport_heliport.taxiway_ts.type_value as varchar), '(' || airport_heliport.taxiway_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.taxiway_ts.abandoned_value as varchar), '(' || airport_heliport.taxiway_ts.abandoned_nilreason || ')') as abandoned,
    coalesce(cast(airport_heliport.taxiway_ts.width_value as varchar) || ' ' || airport_heliport.taxiway_ts.width_uom, '(' || airport_heliport.taxiway_ts.width_nilreason || ')') as width,
    coalesce(cast(airport_heliport.taxiway_ts.widthshoulder_value as varchar) || ' ' || airport_heliport.taxiway_ts.widthshoulder_uom, '(' || airport_heliport.taxiway_ts.widthshoulder_nilreason || ')') as widthshoulder,
    coalesce(cast(airport_heliport.taxiway_ts.length_value as varchar) || ' ' || airport_heliport.taxiway_ts.length_uom, '(' || airport_heliport.taxiway_ts.length_nilreason || ')') as length,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_lgfhge.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_lgfhge.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_lgfhge.href AS surfaceproperties_href,
    coalesce(cast(airport_heliport_airportheliport_pt_kzzfou.title as varchar), '(' || airport_heliport_airportheliport_pt_kzzfou.nilreason[1] || ')') AS associatedairportheliport,
    airport_heliport_airportheliport_pt_kzzfou.href AS associatedairportheliport_href,
    jsonb_agg(airport_heliport_taxiwaycontamination_view_xfohqt.id) AS contaminant,
    jsonb_agg(notes_note_view_huiujr.*) AS taxiway_annotation,
    jsonb_agg(airport_heliport_manoeuvringareaavailability_view_biwkhy.id) AS availability
from airport_heliport.taxiway 
inner join master_join mj2 on airport_heliport.taxiway.id = mj2.source_id
inner join airport_heliport.taxiway_tsp on mj2.target_id = airport_heliport.taxiway_tsp.id
inner join airport_heliport.taxiway_ts on airport_heliport.taxiway_tsp.taxiwaytimeslice_id = airport_heliport.taxiway_ts.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_lgfhge on airport_heliport.taxiway_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_lgfhge.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_kzzfou on airport_heliport.taxiway_ts.associatedairportheliport_id = airport_heliport_airportheliport_pt_kzzfou.id
left join master_join master_join_gzxsui on airport_heliport.taxiway_ts.id = master_join_gzxsui.source_id
left join airport_heliport.taxiwaycontamination_view airport_heliport_taxiwaycontamination_view_xfohqt on master_join_gzxsui.target_id = airport_heliport_taxiwaycontamination_view_xfohqt.id
left join master_join master_join_uivqwl on airport_heliport.taxiway_ts.id = master_join_uivqwl.source_id
left join notes.note_view notes_note_view_huiujr on master_join_uivqwl.target_id = notes_note_view_huiujr.id
left join master_join master_join_ieyozw on airport_heliport.taxiway_ts.id = master_join_ieyozw.source_id
left join airport_heliport.manoeuvringareaavailability_view airport_heliport_manoeuvringareaavailability_view_biwkhy on master_join_ieyozw.target_id = airport_heliport_manoeuvringareaavailability_view_biwkhy.id
where airport_heliport.taxiway.feature_status = 'APPROVED'
  and airport_heliport.taxiway_ts.feature_status = 'APPROVED'
group by
    airport_heliport.taxiway.id,
    airport_heliport.taxiway_ts.id,
    airport_heliport.taxiway_tsp.id,
    airport_heliport.taxiway.identifier,
    airport_heliport.taxiway_ts.interpretation,
    airport_heliport.taxiway_ts.sequence_number,
    airport_heliport.taxiway_ts.correction_number,
    airport_heliport.taxiway_ts.valid_time_begin,
    airport_heliport.taxiway_ts.valid_time_end,
    airport_heliport.taxiway_ts.feature_lifetime_begin,
    airport_heliport.taxiway_ts.feature_lifetime_end,
    airport_heliport.taxiway_ts.designator_value,
    airport_heliport.taxiway_ts.designator_nilreason,
    airport_heliport.taxiway_ts.type_value,
    airport_heliport.taxiway_ts.type_nilreason,
    airport_heliport.taxiway_ts.abandoned_value,
    airport_heliport.taxiway_ts.abandoned_nilreason,
    airport_heliport.taxiway_ts.width_value,
    airport_heliport.taxiway_ts.width_uom,
    airport_heliport.taxiway_ts.width_nilreason,
    airport_heliport.taxiway_ts.widthshoulder_value,
    airport_heliport.taxiway_ts.widthshoulder_uom,
    airport_heliport.taxiway_ts.widthshoulder_nilreason,
    airport_heliport.taxiway_ts.length_value,
    airport_heliport.taxiway_ts.length_uom,
    airport_heliport.taxiway_ts.length_nilreason,
    airport_heliport_surfacecharacteristics_pt_lgfhge.title,
    airport_heliport_surfacecharacteristics_pt_lgfhge.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_lgfhge.href,
    airport_heliport_airportheliport_pt_kzzfou.title,
    airport_heliport_airportheliport_pt_kzzfou.nilreason[1],
    airport_heliport_airportheliport_pt_kzzfou.href
order by taxiway.identifier, taxiway_ts.sequence_number, taxiway_ts.correction_number DESC;
-- TerminalArrivalAreaTimeSliceType
-- ['procedure.terminalarrivalareasector_view', 'geometry.surface_view', 'geometry.point_view', 'notes.note_view']
create or replace view procedure.terminalarrivalarea_view as
select distinct on (terminalarrivalarea.identifier,terminalarrivalarea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    procedure.terminalarrivalarea.id,
    procedure.terminalarrivalarea_ts.id as ts_id,
    procedure.terminalarrivalarea_tsp.id as tsp_id,
    procedure.terminalarrivalarea.identifier,
    procedure.terminalarrivalarea_ts.interpretation,
    procedure.terminalarrivalarea_ts.sequence_number,
    procedure.terminalarrivalarea_ts.correction_number,
    procedure.terminalarrivalarea_ts.valid_time_begin,
    procedure.terminalarrivalarea_ts.valid_time_end,
    procedure.terminalarrivalarea_ts.feature_lifetime_begin,
    procedure.terminalarrivalarea_ts.feature_lifetime_end,
    coalesce(cast(procedure.terminalarrivalarea_ts.arrivalareatype_value as varchar), '(' || procedure.terminalarrivalarea_ts.arrivalareatype_nilreason || ')') as arrivalareatype,
    coalesce(cast(procedure.terminalarrivalarea_ts.outerbufferwidth_value as varchar) || ' ' || procedure.terminalarrivalarea_ts.outerbufferwidth_uom, '(' || procedure.terminalarrivalarea_ts.outerbufferwidth_nilreason || ')') as outerbufferwidth,
    coalesce(cast(procedure.terminalarrivalarea_ts.lateralbufferwidth_value as varchar) || ' ' || procedure.terminalarrivalarea_ts.lateralbufferwidth_uom, '(' || procedure.terminalarrivalarea_ts.lateralbufferwidth_nilreason || ')') as lateralbufferwidth,
    coalesce(cast(navaids_points_designatedpoint_pt_fbqpzb.title as varchar), '(' || navaids_points_designatedpoint_pt_fbqpzb.nilreason[1] || ')') AS iffixdesignatedpoint,
    navaids_points_designatedpoint_pt_fbqpzb.href AS iffixdesignatedpoint_href,
    coalesce(cast(navaids_points_designatedpoint_pt_hqdwee.title as varchar), '(' || navaids_points_designatedpoint_pt_hqdwee.nilreason[1] || ')') AS iaffixdesignatedpoint,
    navaids_points_designatedpoint_pt_hqdwee.href AS iaffixdesignatedpoint_href,
    coalesce(cast(navaids_points_navaid_pt_gwjytx.title as varchar), '(' || navaids_points_navaid_pt_gwjytx.nilreason[1] || ')') AS ifnavaidsystem,
    navaids_points_navaid_pt_gwjytx.href AS ifnavaidsystem_href,
    coalesce(cast(navaids_points_navaid_pt_noqeds.title as varchar), '(' || navaids_points_navaid_pt_noqeds.nilreason[1] || ')') AS iafnavaidsystem,
    navaids_points_navaid_pt_noqeds.href AS iafnavaidsystem_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_txynot.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_txynot.nilreason[1] || ')') AS ifaimingpoint,
    airport_heliport_touchdownliftoff_pt_txynot.href AS ifaimingpoint_href,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_bvpayw.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_bvpayw.nilreason[1] || ')') AS iafaimingpoint,
    airport_heliport_touchdownliftoff_pt_bvpayw.href AS iafaimingpoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_gvghxr.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_gvghxr.nilreason[1] || ')') AS ifrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_gvghxr.href AS ifrunwaypoint_href,
    coalesce(cast(airport_heliport_runwaycentrelinepoint_pt_vtxkqz.title as varchar), '(' || airport_heliport_runwaycentrelinepoint_pt_vtxkqz.nilreason[1] || ')') AS iafrunwaypoint,
    airport_heliport_runwaycentrelinepoint_pt_vtxkqz.href AS iafrunwaypoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_iennnb.title as varchar), '(' || airport_heliport_airportheliport_pt_iennnb.nilreason[1] || ')') AS ifairportreferencepoint,
    airport_heliport_airportheliport_pt_iennnb.href AS ifairportreferencepoint_href,
    coalesce(cast(airport_heliport_airportheliport_pt_udwbmb.title as varchar), '(' || airport_heliport_airportheliport_pt_udwbmb.nilreason[1] || ')') AS iafairportreferencepoint,
    airport_heliport_airportheliport_pt_udwbmb.href AS iafairportreferencepoint_href,
    geometry_point_view_dqocyd.geom AS geom,
    ST_X(geometry_point_view_dqocyd.geom) AS longitude,
    ST_Y(geometry_point_view_dqocyd.geom) AS latitude,
    geometry_point_view_dqocyd.horizontalAccuracy,
    geometry_point_view_iarwlg.geom AS geom,
    ST_X(geometry_point_view_iarwlg.geom) AS longitude,
    ST_Y(geometry_point_view_iarwlg.geom) AS latitude,
    geometry_point_view_iarwlg.horizontalAccuracy,
    geometry_surface_view_bnqbnq.geom AS geom,
    coalesce(cast(procedure_instrumentapproachprocedure_pt_geguwd.title as varchar), '(' || procedure_instrumentapproachprocedure_pt_geguwd.nilreason[1] || ')') AS approachrnav,
    procedure_instrumentapproachprocedure_pt_geguwd.href AS approachrnav_href,
    jsonb_agg(procedure_terminalarrivalareasector_view_xfztdm.id) AS sector,
    jsonb_agg(notes_note_view_abxdyh.*) AS terminalarrivalarea_annotation
from procedure.terminalarrivalarea 
inner join master_join mj2 on procedure.terminalarrivalarea.id = mj2.source_id
inner join procedure.terminalarrivalarea_tsp on mj2.target_id = procedure.terminalarrivalarea_tsp.id
inner join procedure.terminalarrivalarea_ts on procedure.terminalarrivalarea_tsp.terminalarrivalareatimeslice_id = procedure.terminalarrivalarea_ts.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_fbqpzb on procedure.terminalarrivalarea_ts.if_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_fbqpzb.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_gwjytx on procedure.terminalarrivalarea_ts.if_navaidsystem_id = navaids_points_navaid_pt_gwjytx.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_txynot on procedure.terminalarrivalarea_ts.if_aimingpoint_id = airport_heliport_touchdownliftoff_pt_txynot.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_gvghxr on procedure.terminalarrivalarea_ts.if_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_gvghxr.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_iennnb on procedure.terminalarrivalarea_ts.if_airportreferencepoint_id = airport_heliport_airportheliport_pt_iennnb.id
left join geometry.point_view geometry_point_view_dqocyd on procedure.terminalarrivalarea_ts.if_position_id = geometry_point_view_dqocyd.id
left join navaids_points.designatedpoint_pt navaids_points_designatedpoint_pt_hqdwee on procedure.terminalarrivalarea_ts.iaf_fixdesignatedpoint_id = navaids_points_designatedpoint_pt_hqdwee.id
left join navaids_points.navaid_pt navaids_points_navaid_pt_noqeds on procedure.terminalarrivalarea_ts.iaf_navaidsystem_id = navaids_points_navaid_pt_noqeds.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_bvpayw on procedure.terminalarrivalarea_ts.iaf_aimingpoint_id = airport_heliport_touchdownliftoff_pt_bvpayw.id
left join airport_heliport.runwaycentrelinepoint_pt airport_heliport_runwaycentrelinepoint_pt_vtxkqz on procedure.terminalarrivalarea_ts.iaf_runwaypoint_id = airport_heliport_runwaycentrelinepoint_pt_vtxkqz.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_udwbmb on procedure.terminalarrivalarea_ts.iaf_airportreferencepoint_id = airport_heliport_airportheliport_pt_udwbmb.id
left join geometry.point_view geometry_point_view_iarwlg on procedure.terminalarrivalarea_ts.iaf_position_id = geometry_point_view_iarwlg.id
left join geometry.surface_view geometry_surface_view_bnqbnq on procedure.terminalarrivalarea_ts.buffer_id = geometry_surface_view_bnqbnq.id
left join procedure.instrumentapproachprocedure_pt procedure_instrumentapproachprocedure_pt_geguwd on procedure.terminalarrivalarea_ts.approachrnav_id = procedure_instrumentapproachprocedure_pt_geguwd.id
left join master_join master_join_lccros on procedure.terminalarrivalarea_ts.id = master_join_lccros.source_id
left join procedure.terminalarrivalareasector_view procedure_terminalarrivalareasector_view_xfztdm on master_join_lccros.target_id = procedure_terminalarrivalareasector_view_xfztdm.id
left join master_join master_join_xsytyr on procedure.terminalarrivalarea_ts.id = master_join_xsytyr.source_id
left join notes.note_view notes_note_view_abxdyh on master_join_xsytyr.target_id = notes_note_view_abxdyh.id
where procedure.terminalarrivalarea.feature_status = 'APPROVED'
  and procedure.terminalarrivalarea_ts.feature_status = 'APPROVED'
group by
    procedure.terminalarrivalarea.id,
    procedure.terminalarrivalarea_ts.id,
    procedure.terminalarrivalarea_tsp.id,
    procedure.terminalarrivalarea.identifier,
    procedure.terminalarrivalarea_ts.interpretation,
    procedure.terminalarrivalarea_ts.sequence_number,
    procedure.terminalarrivalarea_ts.correction_number,
    procedure.terminalarrivalarea_ts.valid_time_begin,
    procedure.terminalarrivalarea_ts.valid_time_end,
    procedure.terminalarrivalarea_ts.feature_lifetime_begin,
    procedure.terminalarrivalarea_ts.feature_lifetime_end,
    procedure.terminalarrivalarea_ts.arrivalareatype_value,
    procedure.terminalarrivalarea_ts.arrivalareatype_nilreason,
    procedure.terminalarrivalarea_ts.outerbufferwidth_value,
    procedure.terminalarrivalarea_ts.outerbufferwidth_uom,
    procedure.terminalarrivalarea_ts.outerbufferwidth_nilreason,
    procedure.terminalarrivalarea_ts.lateralbufferwidth_value,
    procedure.terminalarrivalarea_ts.lateralbufferwidth_uom,
    procedure.terminalarrivalarea_ts.lateralbufferwidth_nilreason,
    navaids_points_designatedpoint_pt_fbqpzb.title,
    navaids_points_designatedpoint_pt_fbqpzb.nilreason[1],
    navaids_points_designatedpoint_pt_fbqpzb.href,
    navaids_points_navaid_pt_gwjytx.title,
    navaids_points_navaid_pt_gwjytx.nilreason[1],
    navaids_points_navaid_pt_gwjytx.href,
    airport_heliport_touchdownliftoff_pt_txynot.title,
    airport_heliport_touchdownliftoff_pt_txynot.nilreason[1],
    airport_heliport_touchdownliftoff_pt_txynot.href,
    airport_heliport_runwaycentrelinepoint_pt_gvghxr.title,
    airport_heliport_runwaycentrelinepoint_pt_gvghxr.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_gvghxr.href,
    airport_heliport_airportheliport_pt_iennnb.title,
    airport_heliport_airportheliport_pt_iennnb.nilreason[1],
    airport_heliport_airportheliport_pt_iennnb.href,
    geometry_point_view_dqocyd.geom,
    geometry_point_view_dqocyd.horizontalAccuracy,
    navaids_points_designatedpoint_pt_hqdwee.title,
    navaids_points_designatedpoint_pt_hqdwee.nilreason[1],
    navaids_points_designatedpoint_pt_hqdwee.href,
    navaids_points_navaid_pt_noqeds.title,
    navaids_points_navaid_pt_noqeds.nilreason[1],
    navaids_points_navaid_pt_noqeds.href,
    airport_heliport_touchdownliftoff_pt_bvpayw.title,
    airport_heliport_touchdownliftoff_pt_bvpayw.nilreason[1],
    airport_heliport_touchdownliftoff_pt_bvpayw.href,
    airport_heliport_runwaycentrelinepoint_pt_vtxkqz.title,
    airport_heliport_runwaycentrelinepoint_pt_vtxkqz.nilreason[1],
    airport_heliport_runwaycentrelinepoint_pt_vtxkqz.href,
    airport_heliport_airportheliport_pt_udwbmb.title,
    airport_heliport_airportheliport_pt_udwbmb.nilreason[1],
    airport_heliport_airportheliport_pt_udwbmb.href,
    geometry_point_view_iarwlg.geom,
    geometry_point_view_iarwlg.horizontalAccuracy,
    geometry_surface_view_bnqbnq.geom,
    procedure_instrumentapproachprocedure_pt_geguwd.title,
    procedure_instrumentapproachprocedure_pt_geguwd.nilreason[1],
    procedure_instrumentapproachprocedure_pt_geguwd.href
order by terminalarrivalarea.identifier, terminalarrivalarea_ts.sequence_number, terminalarrivalarea_ts.correction_number DESC;
-- TouchDownLiftOffLightSystemTimeSliceType
-- ['shared.lightelement_view', 'airport_heliport.groundlightingavailability_view', 'notes.note_view']
create or replace view airport_heliport.touchdownliftofflightsystem_view as
select distinct on (touchdownliftofflightsystem.identifier,touchdownliftofflightsystem_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.touchdownliftofflightsystem.id,
    airport_heliport.touchdownliftofflightsystem_ts.id as ts_id,
    airport_heliport.touchdownliftofflightsystem_tsp.id as tsp_id,
    airport_heliport.touchdownliftofflightsystem.identifier,
    airport_heliport.touchdownliftofflightsystem_ts.interpretation,
    airport_heliport.touchdownliftofflightsystem_ts.sequence_number,
    airport_heliport.touchdownliftofflightsystem_ts.correction_number,
    airport_heliport.touchdownliftofflightsystem_ts.valid_time_begin,
    airport_heliport.touchdownliftofflightsystem_ts.valid_time_end,
    airport_heliport.touchdownliftofflightsystem_ts.feature_lifetime_begin,
    airport_heliport.touchdownliftofflightsystem_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.touchdownliftofflightsystem_ts.emergencylighting_value as varchar), '(' || airport_heliport.touchdownliftofflightsystem_ts.emergencylighting_nilreason || ')') as emergencylighting,
    coalesce(cast(airport_heliport.touchdownliftofflightsystem_ts.intensitylevel_value as varchar), '(' || airport_heliport.touchdownliftofflightsystem_ts.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(airport_heliport.touchdownliftofflightsystem_ts.colour_value as varchar), '(' || airport_heliport.touchdownliftofflightsystem_ts.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport.touchdownliftofflightsystem_ts.position_value as varchar), '(' || airport_heliport.touchdownliftofflightsystem_ts.position_nilreason || ')') as position,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_xxoowx.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_xxoowx.nilreason[1] || ')') AS lightedtouchdownliftoff,
    airport_heliport_touchdownliftoff_pt_xxoowx.href AS lightedtouchdownliftoff_href,
    jsonb_agg(shared_lightelement_view_wnxgoj.id) AS element,
    jsonb_agg(airport_heliport_groundlightingavailability_view_jolfgt.id) AS availability,
    jsonb_agg(notes_note_view_clzdsi.*) AS touchdownliftofflightsystem_annotation
from airport_heliport.touchdownliftofflightsystem 
inner join master_join mj2 on airport_heliport.touchdownliftofflightsystem.id = mj2.source_id
inner join airport_heliport.touchdownliftofflightsystem_tsp on mj2.target_id = airport_heliport.touchdownliftofflightsystem_tsp.id
inner join airport_heliport.touchdownliftofflightsystem_ts on airport_heliport.touchdownliftofflightsystem_tsp.touchdownliftofflightsystemtimeslice_id = airport_heliport.touchdownliftofflightsystem_ts.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_xxoowx on airport_heliport.touchdownliftofflightsystem_ts.lightedtouchdownliftoff_id = airport_heliport_touchdownliftoff_pt_xxoowx.id
left join master_join master_join_swzsna on airport_heliport.touchdownliftofflightsystem_ts.id = master_join_swzsna.source_id
left join shared.lightelement_view shared_lightelement_view_wnxgoj on master_join_swzsna.target_id = shared_lightelement_view_wnxgoj.id
left join master_join master_join_dvdozq on airport_heliport.touchdownliftofflightsystem_ts.id = master_join_dvdozq.source_id
left join airport_heliport.groundlightingavailability_view airport_heliport_groundlightingavailability_view_jolfgt on master_join_dvdozq.target_id = airport_heliport_groundlightingavailability_view_jolfgt.id
left join master_join master_join_sljlog on airport_heliport.touchdownliftofflightsystem_ts.id = master_join_sljlog.source_id
left join notes.note_view notes_note_view_clzdsi on master_join_sljlog.target_id = notes_note_view_clzdsi.id
where airport_heliport.touchdownliftofflightsystem.feature_status = 'APPROVED'
  and airport_heliport.touchdownliftofflightsystem_ts.feature_status = 'APPROVED'
group by
    airport_heliport.touchdownliftofflightsystem.id,
    airport_heliport.touchdownliftofflightsystem_ts.id,
    airport_heliport.touchdownliftofflightsystem_tsp.id,
    airport_heliport.touchdownliftofflightsystem.identifier,
    airport_heliport.touchdownliftofflightsystem_ts.interpretation,
    airport_heliport.touchdownliftofflightsystem_ts.sequence_number,
    airport_heliport.touchdownliftofflightsystem_ts.correction_number,
    airport_heliport.touchdownliftofflightsystem_ts.valid_time_begin,
    airport_heliport.touchdownliftofflightsystem_ts.valid_time_end,
    airport_heliport.touchdownliftofflightsystem_ts.feature_lifetime_begin,
    airport_heliport.touchdownliftofflightsystem_ts.feature_lifetime_end,
    airport_heliport.touchdownliftofflightsystem_ts.emergencylighting_value,
    airport_heliport.touchdownliftofflightsystem_ts.emergencylighting_nilreason,
    airport_heliport.touchdownliftofflightsystem_ts.intensitylevel_value,
    airport_heliport.touchdownliftofflightsystem_ts.intensitylevel_nilreason,
    airport_heliport.touchdownliftofflightsystem_ts.colour_value,
    airport_heliport.touchdownliftofflightsystem_ts.colour_nilreason,
    airport_heliport.touchdownliftofflightsystem_ts.position_value,
    airport_heliport.touchdownliftofflightsystem_ts.position_nilreason,
    airport_heliport_touchdownliftoff_pt_xxoowx.title,
    airport_heliport_touchdownliftoff_pt_xxoowx.nilreason[1],
    airport_heliport_touchdownliftoff_pt_xxoowx.href
order by touchdownliftofflightsystem.identifier, touchdownliftofflightsystem_ts.sequence_number, touchdownliftofflightsystem_ts.correction_number DESC;
-- TouchDownLiftOffMarkingTimeSliceType
-- ['notes.note_view', 'airport_heliport.markingelement_view']
create or replace view airport_heliport.touchdownliftoffmarking_view as
select distinct on (touchdownliftoffmarking.identifier,touchdownliftoffmarking_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.touchdownliftoffmarking.id,
    airport_heliport.touchdownliftoffmarking_ts.id as ts_id,
    airport_heliport.touchdownliftoffmarking_tsp.id as tsp_id,
    airport_heliport.touchdownliftoffmarking.identifier,
    airport_heliport.touchdownliftoffmarking_ts.interpretation,
    airport_heliport.touchdownliftoffmarking_ts.sequence_number,
    airport_heliport.touchdownliftoffmarking_ts.correction_number,
    airport_heliport.touchdownliftoffmarking_ts.valid_time_begin,
    airport_heliport.touchdownliftoffmarking_ts.valid_time_end,
    airport_heliport.touchdownliftoffmarking_ts.feature_lifetime_begin,
    airport_heliport.touchdownliftoffmarking_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.touchdownliftoffmarking_ts.markingicaostandard_value as varchar), '(' || airport_heliport.touchdownliftoffmarking_ts.markingicaostandard_nilreason || ')') as markingicaostandard,
    coalesce(cast(airport_heliport.touchdownliftoffmarking_ts.condition_value as varchar), '(' || airport_heliport.touchdownliftoffmarking_ts.condition_nilreason || ')') as condition,
    coalesce(cast(airport_heliport.touchdownliftoffmarking_ts.markinglocation_value as varchar), '(' || airport_heliport.touchdownliftoffmarking_ts.markinglocation_nilreason || ')') as markinglocation,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_jicsfb.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_jicsfb.nilreason[1] || ')') AS markedtouchdownliftoff,
    airport_heliport_touchdownliftoff_pt_jicsfb.href AS markedtouchdownliftoff_href,
    jsonb_agg(airport_heliport_markingelement_view_tmnxqt.id) AS element,
    jsonb_agg(notes_note_view_lifgcv.*) AS touchdownliftoffmarking_annotation
from airport_heliport.touchdownliftoffmarking 
inner join master_join mj2 on airport_heliport.touchdownliftoffmarking.id = mj2.source_id
inner join airport_heliport.touchdownliftoffmarking_tsp on mj2.target_id = airport_heliport.touchdownliftoffmarking_tsp.id
inner join airport_heliport.touchdownliftoffmarking_ts on airport_heliport.touchdownliftoffmarking_tsp.touchdownliftoffmarkingtimeslice_id = airport_heliport.touchdownliftoffmarking_ts.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_jicsfb on airport_heliport.touchdownliftoffmarking_ts.markedtouchdownliftoff_id = airport_heliport_touchdownliftoff_pt_jicsfb.id
left join master_join master_join_fvqyzf on airport_heliport.touchdownliftoffmarking_ts.id = master_join_fvqyzf.source_id
left join airport_heliport.markingelement_view airport_heliport_markingelement_view_tmnxqt on master_join_fvqyzf.target_id = airport_heliport_markingelement_view_tmnxqt.id
left join master_join master_join_szdkes on airport_heliport.touchdownliftoffmarking_ts.id = master_join_szdkes.source_id
left join notes.note_view notes_note_view_lifgcv on master_join_szdkes.target_id = notes_note_view_lifgcv.id
where airport_heliport.touchdownliftoffmarking.feature_status = 'APPROVED'
  and airport_heliport.touchdownliftoffmarking_ts.feature_status = 'APPROVED'
group by
    airport_heliport.touchdownliftoffmarking.id,
    airport_heliport.touchdownliftoffmarking_ts.id,
    airport_heliport.touchdownliftoffmarking_tsp.id,
    airport_heliport.touchdownliftoffmarking.identifier,
    airport_heliport.touchdownliftoffmarking_ts.interpretation,
    airport_heliport.touchdownliftoffmarking_ts.sequence_number,
    airport_heliport.touchdownliftoffmarking_ts.correction_number,
    airport_heliport.touchdownliftoffmarking_ts.valid_time_begin,
    airport_heliport.touchdownliftoffmarking_ts.valid_time_end,
    airport_heliport.touchdownliftoffmarking_ts.feature_lifetime_begin,
    airport_heliport.touchdownliftoffmarking_ts.feature_lifetime_end,
    airport_heliport.touchdownliftoffmarking_ts.markingicaostandard_value,
    airport_heliport.touchdownliftoffmarking_ts.markingicaostandard_nilreason,
    airport_heliport.touchdownliftoffmarking_ts.condition_value,
    airport_heliport.touchdownliftoffmarking_ts.condition_nilreason,
    airport_heliport.touchdownliftoffmarking_ts.markinglocation_value,
    airport_heliport.touchdownliftoffmarking_ts.markinglocation_nilreason,
    airport_heliport_touchdownliftoff_pt_jicsfb.title,
    airport_heliport_touchdownliftoff_pt_jicsfb.nilreason[1],
    airport_heliport_touchdownliftoff_pt_jicsfb.href
order by touchdownliftoffmarking.identifier, touchdownliftoffmarking_ts.sequence_number, touchdownliftoffmarking_ts.correction_number DESC;
-- TouchDownLiftOffSafeAreaTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view']
create or replace view airport_heliport.touchdownliftoffsafearea_view as
select distinct on (touchdownliftoffsafearea.identifier,touchdownliftoffsafearea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.touchdownliftoffsafearea.id,
    airport_heliport.touchdownliftoffsafearea_ts.id as ts_id,
    airport_heliport.touchdownliftoffsafearea_tsp.id as tsp_id,
    airport_heliport.touchdownliftoffsafearea.identifier,
    airport_heliport.touchdownliftoffsafearea_ts.interpretation,
    airport_heliport.touchdownliftoffsafearea_ts.sequence_number,
    airport_heliport.touchdownliftoffsafearea_ts.correction_number,
    airport_heliport.touchdownliftoffsafearea_ts.valid_time_begin,
    airport_heliport.touchdownliftoffsafearea_ts.valid_time_end,
    airport_heliport.touchdownliftoffsafearea_ts.feature_lifetime_begin,
    airport_heliport.touchdownliftoffsafearea_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.touchdownliftoffsafearea_ts.lighting_value as varchar), '(' || airport_heliport.touchdownliftoffsafearea_ts.lighting_nilreason || ')') as lighting,
    coalesce(cast(airport_heliport.touchdownliftoffsafearea_ts.obstaclefree_value as varchar), '(' || airport_heliport.touchdownliftoffsafearea_ts.obstaclefree_nilreason || ')') as obstaclefree,
    coalesce(cast(airport_heliport.touchdownliftoffsafearea_ts.width_value as varchar) || ' ' || airport_heliport.touchdownliftoffsafearea_ts.width_uom, '(' || airport_heliport.touchdownliftoffsafearea_ts.width_nilreason || ')') as width,
    coalesce(cast(airport_heliport.touchdownliftoffsafearea_ts.length_value as varchar) || ' ' || airport_heliport.touchdownliftoffsafearea_ts.length_uom, '(' || airport_heliport.touchdownliftoffsafearea_ts.length_nilreason || ')') as length,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_sjcqgi.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_sjcqgi.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_sjcqgi.href AS surfaceproperties_href,
    geometry_elevatedsurface_view_jldzfu.geom AS geom,
    geometry_elevatedsurface_view_jldzfu.elevation,
    geometry_elevatedsurface_view_jldzfu.geoidUndulation,
    geometry_elevatedsurface_view_jldzfu.verticalDatum,
    geometry_elevatedsurface_view_jldzfu.verticalAccuracy,
    geometry_elevatedsurface_view_jldzfu.horizontalAccuracy,
    coalesce(cast(airport_heliport_touchdownliftoff_pt_gyctst.title as varchar), '(' || airport_heliport_touchdownliftoff_pt_gyctst.nilreason[1] || ')') AS protectedtouchdownliftoff,
    airport_heliport_touchdownliftoff_pt_gyctst.href AS protectedtouchdownliftoff_href,
    jsonb_agg(notes_note_view_kknbkw.*) AS touchdownliftoffsafearea_annotation
from airport_heliport.touchdownliftoffsafearea 
inner join master_join mj2 on airport_heliport.touchdownliftoffsafearea.id = mj2.source_id
inner join airport_heliport.touchdownliftoffsafearea_tsp on mj2.target_id = airport_heliport.touchdownliftoffsafearea_tsp.id
inner join airport_heliport.touchdownliftoffsafearea_ts on airport_heliport.touchdownliftoffsafearea_tsp.touchdownliftoffsafeareatimeslice_id = airport_heliport.touchdownliftoffsafearea_ts.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_sjcqgi on airport_heliport.touchdownliftoffsafearea_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_sjcqgi.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_jldzfu on airport_heliport.touchdownliftoffsafearea_ts.extent_id = geometry_elevatedsurface_view_jldzfu.id
left join airport_heliport.touchdownliftoff_pt airport_heliport_touchdownliftoff_pt_gyctst on airport_heliport.touchdownliftoffsafearea_ts.protectedtouchdownliftoff_id = airport_heliport_touchdownliftoff_pt_gyctst.id
left join master_join master_join_sipuvp on airport_heliport.touchdownliftoffsafearea_ts.id = master_join_sipuvp.source_id
left join notes.note_view notes_note_view_kknbkw on master_join_sipuvp.target_id = notes_note_view_kknbkw.id
where airport_heliport.touchdownliftoffsafearea.feature_status = 'APPROVED'
  and airport_heliport.touchdownliftoffsafearea_ts.feature_status = 'APPROVED'
group by
    airport_heliport.touchdownliftoffsafearea.id,
    airport_heliport.touchdownliftoffsafearea_ts.id,
    airport_heliport.touchdownliftoffsafearea_tsp.id,
    airport_heliport.touchdownliftoffsafearea.identifier,
    airport_heliport.touchdownliftoffsafearea_ts.interpretation,
    airport_heliport.touchdownliftoffsafearea_ts.sequence_number,
    airport_heliport.touchdownliftoffsafearea_ts.correction_number,
    airport_heliport.touchdownliftoffsafearea_ts.valid_time_begin,
    airport_heliport.touchdownliftoffsafearea_ts.valid_time_end,
    airport_heliport.touchdownliftoffsafearea_ts.feature_lifetime_begin,
    airport_heliport.touchdownliftoffsafearea_ts.feature_lifetime_end,
    airport_heliport.touchdownliftoffsafearea_ts.lighting_value,
    airport_heliport.touchdownliftoffsafearea_ts.lighting_nilreason,
    airport_heliport.touchdownliftoffsafearea_ts.obstaclefree_value,
    airport_heliport.touchdownliftoffsafearea_ts.obstaclefree_nilreason,
    airport_heliport.touchdownliftoffsafearea_ts.width_value,
    airport_heliport.touchdownliftoffsafearea_ts.width_uom,
    airport_heliport.touchdownliftoffsafearea_ts.width_nilreason,
    airport_heliport.touchdownliftoffsafearea_ts.length_value,
    airport_heliport.touchdownliftoffsafearea_ts.length_uom,
    airport_heliport.touchdownliftoffsafearea_ts.length_nilreason,
    airport_heliport_surfacecharacteristics_pt_sjcqgi.title,
    airport_heliport_surfacecharacteristics_pt_sjcqgi.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_sjcqgi.href,
    geometry_elevatedsurface_view_jldzfu.geom,
    geometry_elevatedsurface_view_jldzfu.elevation,
    geometry_elevatedsurface_view_jldzfu.geoidUndulation,
    geometry_elevatedsurface_view_jldzfu.verticalDatum,
    geometry_elevatedsurface_view_jldzfu.verticalAccuracy,
    geometry_elevatedsurface_view_jldzfu.horizontalAccuracy,
    airport_heliport_touchdownliftoff_pt_gyctst.title,
    airport_heliport_touchdownliftoff_pt_gyctst.nilreason[1],
    airport_heliport_touchdownliftoff_pt_gyctst.href
order by touchdownliftoffsafearea.identifier, touchdownliftoffsafearea_ts.sequence_number, touchdownliftoffsafearea_ts.correction_number DESC;
-- TouchDownLiftOffTimeSliceType
-- ['notes.note_view', 'geometry.elevatedsurface_view', 'geometry.elevatedpoint_view', 'airport_heliport.touchdownliftoffcontamination_view', 'airport_heliport.manoeuvringareaavailability_view']
create or replace view airport_heliport.touchdownliftoff_view as
select distinct on (touchdownliftoff.identifier,touchdownliftoff_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.touchdownliftoff.id,
    airport_heliport.touchdownliftoff_ts.id as ts_id,
    airport_heliport.touchdownliftoff_tsp.id as tsp_id,
    airport_heliport.touchdownliftoff.identifier,
    airport_heliport.touchdownliftoff_ts.interpretation,
    airport_heliport.touchdownliftoff_ts.sequence_number,
    airport_heliport.touchdownliftoff_ts.correction_number,
    airport_heliport.touchdownliftoff_ts.valid_time_begin,
    airport_heliport.touchdownliftoff_ts.valid_time_end,
    airport_heliport.touchdownliftoff_ts.feature_lifetime_begin,
    airport_heliport.touchdownliftoff_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.touchdownliftoff_ts.designator_value as varchar), '(' || airport_heliport.touchdownliftoff_ts.designator_nilreason || ')') as designator,
    coalesce(cast(airport_heliport.touchdownliftoff_ts.slope_value as varchar), '(' || airport_heliport.touchdownliftoff_ts.slope_nilreason || ')') as slope,
    coalesce(cast(airport_heliport.touchdownliftoff_ts.helicopterclass_value as varchar), '(' || airport_heliport.touchdownliftoff_ts.helicopterclass_nilreason || ')') as helicopterclass,
    coalesce(cast(airport_heliport.touchdownliftoff_ts.abandoned_value as varchar), '(' || airport_heliport.touchdownliftoff_ts.abandoned_nilreason || ')') as abandoned,
    coalesce(cast(airport_heliport.touchdownliftoff_ts.length_value as varchar) || ' ' || airport_heliport.touchdownliftoff_ts.length_uom, '(' || airport_heliport.touchdownliftoff_ts.length_nilreason || ')') as length,
    coalesce(cast(airport_heliport.touchdownliftoff_ts.width_value as varchar) || ' ' || airport_heliport.touchdownliftoff_ts.width_uom, '(' || airport_heliport.touchdownliftoff_ts.width_nilreason || ')') as width,
    geometry_elevatedpoint_view_vvghqh.geom AS geom,
    ST_X(geometry_elevatedpoint_view_vvghqh.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_vvghqh.geom) AS latitude,
    geometry_elevatedpoint_view_vvghqh.elevation,
    geometry_elevatedpoint_view_vvghqh.geoidUndulation,
    geometry_elevatedpoint_view_vvghqh.verticalDatum,
    geometry_elevatedpoint_view_vvghqh.verticalAccuracy,
    geometry_elevatedpoint_view_vvghqh.horizontalAccuracy,
    geometry_elevatedsurface_view_fcpqjj.geom AS geom,
    geometry_elevatedsurface_view_fcpqjj.elevation,
    geometry_elevatedsurface_view_fcpqjj.geoidUndulation,
    geometry_elevatedsurface_view_fcpqjj.verticalDatum,
    geometry_elevatedsurface_view_fcpqjj.verticalAccuracy,
    geometry_elevatedsurface_view_fcpqjj.horizontalAccuracy,
    coalesce(cast(airport_heliport_surfacecharacteristics_pt_twntlo.title as varchar), '(' || airport_heliport_surfacecharacteristics_pt_twntlo.nilreason[1] || ')') AS surfaceproperties,
    airport_heliport_surfacecharacteristics_pt_twntlo.href AS surfaceproperties_href,
    coalesce(cast(airport_heliport_airportheliport_pt_deaqhm.title as varchar), '(' || airport_heliport_airportheliport_pt_deaqhm.nilreason[1] || ')') AS associatedairportheliport,
    airport_heliport_airportheliport_pt_deaqhm.href AS associatedairportheliport_href,
    coalesce(cast(airport_heliport_runway_pt_rbyfur.title as varchar), '(' || airport_heliport_runway_pt_rbyfur.nilreason[1] || ')') AS approachtakeoffarea,
    airport_heliport_runway_pt_rbyfur.href AS approachtakeoffarea_href,
    jsonb_agg(airport_heliport_touchdownliftoffcontamination_view_xvoyvj.id) AS contaminant,
    jsonb_agg(notes_note_view_tueapa.*) AS touchdownliftoff_annotation,
    jsonb_agg(airport_heliport_manoeuvringareaavailability_view_zklsjd.id) AS availability
from airport_heliport.touchdownliftoff 
inner join master_join mj2 on airport_heliport.touchdownliftoff.id = mj2.source_id
inner join airport_heliport.touchdownliftoff_tsp on mj2.target_id = airport_heliport.touchdownliftoff_tsp.id
inner join airport_heliport.touchdownliftoff_ts on airport_heliport.touchdownliftoff_tsp.touchdownliftofftimeslice_id = airport_heliport.touchdownliftoff_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_vvghqh on airport_heliport.touchdownliftoff_ts.aimingpoint_id = geometry_elevatedpoint_view_vvghqh.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_fcpqjj on airport_heliport.touchdownliftoff_ts.extent_id = geometry_elevatedsurface_view_fcpqjj.id
left join airport_heliport.surfacecharacteristics_pt airport_heliport_surfacecharacteristics_pt_twntlo on airport_heliport.touchdownliftoff_ts.surfaceproperties_id = airport_heliport_surfacecharacteristics_pt_twntlo.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_deaqhm on airport_heliport.touchdownliftoff_ts.associatedairportheliport_id = airport_heliport_airportheliport_pt_deaqhm.id
left join airport_heliport.runway_pt airport_heliport_runway_pt_rbyfur on airport_heliport.touchdownliftoff_ts.approachtakeoffarea_id = airport_heliport_runway_pt_rbyfur.id
left join master_join master_join_keajzw on airport_heliport.touchdownliftoff_ts.id = master_join_keajzw.source_id
left join airport_heliport.touchdownliftoffcontamination_view airport_heliport_touchdownliftoffcontamination_view_xvoyvj on master_join_keajzw.target_id = airport_heliport_touchdownliftoffcontamination_view_xvoyvj.id
left join master_join master_join_jealbf on airport_heliport.touchdownliftoff_ts.id = master_join_jealbf.source_id
left join notes.note_view notes_note_view_tueapa on master_join_jealbf.target_id = notes_note_view_tueapa.id
left join master_join master_join_kcyrzz on airport_heliport.touchdownliftoff_ts.id = master_join_kcyrzz.source_id
left join airport_heliport.manoeuvringareaavailability_view airport_heliport_manoeuvringareaavailability_view_zklsjd on master_join_kcyrzz.target_id = airport_heliport_manoeuvringareaavailability_view_zklsjd.id
where airport_heliport.touchdownliftoff.feature_status = 'APPROVED'
  and airport_heliport.touchdownliftoff_ts.feature_status = 'APPROVED'
group by
    airport_heliport.touchdownliftoff.id,
    airport_heliport.touchdownliftoff_ts.id,
    airport_heliport.touchdownliftoff_tsp.id,
    airport_heliport.touchdownliftoff.identifier,
    airport_heliport.touchdownliftoff_ts.interpretation,
    airport_heliport.touchdownliftoff_ts.sequence_number,
    airport_heliport.touchdownliftoff_ts.correction_number,
    airport_heliport.touchdownliftoff_ts.valid_time_begin,
    airport_heliport.touchdownliftoff_ts.valid_time_end,
    airport_heliport.touchdownliftoff_ts.feature_lifetime_begin,
    airport_heliport.touchdownliftoff_ts.feature_lifetime_end,
    airport_heliport.touchdownliftoff_ts.designator_value,
    airport_heliport.touchdownliftoff_ts.designator_nilreason,
    airport_heliport.touchdownliftoff_ts.slope_value,
    airport_heliport.touchdownliftoff_ts.slope_nilreason,
    airport_heliport.touchdownliftoff_ts.helicopterclass_value,
    airport_heliport.touchdownliftoff_ts.helicopterclass_nilreason,
    airport_heliport.touchdownliftoff_ts.abandoned_value,
    airport_heliport.touchdownliftoff_ts.abandoned_nilreason,
    airport_heliport.touchdownliftoff_ts.length_value,
    airport_heliport.touchdownliftoff_ts.length_uom,
    airport_heliport.touchdownliftoff_ts.length_nilreason,
    airport_heliport.touchdownliftoff_ts.width_value,
    airport_heliport.touchdownliftoff_ts.width_uom,
    airport_heliport.touchdownliftoff_ts.width_nilreason,
    geometry_elevatedpoint_view_vvghqh.geom,
    geometry_elevatedpoint_view_vvghqh.elevation,
    geometry_elevatedpoint_view_vvghqh.geoidUndulation,
    geometry_elevatedpoint_view_vvghqh.verticalDatum,
    geometry_elevatedpoint_view_vvghqh.verticalAccuracy,
    geometry_elevatedpoint_view_vvghqh.horizontalAccuracy,
    geometry_elevatedsurface_view_fcpqjj.geom,
    geometry_elevatedsurface_view_fcpqjj.elevation,
    geometry_elevatedsurface_view_fcpqjj.geoidUndulation,
    geometry_elevatedsurface_view_fcpqjj.verticalDatum,
    geometry_elevatedsurface_view_fcpqjj.verticalAccuracy,
    geometry_elevatedsurface_view_fcpqjj.horizontalAccuracy,
    airport_heliport_surfacecharacteristics_pt_twntlo.title,
    airport_heliport_surfacecharacteristics_pt_twntlo.nilreason[1],
    airport_heliport_surfacecharacteristics_pt_twntlo.href,
    airport_heliport_airportheliport_pt_deaqhm.title,
    airport_heliport_airportheliport_pt_deaqhm.nilreason[1],
    airport_heliport_airportheliport_pt_deaqhm.href,
    airport_heliport_runway_pt_rbyfur.title,
    airport_heliport_runway_pt_rbyfur.nilreason[1],
    airport_heliport_runway_pt_rbyfur.href
order by touchdownliftoff.identifier, touchdownliftoff_ts.sequence_number, touchdownliftoff_ts.correction_number DESC;
-- UnitTimeSliceType
-- ['organisation.unitdependency_view', 'notes.note_view', 'shared.contactinformation_view', 'organisation.unitavailability_view', 'geometry.elevatedpoint_view']
create or replace view organisation.unit_view as
select distinct on (unit.identifier,unit_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    organisation.unit.id,
    organisation.unit_ts.id as ts_id,
    organisation.unit_tsp.id as tsp_id,
    organisation.unit.identifier,
    organisation.unit_ts.interpretation,
    organisation.unit_ts.sequence_number,
    organisation.unit_ts.correction_number,
    organisation.unit_ts.valid_time_begin,
    organisation.unit_ts.valid_time_end,
    organisation.unit_ts.feature_lifetime_begin,
    organisation.unit_ts.feature_lifetime_end,
    coalesce(cast(organisation.unit_ts.name_value as varchar), '(' || organisation.unit_ts.name_nilreason || ')') as name,
    coalesce(cast(organisation.unit_ts.type_value as varchar), '(' || organisation.unit_ts.type_nilreason || ')') as type,
    coalesce(cast(organisation.unit_ts.complianticao_value as varchar), '(' || organisation.unit_ts.complianticao_nilreason || ')') as complianticao,
    coalesce(cast(organisation.unit_ts.designator_value as varchar), '(' || organisation.unit_ts.designator_nilreason || ')') as designator,
    coalesce(cast(organisation.unit_ts.military_value as varchar), '(' || organisation.unit_ts.military_nilreason || ')') as military,
    geometry_elevatedpoint_view_jvjalr.geom AS geom,
    ST_X(geometry_elevatedpoint_view_jvjalr.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_jvjalr.geom) AS latitude,
    geometry_elevatedpoint_view_jvjalr.elevation,
    geometry_elevatedpoint_view_jvjalr.geoidUndulation,
    geometry_elevatedpoint_view_jvjalr.verticalDatum,
    geometry_elevatedpoint_view_jvjalr.verticalAccuracy,
    geometry_elevatedpoint_view_jvjalr.horizontalAccuracy,
    coalesce(cast(airport_heliport_airportheliport_pt_sgcdoy.title as varchar), '(' || airport_heliport_airportheliport_pt_sgcdoy.nilreason[1] || ')') AS airportlocation,
    airport_heliport_airportheliport_pt_sgcdoy.href AS airportlocation_href,
    coalesce(cast(organisation_organisationauthority_pt_gitmwm.title as varchar), '(' || organisation_organisationauthority_pt_gitmwm.nilreason[1] || ')') AS ownerorganisation,
    organisation_organisationauthority_pt_gitmwm.href AS ownerorganisation_href,
    jsonb_agg(organisation_unitdependency_view_lqdium.id) AS relatedunit,
    jsonb_agg(organisation_unitavailability_view_nstbby.id) AS availability,
    jsonb_agg(notes_note_view_qtdlmq.*) AS unit_annotation
from organisation.unit 
inner join master_join mj2 on organisation.unit.id = mj2.source_id
inner join organisation.unit_tsp on mj2.target_id = organisation.unit_tsp.id
inner join organisation.unit_ts on organisation.unit_tsp.unittimeslice_id = organisation.unit_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_jvjalr on organisation.unit_ts.position_id = geometry_elevatedpoint_view_jvjalr.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_sgcdoy on organisation.unit_ts.airportlocation_id = airport_heliport_airportheliport_pt_sgcdoy.id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_gitmwm on organisation.unit_ts.ownerorganisation_id = organisation_organisationauthority_pt_gitmwm.id
left join master_join master_join_vcahfm on organisation.unit_ts.id = master_join_vcahfm.source_id
left join shared.contactinformation_view shared_contactinformation_view_xvcxym on master_join_vcahfm.target_id = shared_contactinformation_view_xvcxym.id
left join master_join master_join_khnsng on organisation.unit_ts.id = master_join_khnsng.source_id
left join organisation.unitdependency_view organisation_unitdependency_view_lqdium on master_join_khnsng.target_id = organisation_unitdependency_view_lqdium.id
left join master_join master_join_vooknq on organisation.unit_ts.id = master_join_vooknq.source_id
left join organisation.unitavailability_view organisation_unitavailability_view_nstbby on master_join_vooknq.target_id = organisation_unitavailability_view_nstbby.id
left join master_join master_join_zmlpeo on organisation.unit_ts.id = master_join_zmlpeo.source_id
left join notes.note_view notes_note_view_qtdlmq on master_join_zmlpeo.target_id = notes_note_view_qtdlmq.id
where organisation.unit.feature_status = 'APPROVED'
  and organisation.unit_ts.feature_status = 'APPROVED'
group by
    organisation.unit.id,
    organisation.unit_ts.id,
    organisation.unit_tsp.id,
    organisation.unit.identifier,
    organisation.unit_ts.interpretation,
    organisation.unit_ts.sequence_number,
    organisation.unit_ts.correction_number,
    organisation.unit_ts.valid_time_begin,
    organisation.unit_ts.valid_time_end,
    organisation.unit_ts.feature_lifetime_begin,
    organisation.unit_ts.feature_lifetime_end,
    organisation.unit_ts.name_value,
    organisation.unit_ts.name_nilreason,
    organisation.unit_ts.type_value,
    organisation.unit_ts.type_nilreason,
    organisation.unit_ts.complianticao_value,
    organisation.unit_ts.complianticao_nilreason,
    organisation.unit_ts.designator_value,
    organisation.unit_ts.designator_nilreason,
    organisation.unit_ts.military_value,
    organisation.unit_ts.military_nilreason,
    geometry_elevatedpoint_view_jvjalr.geom,
    geometry_elevatedpoint_view_jvjalr.elevation,
    geometry_elevatedpoint_view_jvjalr.geoidUndulation,
    geometry_elevatedpoint_view_jvjalr.verticalDatum,
    geometry_elevatedpoint_view_jvjalr.verticalAccuracy,
    geometry_elevatedpoint_view_jvjalr.horizontalAccuracy,
    airport_heliport_airportheliport_pt_sgcdoy.title,
    airport_heliport_airportheliport_pt_sgcdoy.nilreason[1],
    airport_heliport_airportheliport_pt_sgcdoy.href,
    organisation_organisationauthority_pt_gitmwm.title,
    organisation_organisationauthority_pt_gitmwm.nilreason[1],
    organisation_organisationauthority_pt_gitmwm.href
order by unit.identifier, unit_ts.sequence_number, unit_ts.correction_number DESC;
-- UnplannedHoldingTimeSliceType
-- ['notes.note_view']
create or replace view holding.unplannedholding_view as
select distinct on (unplannedholding.identifier,unplannedholding_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    holding.unplannedholding.id,
    holding.unplannedholding_ts.id as ts_id,
    holding.unplannedholding_tsp.id as tsp_id,
    holding.unplannedholding.identifier,
    holding.unplannedholding_ts.interpretation,
    holding.unplannedholding_ts.sequence_number,
    holding.unplannedholding_ts.correction_number,
    holding.unplannedholding_ts.valid_time_begin,
    holding.unplannedholding_ts.valid_time_end,
    holding.unplannedholding_ts.feature_lifetime_begin,
    holding.unplannedholding_ts.feature_lifetime_end,
    coalesce(cast(holding.unplannedholding_ts.unplannedholding_value as varchar), '(' || holding.unplannedholding_ts.unplannedholding_nilreason || ')') as unplannedholding,
    coalesce(cast(holding.unplannedholding_ts.altitudereference_value as varchar), '(' || holding.unplannedholding_ts.altitudereference_nilreason || ')') as altitudereference,
    coalesce(cast(holding.unplannedholding_ts.controlledairspace_value as varchar), '(' || holding.unplannedholding_ts.controlledairspace_nilreason || ')') as controlledairspace,
    coalesce(cast(holding.unplannedholding_ts.authorizedaltitude_value as varchar) || ' ' || holding.unplannedholding_ts.authorizedaltitude_uom, '(' || holding.unplannedholding_ts.authorizedaltitude_nilreason || ')') as authorizedaltitude,
    jsonb_agg(notes_note_view_fpmkoq.*) AS unplannedholding_annotation
from holding.unplannedholding 
inner join master_join mj2 on holding.unplannedholding.id = mj2.source_id
inner join holding.unplannedholding_tsp on mj2.target_id = holding.unplannedholding_tsp.id
inner join holding.unplannedholding_ts on holding.unplannedholding_tsp.unplannedholdingtimeslice_id = holding.unplannedholding_ts.id
left join master_join master_join_zttisx on holding.unplannedholding_ts.id = master_join_zttisx.source_id
left join notes.note_view notes_note_view_fpmkoq on master_join_zttisx.target_id = notes_note_view_fpmkoq.id
where holding.unplannedholding.feature_status = 'APPROVED'
  and holding.unplannedholding_ts.feature_status = 'APPROVED'
group by
    holding.unplannedholding.id,
    holding.unplannedholding_ts.id,
    holding.unplannedholding_tsp.id,
    holding.unplannedholding.identifier,
    holding.unplannedholding_ts.interpretation,
    holding.unplannedholding_ts.sequence_number,
    holding.unplannedholding_ts.correction_number,
    holding.unplannedholding_ts.valid_time_begin,
    holding.unplannedholding_ts.valid_time_end,
    holding.unplannedholding_ts.feature_lifetime_begin,
    holding.unplannedholding_ts.feature_lifetime_end,
    holding.unplannedholding_ts.unplannedholding_value,
    holding.unplannedholding_ts.unplannedholding_nilreason,
    holding.unplannedholding_ts.altitudereference_value,
    holding.unplannedholding_ts.altitudereference_nilreason,
    holding.unplannedholding_ts.controlledairspace_value,
    holding.unplannedholding_ts.controlledairspace_nilreason,
    holding.unplannedholding_ts.authorizedaltitude_value,
    holding.unplannedholding_ts.authorizedaltitude_uom,
    holding.unplannedholding_ts.authorizedaltitude_nilreason
order by unplannedholding.identifier, unplannedholding_ts.sequence_number, unplannedholding_ts.correction_number DESC;
-- VerticalStructureTimeSliceType
-- ['obstacles.verticalstructurelightingstatus_view', 'obstacles.verticalstructurepart_view', 'notes.note_view']
create or replace view obstacles.verticalstructure_view as
select distinct on (verticalstructure.identifier,verticalstructure_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    obstacles.verticalstructure.id,
    obstacles.verticalstructure_ts.id as ts_id,
    obstacles.verticalstructure_tsp.id as tsp_id,
    obstacles.verticalstructure.identifier,
    obstacles.verticalstructure_ts.interpretation,
    obstacles.verticalstructure_ts.sequence_number,
    obstacles.verticalstructure_ts.correction_number,
    obstacles.verticalstructure_ts.valid_time_begin,
    obstacles.verticalstructure_ts.valid_time_end,
    obstacles.verticalstructure_ts.feature_lifetime_begin,
    obstacles.verticalstructure_ts.feature_lifetime_end,
    coalesce(cast(obstacles.verticalstructure_ts.name_value as varchar), '(' || obstacles.verticalstructure_ts.name_nilreason || ')') as name,
    coalesce(cast(obstacles.verticalstructure_ts.type_value as varchar), '(' || obstacles.verticalstructure_ts.type_nilreason || ')') as type,
    coalesce(cast(obstacles.verticalstructure_ts.lighted_value as varchar), '(' || obstacles.verticalstructure_ts.lighted_nilreason || ')') as lighted,
    coalesce(cast(obstacles.verticalstructure_ts.markingicaostandard_value as varchar), '(' || obstacles.verticalstructure_ts.markingicaostandard_nilreason || ')') as markingicaostandard,
    coalesce(cast(obstacles.verticalstructure_ts.group_value as varchar), '(' || obstacles.verticalstructure_ts.group_nilreason || ')') as group,
    coalesce(cast(obstacles.verticalstructure_ts.lightingicaostandard_value as varchar), '(' || obstacles.verticalstructure_ts.lightingicaostandard_nilreason || ')') as lightingicaostandard,
    coalesce(cast(obstacles.verticalstructure_ts.synchronisedlighting_value as varchar), '(' || obstacles.verticalstructure_ts.synchronisedlighting_nilreason || ')') as synchronisedlighting,
    coalesce(cast(obstacles.verticalstructure_ts.length_value as varchar) || ' ' || obstacles.verticalstructure_ts.length_uom, '(' || obstacles.verticalstructure_ts.length_nilreason || ')') as length,
    coalesce(cast(obstacles.verticalstructure_ts.width_value as varchar) || ' ' || obstacles.verticalstructure_ts.width_uom, '(' || obstacles.verticalstructure_ts.width_nilreason || ')') as width,
    coalesce(cast(obstacles.verticalstructure_ts.radius_value as varchar) || ' ' || obstacles.verticalstructure_ts.radius_uom, '(' || obstacles.verticalstructure_ts.radius_nilreason || ')') as radius,
    coalesce(cast(navaids_points_markerbeacon_pt_avopoa.title as varchar), '(' || navaids_points_markerbeacon_pt_avopoa.nilreason[1] || ')') AS marker,
    navaids_points_markerbeacon_pt_avopoa.href AS marker_href,
    jsonb_agg(obstacles_verticalstructurepart_view_gjkuab.id) AS part,
    jsonb_build_object('id', service_passengerservice_pt_jfghtr.id,
    'title', coalesce(cast(service_passengerservice_pt_jfghtr.title AS varchar), '(' || service_passengerservice_pt_jfghtr.nilreason[1] || ')'),
    'href', service_passengerservice_pt_jfghtr.href) AS hostedpassengerservice,
    jsonb_build_object('id', navaids_points_specialnavigationstation_pt_cywbaf.id,
    'title', coalesce(cast(navaids_points_specialnavigationstation_pt_cywbaf.title AS varchar), '(' || navaids_points_specialnavigationstation_pt_cywbaf.nilreason[1] || ')'),
    'href', navaids_points_specialnavigationstation_pt_cywbaf.href) AS hostedspecialnavstation,
    jsonb_build_object('id', organisation_unit_pt_megnff.id,
    'title', coalesce(cast(organisation_unit_pt_megnff.title AS varchar), '(' || organisation_unit_pt_megnff.nilreason[1] || ')'),
    'href', organisation_unit_pt_megnff.href) AS hostedunit,
    jsonb_build_object('id', organisation_organisationauthority_pt_fjodzj.id,
    'title', coalesce(cast(organisation_organisationauthority_pt_fjodzj.title AS varchar), '(' || organisation_organisationauthority_pt_fjodzj.nilreason[1] || ')'),
    'href', organisation_organisationauthority_pt_fjodzj.href) AS hostedorganisation,
    jsonb_agg(notes_note_view_opielc.*) AS verticalstructure_annotation,
    jsonb_agg(obstacles_verticalstructurelightingstatus_view_nklxoz.id) AS lightingavailability
from obstacles.verticalstructure 
inner join master_join mj2 on obstacles.verticalstructure.id = mj2.source_id
inner join obstacles.verticalstructure_tsp on mj2.target_id = obstacles.verticalstructure_tsp.id
inner join obstacles.verticalstructure_ts on obstacles.verticalstructure_tsp.verticalstructuretimeslice_id = obstacles.verticalstructure_ts.id
left join navaids_points.markerbeacon_pt navaids_points_markerbeacon_pt_avopoa on obstacles.verticalstructure_ts.marker_id = navaids_points_markerbeacon_pt_avopoa.id
left join master_join master_join_qykhvb on obstacles.verticalstructure_ts.id = master_join_qykhvb.source_id
left join obstacles.verticalstructurepart_view obstacles_verticalstructurepart_view_gjkuab on master_join_qykhvb.target_id = obstacles_verticalstructurepart_view_gjkuab.id
left join master_join master_join_phmzab on obstacles.verticalstructure_ts.id = master_join_phmzab.source_id
left join service.passengerservice_pt service_passengerservice_pt_jfghtr on master_join_phmzab.target_id = service_passengerservice_pt_jfghtr.id
left join master_join master_join_amklyt on obstacles.verticalstructure_ts.id = master_join_amklyt.source_id
left join navaids_points.specialnavigationstation_pt navaids_points_specialnavigationstation_pt_cywbaf on master_join_amklyt.target_id = navaids_points_specialnavigationstation_pt_cywbaf.id
left join master_join master_join_houesp on obstacles.verticalstructure_ts.id = master_join_houesp.source_id
left join organisation.unit_pt organisation_unit_pt_megnff on master_join_houesp.target_id = organisation_unit_pt_megnff.id
left join master_join master_join_pgscph on obstacles.verticalstructure_ts.id = master_join_pgscph.source_id
left join organisation.organisationauthority_pt organisation_organisationauthority_pt_fjodzj on master_join_pgscph.target_id = organisation_organisationauthority_pt_fjodzj.id
left join master_join master_join_ofcdif on obstacles.verticalstructure_ts.id = master_join_ofcdif.source_id
left join notes.note_view notes_note_view_opielc on master_join_ofcdif.target_id = notes_note_view_opielc.id
left join master_join master_join_dfwvtc on obstacles.verticalstructure_ts.id = master_join_dfwvtc.source_id
left join obstacles.verticalstructurelightingstatus_view obstacles_verticalstructurelightingstatus_view_nklxoz on master_join_dfwvtc.target_id = obstacles_verticalstructurelightingstatus_view_nklxoz.id
where obstacles.verticalstructure.feature_status = 'APPROVED'
  and obstacles.verticalstructure_ts.feature_status = 'APPROVED'
group by
    obstacles.verticalstructure.id,
    obstacles.verticalstructure_ts.id,
    obstacles.verticalstructure_tsp.id,
    obstacles.verticalstructure.identifier,
    obstacles.verticalstructure_ts.interpretation,
    obstacles.verticalstructure_ts.sequence_number,
    obstacles.verticalstructure_ts.correction_number,
    obstacles.verticalstructure_ts.valid_time_begin,
    obstacles.verticalstructure_ts.valid_time_end,
    obstacles.verticalstructure_ts.feature_lifetime_begin,
    obstacles.verticalstructure_ts.feature_lifetime_end,
    obstacles.verticalstructure_ts.name_value,
    obstacles.verticalstructure_ts.name_nilreason,
    obstacles.verticalstructure_ts.type_value,
    obstacles.verticalstructure_ts.type_nilreason,
    obstacles.verticalstructure_ts.lighted_value,
    obstacles.verticalstructure_ts.lighted_nilreason,
    obstacles.verticalstructure_ts.markingicaostandard_value,
    obstacles.verticalstructure_ts.markingicaostandard_nilreason,
    obstacles.verticalstructure_ts.group_value,
    obstacles.verticalstructure_ts.group_nilreason,
    obstacles.verticalstructure_ts.lightingicaostandard_value,
    obstacles.verticalstructure_ts.lightingicaostandard_nilreason,
    obstacles.verticalstructure_ts.synchronisedlighting_value,
    obstacles.verticalstructure_ts.synchronisedlighting_nilreason,
    obstacles.verticalstructure_ts.length_value,
    obstacles.verticalstructure_ts.length_uom,
    obstacles.verticalstructure_ts.length_nilreason,
    obstacles.verticalstructure_ts.width_value,
    obstacles.verticalstructure_ts.width_uom,
    obstacles.verticalstructure_ts.width_nilreason,
    obstacles.verticalstructure_ts.radius_value,
    obstacles.verticalstructure_ts.radius_uom,
    obstacles.verticalstructure_ts.radius_nilreason,
    navaids_points_markerbeacon_pt_avopoa.title,
    navaids_points_markerbeacon_pt_avopoa.nilreason[1],
    navaids_points_markerbeacon_pt_avopoa.href
order by verticalstructure.identifier, verticalstructure_ts.sequence_number, verticalstructure_ts.correction_number DESC;
-- VisualGlideSlopeIndicatorTimeSliceType
-- ['shared.lightelement_view', 'airport_heliport.groundlightingavailability_view', 'notes.note_view']
create or replace view airport_heliport.visualglideslopeindicator_view as
select distinct on (visualglideslopeindicator.identifier,visualglideslopeindicator_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.visualglideslopeindicator.id,
    airport_heliport.visualglideslopeindicator_ts.id as ts_id,
    airport_heliport.visualglideslopeindicator_tsp.id as tsp_id,
    airport_heliport.visualglideslopeindicator.identifier,
    airport_heliport.visualglideslopeindicator_ts.interpretation,
    airport_heliport.visualglideslopeindicator_ts.sequence_number,
    airport_heliport.visualglideslopeindicator_ts.correction_number,
    airport_heliport.visualglideslopeindicator_ts.valid_time_begin,
    airport_heliport.visualglideslopeindicator_ts.valid_time_end,
    airport_heliport.visualglideslopeindicator_ts.feature_lifetime_begin,
    airport_heliport.visualglideslopeindicator_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.visualglideslopeindicator_ts.emergencylighting_value as varchar), '(' || airport_heliport.visualglideslopeindicator_ts.emergencylighting_nilreason || ')') as emergencylighting,
    coalesce(cast(airport_heliport.visualglideslopeindicator_ts.intensitylevel_value as varchar), '(' || airport_heliport.visualglideslopeindicator_ts.intensitylevel_nilreason || ')') as intensitylevel,
    coalesce(cast(airport_heliport.visualglideslopeindicator_ts.colour_value as varchar), '(' || airport_heliport.visualglideslopeindicator_ts.colour_nilreason || ')') as colour,
    coalesce(cast(airport_heliport.visualglideslopeindicator_ts.type_value as varchar), '(' || airport_heliport.visualglideslopeindicator_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport.visualglideslopeindicator_ts.position_value as varchar), '(' || airport_heliport.visualglideslopeindicator_ts.position_nilreason || ')') as position,
    coalesce(cast(airport_heliport.visualglideslopeindicator_ts.numberbox_value as varchar), '(' || airport_heliport.visualglideslopeindicator_ts.numberbox_nilreason || ')') as numberbox,
    coalesce(cast(airport_heliport.visualglideslopeindicator_ts.portable_value as varchar), '(' || airport_heliport.visualglideslopeindicator_ts.portable_nilreason || ')') as portable,
    coalesce(cast(airport_heliport.visualglideslopeindicator_ts.slopeangle_value as varchar), '(' || airport_heliport.visualglideslopeindicator_ts.slopeangle_nilreason || ')') as slopeangle,
    coalesce(cast(airport_heliport.visualglideslopeindicator_ts.minimumeyeheightoverthreshold_value as varchar) || ' ' || airport_heliport.visualglideslopeindicator_ts.minimumeyeheightoverthreshold_uom, '(' || airport_heliport.visualglideslopeindicator_ts.minimumeyeheightoverthreshold_nilreason || ')') as minimumeyeheightoverthreshold,
    coalesce(cast(airport_heliport_runwaydirection_pt_tqokbz.title as varchar), '(' || airport_heliport_runwaydirection_pt_tqokbz.nilreason[1] || ')') AS runwaydirection,
    airport_heliport_runwaydirection_pt_tqokbz.href AS runwaydirection_href,
    jsonb_agg(shared_lightelement_view_bxkxas.id) AS element,
    jsonb_agg(airport_heliport_groundlightingavailability_view_bfwipt.id) AS availability,
    jsonb_agg(notes_note_view_srpsyh.*) AS visualglideslopeindicator_annotation
from airport_heliport.visualglideslopeindicator 
inner join master_join mj2 on airport_heliport.visualglideslopeindicator.id = mj2.source_id
inner join airport_heliport.visualglideslopeindicator_tsp on mj2.target_id = airport_heliport.visualglideslopeindicator_tsp.id
inner join airport_heliport.visualglideslopeindicator_ts on airport_heliport.visualglideslopeindicator_tsp.visualglideslopeindicatortimeslice_id = airport_heliport.visualglideslopeindicator_ts.id
left join airport_heliport.runwaydirection_pt airport_heliport_runwaydirection_pt_tqokbz on airport_heliport.visualglideslopeindicator_ts.runwaydirection_id = airport_heliport_runwaydirection_pt_tqokbz.id
left join master_join master_join_gleqlx on airport_heliport.visualglideslopeindicator_ts.id = master_join_gleqlx.source_id
left join shared.lightelement_view shared_lightelement_view_bxkxas on master_join_gleqlx.target_id = shared_lightelement_view_bxkxas.id
left join master_join master_join_pqfdht on airport_heliport.visualglideslopeindicator_ts.id = master_join_pqfdht.source_id
left join airport_heliport.groundlightingavailability_view airport_heliport_groundlightingavailability_view_bfwipt on master_join_pqfdht.target_id = airport_heliport_groundlightingavailability_view_bfwipt.id
left join master_join master_join_hmixhl on airport_heliport.visualglideslopeindicator_ts.id = master_join_hmixhl.source_id
left join notes.note_view notes_note_view_srpsyh on master_join_hmixhl.target_id = notes_note_view_srpsyh.id
where airport_heliport.visualglideslopeindicator.feature_status = 'APPROVED'
  and airport_heliport.visualglideslopeindicator_ts.feature_status = 'APPROVED'
group by
    airport_heliport.visualglideslopeindicator.id,
    airport_heliport.visualglideslopeindicator_ts.id,
    airport_heliport.visualglideslopeindicator_tsp.id,
    airport_heliport.visualglideslopeindicator.identifier,
    airport_heliport.visualglideslopeindicator_ts.interpretation,
    airport_heliport.visualglideslopeindicator_ts.sequence_number,
    airport_heliport.visualglideslopeindicator_ts.correction_number,
    airport_heliport.visualglideslopeindicator_ts.valid_time_begin,
    airport_heliport.visualglideslopeindicator_ts.valid_time_end,
    airport_heliport.visualglideslopeindicator_ts.feature_lifetime_begin,
    airport_heliport.visualglideslopeindicator_ts.feature_lifetime_end,
    airport_heliport.visualglideslopeindicator_ts.emergencylighting_value,
    airport_heliport.visualglideslopeindicator_ts.emergencylighting_nilreason,
    airport_heliport.visualglideslopeindicator_ts.intensitylevel_value,
    airport_heliport.visualglideslopeindicator_ts.intensitylevel_nilreason,
    airport_heliport.visualglideslopeindicator_ts.colour_value,
    airport_heliport.visualglideslopeindicator_ts.colour_nilreason,
    airport_heliport.visualglideslopeindicator_ts.type_value,
    airport_heliport.visualglideslopeindicator_ts.type_nilreason,
    airport_heliport.visualglideslopeindicator_ts.position_value,
    airport_heliport.visualglideslopeindicator_ts.position_nilreason,
    airport_heliport.visualglideslopeindicator_ts.numberbox_value,
    airport_heliport.visualglideslopeindicator_ts.numberbox_nilreason,
    airport_heliport.visualglideslopeindicator_ts.portable_value,
    airport_heliport.visualglideslopeindicator_ts.portable_nilreason,
    airport_heliport.visualglideslopeindicator_ts.slopeangle_value,
    airport_heliport.visualglideslopeindicator_ts.slopeangle_nilreason,
    airport_heliport.visualglideslopeindicator_ts.minimumeyeheightoverthreshold_value,
    airport_heliport.visualglideslopeindicator_ts.minimumeyeheightoverthreshold_uom,
    airport_heliport.visualglideslopeindicator_ts.minimumeyeheightoverthreshold_nilreason,
    airport_heliport_runwaydirection_pt_tqokbz.title,
    airport_heliport_runwaydirection_pt_tqokbz.nilreason[1],
    airport_heliport_runwaydirection_pt_tqokbz.href
order by visualglideslopeindicator.identifier, visualglideslopeindicator_ts.sequence_number, visualglideslopeindicator_ts.correction_number DESC;
-- VORTimeSliceType
-- ['navaids_points.navaidoperationalstatus_view', 'navaids_points.authorityfornavaidequipment_view', 'notes.note_view', 'geometry.elevatedpoint_view', 'navaids_points.navaidequipmentmonitoring_view']
create or replace view navaids_points.vor_view as
select distinct on (vor.identifier,vor_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    navaids_points.vor.id,
    navaids_points.vor_ts.id as ts_id,
    navaids_points.vor_tsp.id as tsp_id,
    navaids_points.vor.identifier,
    navaids_points.vor_ts.interpretation,
    navaids_points.vor_ts.sequence_number,
    navaids_points.vor_ts.correction_number,
    navaids_points.vor_ts.valid_time_begin,
    navaids_points.vor_ts.valid_time_end,
    navaids_points.vor_ts.feature_lifetime_begin,
    navaids_points.vor_ts.feature_lifetime_end,
    coalesce(cast(navaids_points.vor_ts.designator_value as varchar), '(' || navaids_points.vor_ts.designator_nilreason || ')') as designator,
    coalesce(cast(navaids_points.vor_ts.name_value as varchar), '(' || navaids_points.vor_ts.name_nilreason || ')') as name,
    coalesce(cast(navaids_points.vor_ts.emissionclass_value as varchar), '(' || navaids_points.vor_ts.emissionclass_nilreason || ')') as emissionclass,
    coalesce(cast(navaids_points.vor_ts.mobile_value as varchar), '(' || navaids_points.vor_ts.mobile_nilreason || ')') as mobile,
    coalesce(cast(navaids_points.vor_ts.magneticvariation_value as varchar), '(' || navaids_points.vor_ts.magneticvariation_nilreason || ')') as magneticvariation,
    coalesce(cast(navaids_points.vor_ts.magneticvariationaccuracy_value as varchar), '(' || navaids_points.vor_ts.magneticvariationaccuracy_nilreason || ')') as magneticvariationaccuracy,
    coalesce(cast(navaids_points.vor_ts.datemagneticvariation_value as varchar), '(' || navaids_points.vor_ts.datemagneticvariation_nilreason || ')') as datemagneticvariation,
    coalesce(cast(navaids_points.vor_ts.flightchecked_value as varchar), '(' || navaids_points.vor_ts.flightchecked_nilreason || ')') as flightchecked,
    coalesce(cast(navaids_points.vor_ts.type_value as varchar), '(' || navaids_points.vor_ts.type_nilreason || ')') as type,
    coalesce(cast(navaids_points.vor_ts.zerobearingdirection_value as varchar), '(' || navaids_points.vor_ts.zerobearingdirection_nilreason || ')') as zerobearingdirection,
    coalesce(cast(navaids_points.vor_ts.declination_value as varchar), '(' || navaids_points.vor_ts.declination_nilreason || ')') as declination,
    coalesce(cast(navaids_points.vor_ts.frequency_value as varchar) || ' ' || navaids_points.vor_ts.frequency_uom, '(' || navaids_points.vor_ts.frequency_nilreason || ')') as frequency,
    geometry_elevatedpoint_view_dyxkib.geom AS geom,
    ST_X(geometry_elevatedpoint_view_dyxkib.geom) AS longitude,
    ST_Y(geometry_elevatedpoint_view_dyxkib.geom) AS latitude,
    geometry_elevatedpoint_view_dyxkib.elevation,
    geometry_elevatedpoint_view_dyxkib.geoidUndulation,
    geometry_elevatedpoint_view_dyxkib.verticalDatum,
    geometry_elevatedpoint_view_dyxkib.verticalAccuracy,
    geometry_elevatedpoint_view_dyxkib.horizontalAccuracy,
    jsonb_agg(navaids_points_authorityfornavaidequipment_view_kqjyuc.id) AS authority,
    jsonb_agg(navaids_points_navaidequipmentmonitoring_view_sgyslc.id) AS monitoring,
    jsonb_agg(navaids_points_navaidoperationalstatus_view_gjvths.id) AS availability,
    jsonb_agg(notes_note_view_qmhuxq.*) AS vor_annotation
from navaids_points.vor 
inner join master_join mj2 on navaids_points.vor.id = mj2.source_id
inner join navaids_points.vor_tsp on mj2.target_id = navaids_points.vor_tsp.id
inner join navaids_points.vor_ts on navaids_points.vor_tsp.vortimeslice_id = navaids_points.vor_ts.id
left join geometry.elevatedpoint_view geometry_elevatedpoint_view_dyxkib on navaids_points.vor_ts.location_id = geometry_elevatedpoint_view_dyxkib.id
left join master_join master_join_ymvsdx on navaids_points.vor_ts.id = master_join_ymvsdx.source_id
left join navaids_points.authorityfornavaidequipment_view navaids_points_authorityfornavaidequipment_view_kqjyuc on master_join_ymvsdx.target_id = navaids_points_authorityfornavaidequipment_view_kqjyuc.id
left join master_join master_join_azagkt on navaids_points.vor_ts.id = master_join_azagkt.source_id
left join navaids_points.navaidequipmentmonitoring_view navaids_points_navaidequipmentmonitoring_view_sgyslc on master_join_azagkt.target_id = navaids_points_navaidequipmentmonitoring_view_sgyslc.id
left join master_join master_join_dxvkvt on navaids_points.vor_ts.id = master_join_dxvkvt.source_id
left join navaids_points.navaidoperationalstatus_view navaids_points_navaidoperationalstatus_view_gjvths on master_join_dxvkvt.target_id = navaids_points_navaidoperationalstatus_view_gjvths.id
left join master_join master_join_dzhyvg on navaids_points.vor_ts.id = master_join_dzhyvg.source_id
left join notes.note_view notes_note_view_qmhuxq on master_join_dzhyvg.target_id = notes_note_view_qmhuxq.id
where navaids_points.vor.feature_status = 'APPROVED'
  and navaids_points.vor_ts.feature_status = 'APPROVED'
group by
    navaids_points.vor.id,
    navaids_points.vor_ts.id,
    navaids_points.vor_tsp.id,
    navaids_points.vor.identifier,
    navaids_points.vor_ts.interpretation,
    navaids_points.vor_ts.sequence_number,
    navaids_points.vor_ts.correction_number,
    navaids_points.vor_ts.valid_time_begin,
    navaids_points.vor_ts.valid_time_end,
    navaids_points.vor_ts.feature_lifetime_begin,
    navaids_points.vor_ts.feature_lifetime_end,
    navaids_points.vor_ts.designator_value,
    navaids_points.vor_ts.designator_nilreason,
    navaids_points.vor_ts.name_value,
    navaids_points.vor_ts.name_nilreason,
    navaids_points.vor_ts.emissionclass_value,
    navaids_points.vor_ts.emissionclass_nilreason,
    navaids_points.vor_ts.mobile_value,
    navaids_points.vor_ts.mobile_nilreason,
    navaids_points.vor_ts.magneticvariation_value,
    navaids_points.vor_ts.magneticvariation_nilreason,
    navaids_points.vor_ts.magneticvariationaccuracy_value,
    navaids_points.vor_ts.magneticvariationaccuracy_nilreason,
    navaids_points.vor_ts.datemagneticvariation_value,
    navaids_points.vor_ts.datemagneticvariation_nilreason,
    navaids_points.vor_ts.flightchecked_value,
    navaids_points.vor_ts.flightchecked_nilreason,
    navaids_points.vor_ts.type_value,
    navaids_points.vor_ts.type_nilreason,
    navaids_points.vor_ts.zerobearingdirection_value,
    navaids_points.vor_ts.zerobearingdirection_nilreason,
    navaids_points.vor_ts.declination_value,
    navaids_points.vor_ts.declination_nilreason,
    navaids_points.vor_ts.frequency_value,
    navaids_points.vor_ts.frequency_uom,
    navaids_points.vor_ts.frequency_nilreason,
    geometry_elevatedpoint_view_dyxkib.geom,
    geometry_elevatedpoint_view_dyxkib.elevation,
    geometry_elevatedpoint_view_dyxkib.geoidUndulation,
    geometry_elevatedpoint_view_dyxkib.verticalDatum,
    geometry_elevatedpoint_view_dyxkib.verticalAccuracy,
    geometry_elevatedpoint_view_dyxkib.horizontalAccuracy
order by vor.identifier, vor_ts.sequence_number, vor_ts.correction_number DESC;
-- WorkAreaTimeSliceType
-- ['geometry.elevatedsurface_view', 'notes.note_view', 'airport_heliport.workareaactivity_view']
create or replace view airport_heliport.workarea_view as
select distinct on (workarea.identifier,workarea_ts.sequence_number)
    (row_number() OVER ())::integer AS row,
    airport_heliport.workarea.id,
    airport_heliport.workarea_ts.id as ts_id,
    airport_heliport.workarea_tsp.id as tsp_id,
    airport_heliport.workarea.identifier,
    airport_heliport.workarea_ts.interpretation,
    airport_heliport.workarea_ts.sequence_number,
    airport_heliport.workarea_ts.correction_number,
    airport_heliport.workarea_ts.valid_time_begin,
    airport_heliport.workarea_ts.valid_time_end,
    airport_heliport.workarea_ts.feature_lifetime_begin,
    airport_heliport.workarea_ts.feature_lifetime_end,
    coalesce(cast(airport_heliport.workarea_ts.plannedOperational_value as varchar), '(' || airport_heliport.workarea_ts.plannedOperational_nilreason || ')') as plannedOperational,
    coalesce(cast(airport_heliport.workarea_ts.type_value as varchar), '(' || airport_heliport.workarea_ts.type_nilreason || ')') as type,
    coalesce(cast(airport_heliport_airportheliport_pt_ibdpiz.title as varchar), '(' || airport_heliport_airportheliport_pt_ibdpiz.nilreason[1] || ')') AS associatedairportheliport,
    airport_heliport_airportheliport_pt_ibdpiz.href AS associatedairportheliport_href,
    geometry_elevatedsurface_view_ihrtts.geom AS geom,
    geometry_elevatedsurface_view_ihrtts.elevation,
    geometry_elevatedsurface_view_ihrtts.geoidUndulation,
    geometry_elevatedsurface_view_ihrtts.verticalDatum,
    geometry_elevatedsurface_view_ihrtts.verticalAccuracy,
    geometry_elevatedsurface_view_ihrtts.horizontalAccuracy,
    jsonb_agg(airport_heliport_workareaactivity_view_cpbjzz.id) AS activation,
    jsonb_agg(notes_note_view_qbmyae.*) AS workarea_annotation
from airport_heliport.workarea 
inner join master_join mj2 on airport_heliport.workarea.id = mj2.source_id
inner join airport_heliport.workarea_tsp on mj2.target_id = airport_heliport.workarea_tsp.id
inner join airport_heliport.workarea_ts on airport_heliport.workarea_tsp.workareatimeslice_id = airport_heliport.workarea_ts.id
left join airport_heliport.airportheliport_pt airport_heliport_airportheliport_pt_ibdpiz on airport_heliport.workarea_ts.associatedairportheliport_id = airport_heliport_airportheliport_pt_ibdpiz.id
left join geometry.elevatedsurface_view geometry_elevatedsurface_view_ihrtts on airport_heliport.workarea_ts.extent_id = geometry_elevatedsurface_view_ihrtts.id
left join master_join master_join_nhmmmh on airport_heliport.workarea_ts.id = master_join_nhmmmh.source_id
left join airport_heliport.workareaactivity_view airport_heliport_workareaactivity_view_cpbjzz on master_join_nhmmmh.target_id = airport_heliport_workareaactivity_view_cpbjzz.id
left join master_join master_join_lajxut on airport_heliport.workarea_ts.id = master_join_lajxut.source_id
left join notes.note_view notes_note_view_qbmyae on master_join_lajxut.target_id = notes_note_view_qbmyae.id
where airport_heliport.workarea.feature_status = 'APPROVED'
  and airport_heliport.workarea_ts.feature_status = 'APPROVED'
group by
    airport_heliport.workarea.id,
    airport_heliport.workarea_ts.id,
    airport_heliport.workarea_tsp.id,
    airport_heliport.workarea.identifier,
    airport_heliport.workarea_ts.interpretation,
    airport_heliport.workarea_ts.sequence_number,
    airport_heliport.workarea_ts.correction_number,
    airport_heliport.workarea_ts.valid_time_begin,
    airport_heliport.workarea_ts.valid_time_end,
    airport_heliport.workarea_ts.feature_lifetime_begin,
    airport_heliport.workarea_ts.feature_lifetime_end,
    airport_heliport.workarea_ts.plannedOperational_value,
    airport_heliport.workarea_ts.plannedOperational_nilreason,
    airport_heliport.workarea_ts.type_value,
    airport_heliport.workarea_ts.type_nilreason,
    airport_heliport_airportheliport_pt_ibdpiz.title,
    airport_heliport_airportheliport_pt_ibdpiz.nilreason[1],
    airport_heliport_airportheliport_pt_ibdpiz.href,
    geometry_elevatedsurface_view_ihrtts.geom,
    geometry_elevatedsurface_view_ihrtts.elevation,
    geometry_elevatedsurface_view_ihrtts.geoidUndulation,
    geometry_elevatedsurface_view_ihrtts.verticalDatum,
    geometry_elevatedsurface_view_ihrtts.verticalAccuracy,
    geometry_elevatedsurface_view_ihrtts.horizontalAccuracy
order by workarea.identifier, workarea_ts.sequence_number, workarea_ts.correction_number DESC;
